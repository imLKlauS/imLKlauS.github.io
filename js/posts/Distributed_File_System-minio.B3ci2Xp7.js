import{u as i,p as s,o as l,c as a,w as h,a as k,_ as t,r as n,b as e,d as E}from"../../assets/app-Dzcvbt2R.js";const p=e("h2",{id:"一-分布式文件系统",tabindex:"-1"},[e("strong",null,"一 分布式文件系统"),E(),e("a",{class:"header-anchor",href:"#一-分布式文件系统","aria-label":'Permalink to "**一 分布式文件系统**"'},"​")],-1),r=e("h3",{id:"_1-1-什么是分布式文件系统",tabindex:"-1"},[e("strong",null,"1.1 什么是分布式文件系统"),E(),e("a",{class:"header-anchor",href:"#_1-1-什么是分布式文件系统","aria-label":'Permalink to "**1.1 什么是分布式文件系统**"'},"​")],-1),d=e("p",null,"要理解分布式文件系统首先了解什么是文件系统。",-1),g=e("p",null,"查阅百度百科：",-1),y=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps49.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),F=e("p",null,"​ 文件系统是负责管理和存储文件的系统软件，操作系统通过文件系统提供的接口去存取文件，用户通过操作系统访问磁盘上的文件。",-1),c=e("p",null,"下图指示了文件系统所处的位置：",-1),o=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps50.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),A=e("p",null,"常见的文件系统：FAT16/FAT32、NTFS、HFS、UFS、APFS、XFS、Ext4等 。",-1),D=e("p",null,"现在有个问题，一此短视频平台拥有大量的视频、图片，这些视频文件、图片文件该如何存储呢？如何存储可以满足互联网上海量用户的浏览。",-1),u=e("p",null,"今天讲的分布式文件系统就是海量用户查阅海量文件的方案。",-1),m=e("p",null,"我们阅读百度百科去理解分布式文件系统的定义：",-1),C=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps51.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),B=e("p",null,"通过概念可以简单理解为：一个计算机无法存储海量的文件，通过网络将若干计算机组织起来共同去存储海量的文件，去接收海量用户的请求，这些组织起来的计算机通过网络进行通信，如下图：",-1),b=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/image-20230704215201202.png",alt:"image-20230704215201202",loading:"lazy",decoding:"async",class:"lazy"})],-1),v=e("p",null,"好处：",-1),f=e("blockquote",null,[e("p",null,"1、一台计算机的文件系统处理能力扩充到多台计算机同时处理。"),e("p",null,"2、一台计算机挂了还有另外副本计算机提供数据。"),e("p",null,"3、每台计算机可以放在不同的地域，这样用户就可以就近访问，提高访问速度。")],-1),S=e("p",null,"市面上有哪些分布式文件系统的产品呢？",-1),j=e("p",null,"1、NFS",-1),M=e("p",null,"阅读百度百科：",-1),x=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps53.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),P=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps54.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),_=e("p",null,"特点：",-1),I=e("p",null,"1）在客户端上映射NFS服务器的驱动器。",-1),T=e("p",null,"2）客户端通过网络访问NFS服务器的硬盘完全透明。",-1),O=e("p",null,"2、GFS",-1),R=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps55.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),w=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps56.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),z=e("p",null,"1）GFS采用主从结构，一个GFS集群由一个master和大量的chunkserver组成。",-1),L=e("p",null,"2）master存储了数据文件的元数据，一个文件被分成了若干块存储在多个chunkserver中。",-1),N=e("p",null,"3）用户从master中获取数据元信息，向chunkserver存储数据。",-1),U=e("p",null,"3、HDFS",-1),K=e("p",null,"HDFS，是Hadoop Distributed File System的简称，是Hadoop抽象文件系统的一种实现。HDFS是一个高度容错性的系统，适合部署在廉价的机器上。HDFS能提供高吞吐量的数据访问，非常适合大规模数据集上的应用。 HDFS的文件分布在集群机器上，同时提供副本进行容错及可靠性保证。例如客户端写入读取文件的直接操作都是分布在集群各个机器上的，没有单点性能压力。",-1),q=e("p",null,"下图是HDFS的架构图：",-1),H=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/image-20230704215636100.png",alt:"image-20230704215636100",loading:"lazy",decoding:"async",class:"lazy"})],-1),$=e("p",null,"1）HDFS采用主从结构，一个HDFS集群由一个名称结点和若干数据结点组成。",-1),W=e("p",null,"2）名称结点存储数据的元信息，一个完整的数据文件分成若干块存储在数据结点。",-1),G=e("p",null,"3）客户端从名称结点获取数据的元信息及数据分块的信息，得到信息客户端即可从数据块来存取数据。",-1),V=e("p",null,[e("strong",null,"4、云计算厂家")],-1),X=e("p",null,"阿里云对象存储服务（Object Storage Service，简称 OSS），是阿里云提供的海量、安全、低成本、高可靠的云存储服务。其数据设计持久性不低于 99.9999999999%（12 个 9），服务设计可用性（或业务连续性）不低于 99.995%。",-1),J=e("p",null,[e("em",null,"官方网站："),e("a",{href:"https://www.aliyun.com/product/oss",target:"_blank",rel:"noreferrer"},[e("em",null,"https://www.aliyun.com/product/oss")])],-1),Y=e("p",null,"百度对象存储BOS提供稳定、安全、高效、高可扩展的云存储服务。您可以将任意数量和形式的非结构化数据存入BOS，并对数据进行管理和处理。BOS支持标准、低频、冷和归档存储等多种存储类型，满足多场景的存储需求。",-1),Q=e("p",null,[e("em",null,"官方网站："),e("a",{href:"https://cloud.baidu.com/product/bos.html",target:"_blank",rel:"noreferrer"},[e("em",null,"https://cloud.baidu.com/product/bos.html")])],-1),Z=e("h3",{id:"_1-2-minio",tabindex:"-1"},[e("strong",null,"1.2 MinIO"),E(),e("a",{class:"header-anchor",href:"#_1-2-minio","aria-label":'Permalink to "**1.2 MinIO**"'},"​")],-1),ii=e("h4",{id:"_1-2-1-介绍",tabindex:"-1"},[e("strong",null,"1.2.1 介绍"),E(),e("a",{class:"header-anchor",href:"#_1-2-1-介绍","aria-label":'Permalink to "**1.2.1 介绍**"'},"​")],-1),si=e("p",null,"本项目采用MinIO构建分布式文件系统，MinIO 是一个非常轻量的服务,可以很简单的和其他应用的结合使用，它兼容亚马逊 S3 云存储服务接口，非常适合于存储大容量非结构化的数据，例如图片、视频、日志文件、备份数据和容器/虚拟机镜像等。",-1),li=e("p",null,"它一大特点就是轻量，使用简单，功能强大，支持各种平台，单个文件最大5TB，兼容 Amazon S3接口，提供了 Java、Python、GO等多版本SDK支持。",-1),ai=e("p",null,[E("官网："),e("a",{href:"https://min.io",target:"_blank",rel:"noreferrer"},"https://min.io")],-1),hi=e("p",null,[E("中文："),e("a",{href:"https://www.minio.org.cn/%EF%BC%8Chttp://docs.minio.org.cn/docs/",target:"_blank",rel:"noreferrer"},"https://www.minio.org.cn/，http://docs.minio.org.cn/docs/")],-1),ki=e("p",null,"MinIO集群采用去中心化共享架构，每个结点是对等关系，通过Nginx可对MinIO进行负载均衡访问。",-1),ti=e("p",null,"去中心化有什么好处？",-1),ni=e("p",null,"在大数据领域，通常的设计理念都是无中心和分布式。Minio分布式模式可以帮助你搭建一个高可用的对象存储服务，你可以使用这些存储设备，而不用考虑其真实物理位置。",-1),ei=e("p",null,"它将分布在不同服务器上的多块硬盘组成一个对象存储服务。由于硬盘分布在不同的节点上，分布式Minio避免了单点故障。如下图：",-1),Ei=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps58.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),pi=e("p",null,"Minio使用纠删码技术来保护数据，它是一种恢复丢失和损坏数据的数学算法，它将数据分块冗余的分散存储在各各节点的磁盘上，所有的可用磁盘组成一个集合，上图由8块硬盘组成一个集合，当上传一个文件时会通过纠删码算法计算对文件进行分块存储，除了将文件本身分成4个数据块，还会生成4个校验块，数据块和校验块会分散的存储在这8块硬盘上。",-1),ri=e("p",null,"使用纠删码的好处是即便丢失一半数量（N/2）的硬盘，仍然可以恢复数据。 比如上边集合中有4个以内的硬盘损害仍可保证数据恢复，不影响上传和下载，如果多于一半的硬盘坏了则无法恢复。",-1),di=e("h4",{id:"_1-2-2-数据恢复演示",tabindex:"-1"},[e("strong",null,"1.2.2 数据恢复演示"),E(),e("a",{class:"header-anchor",href:"#_1-2-2-数据恢复演示","aria-label":'Permalink to "**1.2.2 数据恢复演示**"'},"​")],-1),gi=e("p",null,"下边在本机演示MinIO恢复数据的过程，在本地创建4个目录表示4个硬盘。",-1),yi=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps59.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),Fi=e("p",null,[E("下载minio，下载地址在"),e("a",{href:"https://dl.min.io/server/minio/release/%EF%BC%8C%E5%8F%AF%E4%BB%8E%E8%AF%BE%E7%A8%8B%E8%B5%84%E6%96%99%E6%89%BE%E5%88%B0MinIO%E7%9A%84%E5%AE%89%E8%A3%85%E6%96%87%E4%BB%B6minio.zip%E8%A7%A3%E5%8E%8B%E5%8D%B3%E5%8F%AF%E4%BD%BF%E7%94%A8%EF%BC%8CCMD%E8%BF%9B%E5%85%A5%E6%9C%89minio.exe%E7%9A%84%E7%9B%AE%E5%BD%95%EF%BC%8C%E8%BF%90%E8%A1%8C%E4%B8%8B%E8%BE%B9%E7%9A%84%E5%91%BD%E4%BB%A4%EF%BC%9A",target:"_blank",rel:"noreferrer"},"https://dl.min.io/server/minio/release/，可从课程资料找到MinIO的安装文件minio.zip解压即可使用，CMD进入有minio.exe的目录，运行下边的命令：")],-1),ci=e("div",{style:{"max-height":"300px"},class:"language-shell vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"shell"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"minio.exe"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," server"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," D:"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\d"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"evelop"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\m"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"inio_data"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\d"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"ata1"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  D:"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\d"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"evelop"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\m"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"inio_data"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\d"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"ata2"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  D:"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\d"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"evelop"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\m"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"inio_data"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\d"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"ata3"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  D:"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\d"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"evelop"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\m"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"inio_data"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\d"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"ata4")])])]),e("button",{class:"collapse"})],-1),oi=e("p",null,"启动结果如下：",-1),Ai=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps60.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),Di=e("p",null,"说明如下：",-1),ui=e("p",null,[e("code",null,"WARNING: MINIO_ACCESS_KEY and MINIO_SECRET_KEY are deprecated. Please use MINIO_ROOT_USER and MINIO_ROOT_PASSWORD Formatting 1st pool, 1 set(s), 4 drives per set. WARNING: Host local has more than 2 drives of set. A host failure will result in data becoming unavailable. WARNING: Detected default credentials 'minioadmin:minioadmin', we recommend that you change these values with 'MINIO_ROOT_USER' and 'MINIO_ROOT_PASSWORD' environment variables")],-1),mi=e("p",null,"1）老版本使用的MINIO_ACCESS_KEY 和 MINIO_SECRET_KEY不推荐使用，推荐使用MINIO_ROOT_USER 和MINIO_ROOT_PASSWORD设置账号和密码。",-1),Ci=e("p",null,"2）pool即minio节点组成的池子，当前有一个pool和4个硬盘组成的set集合",-1),Bi=e("p",null,"3）因为集合是4个硬盘，大于2的硬盘损坏数据将无法恢复。",-1),bi=e("p",null,"4）账号和密码默认为minioadmin、minioadmin，可以在环境变量中设置通过’MINIO_ROOT_USER’ and 'MINIO_ROOT_PASSWORD' 进行设置。",-1),vi=e("p",null,"下边输入http://localhost:9000进行登录，账号和密码为：minioadmin/minioadmin",-1),fi=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps61.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),Si=e("p",null,"登录成功：",-1),ji=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps62.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),Mi=e("p",null,"下一步创建bucket，桶，它相当于存储文件的目录，可以创建若干的桶。",-1),xi=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/image-20230704220604232.png",alt:"image-20230704220604232",loading:"lazy",decoding:"async",class:"lazy"})],-1),Pi=e("p",null,"输入bucket的名称，点击“CreateBucket”，创建成功",-1),_i=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps64.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),Ii=e("p",null,"点击“upload”上传文件。",-1),Ti=e("p",null,"下边上传几个文件",-1),Oi=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps65.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),Ri=e("p",null,"下边去四个目录观察文件的存储情况",-1),wi=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps66.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),zi=e("p",null,"我们发现上传的1.mp4文件存储在了四个目录，即四个硬盘上。",-1),Li=e("p",null,"下边测试minio的数据恢复过程：",-1),Ni=e("p",null,"1、首先删除一个目录。",-1),Ui=e("p",null,"删除目录后仍然可以在web控制台上传文件和下载文件。",-1),Ki=e("p",null,"稍等片刻删除的目录自动恢复。",-1),qi=e("p",null,"2、删除两个目录。",-1),Hi=e("p",null,"删除两个目录也会自动恢复。",-1),$i=e("p",null,"3、删除三个目录 。",-1),Wi=e("p",null,"由于 集合中共有4块硬盘，有大于一半的硬盘损坏数据无法恢复。",-1),Gi=e("p",null,[E("此时报错："),e("code",null,"We encountered an internal error, please try again. (Read failed. Insufficient number of drives online)"),E("在线驱动器数量不足。")],-1),Vi=e("h4",{id:"_1-2-3-测试docker环境",tabindex:"-1"},[e("strong",null,"1.2.3 测试Docker环境"),E(),e("a",{class:"header-anchor",href:"#_1-2-3-测试docker环境","aria-label":'Permalink to "**1.2.3 测试Docker环境**"'},"​")],-1),Xi=e("p",null,"开发阶段和生产阶段统一使用Docker下的MINIO。",-1),Ji=e("p",null,"在下发的虚拟机中已安装了MinIO的镜像和容器，执行sh /data/soft /restart.sh启动Docker下的MinIO",-1),Yi=e("p",null,"启动完成登录MinIO查看是否正常。",-1),Qi=e("p",null,[E("访问"),e("a",{href:"http://192.168.2.203:9000",target:"_blank",rel:"noreferrer"},"http://192.168.2.203:9000")],-1),Zi=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/image-20230704221009748.png",alt:"image-20230704221009748",loading:"lazy",decoding:"async",class:"lazy"})],-1),is=e("p",null,"本项目创建两个buckets：",-1),ss=e("p",null,"mediafiles： 普通文件",-1),ls=e("p",null,"video：视频文件",-1),as=e("h4",{id:"_1-2-4-sdk",tabindex:"-1"},[e("strong",null,"1.2.4 SDK"),E(),e("a",{class:"header-anchor",href:"#_1-2-4-sdk","aria-label":'Permalink to "**1.2.4 SDK**"'},"​")],-1),hs=e("h5",{id:"_1-2-4-1上传文件",tabindex:"-1"},[e("strong",null,"1.2.4.1上传文件"),E(),e("a",{class:"header-anchor",href:"#_1-2-4-1上传文件","aria-label":'Permalink to "**1.2.4.1上传文件**"'},"​")],-1),ks=e("p",null,"MinIO提供多个语言版本SDK的支持，下边找到java版本的文档：",-1),ts=e("p",null,[E("地址："),e("a",{href:"https://docs.min.io/docs/java-client-quickstart-guide.html",target:"_blank",rel:"noreferrer"},"https://docs.min.io/docs/java-client-quickstart-guide.html")],-1),ns=e("p",null,"最低需求Java 1.8或更高版本:",-1),es=e("p",null,"maven依赖如下：",-1),Es=e("div",{style:{"max-height":"300px"},class:"language-xml vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"xml"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),e("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"dependency"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    <"),e("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"groupId"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">io.minio</"),e("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"groupId"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    <"),e("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"artifactId"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">minio</"),e("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"artifactId"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    <"),e("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"version"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">8.4.3</"),e("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"version"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"</"),e("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"dependency"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),e("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"dependency"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    <"),e("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"groupId"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">com.squareup.okhttp3</"),e("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"groupId"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    <"),e("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"artifactId"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">okhttp</"),e("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"artifactId"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    <"),e("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"version"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">4.8.1</"),e("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"version"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"</"),e("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"dependency"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")])])]),e("button",{class:"collapse"})],-1),ps=e("p",null,"在media-service工程添加此依赖。",-1),rs=e("p",null,"参数说明：",-1),ds=e("p",null,"需要三个参数才能连接到minio服务。",-1),gs=e("table",null,[e("thead",null,[e("tr",null,[e("th",null,"参数"),e("th",null,"说明")])]),e("tbody",null,[e("tr",null,[e("td",null,"Endpoint"),e("td",null,"对象存储服务的URL")]),e("tr",null,[e("td",null,"Access Key"),e("td",null,"Access key就像用户ID，可以唯一标识你的账户。")]),e("tr",null,[e("td",null,"Secret Key"),e("td",null,"Secret key是你账户的密码。")])])],-1),ys=e("p",null,"官方的示例代码如下：",-1),Fs=e("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"java"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," io.minio.BucketExistsArgs;")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," io.minio.MakeBucketArgs;")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," io.minio.MinioClient;")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," io.minio.UploadObjectArgs;")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," io.minio.errors.MinioException;")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," java.io.IOException;")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," java.security.InvalidKeyException;")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," java.security.NoSuchAlgorithmException;")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," FileUploader"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"  public"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," main"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"String"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[] "),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"args"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"throws"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," IOException, NoSuchAlgorithmException, InvalidKeyException {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    try"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"      // Create a minioClient with the MinIO server playground, its access key and secret key.")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      MinioClient minioClient "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"          MinioClient."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"builder"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"              ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"endpoint"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"https://play.min.io"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"              ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"credentials"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Q3AM3UQ867SPQQA43P2F"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"zuf+tfteSlswRu7BJ86wekitnifILbZam1KYY3TG"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"              ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"build"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"      // Make 'asiatrip' bucket if not exist.")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"      boolean"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," found "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"          minioClient."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bucketExists"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(BucketExistsArgs."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"builder"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bucket"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"asiatrip"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"build"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"      if"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ("),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"found) {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // Make a new bucket called 'asiatrip'.")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        minioClient."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"makeBucket"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(MakeBucketArgs."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"builder"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bucket"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"asiatrip"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"build"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      } "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"else"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        System.out."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"\"Bucket 'asiatrip' already exists.\""),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"      // Upload '/home/user/Photos/asiaphotos.zip' as object name 'asiaphotos-2015.zip' to bucket")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"      // 'asiatrip'.")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      minioClient."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"uploadObject"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"          UploadObjectArgs."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"builder"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"              ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bucket"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"asiatrip"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"              ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"object"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"asiaphotos-2015.zip"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"              ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"filename"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/home/user/Photos/asiaphotos.zip"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"              ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"build"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      System.out."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"          \"'/home/user/Photos/asiaphotos.zip' is successfully uploaded as \"")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"              +"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," \"object 'asiaphotos-2015.zip' to bucket 'asiatrip'.\""),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    } "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"catch"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (MinioException "),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"e"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      System.out."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Error occurred: "'),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," e);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      System.out."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"HTTP trace: "'),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," e."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"httpTrace"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),e("button",{class:"collapse"})],-1),cs=e("p",null,"参考示例在media-service工程中 测试上传文件功能，首先创建一个用于测试的bucket",-1),os=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps68.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),As=e("p",null,"点击“Manage”修改bucket的访问权限",-1),Ds=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps69.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),us=e("p",null,"选择public权限",-1),ms=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps70.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),Cs=e("p",null,"在xuecheng-plus-media-service工程 的test下编写测试代码如下：",-1),Bs=e("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"java"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," io.minio.BucketExistsArgs;")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," io.minio.MakeBucketArgs;")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," io.minio.MinioClient;")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," io.minio.UploadObjectArgs;")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," io.minio.errors.MinioException;")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," java.io.IOException;")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," java.security.InvalidKeyException;")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," java.security.NoSuchAlgorithmException;")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," MinioTest"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    MinioClient minioClient "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            MinioClient."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"builder"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"endpoint"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"http://192.168.2.203:9000"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"credentials"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"minioadmin"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"minioadmin"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"build"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Test")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," test_upload"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"throws"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Exception {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        try"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            UploadObjectArgs testbucket "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," UploadObjectArgs."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"builder"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bucket"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"testbucket"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//桶")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"filename"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"D:'),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"Learning"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"upload"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'1.mp4"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//指定本地文件路径")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},'    //                .object("1.mp4")//对象名 在桶下存储该文件')]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"object"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"test/01/1.mp4"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//对象名 放在子目录下")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"contentType"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"video/mp4"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//默认根据扩展名确定文件内容类型，也可以指定")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"build"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            minioClient."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"uploadObject"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(testbucket);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            System.out."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"上传成功"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        } "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"catch"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (Exception "),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"e"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            e."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"printStackTrace"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            System.out."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"上传失败"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),e("button",{class:"collapse"})],-1),bs=e("p",null,"执行upload方法，分别测试向桶的根目录上传文件以及子目录上传文件。",-1),vs=e("p",null,"上传成功，通过web控制台查看文件，并预览文件。",-1),fs=e("p",null,"说明：",-1),Ss=e("p",null,"设置contentType可以通过com.j256.simplemagic.ContentType枚举类查看常用的mimeType（媒体类型）",-1),js=e("p",null,"通过扩展名得到mimeType，代码如下：",-1),Ms=e("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"java"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"\t//根据扩展名取出mimeType")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    ContentInfo extensionMatch "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ContentInfoUtil."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"findExtensionMatch"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'".mp4"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String mimeType "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," MediaType.APPLICATION_OCTET_STREAM_VALUE;"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//通用mimeType，字节流")])])]),e("button",{class:"collapse"})],-1),xs=e("p",null,"完善上边的代码 如下：",-1),Ps=e("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"java"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"\t@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Test")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," test_upload"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() throws Exception {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //通过扩展名得到媒体资源类型 mimeType")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //根据扩展名取出mimeType")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        ContentInfo extensionMatch "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ContentInfoUtil."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"findExtensionMatch"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'".mp4"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        String mimeType "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," MediaType.APPLICATION_OCTET_STREAM_VALUE;"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//通用mimeType，字节流")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        if"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(extensionMatch"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"null"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"){")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            mimeType "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," extensionMatch."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getMimeType"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //上传文件的参数信息")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        UploadObjectArgs uploadObjectArgs "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," UploadObjectArgs."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"builder"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bucket"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"testbucket"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//桶")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"filename"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"D:'),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"Learning"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"upload"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'1.mp4"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//指定本地文件路径")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},'//                .object("1.mp4")//对象名 在桶下存储该文件')]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"object"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"test/01/1.mp4"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//对象名 放在子目录下")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"contentType"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(mimeType)"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//设置媒体文件类型")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"build"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //上传文件")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        minioClient."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"uploadObject"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(uploadObjectArgs);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")])])]),e("button",{class:"collapse"})],-1),_s=e("h5",{id:"_1-2-4-2-删除文件",tabindex:"-1"},[e("strong",null,"1.2.4.2 删除文件"),E(),e("a",{class:"header-anchor",href:"#_1-2-4-2-删除文件","aria-label":'Permalink to "**1.2.4.2 删除文件**"'},"​")],-1),Is=e("p",null,"下边测试删除文件",-1),Ts=e("p",null,[E("参考："),e("a",{href:"https://docs.min.io/docs/java-client-api-reference#removeObject",target:"_blank",rel:"noreferrer"},"https://docs.min.io/docs/java-client-api-reference#removeObject")],-1),Os=e("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"java"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Test")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," delete"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(){")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    try"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        minioClient."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"removeObject"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"               RemoveObjectArgs."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"builder"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bucket"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"testbucket"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"object"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"001/test001.mp4"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"build"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        System.out."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"删除成功"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    } "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"catch"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (Exception "),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"e"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"       e."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"printStackTrace"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        System.out."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"删除失败"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),e("button",{class:"collapse"})],-1),Rs=e("h5",{id:"_1-2-4-3-查询文件",tabindex:"-1"},[e("strong",null,"1.2.4.3 查询文件"),E(),e("a",{class:"header-anchor",href:"#_1-2-4-3-查询文件","aria-label":'Permalink to "**1.2.4.3 查询文件**"'},"​")],-1),ws=e("p",null,"通过查询文件查看文件是否存在minio中。",-1),zs=e("p",null,[E("参考："),e("a",{href:"https://docs.min.io/docs/java-client-api-reference#getObject",target:"_blank",rel:"noreferrer"},"https://docs.min.io/docs/java-client-api-reference#getObject")],-1),Ls=e("p",null,"校验文件的完整性，对文件计算出md5值，比较原始文件的md5和目标文件的md5，一致则说明完整",-1),Ns=e("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"java"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//查询文件 从minio中下载")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Test")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," test_getFile"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() throws Exception {")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    GetObjectArgs getObjectArgs "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," GetObjectArgs."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"builder"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bucket"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"testbucket"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"object"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"test/01/1.mp4"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"build"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //查询远程服务获取到一个流对象")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    FilterInputStream inputStream "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," minioClient."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getObject"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(getObjectArgs);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //指定输出流")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    FileOutputStream outputStream "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," FileOutputStream"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"new"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," File"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"D:'),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"Learning"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"upload"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'1a.mp4"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"));")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    IOUtils."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"copy"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(inputStream,outputStream);")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //校验文件的完整性对文件的内容进行md5")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    FileInputStream fileInputStream1 "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," FileInputStream"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"new"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," File"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"D:'),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"Learning"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"upload"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'1.mp4"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"));")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String source_md5 "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," DigestUtils."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"md5Hex"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(fileInputStream1);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    FileInputStream fileInputStream "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," FileInputStream"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"new"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," File"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"D:'),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"Learning"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"upload"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'1a.mp4"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"));")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String local_md5 "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," DigestUtils."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"md5Hex"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(fileInputStream);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(source_md5."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"equals"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(local_md5)){")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        System.out."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"下载成功"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),e("button",{class:"collapse"})],-1),Us=e("h2",{id:"二-上传图片",tabindex:"-1"},[e("strong",null,"二 上传图片"),E(),e("a",{class:"header-anchor",href:"#二-上传图片","aria-label":'Permalink to "**二 上传图片**"'},"​")],-1),Ks=e("h3",{id:"_2-1-需求分析",tabindex:"-1"},[e("strong",null,"2.1 需求分析"),E(),e("a",{class:"header-anchor",href:"#_2-1-需求分析","aria-label":'Permalink to "**2.1 需求分析**"'},"​")],-1),qs=e("h4",{id:"_2-1-1-业务流程",tabindex:"-1"},[e("strong",null,"2.1.1 业务流程"),E(),e("a",{class:"header-anchor",href:"#_2-1-1-业务流程","aria-label":'Permalink to "**2.1.1 业务流程**"'},"​")],-1),Hs=e("p",null,"课程图片是宣传课程非常重要的信息，在新增课程界面上传课程图片，也可以修改课程图片。",-1),$s=e("p",null,"如下图：",-1),Ws=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/image-20230704224229162.png",alt:"image-20230704224229162",loading:"lazy",decoding:"async",class:"lazy"})],-1),Gs=e("p",null,"上传课程图片总体上包括两部分：",-1),Vs=e("p",null,"1、上传课程图片前端请求媒资管理服务将文件上传至分布式文件系统，并且在媒资管理数据库保存文件信息。",-1),Xs=e("p",null,"2、上传图片成功保存图片地址到课程基本信息表中。",-1),Js=e("p",null,"详细流程如下：",-1),Ys=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps72.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),Qs=e("p",null,"1、前端进入上传图片界面",-1),Zs=e("p",null,"2、上传图片，请求媒资管理服务。",-1),il=e("p",null,"3、媒资管理服务将图片文件存储在MinIO。",-1),sl=e("p",null,"4、媒资管理记录文件信息到数据库。",-1),ll=e("p",null,"5、前端请求内容管理服务保存课程信息，在内容管理数据库保存图片地址。",-1),al=e("h4",{id:"_2-1-2-数据模型",tabindex:"-1"},[e("strong",null,"2.1.2 数据模型"),E(),e("a",{class:"header-anchor",href:"#_2-1-2-数据模型","aria-label":'Permalink to "**2.1.2 数据模型**"'},"​")],-1),hl=e("p",null,"涉及到的数据表有：课程信息表中的图片字段、媒资数据库的文件表，下边主要看媒资数据库的文件表。",-1),kl=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps73.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),tl=e("p",null,"各字段描述如下：",-1),nl=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps74.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),el=e("h3",{id:"_2-2-准备环境",tabindex:"-1"},[e("strong",null,"2.2 准备环境"),E(),e("a",{class:"header-anchor",href:"#_2-2-准备环境","aria-label":'Permalink to "**2.2 准备环境**"'},"​")],-1),El=e("p",null,"首先在minio配置bucket，bucket名称为：mediafiles，并设置bucket的权限为公开。",-1),pl=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps75.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),rl=e("p",null,[E("在nacos配置中minio的相关信息，进入"),e("code",null,"media-service-dev.yaml"),E(":")],-1),dl=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps76.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),gl=e("p",null,"配置信息如下：",-1),yl=e("div",{style:{"max-height":"300px"},class:"language-yaml vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"yaml"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"minio"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  endpoint"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"http://192.168.2.203:9000")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  accessKey"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"minioadmin")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  secretKey"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"minioadmin")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  bucket"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    files"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"mediafiles")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    videofiles"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"video")])])]),e("button",{class:"collapse"})],-1),Fl=e("p",null,"在media-service工程编写minio的配置类：",-1),cl=e("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"java"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Configuration")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," MinioConfig"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," @"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Value"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"${minio.endpoint}"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," private"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String endpoint;")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," @"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Value"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"${minio.accessKey}"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," private"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String accessKey;")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," @"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Value"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"${minio.secretKey}"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," private"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String secretKey;")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," @"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Bean")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," public"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," MinioClient "),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"minioClient"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  MinioClient minioClient "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"          MinioClient."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"builder"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                  ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"endpoint"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(endpoint)")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                  ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"credentials"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(accessKey, secretKey)")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                  ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"build"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"  return"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," minioClient;")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),e("button",{class:"collapse"})],-1),ol=e("h3",{id:"_2-3-接口定义",tabindex:"-1"},[e("strong",null,"2.3 接口定义"),E(),e("a",{class:"header-anchor",href:"#_2-3-接口定义","aria-label":'Permalink to "**2.3 接口定义**"'},"​")],-1),Al=e("p",null,"根据需求分析，下边进行接口定义，此接口定义为一个通用的上传文件接口，可以上传图片或其它文件。",-1),Dl=e("p",null,"首先分析接口：",-1),ul=e("blockquote",null,[e("p",null,"请求地址：/media/upload/coursefile"),e("p",null,[E("请求内容："),e("strong",null,"Content-Type:"),E(" multipart/form-data;")]),e("p",null,'form-data; name="filedata"; filename="具体的文件名称"')],-1),ml=e("p",null,"响应参数：文件信息，如下",-1),Cl=e("div",{style:{"max-height":"300px"},class:"language-json vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"json"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "id"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"a16da7a132559daf9e1193166b3e7f52"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "companyId"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1232141425"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "companyName"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"null"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "filename"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"1.jpg"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "fileType"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"001001"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "tags"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'""'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "bucket"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/testbucket/2022/09/12/a16da7a132559daf9e1193166b3e7f52.jpg"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "fileId"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"a16da7a132559daf9e1193166b3e7f52"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "url"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/testbucket/2022/09/12/a16da7a132559daf9e1193166b3e7f52.jpg"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "timelength"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"null"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "username"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"null"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "createDate"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"2022-09-12T21:57:18"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "changeDate"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"null"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "status"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"1"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "remark"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'""'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "auditStatus"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"null"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "auditMind"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"null"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "fileSize"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"248329")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),e("button",{class:"collapse"})],-1),Bl=e("p",null,"定义上传响应模型类：",-1),bl=e("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"java"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"/**")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * @description 上传普通文件成功响应结果")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," */")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Data")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," UploadFileResultDto"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," extends"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," MediaFiles"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),e("button",{class:"collapse"})],-1),vl=e("p",null,"定义接口如下：",-1),fl=e("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"java"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ApiOperation"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"上传文件"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestMapping"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"value"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "/upload/coursefile"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"consumes"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," MediaType.MULTIPART_FORM_DATA_VALUE)")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," UploadFileResultDto "),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"upload"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestPart"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"filedata"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") MultipartFile upload) throws IOException {")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    return"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),e("button",{class:"collapse"})],-1),Sl=e("p",null,"接口定义好后可以用httpclient工具测试一下",-1),jl=e("p",null,"使用httpclient测试",-1),Ml=e("div",{style:{"max-height":"300px"},class:"language-http vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"http"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"### 上传文件")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"POST"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {{media_host}}/media/upload/coursefile")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"Content-Type"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," multipart/form-data; boundary=WebAppBoundary")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"--WebAppBoundary")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"Content-Disposition"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' form-data; name="filedata"; filename="1.jpg"')]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"Content-Type"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," application/octet-stream")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"< d:/develop/upload/1.jpg")])])]),e("button",{class:"collapse"})],-1),xl=e("h3",{id:"_2-4-接口开发",tabindex:"-1"},[e("strong",null,"2.4 接口开发"),E(),e("a",{class:"header-anchor",href:"#_2-4-接口开发","aria-label":'Permalink to "**2.4 接口开发**"'},"​")],-1),Pl=e("h4",{id:"_2-4-1-dao开发",tabindex:"-1"},[e("strong",null,"2.4.1 DAO开发"),E(),e("a",{class:"header-anchor",href:"#_2-4-1-dao开发","aria-label":'Permalink to "**2.4.1 DAO开发**"'},"​")],-1),_l=e("p",null,[E("根据需求分析DAO层实现向"),e("code",null,"media_files"),E("表插入一条记录，使用"),e("code",null,"media_files"),E("表生成的mapper即可。")],-1),Il=e("h4",{id:"_2-4-2-service开发",tabindex:"-1"},[e("strong",null,"2.4.2 Service开发"),E(),e("a",{class:"header-anchor",href:"#_2-4-2-service开发","aria-label":'Permalink to "**2.4.2 Service开发**"'},"​")],-1),Tl=e("p",null,"Service方法需要提供一个更加通用的保存文件的方法。",-1),Ol=e("p",null,"定义请求参数类：",-1),Rl=e("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"java"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"/**")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * @description 上传普通文件请求参数")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," */")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," @"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Data")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," UploadFileParamsDto"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," /**")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  * 文件名称")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  */")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," private"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String filename;")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," /**")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  * 文件类型（文档，音频，视频）")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  */")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," private"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String fileType;")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," /**")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  * 文件大小")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  */")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," private"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Long fileSize;")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," /**")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  * 标签")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  */")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," private"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String tags;")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," /**")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  * 上传人")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  */")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," private"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String username;")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," /**")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  * 备注")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  */")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," private"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String remark;")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),e("button",{class:"collapse"})],-1),wl=e("p",null,"定义service方法：",-1),zl=e("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"java"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"/**")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * 上传文件")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," companyId"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," 机构id")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," uploadFileParamsDto"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," 上传文件信息")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," localFilePath"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," 文件磁盘路径")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@return"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," 文件信息")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," */")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," UploadFileResultDto "),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"uploadFile"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Long companyId, UploadFileParamsDto uploadFileParamsDto, String localFilePath);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//修改版")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," UploadFileResultDto "),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"uploadFile"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Long companyId, UploadFileParamsDto uploadFileParamsDto, String localFilePath, String objectName);")])])]),e("button",{class:"collapse"})],-1),Ll=e("p",null,"实现方法如下：",-1),Nl=e("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"java"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Autowired")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"MinioClient minioClient;")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Autowired")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"MediaFilesMapper mediaFilesMapper;")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//普通文件桶")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Value"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"${minio.bucket.files}"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"private"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String bucket_Files;")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//获取文件默认存储目录路径 年/月/日")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"private"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String "),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getDefaultFolderPath"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    SimpleDateFormat sdf "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," SimpleDateFormat"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"yyyy-MM-dd"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String folder "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," sdf."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"format"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"new"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Date"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"replace"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"-"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    return"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," folder;")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//获取文件的md5")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"private"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String "),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getFileMd5"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(File file) {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    try"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (FileInputStream fileInputStream "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," FileInputStream"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(file)) {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        String fileMd5 "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," DigestUtils."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"md5Hex"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(fileInputStream);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," fileMd5;")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    } "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"catch"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (Exception "),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"e"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        e."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"printStackTrace"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"private"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String "),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getMimeType"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(String extension){")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(extension"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=="),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"null"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        extension "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' ""'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //根据扩展名取出mimeType")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    ContentInfo extensionMatch "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ContentInfoUtil."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"findExtensionMatch"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(extension);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //通用mimeType，字节流")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String mimeType "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," MediaType.APPLICATION_OCTET_STREAM_VALUE;")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(extensionMatch"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"null"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"){")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        mimeType "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," extensionMatch."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getMimeType"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    return"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," mimeType;")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"/**")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * @description 将文件写入minIO")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," localFilePath"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  文件地址")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," bucket"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  桶")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," objectName"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," 对象名称")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@return"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," void")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," */")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," boolean"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," addMediaFilesToMinIO"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(String localFilePath,String mimeType,String bucket, String objectName) {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    try"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        UploadObjectArgs testbucket "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," UploadObjectArgs."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"builder"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bucket"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(bucket)")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"object"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(objectName)")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"filename"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(localFilePath)")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"contentType"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(mimeType)")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"build"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        minioClient."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"uploadObject"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(testbucket);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        log."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"debug"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"上传文件到minio成功,bucket:{},objectName:{}"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",bucket,objectName);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        System.out."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"上传成功"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," true"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    } "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"catch"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (Exception "),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"e"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        e."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"printStackTrace"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        log."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"error"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"上传文件到minio出错,bucket:{},objectName:{},错误原因:{}"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",bucket,objectName,e."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getMessage"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(),e);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        XueChengPlusException."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"cast"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"上传文件到文件系统失败"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    return"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," false"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"/**")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * @description 将文件信息添加到文件表")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," companyId"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  机构id")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," fileMd5"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  文件md5值")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," uploadFileParamsDto"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  上传文件的信息")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," bucket"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  桶")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," objectName"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," 对象名称")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@return"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," com.xuecheng.media.model.po.MediaFiles")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," */")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Transactional")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," MediaFiles "),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"addMediaFilesToDb"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Long companyId,String fileMd5,UploadFileParamsDto uploadFileParamsDto,String bucket,String objectName){")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //从数据库查询文件")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    MediaFiles mediaFiles "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," mediaFilesMapper."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"selectById"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(fileMd5);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (mediaFiles "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=="),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        mediaFiles "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," MediaFiles"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //拷贝基本信息")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        BeanUtils."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"copyProperties"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(uploadFileParamsDto, mediaFiles);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        mediaFiles."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setId"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(fileMd5);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        mediaFiles."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setFileId"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(fileMd5);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        mediaFiles."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setCompanyId"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(companyId);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        mediaFiles."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setUrl"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/"'),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," bucket "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "/"'),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," objectName);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        mediaFiles."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setBucket"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(bucket);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        mediaFiles."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setFilePath"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(objectName);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        mediaFiles."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setCreateDate"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(LocalDateTime."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"now"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        mediaFiles."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setAuditStatus"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"002003"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        mediaFiles."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setStatus"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"1"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //保存文件信息到文件表")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        int"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," insert "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," mediaFilesMapper."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"insert"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(mediaFiles);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        if"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (insert "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            log."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"error"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"保存文件信息到数据库失败,{}"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",mediaFiles."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"toString"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            XueChengPlusException."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"cast"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"保存文件信息失败"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        log."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"debug"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"保存文件信息到数据库成功,{}"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",mediaFiles."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"toString"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    return"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," mediaFiles;")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Transactional")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Override")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," UploadFileResultDto "),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"uploadFile"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Long companyId, UploadFileParamsDto uploadFileParamsDto, String localFilePath) {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    File file "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," File"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(localFilePath);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ("),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"file."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"exists"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()) {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        XueChengPlusException."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"cast"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"文件不存在"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //文件名称")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String filename "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," uploadFileParamsDto."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getFilename"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //文件扩展名")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String extension "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," filename."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"substring"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(filename."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"lastIndexOf"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"."'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"));")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //文件mimeType")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String mimeType "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getMimeType"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(extension);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //文件的md5值")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String fileMd5 "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getFileMd5"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(file);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //文件的默认目录")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String defaultFolderPath "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getDefaultFolderPath"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //存储到minio中的对象名(带目录)")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String  objectName "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," defaultFolderPath "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," fileMd5 "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," exension;")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //将文件上传到minio")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    boolean"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," b "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," addMediaFilesToMinIO"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(localFilePath, mimeType, bucket_files, objectName);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //文件大小")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    uploadFileParamsDto."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setFileSize"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(file."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"length"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //将文件信息存储到数据库")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    MediaFiles mediaFiles "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," addMediaFilesToDb"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(companyId, fileMd5, uploadFileParamsDto, bucket_files, objectName);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //准备返回数据")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    UploadFileResultDto uploadFileResultDto "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," UploadFileResultDto"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    BeanUtils."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"copyProperties"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(mediaFiles, uploadFileResultDto);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    return"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," uploadFileResultDto;")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),e("button",{class:"collapse"})],-1),Ul=e("p",null,"修改版",-1),Kl=e("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"java"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//将文件信息添加到文件表添加到service接口")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"MediaFiles "),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"addMediaFilesToDb"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Long companyId,String fileMd5,UploadFileParamsDto uploadFileParamsDto,String bucket,String objectName);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"/*-----------------------------------------------------------------------------------------------------------------------*/")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//注入自身")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Autowired")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"MediaFileService currentProxy;")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"/**")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * @description 将文件信息添加到文件表")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," companyId"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  机构id")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," fileMd5"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  文件md5值")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," uploadFileParamsDto"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  上传文件的信息")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," bucket"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  桶")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," objectName"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," 对象名称")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@return"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," com.xuecheng.media.model.po.MediaFiles")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     */")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Override")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Transactional")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," MediaFiles "),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"addMediaFilesToDb"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Long companyId,String fileMd5,UploadFileParamsDto uploadFileParamsDto,String bucket,String objectName){")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //将文件信息保存到数据库")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        MediaFiles mediaFiles "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," mediaFilesMapper."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"selectById"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(fileMd5);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        if"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(mediaFiles "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=="),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"){")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            mediaFiles "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," MediaFiles"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            BeanUtils."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"copyProperties"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(uploadFileParamsDto,mediaFiles);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            //文件id")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            mediaFiles."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setId"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(fileMd5);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            //机构id")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            mediaFiles."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setCompanyId"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(companyId);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            //桶")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            mediaFiles."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setBucket"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(bucket);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            //file_path")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            mediaFiles."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setFilePath"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(objectName);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            //file_id")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            mediaFiles."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setFileId"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(fileMd5);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            //url")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            mediaFiles."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setUrl"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/"'),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"bucket"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/"'),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"objectName);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            //上传时间")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            mediaFiles."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setCreateDate"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(LocalDateTime."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"now"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            //状态")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            mediaFiles."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setStatus"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"1"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            //审核状态")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            mediaFiles."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setAuditStatus"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"002003"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            //插入数据库")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            int"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," insert "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," mediaFilesMapper."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"insert"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(mediaFiles);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            if"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(insert"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<="),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"){")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                log."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"debug"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"向数据库保存文件失败,bucket:{},objectName:{}"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",bucket,objectName);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"                return"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            //添加到待处理任务表")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"            addWaitingTask"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(mediaFiles);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            log."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"debug"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"保存文件信息到数据库成功,{}"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", mediaFiles."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"toString"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," mediaFiles;")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Override")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," UploadFileResultDto "),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"uploadFile"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Long companyId, UploadFileParamsDto uploadFileParamsDto, String localFilePath, String objectName) {")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //文件名")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String filename "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," uploadFileParamsDto."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getFilename"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //先得到扩展名")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String extension "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," filename."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"substring"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(filename."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"lastIndexOf"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"."'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"));")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //得到mimeType")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String mimeType "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getMimeType"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(extension);")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //子目录")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String defaultFolderPath "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getDefaultFolderPath"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //文件的md5值")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String fileMd5 "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getFileMd5"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"new"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," File"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(localFilePath));")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (StringUtil."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"isEmpty"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(objectName)){")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //                      2023/6/23/  adgfgetgwg24f4gr.jpg")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        objectName "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," defaultFolderPath"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"fileMd5"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"extension;")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //上传文件到minio")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    boolean"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," result "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," addMediaFilesToMinIO"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(localFilePath, mimeType, bucket_mediafiles, objectName);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"result){")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        XueChengPlusException."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"cast"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"上传文件失败"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //入库文件信息")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    MediaFiles mediaFiles "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," currentProxy."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"addMediaFilesToDb"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(companyId, fileMd5, uploadFileParamsDto, bucket_mediafiles, objectName);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(mediaFiles"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=="),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"null"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"){")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        XueChengPlusException."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"cast"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"文件上传后保存信息失败"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //准备返回的对象")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    UploadFileResultDto uploadFileResultDto "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," UploadFileResultDto"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    BeanUtils."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"copyProperties"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(mediaFiles,uploadFileResultDto);")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    return"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," uploadFileResultDto;")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),e("button",{class:"collapse"})],-1),ql=e("h4",{id:"_2-4-3-完善接口层",tabindex:"-1"},[e("strong",null,"2.4.3 完善接口层"),E(),e("a",{class:"header-anchor",href:"#_2-4-3-完善接口层","aria-label":'Permalink to "**2.4.3 完善接口层**"'},"​")],-1),Hl=e("p",null,"完善接口层代码 ：",-1),$l=e("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"java"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ApiOperation"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"上传文件"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestMapping"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"value"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "/upload/coursefile"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},","),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"consumes"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," MediaType.MULTIPART_FORM_DATA_VALUE)")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ResponseBody")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," UploadFileResultDto "),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"upload"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestPart"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"filedata"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") MultipartFile upload,@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestParam"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"value"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "folder"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},","),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"required"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"false"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") String folder,@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestParam"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"value"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "objectName"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},","),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"required"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"false"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") String objectName) throws IOException {")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        Long companyId "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 1232141425L"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    UploadFileParamsDto uploadFileParamsDto "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," UploadFileParamsDto"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //文件大小")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    uploadFileParamsDto."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setFileSize"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(filedata."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getSize"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //图片")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    uploadFileParamsDto."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setFileType"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"001001"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //文件名称")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    uploadFileParamsDto."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setFilename"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(filedata."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getOriginalFilename"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//文件名称")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //文件大小")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    long"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," fileSize "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," filedata."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getSize"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    uploadFileParamsDto."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setFileSize"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(fileSize);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //创建临时文件")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    File tempFile "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," File."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"createTempFile"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"minio"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"temp"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //上传的文件拷贝到临时文件")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    filedata."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"transferTo"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(tempFile);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //文件路径")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String absolutePath "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," tempFile."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getAbsolutePath"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //上传文件")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    UploadFileResultDto uploadFileResultDto "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," mediaFileService."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"uploadFile"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(companyId, uploadFileParamsDto, absolutePath);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    ")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    return"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," uploadFileResultDto;")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"\t//修改版")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," \t@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ApiOperation"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"上传图片"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestMapping"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"value"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "/upload/coursefile"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},","),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"consumes"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," MediaType.MULTIPART_FORM_DATA_VALUE)")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," UploadFileResultDto "),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"upload"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestPart"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"filedata"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") MultipartFile filedata,")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                      @"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestParam"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"value"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "objectName"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},","),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"required"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"false"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") String objectName) throws IOException {")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //准备上传文件的信息")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        UploadFileParamsDto uploadFileParamsDto "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," UploadFileParamsDto"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //原始文件名称")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        uploadFileParamsDto."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setFilename"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(filedata."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getOriginalFilename"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //文件大小")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        uploadFileParamsDto."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setFileSize"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(filedata."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getSize"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //文件类型")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        uploadFileParamsDto."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setFileType"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"001001"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //创建一个临时文件")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        File tempFile "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," File."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"createTempFile"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"minio"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'".temp"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //将本地要上传的文件拷贝到临时文件，拿到本地路径")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        filedata."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"transferTo"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(tempFile);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        Long companyId "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 1232141425L"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //文件路径")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        String localFilePath "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," tempFile."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getAbsolutePath"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //调用service上传图片")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        UploadFileResultDto uploadFileResultDto "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," mediaFileService."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"uploadFile"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(companyId, uploadFileParamsDto, localFilePath, objectName);")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," uploadFileResultDto;")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")])])]),e("button",{class:"collapse"})],-1),Wl=e("h4",{id:"_2-4-4-接口测试",tabindex:"-1"},[e("strong",null,"2.4.4 接口测试"),E(),e("a",{class:"header-anchor",href:"#_2-4-4-接口测试","aria-label":'Permalink to "**2.4.4 接口测试**"'},"​")],-1),Gl=e("p",null,"1、首先使用httpclient测试",-1),Vl=e("div",{style:{"max-height":"300px"},class:"language-http vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"http"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"### 上传文件")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"POST"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {{media_host}}/media/upload/coursefile")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"Content-Type"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," multipart/form-data; boundary=WebAppBoundary")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"--WebAppBoundary")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"Content-Disposition"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' form-data; name="filedata"; filename="1.jpg"')]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"Content-Type"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," application/octet-stream")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"< d:/develop/upload/1.jpg")])])]),e("button",{class:"collapse"})],-1),Xl=e("p",null,"2、再进行前后端联调测试",-1),Jl=e("p",null,"在新增课程、编辑课程界面上传图，保存课程信息后再次进入编辑课程界面，查看是否可以正常保存课程图片信息。",-1),Yl=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps77.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),Ql=e("p",null,"上图图片完成后，进入媒资管理，查看文件列表中是否有刚刚上传的图片信息。",-1),Zl=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps78.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),ia=e("h4",{id:"_2-4-5-service事务优化",tabindex:"-1"},[e("strong",null,"2.4.5 Service事务优化"),E(),e("a",{class:"header-anchor",href:"#_2-4-5-service事务优化","aria-label":'Permalink to "**2.4.5 Service事务优化**"'},"​")],-1),sa=e("p",null,"上边的service方法优化后并测试通过，现在思考关于uploadFile方法的是否应该开启事务。",-1),la=e("p",null,[E("目前是在uploadFile方法上添加"),e("code",null,"@Transactional"),E("，当调用uploadFile方法前会开启数据库事务，如果上传文件过程时间较长那么数据库的事务持续时间就会变长，这样数据库链接释放就慢，最终导致数据库链接不够用。")],-1),aa=e("p",null,[E("我们只将addMediaFilesToDb方法添加事务控制即可,uploadFile方法上的"),e("code",null,"@Transactional"),E("注解去掉。")],-1),ha=e("p",null,"优化后如下：",-1),ka=e("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"java"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"/**")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * @description 将文件信息添加到文件表")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," companyId"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  机构id")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," fileMd5"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  文件md5值")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," uploadFileParamsDto"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  上传文件的信息")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," bucket"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  桶")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," objectName"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," 对象名称")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@return"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," com.xuecheng.media.model.po.MediaFiles")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," */")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Override")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Transactional")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," MediaFiles "),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"addMediaFilesToDb"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Long companyId,String fileMd5,UploadFileParamsDto uploadFileParamsDto,String bucket,String objectName){")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //将文件信息保存到数据库")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    MediaFiles mediaFiles "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," mediaFilesMapper."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"selectById"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(fileMd5);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(mediaFiles "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=="),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"){")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        mediaFiles "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," MediaFiles"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        BeanUtils."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"copyProperties"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(uploadFileParamsDto,mediaFiles);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //文件id")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        mediaFiles."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setId"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(fileMd5);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //机构id")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        mediaFiles."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setCompanyId"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(companyId);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //桶")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        mediaFiles."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setBucket"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(bucket);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //file_path")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        mediaFiles."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setFilePath"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(objectName);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //file_id")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        mediaFiles."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setFileId"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(fileMd5);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //url")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        mediaFiles."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setUrl"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/"'),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"bucket"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/"'),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"objectName);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //上传时间")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        mediaFiles."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setCreateDate"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(LocalDateTime."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"now"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //状态")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        mediaFiles."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setStatus"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"1"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //审核状态")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        mediaFiles."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setAuditStatus"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"002003"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //插入数据库")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        int"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," insert "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," mediaFilesMapper."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"insert"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(mediaFiles);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        if"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(insert"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<="),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"){")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            log."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"debug"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"向数据库保存文件失败,bucket:{},objectName:{}"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",bucket,objectName);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            return"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //添加到待处理任务表")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        addWaitingTask"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(mediaFiles);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        log."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"debug"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"保存文件信息到数据库成功,{}"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", mediaFiles."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"toString"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    return"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," mediaFiles;")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),e("button",{class:"collapse"})],-1),ta=e("p",null,[E("我们人为在"),e("code",null,"int insert = mediaFilesMapper.insert(mediaFiles);"),E("下边添加一个异常代码"),e("code",null,"int a=1/0;")],-1),na=e("p",null,"测试是否事务控制。很遗憾，事务控制失败。",-1),ea=e("p",null,[E("方法上已经添加了"),e("code",null,"@Transactional"),E("注解为什么该方法不能被事务控制呢？")],-1),Ea=e("p",null,[E("如果是在uploadFile方法上添加"),e("code",null,"@Transactional"),E("注解就可以控制事务，去掉则不行。")],-1),pa=e("p",null,"现在的问题其实是一个非事务方法调同类一个事务方法，事务无法控制，这是为什么？",-1),ra=e("p",null,"下边分析原因：",-1),da=e("p",null,[E("如果在uploadFile方法上添加"),e("code",null,"@Transactional"),E("注解，代理对象执行此方法前会开启事务，如下图：")],-1),ga=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps79.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),ya=e("p",null,[E("如果在uploadFile方法上没有"),e("code",null,"@Transactional"),E("注解，代理对象执行此方法前不进行事务控制，如下图：")],-1),Fa=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps80.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),ca=e("p",null,[E("所以判断该方法是否可以事务控制必须保证是通过代理对象调用此方法，且此方法上添加了"),e("code",null,"@Transactional"),E("注解。")],-1),oa=e("p",null,[E("现在在addMediaFilesToDb方法上添加"),e("code",null,"@Transactional"),E("注解，也不会进行事务控制是因为并不是通过代理对象执行的addMediaFilesToDb方法。为了判断在uploadFile方法中去调用addMediaFilesToDb方法是否是通过代理对象去调用，我们可以打断点跟踪。")],-1),Aa=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps81.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),Da=e("p",null,"我们发现在uploadFile方法中去调用addMediaFilesToDb方法不是通过代理对象去调用。",-1),ua=e("p",null,"如何解决呢？通过代理对象去调用addMediaFilesToDb方法即可解决。",-1),ma=e("p",null,"在MediaFileService的实现类中注入MediaFileService的代理对象，如下：",-1),Ca=e("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"java"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Autowired")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"MediaFileService currentProxy;")])])]),e("button",{class:"collapse"})],-1),Ba=e("p",null,"将addMediaFilesToDb方法提成接口。",-1),ba=e("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"java"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"/**")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * @description 将文件信息添加到文件表")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," companyId"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  机构id")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," fileMd5"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  文件md5值")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," uploadFileParamsDto"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  上传文件的信息")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," bucket"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  桶")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," objectName"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," 对象名称")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@return"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," com.xuecheng.media.model.po.MediaFiles")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," */")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," MediaFiles "),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"addMediaFilesToDb"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Long companyId,String fileMd5,UploadFileParamsDto uploadFileParamsDto,String bucket,String objectName);")])])]),e("button",{class:"collapse"})],-1),va=e("p",null,"调用addMediaFilesToDb方法的代码处改为如下：",-1),fa=e("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"java"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"..... ")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //写入文件表 ")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    MediaFiles mediaFiles "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," currentProxy."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"addMediaFilesToDb"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(companyId, fileMd5, uploadFileParamsDto, bucket_files, objectName);  ")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"....")])])]),e("button",{class:"collapse"})],-1),Sa=e("p",null,"再次测试事务是否可以正常控制。",-1),ja=e("h2",{id:"三-上传视频",tabindex:"-1"},[e("strong",null,"三 上传视频"),E(),e("a",{class:"header-anchor",href:"#三-上传视频","aria-label":'Permalink to "**三 上传视频**"'},"​")],-1),Ma=e("h3",{id:"_3-1-需求分析",tabindex:"-1"},[e("strong",null,"3.1 需求分析"),E(),e("a",{class:"header-anchor",href:"#_3-1-需求分析","aria-label":'Permalink to "**3.1 需求分析**"'},"​")],-1),xa=e("p",null,"1、教学机构人员进入媒资管理列表查询自己上传的媒资文件。",-1),Pa=e("p",null,"点击“媒资管理”",-1),_a=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps82.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),Ia=e("p",null,"进入媒资管理列表页面查询本机构上传的媒资文件。",-1),Ta=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/image-20230704231746909.png",alt:"image-20230704231746909",loading:"lazy",decoding:"async",class:"lazy"})],-1),Oa=e("p",null,'2、教育机构用户在"媒资管理"页面中点击 "上传视频" 按钮。',-1),Ra=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps84.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),wa=e("p",null,"点击“上传视频”打开上传页面",-1),za=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps85.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),La=e("p",null,"3、选择要上传的文件，自动执行文件上传。",-1),Na=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps86.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),Ua=e("p",null,"4、视频上传成功会自动处理，处理完成可以预览视频。",-1),Ka=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps87.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),qa=e("h3",{id:"_3-2-断点续传技术",tabindex:"-1"},[e("strong",null,"3.2 断点续传技术"),E(),e("a",{class:"header-anchor",href:"#_3-2-断点续传技术","aria-label":'Permalink to "**3.2 断点续传技术**"'},"​")],-1),Ha=e("h4",{id:"_3-2-1-什么是断点续传",tabindex:"-1"},[e("strong",null,"3.2.1 什么是断点续传"),E(),e("a",{class:"header-anchor",href:"#_3-2-1-什么是断点续传","aria-label":'Permalink to "**3.2.1 什么是断点续传**"'},"​")],-1),$a=e("p",null,"通常视频文件都比较大，所以对于媒资系统上传文件的需求要满足大文件的上传要求。http协议本身对上传文件大小没有限制，但是客户的网络环境质量、电脑硬件环境等参差不齐，如果一个大文件快上传完了网断了没有上传完成，需要客户重新上传，用户体验非常差，所以对于大文件上传的要求最基本的是断点续传。",-1),Wa=e("p",null,"什么是断点续传：",-1),Ga=e("p",null,"​ 引用百度百科：断点续传指的是在下载或上传时，将下载或上传任务（一个文件或一个压缩包）人为的划分为几个部分，每一个部分采用一个线程进行上传或下载，如果碰到网络故障，可以从已经上传或下载的部分开始继续上传下载未完成的部分，而没有必要从头开始上传下载，断点续传可以提高节省操作时间，提高用户体验性。",-1),Va=e("p",null,"断点续传流程如下图：",-1),Xa=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps88.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),Ja=e("p",null,"流程如下：",-1),Ya=e("p",null,"1、前端上传前先把文件分成块",-1),Qa=e("p",null,"2、一块一块的上传，上传中断后重新上传，已上传的分块则不用再上传",-1),Za=e("p",null,"3、各分块上传完成最后在服务端合并文件",-1),ih=e("h4",{id:"_3-2-2-分块与合并测试",tabindex:"-1"},[e("strong",null,"3.2.2 分块与合并测试"),E(),e("a",{class:"header-anchor",href:"#_3-2-2-分块与合并测试","aria-label":'Permalink to "**3.2.2 分块与合并测试**"'},"​")],-1),sh=e("p",null,"为了更好的理解文件分块上传的原理，下边用java代码测试文件的分块与合并。",-1),lh=e("p",null,"文件分块的流程如下：",-1),ah=e("p",null,"1、获取源文件长度",-1),hh=e("p",null,"2、根据设定的分块文件的大小计算出块数",-1),kh=e("p",null,"3、从源文件读数据依次向每一个块文件写数据。",-1),th=e("p",null,"测试代码如下：",-1),nh=e("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"java"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"/**")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@author"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," Klaus")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * @date 2023/06/23 19:43")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * @description 测试大文件上传方法")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," */")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," BigFileTest"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //分块测试")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Test")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testChunk"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"throws"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," IOException {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //源文件")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        File sourceFile "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," File"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"D:'),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"Learning"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"upload"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'1.mkv"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //分块文件存储路径")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        String chunkFilePath "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "D:'),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"Learning"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"upload"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"chunk"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //分块文件大小")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //long chunkSize = 1024 * 1024 * 1;")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        int"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," chunkSize "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 1024"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," *"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 1024"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," *"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 5"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //分块文件个数")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        int"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," chunkNum "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ("),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"int"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") Math."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"ceil"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(sourceFile."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"length"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"*"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 1.0"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," /"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," chunkSize);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //使用流从源文件读数据，向分块文件中写数据")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        RandomAccessFile raf_r "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," RandomAccessFile"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(sourceFile, "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"r"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //缓存区")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        byte"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[] bytes "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," byte"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1024"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"];")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        for"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ("),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"int"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," i "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"; i "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," chunkNum; i"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"++"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            File chunkFile "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," File"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(chunkFilePath "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," i);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            //分块文件写入流")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            RandomAccessFile raf_rw "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," RandomAccessFile"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(chunkFile, "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"rw"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            int"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," len "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," -"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            while"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ((len"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"raf_r."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"read"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(bytes))"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!=-"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"){")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                raf_rw."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"write"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(bytes,"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",len);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"                if"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(chunkFile."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"length"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"chunkSize){")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"                    break"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            raf_rw."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"close"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        raf_r."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"close"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),e("button",{class:"collapse"})],-1),eh=e("p",null,"文件合并流程：",-1),Eh=e("p",null,"1、找到要合并的文件并按文件合并的先后进行排序。",-1),ph=e("p",null,"2、创建合并文件",-1),rh=e("p",null,"3、依次从合并的文件中读取数据向合并文件写入数",-1),dh=e("p",null,"文件合并的测试代码 ：",-1),gh=e("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"java"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//将分块进行合并")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Test")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testMerge"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() throws IOException {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //块文件目录")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    File chunkFolder "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," File"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"D:'),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"Learning"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"upload"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'chunk"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //源文件")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    File sourceFile "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," File"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"D:'),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"Learning"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"upload"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'1.mkv"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //合并后的文件")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    File mergeFile "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," File"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"D:'),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"Learning"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"upload"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'1_1.mkv"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //取出所有分块文件")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    File"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[] files "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," chunkFolder."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"listFiles"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //将数组转成list")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    List<"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"File"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> filesList "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Arrays."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"asList"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(files);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //对分块文件排序")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    Collections."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"sort"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(filesList, "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"new"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Comparator<"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"File"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">() {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        @"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Override")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        public"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," int"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," compare"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(File "),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"o1"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", File "),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"o2"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            return"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"parseInt"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(o1."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getName"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Integer."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"parseInt"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(o2."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getName"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    });")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //向合并文件写的流")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    RandomAccessFile raf_rw "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," RandomAccessFile"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(mergeFile, "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"rw"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //缓存区")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    byte"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[] bytes "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," byte"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1024"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"];")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //遍历分块文件，向合并 的文件写")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    for"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (File file "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," filesList) {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //读分块的流")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        RandomAccessFile raf_r "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," RandomAccessFile"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(file, "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"r"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        int"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," len "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," -"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        while"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ((len"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"raf_r."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"read"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(bytes))"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!=-"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"){")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            raf_rw."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"write"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(bytes,"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",len);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        raf_r."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"close"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    raf_rw."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"close"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //合并文件完成后对合并的文件md5校验")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    FileInputStream fileInputStream_merge "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," FileInputStream"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(mergeFile);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    FileInputStream fileInputStream_source "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," FileInputStream"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(sourceFile);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String md5_merge "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," DigestUtils."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"md5Hex"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(fileInputStream_merge);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String md5_source "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," DigestUtils."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"md5Hex"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(fileInputStream_source);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(md5_merge."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"equals"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(md5_source)){")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        System.out."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"文件合并成功"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),e("button",{class:"collapse"})],-1),yh=e("h4",{id:"_3-2-3-视频上传流程",tabindex:"-1"},[e("strong",null,"3.2.3 视频上传流程"),E(),e("a",{class:"header-anchor",href:"#_3-2-3-视频上传流程","aria-label":'Permalink to "**3.2.3 视频上传流程**"'},"​")],-1),Fh=e("p",null,"下图是上传视频的整体流程：",-1),ch=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/image-20230704232249335.png",alt:"image-20230704232249335",loading:"lazy",decoding:"async",class:"lazy"})],-1),oh=e("p",null,"1、前端对文件进行分块。",-1),Ah=e("p",null,"2、前端上传分块文件前请求媒资服务检查文件是否存在，如果已经存在则不再上传。",-1),Dh=e("p",null,"3、如果分块文件不存在则前端开始上传",-1),uh=e("p",null,"4、前端请求媒资服务上传分块。",-1),mh=e("p",null,"5、媒资服务将分块上传至MinIO。",-1),Ch=e("p",null,"6、前端将分块上传完毕请求媒资服务合并分块。",-1),Bh=e("p",null,"7、媒资服务判断分块上传完成则请求MinIO合并文件。",-1),bh=e("p",null,"8、合并完成校验合并后的文件是否完整，如果完整则上传完成，否则删除文件。",-1),vh=e("h4",{id:"_3-2-4-minio合并文件测试",tabindex:"-1"},[e("strong",null,"3.2.4 minio合并文件测试"),E(),e("a",{class:"header-anchor",href:"#_3-2-4-minio合并文件测试","aria-label":'Permalink to "**3.2.4 minio合并文件测试**"'},"​")],-1),fh=e("p",null,"1、将分块文件上传至minio",-1),Sh=e("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"java"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//将分块文件上传到minio")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Test")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," uploadChunk"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() throws IOException,  InsufficientDataException, ErrorResponseException, NoSuchAlgorithmException,  InvalidResponseException, XmlParserException, InternalException, ServerException, InvalidKeyException {")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    for"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ("),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"int"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," i "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"; i "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 3"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"; i"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"++"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //上传文件的参数信息")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        UploadObjectArgs uploadObjectArgs "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," UploadObjectArgs."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"builder"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bucket"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"testbucket"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//桶")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"filename"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"D:'),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"Learning"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"upload"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"chunk"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"i) "),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//指定本地文件路径")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"object"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"chunk/"'),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"i)"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//对象名 放在子目录下")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"build"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //上传文件")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        minioClient."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"uploadObject"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(uploadObjectArgs);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        System.out."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"上传分块"'),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"i"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"成功"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),e("button",{class:"collapse"})],-1),jh=e("p",null,"2、通过minio的合并文件",-1),Mh=e("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"java"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//合并文件，要求分块文件最小5M")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Test")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testMerge"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() throws Exception {")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//        List<ComposeSource> sources = new ArrayList<>();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//        for (int i = 0; i < 30; i++) {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//            //指定分块文件的信息")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},'//            ComposeSource composeSource = ComposeSource.builder().bucket("testbucket").object("chunk/" + i).build();')]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//            sources.add(composeSource);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//        }")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        List<"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ComposeSource"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> sources "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Stream."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iterate"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", i "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"->"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ++"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"i)."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"limit"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"3"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"map"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(i "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"->"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ComposeSource."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"builder"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bucket"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"testbucket"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"object"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"chunk/"'),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," i)."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"build"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"collect"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Collectors."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"toList"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //指定合并后的objectName等信息")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        ComposeObjectArgs composeObjectArgs "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ComposeObjectArgs."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"builder"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bucket"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"testbucket"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"object"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"merge01.mp4"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"sources"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(sources)"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//指定源文件")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"build"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //合并文件,")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //报错size 1048576 must be greater than 5242880，minio默认的分块文件大小为5M")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        minioClient."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"composeObject"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(composeObjectArgs);")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//清除分块文件")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Test")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," test_removeObjects"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(){")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //合并分块完成将分块文件清除")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    List<"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"DeleteObject"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> deleteObjects "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Stream."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iterate"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", i "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"->"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ++"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"i)")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"limit"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"6"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"map"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(i "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"->"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," DeleteObject"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"chunk/"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"concat"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Integer."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"toString"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(i))))")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"collect"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Collectors."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"toList"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    RemoveObjectsArgs removeObjectsArgs "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RemoveObjectsArgs."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"builder"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bucket"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"testbucket"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"objects"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(deleteObjects)."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"build"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    Iterable<Result<"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"DeleteError"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">> results "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," minioClient."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"removeObjects"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(removeObjectsArgs);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    results."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"forEach"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(r"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"->"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        DeleteError deleteError "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        try"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            deleteError "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," r."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"get"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        } "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"catch"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (Exception "),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"e"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            e."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"printStackTrace"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    });")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),e("button",{class:"collapse"})],-1),xh=e("p",null,[E("使用minio合并文件报错："),e("code",null,"java.lang.IllegalArgumentException: source testbucket/chunk/0: size 1048576 must be greater than 5242880")],-1),Ph=e("p",null,"minio合并文件默认分块最小5M，我们将分块改为5M再次测试。",-1),_h=e("h3",{id:"_3-3-接口定义",tabindex:"-1"},[e("strong",null,"3.3 接口定义"),E(),e("a",{class:"header-anchor",href:"#_3-3-接口定义","aria-label":'Permalink to "**3.3 接口定义**"'},"​")],-1),Ih=e("p",null,[E("根据上传视频流程，定义接口，与前端的约定是操作成功返回"),e("code",null,"{code:0}"),E("否则返回"),e("code",null,"{code:-1}")],-1),Th=e("p",null,[E("从课程资料中拷贝"),e("code",null,"RestResponse.java"),E("类到base工程下的model包下。")],-1),Oh=e("p",null,"定义接口如下：",-1),Rh=e("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"java"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Api"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"value"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "大文件上传接口"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"tags"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "大文件上传接口"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RestController")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," BigFilesController"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ApiOperation"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"value"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "文件上传前检查文件"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"PostMapping"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/upload/checkfile"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RestResponse<"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Boolean"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> "),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"checkfile"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            @"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestParam"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"fileMd5"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") String "),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"fileMd5")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    ) "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"throws"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Exception {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ApiOperation"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"value"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "分块文件上传前的检测"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"PostMapping"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/upload/checkchunk"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RestResponse<"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Boolean"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> "),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"checkchunk"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestParam"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"fileMd5"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") String "),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"fileMd5"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                            @"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestParam"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"chunk"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"int"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," chunk"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"throws"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Exception {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"       return"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ApiOperation"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"value"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "上传分块文件"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"PostMapping"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/upload/uploadchunk"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RestResponse "),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"uploadchunk"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestParam"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"file"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") MultipartFile "),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"file"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                    @"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestParam"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"fileMd5"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") String "),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"fileMd5"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                    @"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestParam"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"chunk"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"int"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," chunk"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"throws"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Exception {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ApiOperation"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"value"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "合并文件"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"PostMapping"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/upload/mergechunks"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RestResponse "),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"mergechunks"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestParam"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"fileMd5"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") String "),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"fileMd5"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                    @"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestParam"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"fileName"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") String "),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"fileName"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                    @"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestParam"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"chunkTotal"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"int"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," chunkTotal"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"throws"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Exception {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),e("button",{class:"collapse"})],-1),wh=e("h3",{id:"_3-4-上传分块开发",tabindex:"-1"},[e("strong",null,"3.4 上传分块开发"),E(),e("a",{class:"header-anchor",href:"#_3-4-上传分块开发","aria-label":'Permalink to "**3.4 上传分块开发**"'},"​")],-1),zh=e("h4",{id:"_3-4-1-dao开发",tabindex:"-1"},[e("strong",null,"3.4.1 DAO开发"),E(),e("a",{class:"header-anchor",href:"#_3-4-1-dao开发","aria-label":'Permalink to "**3.4.1 DAO开发**"'},"​")],-1),Lh=e("p",null,"向媒资数据库的文件表插入记录，使用自动生成的Mapper接口即可满足要求。",-1),Nh=e("h4",{id:"_3-4-2-service开发",tabindex:"-1"},[e("strong",null,"3.4.2 Service开发"),E(),e("a",{class:"header-anchor",href:"#_3-4-2-service开发","aria-label":'Permalink to "**3.4.2 Service开发**"'},"​")],-1),Uh=e("h5",{id:"_3-4-2-1-检查文件和分块",tabindex:"-1"},[e("strong",null,"3.4.2.1 检查文件和分块"),E(),e("a",{class:"header-anchor",href:"#_3-4-2-1-检查文件和分块","aria-label":'Permalink to "**3.4.2.1 检查文件和分块**"'},"​")],-1),Kh=e("p",null,"接口完成进行接口实现，首先实现检查文件方法和检查分块方法。",-1),qh=e("p",null,"在MediaFileService中定义service接口如下：",-1),Hh=e("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"java"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"/**")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * @description 检查文件是否存在")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," fileMd5"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," 文件的md5")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@return"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," com.xuecheng.base.model.RestResponse<java.lang.Boolean> false不存在，true存在")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"*/")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RestResponse"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Boolean"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," checkFile"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(String fileMd5);")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"/**")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * @description 检查分块是否存在")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," fileMd5"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  文件的md5")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," chunkIndex"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  分块序号")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@return"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," com.xuecheng.base.model.RestResponse<java.lang.Boolean> false不存在，true存在")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"*/")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RestResponse"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Boolean"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," checkChunk"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(String fileMd5, "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"int"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," chunkIndex);")])])]),e("button",{class:"collapse"})],-1),$h=e("p",null,"service接口实现方法：",-1),Wh=e("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"java"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Override")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RestResponse"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Boolean"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," checkFile"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(String fileMd5) {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //查询文件信息")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    MediaFiles mediaFiles "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," mediaFilesMapper."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"selectById"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(fileMd5);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (mediaFiles "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //桶")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        String bucket "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," mediaFiles."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getBucket"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //存储目录")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        String filePath "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," mediaFiles."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getFilePath"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //文件流")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        InputStream stream "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        try"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            stream "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," minioClient."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getObject"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    GetObjectArgs."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"builder"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                            ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bucket"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(bucket)")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                            ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"object"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(filePath)")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                            ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"build"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            if"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (stream "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"                //文件已存在")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"                return"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RestResponse."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"success"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        } "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"catch"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (Exception "),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"e"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"           ")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //文件不存在")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    return"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RestResponse."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"success"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"false"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Override")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RestResponse"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Boolean"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," checkChunk"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(String fileMd5, "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"int"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," chunkIndex) {")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //得到分块文件目录")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String chunkFileFolderPath "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getChunkFileFolderPath"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(fileMd5);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //得到分块文件的路径")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String chunkFilePath "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," chunkFileFolderPath "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," chunkIndex;")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //文件流")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    InputStream fileInputStream "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    try"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        fileInputStream "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," minioClient."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getObject"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                GetObjectArgs."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"builder"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                        ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bucket"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(bucket_videoFiles)")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                        ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"object"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(chunkFilePath)")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                        ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"build"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        if"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (fileInputStream "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            //分块已存在")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            return"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RestResponse."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"success"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    } "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"catch"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (Exception "),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"e"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        ")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //分块未存在")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    return"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RestResponse."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"success"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"false"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//得到分块文件的目录")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"private"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String "),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getChunkFileFolderPath"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(String fileMd5) {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    return"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," fileMd5."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"substring"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "/"'),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," fileMd5."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"substring"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "/"'),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," fileMd5 "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "/"'),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "chunk"'),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "/"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),e("button",{class:"collapse"})],-1),Gh=e("h5",{id:"_3-4-2-2-上传分块",tabindex:"-1"},[e("strong",null,"3.4.2.2 上传分块"),E(),e("a",{class:"header-anchor",href:"#_3-4-2-2-上传分块","aria-label":'Permalink to "**3.4.2.2 上传分块**"'},"​")],-1),Vh=e("p",null,"定义service接口",-1),Xh=e("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"java"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"/**")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * @description 上传分块")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," fileMd5"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  文件md5")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," chunk"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  分块序号")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," localChunkFilePath"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  分块文件本地路径")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@return"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," com.xuecheng.base.model.RestResponse")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," */")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RestResponse "),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"uploadChunk"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(String fileMd5,"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"int"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," chunk,String localChunkFilePath);")])])]),e("button",{class:"collapse"})],-1),Jh=e("p",null,"接口实现：",-1),Yh=e("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"java"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Override")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RestResponse "),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"uploadChunk"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(String fileMd5, "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"int"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," chunk, String localChunkFilePath) {")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //得到分块文件的目录路径")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String chunkFileFolderPath "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getChunkFileFolderPath"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(fileMd5);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //得到分块文件的路径")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String chunkFilePath "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," chunkFileFolderPath "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," chunk;")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //mimeType")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String mimeType "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getMimeType"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"null"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //将文件存储至minIO")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    boolean"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," b "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," addMediaFilesToMinIO"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(localChunkFilePath, mimeType, bucket_videoFiles, chunkFilePath);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ("),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"b) {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        log."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"debug"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"上传分块文件失败:{}"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", chunkFilePath);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RestResponse."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"validfail"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"false"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"上传分块失败"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    log."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"debug"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"上传分块文件成功:{}"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",chunkFilePath);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    return"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RestResponse."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"success"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),e("button",{class:"collapse"})],-1),Qh=e("h5",{id:"_3-4-2-3-上传分块测试",tabindex:"-1"},[e("strong",null,"3.4.2.3 上传分块测试"),E(),e("a",{class:"header-anchor",href:"#_3-4-2-3-上传分块测试","aria-label":'Permalink to "**3.4.2.3 上传分块测试**"'},"​")],-1),Zh=e("p",null,"完善接口层：",-1),ik=e("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"java"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ApiOperation"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"value"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "文件上传前检查文件"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"PostMapping"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/upload/checkfile"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RestResponse"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Boolean"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," checkfile"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        @"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestParam"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"fileMd5"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") String fileMd5")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") throws Exception {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    return"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," mediaFileService."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"checkFile"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(fileMd5);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ApiOperation"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"value"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "分块文件上传前的检测"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"PostMapping"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/upload/checkchunk"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RestResponse"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Boolean"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," checkchunk"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestParam"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"fileMd5"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") String fileMd5,")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                        @"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestParam"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"chunk"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"int"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," chunk) throws Exception {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    return"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," mediaFileService."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"checkChunk"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(fileMd5,chunk);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ApiOperation"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"value"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "上传分块文件"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"PostMapping"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/upload/uploadchunk"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RestResponse "),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"uploadchunk"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestParam"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"file"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") MultipartFile file,")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                @"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestParam"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"fileMd5"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") String fileMd5,")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                @"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestParam"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"chunk"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"int"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," chunk) throws Exception {")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //创建临时文件")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    File tempFile "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," File."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"createTempFile"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"minio"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"temp"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //上传的文件拷贝到临时文件")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    file."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"transferTo"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(tempFile);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //文件路径")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String absolutePath "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," tempFile."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getAbsolutePath"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    return"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," mediaFileService."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"uploadChunk"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(fileMd5,chunk,absolutePath);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),e("button",{class:"collapse"})],-1),sk=e("p",null,"启动前端工程，进入上传视频界面进行前后端联调测试。",-1),lk=e("p",null,"前端对文件分块的大小为5MB，SpringBoot web默认上传文件的大小限制为1MB，这里需要在media-api工程修改配置如下：",-1),ak=e("div",{style:{"max-height":"300px"},class:"language-yaml vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"yaml"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"spring"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  servlet"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    multipart"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"      max-file-size"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"50MB")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"      max-request-size"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"50MB")])])]),e("button",{class:"collapse"})],-1),hk=e("p",null,[e("code",null,"max-file-size"),E("：单个文件的大小限制")],-1),kk=e("p",null,[e("code",null,"Max-request-size"),E(": 单次请求的大小限制")],-1),tk=e("p",null,[E("上传分块时被限制大小，在本地"),e("code",null,"nginx.conf"),E("配置：")],-1),nk=e("div",{style:{"max-height":"300px"},class:"language-apl vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"apl"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"#"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"gzip  on"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},";")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"#"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"文件服务")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"client_max_body_size "),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"50m"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},";")])])]),e("button",{class:"collapse"})],-1),ek=e("h3",{id:"_3-5-合并分块开发",tabindex:"-1"},[e("strong",null,"3.5 合并分块开发"),E(),e("a",{class:"header-anchor",href:"#_3-5-合并分块开发","aria-label":'Permalink to "**3.5 合并分块开发**"'},"​")],-1),Ek=e("h4",{id:"_3-5-1-service开发",tabindex:"-1"},[e("strong",null,"3.5.1 service开发"),E(),e("a",{class:"header-anchor",href:"#_3-5-1-service开发","aria-label":'Permalink to "**3.5.1 service开发**"'},"​")],-1),pk=e("p",null,"定义service接口：",-1),rk=e("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"java"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"/**")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * @description 合并分块")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," companyId"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  机构id")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," fileMd5"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  文件md5")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," chunkTotal"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," 分块总和")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," uploadFileParamsDto"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," 文件信息")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@return"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," com.xuecheng.base.model.RestResponse")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," */")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RestResponse "),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"mergechunks"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Long companyId,String fileMd5,"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"int"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," chunkTotal,UploadFileParamsDto uploadFileParamsDto);")])])]),e("button",{class:"collapse"})],-1),dk=e("p",null,"service实现：",-1),gk=e("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"java"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Java")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Override")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RestResponse "),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"mergechunks"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Long companyId, String fileMd5, "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"int"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," chunkTotal, UploadFileParamsDto uploadFileParamsDto) {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //=====获取分块文件路径=====")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String chunkFileFolderPath "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getChunkFileFolderPath"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(fileMd5);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //组成将分块文件路径组成 List<ComposeSource>")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    List<"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ComposeSource"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> sourceObjectList "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Stream."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iterate"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", i "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"->"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ++"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"i)")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"limit"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(chunkTotal)")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"map"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(i "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"->"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ComposeSource."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"builder"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bucket"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(bucket_videoFiles)")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"object"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(chunkFileFolderPath."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"concat"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Integer."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"toString"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(i)))")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"build"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"collect"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Collectors."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"toList"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //=====合并=====")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //文件名称")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String fileName "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," uploadFileParamsDto."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getFilename"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //文件扩展名")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String extName "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," fileName."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"substring"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(fileName."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"lastIndexOf"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"."'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"));")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //合并文件路径")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String mergeFilePath "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getFilePathByMd5"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(fileMd5, extName);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    try"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //合并文件")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        ObjectWriteResponse response "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," minioClient."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"composeObject"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                ComposeObjectArgs."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"builder"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                        ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bucket"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(bucket_videoFiles)")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                        ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"object"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(mergeFilePath)")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                        ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"sources"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(sourceObjectList)")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                        ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"build"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        log."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"debug"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"合并文件成功:{}"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",mergeFilePath);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    } "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"catch"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (Exception "),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"e"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        log."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"debug"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"合并文件失败,fileMd5:{},异常:{}"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",fileMd5,e."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getMessage"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(),e);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RestResponse."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"validfail"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"false"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"合并文件失败。"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // ====验证md5====")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //下载合并后的文件")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    File minioFile "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," downloadFileFromMinIO"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(bucket_videoFiles,mergeFilePath);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(minioFile "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=="),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"){")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        log."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"debug"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"下载合并后文件失败,mergeFilePath:{}"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",mergeFilePath);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RestResponse."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"validfail"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"false"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"下载合并后文件失败。"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    try"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (InputStream newFileInputStream "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," FileInputStream"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(minioFile)) {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //minio上文件的md5值")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        String md5Hex "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," DigestUtils."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"md5Hex"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(newFileInputStream);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //比较md5值，不一致则说明文件不完整")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        if"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"fileMd5."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"equals"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(md5Hex)){")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            return"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RestResponse."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"validfail"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"false"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"文件合并校验失败，最终上传失败。"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //文件大小")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        uploadFileParamsDto."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setFileSize"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(minioFile."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"length"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"catch"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (Exception "),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"e"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"){")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        log."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"debug"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"校验文件失败,fileMd5:{},异常:{}"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",fileMd5,e."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getMessage"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(),e);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RestResponse."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"validfail"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"false"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"文件合并校验失败，最终上传失败。"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"finally"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"       if"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(minioFile"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"null"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"){")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"           minioFile."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"delete"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"       }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //文件入库")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    currentProxy."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"addMediaFilesToDb"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(companyId,fileMd5,uploadFileParamsDto,bucket_videoFiles,mergeFilePath);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //=====清除分块文件=====")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    clearChunkFiles"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(chunkFileFolderPath,chunkTotal);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    return"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RestResponse."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"success"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"/**")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * 从minio下载文件")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," bucket"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," 桶")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," objectName"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," 对象名称")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@return"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," 下载后的文件")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," */")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," File "),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"downloadFileFromMinIO"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(String bucket,String objectName){")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    //临时文件")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    File minioFile "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    FileOutputStream outputStream "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    try"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        InputStream stream "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," minioClient."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getObject"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(GetObjectArgs."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"builder"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bucket"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(bucket)")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"object"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(objectName)")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"build"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //创建临时文件")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        minioFile"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"File."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"createTempFile"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"minio"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'".merge"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        outputStream "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," FileOutputStream"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(minioFile);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        IOUtils."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"copy"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(stream,outputStream);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," minioFile;")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    } "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"catch"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (Exception "),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"e"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"       e."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"printStackTrace"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"finally"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        if"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(outputStream"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"null"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"){")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            try"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                outputStream."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"close"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            } "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"catch"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (IOException "),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"e"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                e."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"printStackTrace"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    return"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"/**")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * 得到合并后的文件的地址")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," fileMd5"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," 文件id即md5值")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," fileExt"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," 文件扩展名")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@return")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," */")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"private"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String "),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getFilePathByMd5"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(String fileMd5,String fileExt){")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    return"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"   fileMd5."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"substring"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},","),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "/"'),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," fileMd5."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"substring"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},","),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "/"'),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," fileMd5 "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "/"'),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"fileMd5 "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"fileExt;")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"/**")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * 清除分块文件")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," chunkFileFolderPath"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," 分块文件路径")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," chunkTotal"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," 分块文件总数")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," */")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"private"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," clearChunkFiles"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(String chunkFileFolderPath,"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"int"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," chunkTotal){")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    try"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        List<"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"DeleteObject"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> deleteObjects "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Stream."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iterate"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", i "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"->"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ++"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"i)")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"limit"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(chunkTotal)")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"map"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(i "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"->"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," DeleteObject"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(chunkFileFolderPath."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"concat"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Integer."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"toString"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(i))))")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                ."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"collect"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Collectors."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"toList"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        RemoveObjectsArgs removeObjectsArgs "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RemoveObjectsArgs."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"builder"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bucket"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"video"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"objects"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(deleteObjects)."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"build"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        Iterable<Result<"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"DeleteError"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">> results "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," minioClient."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"removeObjects"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(removeObjectsArgs);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        results."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"forEach"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(r"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"->"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            DeleteError deleteError "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            try"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                deleteError "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," r."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"get"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            } "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"catch"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (Exception "),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"e"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                e."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"printStackTrace"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                log."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"error"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"清楚分块文件失败,objectname:{}"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",deleteError."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"objectName"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(),e);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        });")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    } "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"catch"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (Exception "),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"e"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        e."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"printStackTrace"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        log."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"error"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"清楚分块文件失败,chunkFileFolderPath:{}"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",chunkFileFolderPath,e);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),e("button",{class:"collapse"})],-1),yk=e("h4",{id:"_3-5-2-接口层完善",tabindex:"-1"},[e("strong",null,"3.5.2 接口层完善"),E(),e("a",{class:"header-anchor",href:"#_3-5-2-接口层完善","aria-label":'Permalink to "**3.5.2 接口层完善**"'},"​")],-1),Fk=e("p",null,"下边完善接口层",-1),ck=e("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"java"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ApiOperation"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"value"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "合并文件"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"PostMapping"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/upload/mergechunks"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RestResponse "),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"mergechunks"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestParam"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"fileMd5"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") String fileMd5,")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                @"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestParam"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"fileName"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") String fileName,")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                @"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestParam"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"chunkTotal"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"int"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," chunkTotal) throws Exception {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    Long companyId "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 1232141425L"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    UploadFileParamsDto uploadFileParamsDto "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," UploadFileParamsDto"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    uploadFileParamsDto."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setFileType"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"001002"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    uploadFileParamsDto."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setTags"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"课程视频"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    uploadFileParamsDto."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setRemark"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'""'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    uploadFileParamsDto."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setFilename"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(fileName);")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    return"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," mediaFileService."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"mergechunks"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(companyId,fileMd5,chunkTotal,uploadFileParamsDto);")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),e("button",{class:"collapse"})],-1),ok=e("h4",{id:"_3-5-3-合并分块测试",tabindex:"-1"},[e("strong",null,"3.5.3 合并分块测试"),E(),e("a",{class:"header-anchor",href:"#_3-5-3-合并分块测试","aria-label":'Permalink to "**3.5.3 合并分块测试**"'},"​")],-1),Ak=e("p",null,"下边进行前后端联调：",-1),Dk=e("p",null,"1、上传一个视频测试合并分块的执行逻辑",-1),uk=e("p",null,"进入service方法逐行跟踪。",-1),mk=e("p",null,"2、断点续传测试",-1),Ck=e("p",null,"上传一部分后，停止刷新浏览器再重新上传，通过浏览器日志发现已经上传过的分块不再重新上传",-1),Bk=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps90.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),bk=e("h2",{id:"四-绑定媒资",tabindex:"-1"},[e("strong",null,"四 绑定媒资"),E(),e("a",{class:"header-anchor",href:"#四-绑定媒资","aria-label":'Permalink to "**四 绑定媒资**"'},"​")],-1),vk=e("h3",{id:"_4-1-需求分析",tabindex:"-1"},[e("strong",null,"4.1 需求分析"),E(),e("a",{class:"header-anchor",href:"#_4-1-需求分析","aria-label":'Permalink to "**4.1 需求分析**"'},"​")],-1),fk=e("h4",{id:"_4-1-1-业务流程",tabindex:"-1"},[e("strong",null,"4.1.1 业务流程"),E(),e("a",{class:"header-anchor",href:"#_4-1-1-业务流程","aria-label":'Permalink to "**4.1.1 业务流程**"'},"​")],-1),Sk=e("p",null,"到目前为止，媒资管理已完成文件上传、视频处理、我的媒资功能等基本功能，其它模块可以使用媒资文件，本节要讲解课程计划绑定媒资文件。",-1),jk=e("p",null,"如何将课程计划绑定媒资呢？",-1),Mk=e("p",null,"首先进入课程计划界面，然后选择要绑定的视频进行绑定即可。",-1),xk=e("p",null,"具体的业务流程如下：",-1),Pk=e("p",null,'1.教育机构用户进入课程管理页面并编辑某一个课程，在"课程大纲"标签页的某一小节后可点击”添加视频“。',-1),_k=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps139.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),Ik=e("p",null,"2.弹出添加视频对话框，可通过视频关键字搜索已审核通过的视频媒资。",-1),Tk=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps140.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),Ok=e("p",null,"3.选择视频媒资，点击提交按钮，完成课程计划绑定媒资流程。",-1),Rk=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps141.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),wk=e("p",null,"课程计划关联视频后如下图：",-1),zk=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps142.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),Lk=e("p",null,"点击已经绑定的视频名称即可解除绑定。",-1),Nk=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps143.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),Uk=e("h4",{id:"_4-1-2-数据模型",tabindex:"-1"},[e("strong",null,"4.1.2 数据模型"),E(),e("a",{class:"header-anchor",href:"#_4-1-2-数据模型","aria-label":'Permalink to "**4.1.2 数据模型**"'},"​")],-1),Kk=e("p",null,"课程计划绑定媒资文件后存储至课程计划绑定媒资表",-1),qk=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps144.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),Hk=e("h3",{id:"_4-2-接口定义",tabindex:"-1"},[e("strong",null,"4.2 接口定义"),E(),e("a",{class:"header-anchor",href:"#_4-2-接口定义","aria-label":'Permalink to "**4.2 接口定义**"'},"​")],-1),$k=e("p",null,"根据业务流程，用户进入课程计划列表，首先确定向哪个课程计划添加视频，点击”添加视频“后用户选择视频，选择视频，点击提交，前端以json格式请求以下参数：",-1),Wk=e("p",null,"提交媒资文件id、文件名称、教学计划id",-1),Gk=e("p",null,"示例如下：",-1),Vk=e("div",{style:{"max-height":"300px"},class:"language-json vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"json"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "mediaId"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"70a98b4a2fffc89e50b101f959cc33ca"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "fileName"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"22-Hmily实现TCC事务-开发bank2的confirm方法.avi"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "teachplanId"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"257")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),e("button",{class:"collapse"})],-1),Xk=e("p",null,"此接口在内容管理模块提供。",-1),Jk=e("p",null,"在内容管理模块定义请求参数模型类型：",-1),Yk=e("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"java"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Data")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ApiModel"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"value"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"BindTeachplanMediaDto"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"description"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"教学计划-媒资绑定提交数据"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," BindTeachplanMediaDto"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ApiModelProperty"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"value"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "媒资文件id"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"required"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," true"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"private"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String mediaId;")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ApiModelProperty"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"value"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "媒资文件名称"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"required"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," true"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"private"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String fileName;")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," @"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ApiModelProperty"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"value"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "课程计划标识"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"required"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," true"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," private"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Long teachplanId;")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),e("button",{class:"collapse"})],-1),Qk=e("p",null,"在TeachplanController类中定义接口如下：",-1),Zk=e("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"java"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ApiOperation"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"value"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "课程计划和媒资信息绑定"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"PostMapping"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/teachplan/association/media"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," associationMedia"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestBody"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," BindTeachplanMediaDto bindTeachplanMediaDto){")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),e("button",{class:"collapse"})],-1),it=e("h3",{id:"_4-3-接口开发",tabindex:"-1"},[e("strong",null,"4.3 接口开发"),E(),e("a",{class:"header-anchor",href:"#_4-3-接口开发","aria-label":'Permalink to "**4.3 接口开发**"'},"​")],-1),st=e("h4",{id:"_4-3-1-dao开发",tabindex:"-1"},[e("strong",null,"4.3.1 DAO开发"),E(),e("a",{class:"header-anchor",href:"#_4-3-1-dao开发","aria-label":'Permalink to "**4.3.1 DAO开发**"'},"​")],-1),lt=e("p",null,"对teachplanMedia表自动生成Mapper。",-1),at=e("h4",{id:"_4-3-2-service开发",tabindex:"-1"},[e("strong",null,"4.3.2 Service开发"),E(),e("a",{class:"header-anchor",href:"#_4-3-2-service开发","aria-label":'Permalink to "**4.3.2 Service开发**"'},"​")],-1),ht=e("p",null,"根据需求定义service接口",-1),kt=e("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"java"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"/**")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * @description 教学计划绑定媒资")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),e("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," bindTeachplanMediaDto")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@return"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," com.xuecheng.content.model.po.TeachplanMedia")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@author"),e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," Mr.M")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * @date 2022/9/14 22:20")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"*/")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," TeachplanMedia "),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"associationMedia"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(BindTeachplanMediaDto bindTeachplanMediaDto);")])])]),e("button",{class:"collapse"})],-1),tt=e("p",null,"定义接口实现",-1),nt=e("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"java"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," @"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Transactional")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," @"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Override")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," TeachplanMedia "),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"associationMedia"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(BindTeachplanMediaDto bindTeachplanMediaDto) {")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," //教学计划id")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Long teachplanId "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," bindTeachplanMediaDto."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getTeachplanId"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Teachplan teachplan "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," teachplanMapper."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"selectById"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(teachplanId);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," if"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(teachplan"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=="),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"null"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"){")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  XueChengPlusException."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"cast"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"教学计划不存在"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer grade "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," teachplan."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getGrade"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," if"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(grade"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"){")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  XueChengPlusException."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"cast"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"只允许第二级教学计划绑定媒资文件"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," }")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," //课程id")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Long courseId "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," teachplan."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getCourseId"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," //先删除原来该教学计划绑定的媒资")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," teachplanMediaMapper."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"delete"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"new"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," LambdaQueryWrapper<"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"TeachplanMedia"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">()."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"eq"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(TeachplanMedia"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"::"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"getTeachplanId,teachplanId));")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," //再添加教学计划与媒资的绑定关系")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," TeachplanMedia teachplanMedia "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," TeachplanMedia"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," teachplanMedia."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setCourseId"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(courseId);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," teachplanMedia."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setTeachplanId"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(teachplanId);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," teachplanMedia."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setMediaFilename"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(bindTeachplanMediaDto."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getFileName"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," teachplanMedia."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setMediaId"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(bindTeachplanMediaDto."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getMediaId"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," teachplanMedia."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setCreateDate"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(LocalDateTime."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"now"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," teachplanMediaMapper."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"insert"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(teachplanMedia);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," return"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," teachplanMedia;")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),e("button",{class:"collapse"})],-1),et=e("h4",{id:"_4-3-3-接口层完善",tabindex:"-1"},[e("strong",null,"4.3.3 接口层完善"),E(),e("a",{class:"header-anchor",href:"#_4-3-3-接口层完善","aria-label":'Permalink to "**4.3.3 接口层完善**"'},"​")],-1),Et=e("p",null,"完善接口层调用Service层的代码",-1),pt=e("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"java"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ApiOperation"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"value"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "课程计划和媒资信息绑定"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"PostMapping"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/teachplan/association/media"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"void"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," associationMedia"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(@"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestBody"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," BindTeachplanMediaDto bindTeachplanMediaDto){")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    teachplanService."),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"associationMedia"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(bindTeachplanMediaDto);")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),e("button",{class:"collapse"})],-1),rt=e("h4",{id:"_4-3-4-接口测试",tabindex:"-1"},[e("strong",null,"4.3.4 接口测试"),E(),e("a",{class:"header-anchor",href:"#_4-3-4-接口测试","aria-label":'Permalink to "**4.3.4 接口测试**"'},"​")],-1),dt=e("p",null,"1、使用httpclient测试",-1),gt=e("div",{style:{"max-height":"300px"},class:"language-http vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"http"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"### 课程计划绑定视频")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"POST"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {{media_host}}/media/teachplan/association/media")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"Content-Type"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," application/json")]),E("\n"),e("span",{class:"line"}),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "mediaId"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'""'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "fileName"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'""'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "teachplanId"'),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'""')]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),e("button",{class:"collapse"})],-1),yt=e("p",null,"2、前后端联调",-1),Ft=e("p",null,"此功能较为简单推荐直接前后端联调",-1),ct=e("p",null,"向指定课程计划添加视频",-1),ot=e("h3",{id:"_4-4-实战",tabindex:"-1"},[e("strong",null,"4.4 实战"),E(),e("a",{class:"header-anchor",href:"#_4-4-实战","aria-label":'Permalink to "**4.4 实战**"'},"​")],-1),At=e("p",null,"根据接口定义实现解除绑定功能。",-1),Dt=e("p",null,"点击已经绑定的视频名称即可解除绑定。",-1),ut=e("figure",null,[e("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wps145.jpg",alt:"img",loading:"lazy",decoding:"async",class:"lazy"})],-1),mt=e("p",null,"接口定义如下：",-1),Ct=e("p",null,[e("code",null,"delete /teachplan/association/media/{teachPlanId}/{mediaId} 返回200状态码表示成功。")],-1),Bt=e("p",null,"开发完成使用httpclient测试、前后端联调",-1),bt=e("div",{style:{"max-height":"300px"},class:"language-http vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"http"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"### 课程计划接触视频绑定")]),E("\n"),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"DELETE"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {{media_host}}/media/teachplan/association/media/{teachPlanId}/{mediaId}")])])]),e("button",{class:"collapse"})],-1),vt={__name:"Distributed_File_System-minio",setup(e,{expose:E}){const vt=JSON.parse('{"title":"分布式文件系统-minio","description":"","frontmatter":{"cover":"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/planet_clouds_light_94996_1920x1080.jpg","title":"分布式文件系统-minio","date":"2023-07-04T21:21:17.000Z","author":"imklaus","categories":"Java","tags":["Spring Cloud","Spring Boot","minio"],"top":240,"outline":"deep"},"headers":[{"level":2,"title":"一 分布式文件系统","slug":"一-分布式文件系统","link":"#一-分布式文件系统","children":[{"level":3,"title":"1.1 什么是分布式文件系统","slug":"_1-1-什么是分布式文件系统","link":"#_1-1-什么是分布式文件系统","children":[]},{"level":3,"title":"1.2 MinIO","slug":"_1-2-minio","link":"#_1-2-minio","children":[]}]},{"level":2,"title":"二 上传图片","slug":"二-上传图片","link":"#二-上传图片","children":[{"level":3,"title":"2.1 需求分析","slug":"_2-1-需求分析","link":"#_2-1-需求分析","children":[]},{"level":3,"title":"2.2 准备环境","slug":"_2-2-准备环境","link":"#_2-2-准备环境","children":[]},{"level":3,"title":"2.3 接口定义","slug":"_2-3-接口定义","link":"#_2-3-接口定义","children":[]},{"level":3,"title":"2.4 接口开发","slug":"_2-4-接口开发","link":"#_2-4-接口开发","children":[]}]},{"level":2,"title":"三 上传视频","slug":"三-上传视频","link":"#三-上传视频","children":[{"level":3,"title":"3.1 需求分析","slug":"_3-1-需求分析","link":"#_3-1-需求分析","children":[]},{"level":3,"title":"3.2 断点续传技术","slug":"_3-2-断点续传技术","link":"#_3-2-断点续传技术","children":[]},{"level":3,"title":"3.3 接口定义","slug":"_3-3-接口定义","link":"#_3-3-接口定义","children":[]},{"level":3,"title":"3.4 上传分块开发","slug":"_3-4-上传分块开发","link":"#_3-4-上传分块开发","children":[]},{"level":3,"title":"3.5 合并分块开发","slug":"_3-5-合并分块开发","link":"#_3-5-合并分块开发","children":[]}]},{"level":2,"title":"四 绑定媒资","slug":"四-绑定媒资","link":"#四-绑定媒资","children":[{"level":3,"title":"4.1 需求分析","slug":"_4-1-需求分析","link":"#_4-1-需求分析","children":[]},{"level":3,"title":"4.2 接口定义","slug":"_4-2-接口定义","link":"#_4-2-接口定义","children":[]},{"level":3,"title":"4.3 接口开发","slug":"_4-3-接口开发","link":"#_4-3-接口开发","children":[]},{"level":3,"title":"4.4 实战","slug":"_4-4-实战","link":"#_4-4-实战","children":[]}]}],"relativePath":"pages/posts/Distributed_File_System-minio.md","path":"D:/Learning/myblog/valaxy-lastest/imklaus-valaxy-blog/pages/posts/Distributed_File_System-minio.md","lastUpdated":null}'),ft=i(),St=vt.frontmatter||{};ft.meta.frontmatter=Object.assign(ft.meta.frontmatter||{},vt.frontmatter||{}),s("pageData",vt),s("valaxy:frontmatter",St),globalThis.$frontmatter=St;return E({frontmatter:{cover:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/planet_clouds_light_94996_1920x1080.jpg",title:"分布式文件系统-minio",date:"2023-07-04T21:21:17.000Z",author:"imklaus",categories:"Java",tags:["Spring Cloud","Spring Boot","minio"],top:240,outline:"deep"}}),(i,s)=>{const e=t;return l(),a(e,{frontmatter:k(St)},{"main-content-md":h((()=>[p,r,d,g,y,F,c,o,A,D,u,m,C,B,b,v,f,S,j,M,x,P,_,I,T,O,R,w,z,L,N,U,K,q,H,$,W,G,V,X,J,Y,Q,Z,ii,si,li,ai,hi,ki,ti,ni,ei,Ei,pi,ri,di,gi,yi,Fi,ci,oi,Ai,Di,ui,mi,Ci,Bi,bi,vi,fi,Si,ji,Mi,xi,Pi,_i,Ii,Ti,Oi,Ri,wi,zi,Li,Ni,Ui,Ki,qi,Hi,$i,Wi,Gi,Vi,Xi,Ji,Yi,Qi,Zi,is,ss,ls,as,hs,ks,ts,ns,es,Es,ps,rs,ds,gs,ys,Fs,cs,os,As,Ds,us,ms,Cs,Bs,bs,vs,fs,Ss,js,Ms,xs,Ps,_s,Is,Ts,Os,Rs,ws,zs,Ls,Ns,Us,Ks,qs,Hs,$s,Ws,Gs,Vs,Xs,Js,Ys,Qs,Zs,il,sl,ll,al,hl,kl,tl,nl,el,El,pl,rl,dl,gl,yl,Fl,cl,ol,Al,Dl,ul,ml,Cl,Bl,bl,vl,fl,Sl,jl,Ml,xl,Pl,_l,Il,Tl,Ol,Rl,wl,zl,Ll,Nl,Ul,Kl,ql,Hl,$l,Wl,Gl,Vl,Xl,Jl,Yl,Ql,Zl,ia,sa,la,aa,ha,ka,ta,na,ea,Ea,pa,ra,da,ga,ya,Fa,ca,oa,Aa,Da,ua,ma,Ca,Ba,ba,va,fa,Sa,ja,Ma,xa,Pa,_a,Ia,Ta,Oa,Ra,wa,za,La,Na,Ua,Ka,qa,Ha,$a,Wa,Ga,Va,Xa,Ja,Ya,Qa,Za,ih,sh,lh,ah,hh,kh,th,nh,eh,Eh,ph,rh,dh,gh,yh,Fh,ch,oh,Ah,Dh,uh,mh,Ch,Bh,bh,vh,fh,Sh,jh,Mh,xh,Ph,_h,Ih,Th,Oh,Rh,wh,zh,Lh,Nh,Uh,Kh,qh,Hh,$h,Wh,Gh,Vh,Xh,Jh,Yh,Qh,Zh,ik,sk,lk,ak,hk,kk,tk,nk,ek,Ek,pk,rk,dk,gk,yk,Fk,ck,ok,Ak,Dk,uk,mk,Ck,Bk,bk,vk,fk,Sk,jk,Mk,xk,Pk,_k,Ik,Tk,Ok,Rk,wk,zk,Lk,Nk,Uk,Kk,qk,Hk,$k,Wk,Gk,Vk,Xk,Jk,Yk,Qk,Zk,it,st,lt,at,ht,kt,tt,nt,et,Et,pt,rt,dt,gt,yt,Ft,ct,ot,At,Dt,ut,mt,Ct,Bt,bt])),"main-header":h((()=>[n(i.$slots,"main-header")])),"main-header-after":h((()=>[n(i.$slots,"main-header-after")])),"main-nav":h((()=>[n(i.$slots,"main-nav")])),"main-content":h((()=>[n(i.$slots,"main-content")])),"main-content-after":h((()=>[n(i.$slots,"main-content-after")])),"main-nav-before":h((()=>[n(i.$slots,"main-nav-before")])),"main-nav-after":h((()=>[n(i.$slots,"main-nav-after")])),comment:h((()=>[n(i.$slots,"comment")])),footer:h((()=>[n(i.$slots,"footer")])),aside:h((()=>[n(i.$slots,"aside")])),"aside-custom":h((()=>[n(i.$slots,"aside-custom")])),default:h((()=>[n(i.$slots,"default")])),_:3},8,["frontmatter"])}}};export{vt as default};
