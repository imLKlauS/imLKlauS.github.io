import{_ as s,h as l,p as o,j as e,k as n,l as a,m as t,s as r,t as c,v as p,q as E,x as y}from"../../assets/app-eda06591.js";import"../@vueuse/@vueuse.592447f3.js";import"../animejs/animejs.82133372.js";const i=JSON.parse('{"title":"设计模式之抽象策略模式-Strategy","description":"","frontmatter":{"cover":"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wallhaven-e7pwdw1920x1080.png","title":"设计模式之抽象策略模式-Strategy","top":260,"author":"imklaus","tags":["Spring Boot","策略模式"],"categories":"Java","date":"2023-09-01T19:57:12.000Z","outline":"deep"},"headers":[{"level":2,"title":"策略模式是什么","slug":"策略模式是什么","link":"#策略模式是什么","children":[]},{"level":2,"title":"优惠类型实战","slug":"优惠类型实战","link":"#优惠类型实战","children":[]},{"level":2,"title":"策略模式结合 Spring","slug":"策略模式结合-spring","link":"#策略模式结合-spring","children":[]},{"level":2,"title":"策略模式优缺点","slug":"策略模式优缺点","link":"#策略模式优缺点","children":[]},{"level":2,"title":"框架源码应用","slug":"框架源码应用","link":"#框架源码应用","children":[]},{"level":2,"title":"策略模式抽象","slug":"策略模式抽象","link":"#策略模式抽象","children":[]},{"level":2,"title":"策略模式实现","slug":"策略模式实现","link":"#策略模式实现","children":[{"level":3,"title":"列车座位选择器","slug":"列车座位选择器","link":"#列车座位选择器","children":[]},{"level":3,"title":"登录选择","slug":"登录选择","link":"#登录选择","children":[]}]},{"level":2,"title":"文末总结","slug":"文末总结","link":"#文末总结","children":[]}],"relativePath":"pages/posts/Abstract Strategy Pattern of Design Patterns - Strategy.md","path":"D:\\\\Learning\\\\myblog\\\\valaxy-blog\\\\imklaus.github.io-main\\\\pages\\\\posts\\\\Abstract Strategy Pattern of Design Patterns - Strategy.md","lastUpdated":null}'),u=JSON.parse('{"title":"设计模式之抽象策略模式-Strategy","description":"","frontmatter":{"cover":"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/wallhaven-e7pwdw1920x1080.png","title":"设计模式之抽象策略模式-Strategy","top":260,"author":"imklaus","tags":["Spring Boot","策略模式"],"categories":"Java","date":"2023-09-01T19:57:12.000Z","outline":"deep"},"headers":[{"level":2,"title":"策略模式是什么","slug":"策略模式是什么","link":"#策略模式是什么","children":[]},{"level":2,"title":"优惠类型实战","slug":"优惠类型实战","link":"#优惠类型实战","children":[]},{"level":2,"title":"策略模式结合 Spring","slug":"策略模式结合-spring","link":"#策略模式结合-spring","children":[]},{"level":2,"title":"策略模式优缺点","slug":"策略模式优缺点","link":"#策略模式优缺点","children":[]},{"level":2,"title":"框架源码应用","slug":"框架源码应用","link":"#框架源码应用","children":[]},{"level":2,"title":"策略模式抽象","slug":"策略模式抽象","link":"#策略模式抽象","children":[]},{"level":2,"title":"策略模式实现","slug":"策略模式实现","link":"#策略模式实现","children":[{"level":3,"title":"列车座位选择器","slug":"列车座位选择器","link":"#列车座位选择器","children":[]},{"level":3,"title":"登录选择","slug":"登录选择","link":"#登录选择","children":[]}]},{"level":2,"title":"文末总结","slug":"文末总结","link":"#文末总结","children":[]}],"relativePath":"pages/posts/Abstract Strategy Pattern of Design Patterns - Strategy.md","path":"D:\\\\Learning\\\\myblog\\\\valaxy-blog\\\\imklaus.github.io-main\\\\pages\\\\posts\\\\Abstract Strategy Pattern of Design Patterns - Strategy.md","lastUpdated":null}'),F={name:"pages/posts/Abstract Strategy Pattern of Design Patterns - Strategy.md",data:()=>({data:u,frontmatter:u.frontmatter,$frontmatter:u.frontmatter}),setup(){const s=l();s.meta.frontmatter=Object.assign(s.meta.frontmatter,u.frontmatter),o("pageData",u)}},d={id:"死磕设计模式之抽象策略模式",tabindex:"-1"},A={id:"策略模式是什么",tabindex:"-1"},m=r("p",null,"策略模式在 GoF 的《设计模式》一书中，是这样定义的：",-1),D=r("blockquote",null,[r("p",null,"Define a family of algorithms, encapsulate each one, and make them interchangeable. Strategy lets the algorithm vary independently from clients that use it.")],-1),g=r("p",null,"策略设计模式（Strategy Pattern）是一种面向对象设计模式，它定义了一系列算法，并将每个算法封装起来，使它们可以相互替换。这种模式使得算法可以独立于使用它们的客户端而变化。",-1),C=r("p",null,"策略设计模式包含三个主要的角色：",-1),S=r("blockquote",null,[r("ol",null,[r("li",null,"环境（Context）：持有一个策略对象，并调用其算法。"),r("li",null,"策略（Strategy）：定义了一组算法，并将每个算法封装起来，使它们可以相互替换。"),r("li",null,"具体策略（ConcreteStrategy）：实现了策略接口，提供了具体的算法实现。")])],-1),h=r("p",null,"在策略设计模式中，环境持有一个策略对象，并通过调用策略的算法来完成具体的任务。策略对象可以根据需要进行替换，从而实现不同的算法实现，并且可以在运行时动态地更改策略对象。",-1),b=r("p",null,"看到上面的介绍可能不太明白策略模式具体为何物，这里会从最基本的代码说起，一步一步彻底掌握此模式。",-1),T={id:"优惠类型实战",tabindex:"-1"},v=r("p",null,[c("下述代码可能大家都能联想出对应的业务，"),r("strong",null,"根据对应的优惠类型，对价格作出相应的优惠。")],-1),B=r("figure",null,[r("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/1672473955617-630ff21a-2791-428d-bebd-bb953989f57d.png",alt:"img",loading:"lazy",decoding:"async"})],-1),f=r("p",null,"这段代码是能够满足项目中业务需求的，而且很多已上线生产环境的代码也有这类代码。但是，这一段代码存在存在两个弊端：",-1),R=r("ol",null,[r("li",null,[c("代码的复杂性，正常业务代码逻辑肯定会比这个代码块复杂很多，这也就 "),r("strong",null,"导致了 if-else 的分支以及代码数量过多"),c("。这种方式可以通过将代码拆分成独立函数或者拆分成类来解决。")]),r("li",null,[c("开闭原则，价格优惠肯定会 "),r("strong",null,"随着不同的时期作出不同的改变"),c("，或许新增、删除或修改。如果在一个函数中修改无疑是件恐怖的事情，想想可能多个开发者分别进行开发，杂乱无章的注释，混乱的代码逻辑等情况十有八九会发生。")])],-1),P=r("p",null,"如何运用策略模式优化上述代码，使程序设计看着简约、可扩展等特性。",-1),k=r("ol",null,[r("li",null,"简化代码的复杂性，将不同的优惠类型定义为不同的策略算法实现类。"),r("li",null,"保证开闭原则，增加程序的健壮性以及可扩展性。")],-1),U=r("p",null,"将上述代码块改造为策略设计模式，大致需要三个步骤。",-1),O=r("ol",null,[r("li",null,"定义抽象策略接口，因为业务使用接口而不是具体的实现类的话，便可以灵活的替换不同的策略；"),r("li",null,"定义具体策略实现类，实现自抽象策略接口，其内部封装具体的业务实现；"),r("li",null,"定义策略工厂，封装创建策略实现（算法），对客户端屏蔽具体的创建细节。")],-1),q=r("figure",null,[r("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/1672473992392-4b6d78d6-47ab-4d98-afe7-110143827b6b.png",alt:"img",loading:"lazy",decoding:"async"})],-1),x=r("p",null,"目前把抽象策略接口、具体的策略实现类以及策略工厂都已经创建了，现在可以看一下客户端需要如何调用，又是如何对客户端屏蔽具体实现细节的。",-1),_=r("figure",null,[r("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/1672474008299-8d04739e-21e7-4c18-bf06-ca39a837ed9b.png",alt:"img",loading:"lazy",decoding:"async"})],-1),I=r("p",null,[c("根据代码块图片得知，具体策略类是从策略工厂中获取，确实是取消了 if-else 设计，"),r("strong",null,"在工厂中使用 Map 存储策略实现"),c("。获取到策略类后执行具体的优惠策略方法就可以获取优惠后的金额。")],-1),L=r("p",null,[c("通过分析大家得知，目前这种设计确实将应用代码的复杂性降低了。"),r("strong",null,"如果新增一个优惠策略，只需要新增一个策略算法实现类即可"),c("。但是，添加一个策略算法实现，"),r("strong",null,"意味着需要改动策略工厂中的代码"),c("，还是不符合开闭原则。")],-1),N=r("p",null,"如何完整实现符合开闭原则的策略模式，需要借助 Spring 的帮助，详细案例请继续往下看。",-1),M={id:"策略模式结合-spring",tabindex:"-1"},V=r("p",null,"最近项目中设计的一个功能用到了策略模式，分为两类角色，笔者负责定义抽象策略接口以及策略工厂，不同的策略算法需要各个业务方去实现，可以联想到上文中的优惠券功能。因为是 Spring 项目，所以都是按照 Spring 的方式进行处理。",-1),w=r("figure",null,[r("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/1672474038315-5988975f-07d4-452f-95d9-f8e7921915fe.png",alt:"img",loading:"lazy",decoding:"async"})],-1),j=r("p",null,"可以看到，比对上面的示例代码，有两处明显的变化：",-1),H=r("ol",null,[r("li",null,"抽象策略接口中，新定义了 mark() 接口，此接口用来标示算法的唯一性；"),r("li",null,"具体策略实现类，使用 @Component 修饰，将对象本身交由 Spring 进行管理 。")],-1),K=r("p",null,"小贴士：为了阅读方便，mark() 返回直接使用字符串替代，读者朋友在返回标示时最好使用枚举定义。",-1),G=r("p",null,"接下来继续查看抽象策略工厂如何改造，才能满足开闭原则。",-1),Q=r("figure",null,[r("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/1672474063847-3dacf3d3-dcdc-4219-9b74-47191e535764.png",alt:"img",loading:"lazy",decoding:"async"})],-1),$=r("p",null,"通过 InitializingBean 接口实现中调用 IOC 容器查找对应策略实现，随后将策略实现 mark() 方法返回值作为 key， 策略实现本身作为 value 添加到 Map 容器中等待客户端的调用。",-1),z=r("figure",null,[r("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/1672474079146-767a091f-05ec-4dd8-9d3d-379981a8d0bb.png",alt:"img",loading:"lazy",decoding:"async"})],-1),Y=r("p",null,"这里使用的 SpringBoot 测试类，注入策略工厂 Bean，通过策略工厂选择出具体的策略算法类，继而通过算法获取到优惠后的价格。",-1),J=r("p",null,"总结下本小节，我们通过和 Spring 结合的方式，通过策略设计模式对文初的代码块进行了两块优化：应对代码的复杂性，让其满足开闭原则。",-1),Z=r("p",null,[c("更具体一些呢就是 "),r("strong",null,"通过抽象策略算法类减少代码的复杂性，继而通过 Spring 的一些特性同时满足了开闭原则"),c("，现在来了新需求只要添加新的策略类即可，健壮易扩展。")],-1),W={id:"策略模式优缺点",tabindex:"-1"},X=r("p",null,"策略设计模式的优点包括：",-1),ss=r("ol",null,[r("li",null,"提高了代码的灵活性和可维护性：由于算法的实现与使用相分离，使得代码的灵活性和可维护性得到提高。当需要修改或添加新的算法时，只需要定义新的策略类，并将其传递给环境类即可，而无需修改环境类的代码。"),r("li",null,"提高了代码的复用性：策略设计模式将算法的实现封装在策略类中，使得算法可以被多个客户端重复使用，从而提高了代码的复用性。"),r("li",null,"可以动态地切换算法：策略设计模式将算法封装在策略类中，使得可以在运行时动态地更改算法，从而实现不同的功能和行为。这样可以使得程序更加灵活，适应不同的需求和变化。"),r("li",null,"算法实现与使用相分离：策略设计模式将算法的实现与使用相分离，使得代码更加清晰、简洁、易于维护和扩展。由于算法的实现被封装在策略类中，客户端只需要关注如何选择和使用不同的算法即可，这样可以使得代码更加易于理解和维护。"),r("li",null,"可以避免使用大量的条件语句：在某些情况下，需要根据不同的条件来选择不同的算法，这可能会导致代码中出现大量的条件语句，使得代码难以维护和扩展。而策略设计模式可以避免这种情况的发生，使得代码更加简洁和易于维护。")],-1),ls=r("p",null,"需要注意的是，在使用策略设计模式时需要注意以下几点：",-1),os=r("ol",null,[r("li",null,"策略类之间应该是相互独立的，彼此之间不应该有任何依赖关系。这样才能确保算法的选择和替换可以在运行时动态地进行，同时也可以避免代码的耦合度过高。"),r("li",null,"策略接口应该尽可能地简单和通用，以便于不同的策略实现类可以共用同一个接口。这样可以提高代码的复用性和灵活性，同时也可以避免接口过于复杂和难以维护。"),r("li",null,"策略设计模式适用于需要在运行时动态切换算法的场景，如果算法的实现不需要动态切换，或者算法的实现较为简单，策略设计模式可能会显得过于复杂。因此，在选择使用策略设计模式时，需要根据具体的需求和场景进行判断和选择。"),r("li",null,"策略设计模式可以与其他设计模式结合使用，例如工厂方法模式、单例模式等。这样可以进一步提高代码的灵活性和可维护性，同时也可以避免代码的复杂度过高。")],-1),es={id:"框架源码应用",tabindex:"-1"},ns=r("p",null,"自己用肯定觉得不够，必要时候还得看看设计开源框架源码的大佬们如何在代码中运用策略模式的。",-1),as=r("p",null,"在马哥了解中，JDK、Spring、SpringMvc、Mybatis、Dubbo 等等都运用了策略设计模式，这里就以 Mybatis 举例说明。",-1),ts=r("p",null,"Mybatis 中 Executor 代表执行器，负责增删改查的具体操作。其中用到了两种设计模式，模版方法以及策略模式。",-1),rs=r("figure",null,[r("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/1672474104169-3317d8bf-5313-470e-9626-4a317ccaf396.png",alt:"img",loading:"lazy",decoding:"async"})],-1),cs=r("ul",null,[r("li",null,"Executor 代表了抽象策略接口，刚才说到的模版方法模式源自 BaseExecutor。"),r("li",null,"Configuration 代表策略工厂，负责创建具体的策略算法实现类。"),r("li",null,"SimpleExecuto、ReuseExecutor... 表示封装了具体的策略算法实现类。")],-1),ps=r("figure",null,[r("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/1672474128984-76fc2c9a-91b8-4f34-8643-a64bd58bc4bf.png",alt:"img",loading:"lazy",decoding:"async"})],-1),Es=r("p",null,"上述代码块发生在 Configuration 类中创建执行器 Executor，通过 executorType 判断创建不同的策略算法。",-1),ys=r("p",null,"上述代码块并没有彻底消除 if-else，因为 Mybatis 中执行器策略基本是固定的，也就是说它只会有这些 if-else 判断，基本不会新增或修改。如果非要消除 if-else，可以这么搞，这里写一下伪代码。",-1),is=r("figure",null,[r("img",{src:"https://jsd.onmicrosoft.cn/gh/imLKlauS/blog-picture@main/blogs/1672474150395-2d817442-442a-4e13-9df8-1642324d57d8.png",alt:"img",loading:"lazy",decoding:"async"})],-1),us=r("p",null,[c("这种方式叫做 "),r("strong",null,'"查表法"'),c("，通过策略工厂实现消除 if-else 分支。最后，Mybatis 太过详细的设计这里不再赘述，有兴趣的小伙伴可以去把源码下载啃一啃。")],-1),Fs=r("p",null,[c("到了这里可能有读者看出了问题，"),r("strong",null,"策略模式就算消除了 if-else 但是如果添加新的策略类，不还是会违反开闭原则么？")],-1),ds=r("p",null,[c("没错，因为 Mybatis 本身没有引入 Spring 依赖，"),r("strong",null,"所以没有办法借助 IOC 容器实现开闭原则"),c("。Spring 是一种开闭原则解决方式，那还有没有别的解决方式？")],-1),As=r("p",null,[c("解决方式有很多，开闭原则核心就是 "),r("strong",null,"对原有代码修改关闭，对新增代码开放"),c("。可以通过扫描指定包下的自定义注解亦或者通过 instanceof 判断是否继承自某接口都可以。")],-1),ms={id:"策略模式抽象",tabindex:"-1"},Ds=r("p",null,[c("可能细心的小伙伴会发现一个问题，当业务使用越来越多的情况下，重复定义 "),r("code",null,"DiscountStrategy"),c(" 以及 "),r("code",null,"DiscountStrategyFactory"),c(" 会增加系统冗余代码量。")],-1),gs=r("p",null,"可以考虑将这两个基础类抽象出来，作为基础组件库中的通用组件，供所有系统下的业务使用，从而避免代码冗余。",-1),Cs=r("p",null,"定义抽象策略处理接口，添加有返回值和无返回值接口。",-1),Ss=r("div",{class:"language-java"},[r("button",{title:"Copy Code",class:"copy"}),r("span",{class:"lang"},"java"),r("pre",{class:"shiki github-dark vp-code-dark"},[r("code",null,[r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"/**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}}," * 策略执行抽象")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}}," */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"interface"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"AbstractExecuteStrategy"),r("span",{style:{color:"#E1E4E8"}},"<"),r("span",{style:{color:"#F97583"}},"REQUEST"),r("span",{style:{color:"#E1E4E8"}},", "),r("span",{style:{color:"#F97583"}},"RESPONSE"),r("span",{style:{color:"#E1E4E8"}},"> {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"    /**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * 执行策略标识")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    String "),r("span",{style:{color:"#B392F0"}},"mark"),r("span",{style:{color:"#E1E4E8"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"    /**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * 执行策略")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     *")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * "),r("span",{style:{color:"#F97583"}},"@param"),r("span",{style:{color:"#6A737D"}}," "),r("span",{style:{color:"#FFAB70"}},"requestParam"),r("span",{style:{color:"#6A737D"}}," 执行策略入参")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"default"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"void"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"execute"),r("span",{style:{color:"#E1E4E8"}},"(REQUEST "),r("span",{style:{color:"#FFAB70"}},"requestParam"),r("span",{style:{color:"#E1E4E8"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"    /**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * 执行策略，带返回值")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     *")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * "),r("span",{style:{color:"#F97583"}},"@param"),r("span",{style:{color:"#6A737D"}}," "),r("span",{style:{color:"#FFAB70"}},"requestParam"),r("span",{style:{color:"#6A737D"}}," 执行策略入参")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * "),r("span",{style:{color:"#F97583"}},"@return"),r("span",{style:{color:"#6A737D"}}," 执行策略后返回值")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"default"),r("span",{style:{color:"#E1E4E8"}}," RESPONSE "),r("span",{style:{color:"#B392F0"}},"executeResp"),r("span",{style:{color:"#E1E4E8"}},"(REQUEST "),r("span",{style:{color:"#FFAB70"}},"requestParam"),r("span",{style:{color:"#E1E4E8"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        "),r("span",{style:{color:"#F97583"}},"return"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#79B8FF"}},"null"),r("span",{style:{color:"#E1E4E8"}},";")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"}")])])]),r("pre",{class:"shiki github-light vp-code-light"},[r("code",null,[r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"/**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}}," * 策略执行抽象")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}}," */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"interface"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"AbstractExecuteStrategy"),r("span",{style:{color:"#24292E"}},"<"),r("span",{style:{color:"#D73A49"}},"REQUEST"),r("span",{style:{color:"#24292E"}},", "),r("span",{style:{color:"#D73A49"}},"RESPONSE"),r("span",{style:{color:"#24292E"}},"> {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"    /**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * 执行策略标识")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    String "),r("span",{style:{color:"#6F42C1"}},"mark"),r("span",{style:{color:"#24292E"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"    /**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * 执行策略")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     *")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * "),r("span",{style:{color:"#D73A49"}},"@param"),r("span",{style:{color:"#6A737D"}}," "),r("span",{style:{color:"#E36209"}},"requestParam"),r("span",{style:{color:"#6A737D"}}," 执行策略入参")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"default"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"void"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"execute"),r("span",{style:{color:"#24292E"}},"(REQUEST "),r("span",{style:{color:"#E36209"}},"requestParam"),r("span",{style:{color:"#24292E"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"    /**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * 执行策略，带返回值")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     *")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * "),r("span",{style:{color:"#D73A49"}},"@param"),r("span",{style:{color:"#6A737D"}}," "),r("span",{style:{color:"#E36209"}},"requestParam"),r("span",{style:{color:"#6A737D"}}," 执行策略入参")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * "),r("span",{style:{color:"#D73A49"}},"@return"),r("span",{style:{color:"#6A737D"}}," 执行策略后返回值")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"default"),r("span",{style:{color:"#24292E"}}," RESPONSE "),r("span",{style:{color:"#6F42C1"}},"executeResp"),r("span",{style:{color:"#24292E"}},"(REQUEST "),r("span",{style:{color:"#E36209"}},"requestParam"),r("span",{style:{color:"#24292E"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        "),r("span",{style:{color:"#D73A49"}},"return"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#005CC5"}},"null"),r("span",{style:{color:"#24292E"}},";")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"}")])])])],-1),hs=r("p",null,[c("添加策略选择器，通过订阅 Spring 初始化事件执行扫描所有策略模式接口执行器，并根据 mark 方法定义标识添加到 "),r("code",null,"abstractExecuteStrategyMap"),c(" 容器中。")],-1),bs=r("p",null,[c("客户端在实际业务中使用 "),r("code",null,"AbstractStrategyChoose#choose"),c(" 即可完成策略模式实现。")],-1),Ts=r("div",{class:"language-java"},[r("button",{title:"Copy Code",class:"copy"}),r("span",{class:"lang"},"java"),r("pre",{class:"shiki github-dark vp-code-dark"},[r("code",null,[r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"/**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}}," * 策略选择器")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}}," */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"class"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"AbstractStrategyChoose"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"implements"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"ApplicationListener"),r("span",{style:{color:"#E1E4E8"}},"<"),r("span",{style:{color:"#F97583"}},"ApplicationInitializingEvent"),r("span",{style:{color:"#E1E4E8"}},"> {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"    /**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * 执行策略集合")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"private"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"final"),r("span",{style:{color:"#E1E4E8"}}," Map<"),r("span",{style:{color:"#F97583"}},"String"),r("span",{style:{color:"#E1E4E8"}},", "),r("span",{style:{color:"#F97583"}},"AbstractExecuteStrategy"),r("span",{style:{color:"#E1E4E8"}},"> abstractExecuteStrategyMap "),r("span",{style:{color:"#F97583"}},"="),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"new"),r("span",{style:{color:"#E1E4E8"}}," HashMap<>();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"    /**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * 根据 mark 查询具体策略")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     *")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * "),r("span",{style:{color:"#F97583"}},"@param"),r("span",{style:{color:"#6A737D"}}," "),r("span",{style:{color:"#FFAB70"}},"mark"),r("span",{style:{color:"#6A737D"}}," 策略标识")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * "),r("span",{style:{color:"#F97583"}},"@return"),r("span",{style:{color:"#6A737D"}}," 实际执行策略")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," AbstractExecuteStrategy "),r("span",{style:{color:"#B392F0"}},"choose"),r("span",{style:{color:"#E1E4E8"}},"(String "),r("span",{style:{color:"#FFAB70"}},"mark"),r("span",{style:{color:"#E1E4E8"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        "),r("span",{style:{color:"#F97583"}},"return"),r("span",{style:{color:"#E1E4E8"}}," Optional."),r("span",{style:{color:"#B392F0"}},"ofNullable"),r("span",{style:{color:"#E1E4E8"}},"(abstractExecuteStrategyMap."),r("span",{style:{color:"#B392F0"}},"get"),r("span",{style:{color:"#E1E4E8"}},"(mark))."),r("span",{style:{color:"#B392F0"}},"orElseThrow"),r("span",{style:{color:"#E1E4E8"}},"(() "),r("span",{style:{color:"#F97583"}},"->"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"new"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"ServiceException"),r("span",{style:{color:"#E1E4E8"}},"(String."),r("span",{style:{color:"#B392F0"}},"format"),r("span",{style:{color:"#E1E4E8"}},"("),r("span",{style:{color:"#9ECBFF"}},'"[%s] 策略未定义"'),r("span",{style:{color:"#E1E4E8"}},", mark)));")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"    /**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * 根据 mark 查询具体策略并执行")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     *")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * "),r("span",{style:{color:"#F97583"}},"@param"),r("span",{style:{color:"#6A737D"}}," "),r("span",{style:{color:"#FFAB70"}},"mark"),r("span",{style:{color:"#6A737D"}},"         策略标识")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * "),r("span",{style:{color:"#F97583"}},"@param"),r("span",{style:{color:"#6A737D"}}," "),r("span",{style:{color:"#FFAB70"}},"requestParam"),r("span",{style:{color:"#6A737D"}}," 执行策略入参")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * "),r("span",{style:{color:"#F97583"}},"@param"),r("span",{style:{color:"#6A737D"}}," "),r("span",{style:{color:"#FFAB70"}},"<REQUEST>"),r("span",{style:{color:"#6A737D"}},"    执行策略入参范型")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," <"),r("span",{style:{color:"#F97583"}},"REQUEST"),r("span",{style:{color:"#E1E4E8"}},"> "),r("span",{style:{color:"#F97583"}},"void"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"chooseAndExecute"),r("span",{style:{color:"#E1E4E8"}},"(String "),r("span",{style:{color:"#FFAB70"}},"mark"),r("span",{style:{color:"#E1E4E8"}},", REQUEST "),r("span",{style:{color:"#FFAB70"}},"requestParam"),r("span",{style:{color:"#E1E4E8"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        AbstractExecuteStrategy executeStrategy "),r("span",{style:{color:"#F97583"}},"="),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"choose"),r("span",{style:{color:"#E1E4E8"}},"(mark);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        executeStrategy."),r("span",{style:{color:"#B392F0"}},"execute"),r("span",{style:{color:"#E1E4E8"}},"(requestParam);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"    /**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * 根据 mark 查询具体策略并执行，带返回结果")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     *")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * "),r("span",{style:{color:"#F97583"}},"@param"),r("span",{style:{color:"#6A737D"}}," "),r("span",{style:{color:"#FFAB70"}},"mark"),r("span",{style:{color:"#6A737D"}},"         策略标识")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * "),r("span",{style:{color:"#F97583"}},"@param"),r("span",{style:{color:"#6A737D"}}," "),r("span",{style:{color:"#FFAB70"}},"requestParam"),r("span",{style:{color:"#6A737D"}}," 执行策略入参")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * "),r("span",{style:{color:"#F97583"}},"@param"),r("span",{style:{color:"#6A737D"}}," "),r("span",{style:{color:"#FFAB70"}},"<REQUEST>"),r("span",{style:{color:"#6A737D"}},"    执行策略入参范型")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * "),r("span",{style:{color:"#F97583"}},"@param"),r("span",{style:{color:"#6A737D"}}," "),r("span",{style:{color:"#FFAB70"}},"<RESPONSE>"),r("span",{style:{color:"#6A737D"}},"   执行策略出参范型")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * "),r("span",{style:{color:"#F97583"}},"@return")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," <"),r("span",{style:{color:"#F97583"}},"REQUEST"),r("span",{style:{color:"#E1E4E8"}},", "),r("span",{style:{color:"#F97583"}},"RESPONSE"),r("span",{style:{color:"#E1E4E8"}},"> RESPONSE "),r("span",{style:{color:"#B392F0"}},"chooseAndExecuteResp"),r("span",{style:{color:"#E1E4E8"}},"(String "),r("span",{style:{color:"#FFAB70"}},"mark"),r("span",{style:{color:"#E1E4E8"}},", REQUEST "),r("span",{style:{color:"#FFAB70"}},"requestParam"),r("span",{style:{color:"#E1E4E8"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        AbstractExecuteStrategy executeStrategy "),r("span",{style:{color:"#F97583"}},"="),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"choose"),r("span",{style:{color:"#E1E4E8"}},"(mark);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        "),r("span",{style:{color:"#F97583"}},"return"),r("span",{style:{color:"#E1E4E8"}}," (RESPONSE) executeStrategy."),r("span",{style:{color:"#B392F0"}},"executeResp"),r("span",{style:{color:"#E1E4E8"}},"(requestParam);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    @"),r("span",{style:{color:"#F97583"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"void"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"onApplicationEvent"),r("span",{style:{color:"#E1E4E8"}},"(ApplicationInitializingEvent "),r("span",{style:{color:"#FFAB70"}},"event"),r("span",{style:{color:"#E1E4E8"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        Map<"),r("span",{style:{color:"#F97583"}},"String"),r("span",{style:{color:"#E1E4E8"}},", "),r("span",{style:{color:"#F97583"}},"AbstractExecuteStrategy"),r("span",{style:{color:"#E1E4E8"}},"> actual "),r("span",{style:{color:"#F97583"}},"="),r("span",{style:{color:"#E1E4E8"}}," ApplicationContextHolder."),r("span",{style:{color:"#B392F0"}},"getBeansOfType"),r("span",{style:{color:"#E1E4E8"}},"(AbstractExecuteStrategy.class);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        actual."),r("span",{style:{color:"#B392F0"}},"forEach"),r("span",{style:{color:"#E1E4E8"}},"((beanName, bean) "),r("span",{style:{color:"#F97583"}},"->"),r("span",{style:{color:"#E1E4E8"}}," {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"            AbstractExecuteStrategy beanExist "),r("span",{style:{color:"#F97583"}},"="),r("span",{style:{color:"#E1E4E8"}}," abstractExecuteStrategyMap."),r("span",{style:{color:"#B392F0"}},"get"),r("span",{style:{color:"#E1E4E8"}},"(bean."),r("span",{style:{color:"#B392F0"}},"mark"),r("span",{style:{color:"#E1E4E8"}},"());")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"            "),r("span",{style:{color:"#F97583"}},"if"),r("span",{style:{color:"#E1E4E8"}}," (beanExist "),r("span",{style:{color:"#F97583"}},"!="),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#79B8FF"}},"null"),r("span",{style:{color:"#E1E4E8"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"                "),r("span",{style:{color:"#F97583"}},"throw"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"new"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"ServiceException"),r("span",{style:{color:"#E1E4E8"}},"(String."),r("span",{style:{color:"#B392F0"}},"format"),r("span",{style:{color:"#E1E4E8"}},"("),r("span",{style:{color:"#9ECBFF"}},'"[%s] Duplicate execution policy"'),r("span",{style:{color:"#E1E4E8"}},", bean."),r("span",{style:{color:"#B392F0"}},"mark"),r("span",{style:{color:"#E1E4E8"}},"()));")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"            }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"            abstractExecuteStrategyMap."),r("span",{style:{color:"#B392F0"}},"put"),r("span",{style:{color:"#E1E4E8"}},"(bean."),r("span",{style:{color:"#B392F0"}},"mark"),r("span",{style:{color:"#E1E4E8"}},"(), bean);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        });")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"}")])])]),r("pre",{class:"shiki github-light vp-code-light"},[r("code",null,[r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"/**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}}," * 策略选择器")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}}," */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"class"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"AbstractStrategyChoose"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"implements"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"ApplicationListener"),r("span",{style:{color:"#24292E"}},"<"),r("span",{style:{color:"#D73A49"}},"ApplicationInitializingEvent"),r("span",{style:{color:"#24292E"}},"> {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"    /**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * 执行策略集合")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"private"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"final"),r("span",{style:{color:"#24292E"}}," Map<"),r("span",{style:{color:"#D73A49"}},"String"),r("span",{style:{color:"#24292E"}},", "),r("span",{style:{color:"#D73A49"}},"AbstractExecuteStrategy"),r("span",{style:{color:"#24292E"}},"> abstractExecuteStrategyMap "),r("span",{style:{color:"#D73A49"}},"="),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"new"),r("span",{style:{color:"#24292E"}}," HashMap<>();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"    /**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * 根据 mark 查询具体策略")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     *")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * "),r("span",{style:{color:"#D73A49"}},"@param"),r("span",{style:{color:"#6A737D"}}," "),r("span",{style:{color:"#E36209"}},"mark"),r("span",{style:{color:"#6A737D"}}," 策略标识")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * "),r("span",{style:{color:"#D73A49"}},"@return"),r("span",{style:{color:"#6A737D"}}," 实际执行策略")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," AbstractExecuteStrategy "),r("span",{style:{color:"#6F42C1"}},"choose"),r("span",{style:{color:"#24292E"}},"(String "),r("span",{style:{color:"#E36209"}},"mark"),r("span",{style:{color:"#24292E"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        "),r("span",{style:{color:"#D73A49"}},"return"),r("span",{style:{color:"#24292E"}}," Optional."),r("span",{style:{color:"#6F42C1"}},"ofNullable"),r("span",{style:{color:"#24292E"}},"(abstractExecuteStrategyMap."),r("span",{style:{color:"#6F42C1"}},"get"),r("span",{style:{color:"#24292E"}},"(mark))."),r("span",{style:{color:"#6F42C1"}},"orElseThrow"),r("span",{style:{color:"#24292E"}},"(() "),r("span",{style:{color:"#D73A49"}},"->"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"new"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"ServiceException"),r("span",{style:{color:"#24292E"}},"(String."),r("span",{style:{color:"#6F42C1"}},"format"),r("span",{style:{color:"#24292E"}},"("),r("span",{style:{color:"#032F62"}},'"[%s] 策略未定义"'),r("span",{style:{color:"#24292E"}},", mark)));")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"    /**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * 根据 mark 查询具体策略并执行")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     *")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * "),r("span",{style:{color:"#D73A49"}},"@param"),r("span",{style:{color:"#6A737D"}}," "),r("span",{style:{color:"#E36209"}},"mark"),r("span",{style:{color:"#6A737D"}},"         策略标识")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * "),r("span",{style:{color:"#D73A49"}},"@param"),r("span",{style:{color:"#6A737D"}}," "),r("span",{style:{color:"#E36209"}},"requestParam"),r("span",{style:{color:"#6A737D"}}," 执行策略入参")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * "),r("span",{style:{color:"#D73A49"}},"@param"),r("span",{style:{color:"#6A737D"}}," "),r("span",{style:{color:"#E36209"}},"<REQUEST>"),r("span",{style:{color:"#6A737D"}},"    执行策略入参范型")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," <"),r("span",{style:{color:"#D73A49"}},"REQUEST"),r("span",{style:{color:"#24292E"}},"> "),r("span",{style:{color:"#D73A49"}},"void"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"chooseAndExecute"),r("span",{style:{color:"#24292E"}},"(String "),r("span",{style:{color:"#E36209"}},"mark"),r("span",{style:{color:"#24292E"}},", REQUEST "),r("span",{style:{color:"#E36209"}},"requestParam"),r("span",{style:{color:"#24292E"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        AbstractExecuteStrategy executeStrategy "),r("span",{style:{color:"#D73A49"}},"="),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"choose"),r("span",{style:{color:"#24292E"}},"(mark);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        executeStrategy."),r("span",{style:{color:"#6F42C1"}},"execute"),r("span",{style:{color:"#24292E"}},"(requestParam);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"    /**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * 根据 mark 查询具体策略并执行，带返回结果")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     *")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * "),r("span",{style:{color:"#D73A49"}},"@param"),r("span",{style:{color:"#6A737D"}}," "),r("span",{style:{color:"#E36209"}},"mark"),r("span",{style:{color:"#6A737D"}},"         策略标识")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * "),r("span",{style:{color:"#D73A49"}},"@param"),r("span",{style:{color:"#6A737D"}}," "),r("span",{style:{color:"#E36209"}},"requestParam"),r("span",{style:{color:"#6A737D"}}," 执行策略入参")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * "),r("span",{style:{color:"#D73A49"}},"@param"),r("span",{style:{color:"#6A737D"}}," "),r("span",{style:{color:"#E36209"}},"<REQUEST>"),r("span",{style:{color:"#6A737D"}},"    执行策略入参范型")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * "),r("span",{style:{color:"#D73A49"}},"@param"),r("span",{style:{color:"#6A737D"}}," "),r("span",{style:{color:"#E36209"}},"<RESPONSE>"),r("span",{style:{color:"#6A737D"}},"   执行策略出参范型")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * "),r("span",{style:{color:"#D73A49"}},"@return")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," <"),r("span",{style:{color:"#D73A49"}},"REQUEST"),r("span",{style:{color:"#24292E"}},", "),r("span",{style:{color:"#D73A49"}},"RESPONSE"),r("span",{style:{color:"#24292E"}},"> RESPONSE "),r("span",{style:{color:"#6F42C1"}},"chooseAndExecuteResp"),r("span",{style:{color:"#24292E"}},"(String "),r("span",{style:{color:"#E36209"}},"mark"),r("span",{style:{color:"#24292E"}},", REQUEST "),r("span",{style:{color:"#E36209"}},"requestParam"),r("span",{style:{color:"#24292E"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        AbstractExecuteStrategy executeStrategy "),r("span",{style:{color:"#D73A49"}},"="),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"choose"),r("span",{style:{color:"#24292E"}},"(mark);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        "),r("span",{style:{color:"#D73A49"}},"return"),r("span",{style:{color:"#24292E"}}," (RESPONSE) executeStrategy."),r("span",{style:{color:"#6F42C1"}},"executeResp"),r("span",{style:{color:"#24292E"}},"(requestParam);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    @"),r("span",{style:{color:"#D73A49"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"void"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"onApplicationEvent"),r("span",{style:{color:"#24292E"}},"(ApplicationInitializingEvent "),r("span",{style:{color:"#E36209"}},"event"),r("span",{style:{color:"#24292E"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        Map<"),r("span",{style:{color:"#D73A49"}},"String"),r("span",{style:{color:"#24292E"}},", "),r("span",{style:{color:"#D73A49"}},"AbstractExecuteStrategy"),r("span",{style:{color:"#24292E"}},"> actual "),r("span",{style:{color:"#D73A49"}},"="),r("span",{style:{color:"#24292E"}}," ApplicationContextHolder."),r("span",{style:{color:"#6F42C1"}},"getBeansOfType"),r("span",{style:{color:"#24292E"}},"(AbstractExecuteStrategy.class);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        actual."),r("span",{style:{color:"#6F42C1"}},"forEach"),r("span",{style:{color:"#24292E"}},"((beanName, bean) "),r("span",{style:{color:"#D73A49"}},"->"),r("span",{style:{color:"#24292E"}}," {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"            AbstractExecuteStrategy beanExist "),r("span",{style:{color:"#D73A49"}},"="),r("span",{style:{color:"#24292E"}}," abstractExecuteStrategyMap."),r("span",{style:{color:"#6F42C1"}},"get"),r("span",{style:{color:"#24292E"}},"(bean."),r("span",{style:{color:"#6F42C1"}},"mark"),r("span",{style:{color:"#24292E"}},"());")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"            "),r("span",{style:{color:"#D73A49"}},"if"),r("span",{style:{color:"#24292E"}}," (beanExist "),r("span",{style:{color:"#D73A49"}},"!="),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#005CC5"}},"null"),r("span",{style:{color:"#24292E"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"                "),r("span",{style:{color:"#D73A49"}},"throw"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"new"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"ServiceException"),r("span",{style:{color:"#24292E"}},"(String."),r("span",{style:{color:"#6F42C1"}},"format"),r("span",{style:{color:"#24292E"}},"("),r("span",{style:{color:"#032F62"}},'"[%s] Duplicate execution policy"'),r("span",{style:{color:"#24292E"}},", bean."),r("span",{style:{color:"#6F42C1"}},"mark"),r("span",{style:{color:"#24292E"}},"()));")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"            }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"            abstractExecuteStrategyMap."),r("span",{style:{color:"#6F42C1"}},"put"),r("span",{style:{color:"#24292E"}},"(bean."),r("span",{style:{color:"#6F42C1"}},"mark"),r("span",{style:{color:"#24292E"}},"(), bean);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        });")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"}")])])])],-1),vs=r("p",null,"这两个实现已经被放置在基础组件库中，如果业务需要使用策略模式，则无需重新定义。",-1),Bs={id:"策略模式实现",tabindex:"-1"},fs={id:"列车座位选择器",tabindex:"-1"},Rs={id:"购票时列车座位选择器",tabindex:"-1"},Ps=r("div",{class:"language-java"},[r("button",{title:"Copy Code",class:"copy"}),r("span",{class:"lang"},"java"),r("pre",{class:"shiki github-dark vp-code-dark"},[r("code",null,[r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"@"),r("span",{style:{color:"#F97583"}},"Slf4j")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"@"),r("span",{style:{color:"#F97583"}},"Component")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"@"),r("span",{style:{color:"#F97583"}},"RequiredArgsConstructor")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"final"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"class"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"TrainSeatTypeSelector"),r("span",{style:{color:"#E1E4E8"}}," {")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ......")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"private"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"final"),r("span",{style:{color:"#E1E4E8"}}," AbstractStrategyChoose abstractStrategyChoose;")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," List<"),r("span",{style:{color:"#F97583"}},"TrainPurchaseTicketRespDTO"),r("span",{style:{color:"#E1E4E8"}},"> "),r("span",{style:{color:"#B392F0"}},"select"),r("span",{style:{color:"#E1E4E8"}},"(Integer "),r("span",{style:{color:"#FFAB70"}},"trainType"),r("span",{style:{color:"#E1E4E8"}},", PurchaseTicketReqDTO "),r("span",{style:{color:"#FFAB70"}},"requestParam"),r("span",{style:{color:"#E1E4E8"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"       ......")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"            List<"),r("span",{style:{color:"#F97583"}},"TrainPurchaseTicketRespDTO"),r("span",{style:{color:"#E1E4E8"}},"> aggregationResult "),r("span",{style:{color:"#F97583"}},"="),r("span",{style:{color:"#E1E4E8"}}," abstractStrategyChoose."),r("span",{style:{color:"#B392F0"}},"chooseAndExecuteResp"),r("span",{style:{color:"#E1E4E8"}},"(buildStrategyKey, selectSeatDTO);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"\t   ......")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"}")])])]),r("pre",{class:"shiki github-light vp-code-light"},[r("code",null,[r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"@"),r("span",{style:{color:"#D73A49"}},"Slf4j")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"@"),r("span",{style:{color:"#D73A49"}},"Component")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"@"),r("span",{style:{color:"#D73A49"}},"RequiredArgsConstructor")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"final"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"class"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"TrainSeatTypeSelector"),r("span",{style:{color:"#24292E"}}," {")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ......")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"private"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"final"),r("span",{style:{color:"#24292E"}}," AbstractStrategyChoose abstractStrategyChoose;")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," List<"),r("span",{style:{color:"#D73A49"}},"TrainPurchaseTicketRespDTO"),r("span",{style:{color:"#24292E"}},"> "),r("span",{style:{color:"#6F42C1"}},"select"),r("span",{style:{color:"#24292E"}},"(Integer "),r("span",{style:{color:"#E36209"}},"trainType"),r("span",{style:{color:"#24292E"}},", PurchaseTicketReqDTO "),r("span",{style:{color:"#E36209"}},"requestParam"),r("span",{style:{color:"#24292E"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"       ......")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"            List<"),r("span",{style:{color:"#D73A49"}},"TrainPurchaseTicketRespDTO"),r("span",{style:{color:"#24292E"}},"> aggregationResult "),r("span",{style:{color:"#D73A49"}},"="),r("span",{style:{color:"#24292E"}}," abstractStrategyChoose."),r("span",{style:{color:"#6F42C1"}},"chooseAndExecuteResp"),r("span",{style:{color:"#24292E"}},"(buildStrategyKey, selectSeatDTO);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"\t   ......")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"}")])])])],-1),ks={id:"抽象高铁购票模板基础服务",tabindex:"-1"},Us=r("div",{class:"language-java"},[r("button",{title:"Copy Code",class:"copy"}),r("span",{class:"lang"},"java"),r("pre",{class:"shiki github-dark vp-code-dark"},[r("code",null,[r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"@"),r("span",{style:{color:"#F97583"}},"FunctionalInterface")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"interface"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"CommandLineRunner"),r("span",{style:{color:"#E1E4E8"}}," {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"void"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"run"),r("span",{style:{color:"#E1E4E8"}},"(String... "),r("span",{style:{color:"#FFAB70"}},"args"),r("span",{style:{color:"#E1E4E8"}},") "),r("span",{style:{color:"#F97583"}},"throws"),r("span",{style:{color:"#E1E4E8"}}," Exception;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"}")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"/**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}}," * 购票顶级抽象接口，为后续火车、高铁、汽车、飞机等出行工具规定行为约束")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}}," */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"interface"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"IPurchaseTicket"),r("span",{style:{color:"#E1E4E8"}}," {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"}")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"abstract"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"class"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"AbstractTrainPurchaseTicketTemplate"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"implements"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"IPurchaseTicket"),r("span",{style:{color:"#E1E4E8"}},", "),r("span",{style:{color:"#B392F0"}},"CommandLineRunner"),r("span",{style:{color:"#E1E4E8"}},", "),r("span",{style:{color:"#B392F0"}},"AbstractExecuteStrategy"),r("span",{style:{color:"#E1E4E8"}},"<"),r("span",{style:{color:"#F97583"}},"SelectSeatDTO"),r("span",{style:{color:"#E1E4E8"}},", List<"),r("span",{style:{color:"#F97583"}},"TrainPurchaseTicketRespDTO"),r("span",{style:{color:"#E1E4E8"}},">> {")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"private"),r("span",{style:{color:"#E1E4E8"}}," DistributedCache distributedCache;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"private"),r("span",{style:{color:"#E1E4E8"}}," String ticketAvailabilityCacheUpdateType;")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"    /**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * 选择座位")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     *")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * "),r("span",{style:{color:"#F97583"}},"@param"),r("span",{style:{color:"#6A737D"}}," "),r("span",{style:{color:"#FFAB70"}},"requestParam"),r("span",{style:{color:"#6A737D"}}," 购票请求入参")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * "),r("span",{style:{color:"#F97583"}},"@return"),r("span",{style:{color:"#6A737D"}}," 乘车人座位")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"protected"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"abstract"),r("span",{style:{color:"#E1E4E8"}}," List<"),r("span",{style:{color:"#F97583"}},"TrainPurchaseTicketRespDTO"),r("span",{style:{color:"#E1E4E8"}},"> "),r("span",{style:{color:"#B392F0"}},"selectSeats"),r("span",{style:{color:"#E1E4E8"}},"(SelectSeatDTO "),r("span",{style:{color:"#FFAB70"}},"requestParam"),r("span",{style:{color:"#E1E4E8"}},");")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"protected"),r("span",{style:{color:"#E1E4E8"}}," TrainSeatBaseDTO "),r("span",{style:{color:"#B392F0"}},"buildTrainSeatBaseDTO"),r("span",{style:{color:"#E1E4E8"}},"(SelectSeatDTO "),r("span",{style:{color:"#FFAB70"}},"requestParam"),r("span",{style:{color:"#E1E4E8"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        "),r("span",{style:{color:"#F97583"}},"return"),r("span",{style:{color:"#E1E4E8"}}," TrainSeatBaseDTO."),r("span",{style:{color:"#B392F0"}},"builder"),r("span",{style:{color:"#E1E4E8"}},"()")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"                ."),r("span",{style:{color:"#B392F0"}},"trainId"),r("span",{style:{color:"#E1E4E8"}},"(requestParam."),r("span",{style:{color:"#B392F0"}},"getRequestParam"),r("span",{style:{color:"#E1E4E8"}},"()."),r("span",{style:{color:"#B392F0"}},"getTrainId"),r("span",{style:{color:"#E1E4E8"}},"())")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"                ."),r("span",{style:{color:"#B392F0"}},"departure"),r("span",{style:{color:"#E1E4E8"}},"(requestParam."),r("span",{style:{color:"#B392F0"}},"getRequestParam"),r("span",{style:{color:"#E1E4E8"}},"()."),r("span",{style:{color:"#B392F0"}},"getDeparture"),r("span",{style:{color:"#E1E4E8"}},"())")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"                ."),r("span",{style:{color:"#B392F0"}},"arrival"),r("span",{style:{color:"#E1E4E8"}},"(requestParam."),r("span",{style:{color:"#B392F0"}},"getRequestParam"),r("span",{style:{color:"#E1E4E8"}},"()."),r("span",{style:{color:"#B392F0"}},"getArrival"),r("span",{style:{color:"#E1E4E8"}},"())")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"                ."),r("span",{style:{color:"#B392F0"}},"chooseSeatList"),r("span",{style:{color:"#E1E4E8"}},"(requestParam."),r("span",{style:{color:"#B392F0"}},"getRequestParam"),r("span",{style:{color:"#E1E4E8"}},"()."),r("span",{style:{color:"#B392F0"}},"getChooseSeats"),r("span",{style:{color:"#E1E4E8"}},"())")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"                ."),r("span",{style:{color:"#B392F0"}},"passengerSeatDetails"),r("span",{style:{color:"#E1E4E8"}},"(requestParam."),r("span",{style:{color:"#B392F0"}},"getPassengerSeatDetails"),r("span",{style:{color:"#E1E4E8"}},"())")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"                ."),r("span",{style:{color:"#B392F0"}},"build"),r("span",{style:{color:"#E1E4E8"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    }")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    @"),r("span",{style:{color:"#F97583"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," List<"),r("span",{style:{color:"#F97583"}},"TrainPurchaseTicketRespDTO"),r("span",{style:{color:"#E1E4E8"}},"> "),r("span",{style:{color:"#B392F0"}},"executeResp"),r("span",{style:{color:"#E1E4E8"}},"(SelectSeatDTO "),r("span",{style:{color:"#FFAB70"}},"requestParam"),r("span",{style:{color:"#E1E4E8"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        List<"),r("span",{style:{color:"#F97583"}},"TrainPurchaseTicketRespDTO"),r("span",{style:{color:"#E1E4E8"}},"> actualResult "),r("span",{style:{color:"#F97583"}},"="),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"selectSeats"),r("span",{style:{color:"#E1E4E8"}},"(requestParam);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        "),r("span",{style:{color:"#6A737D"}},"// 扣减车厢余票缓存，扣减站点余票缓存")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        "),r("span",{style:{color:"#F97583"}},"if"),r("span",{style:{color:"#E1E4E8"}}," (CollUtil."),r("span",{style:{color:"#B392F0"}},"isNotEmpty"),r("span",{style:{color:"#E1E4E8"}},"(actualResult) "),r("span",{style:{color:"#F97583"}},"&&"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"!"),r("span",{style:{color:"#E1E4E8"}},"StrUtil."),r("span",{style:{color:"#B392F0"}},"equals"),r("span",{style:{color:"#E1E4E8"}},"(ticketAvailabilityCacheUpdateType, "),r("span",{style:{color:"#9ECBFF"}},'"binlog"'),r("span",{style:{color:"#E1E4E8"}},")) {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"            String trainId "),r("span",{style:{color:"#F97583"}},"="),r("span",{style:{color:"#E1E4E8"}}," requestParam."),r("span",{style:{color:"#B392F0"}},"getRequestParam"),r("span",{style:{color:"#E1E4E8"}},"()."),r("span",{style:{color:"#B392F0"}},"getTrainId"),r("span",{style:{color:"#E1E4E8"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"            String departure "),r("span",{style:{color:"#F97583"}},"="),r("span",{style:{color:"#E1E4E8"}}," requestParam."),r("span",{style:{color:"#B392F0"}},"getRequestParam"),r("span",{style:{color:"#E1E4E8"}},"()."),r("span",{style:{color:"#B392F0"}},"getDeparture"),r("span",{style:{color:"#E1E4E8"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"            String arrival "),r("span",{style:{color:"#F97583"}},"="),r("span",{style:{color:"#E1E4E8"}}," requestParam."),r("span",{style:{color:"#B392F0"}},"getRequestParam"),r("span",{style:{color:"#E1E4E8"}},"()."),r("span",{style:{color:"#B392F0"}},"getArrival"),r("span",{style:{color:"#E1E4E8"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"            String keySuffix "),r("span",{style:{color:"#F97583"}},"="),r("span",{style:{color:"#E1E4E8"}}," StrUtil."),r("span",{style:{color:"#B392F0"}},"join"),r("span",{style:{color:"#E1E4E8"}},"("),r("span",{style:{color:"#9ECBFF"}},'"_"'),r("span",{style:{color:"#E1E4E8"}},", trainId, departure, arrival);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"            StringRedisTemplate stringRedisTemplate "),r("span",{style:{color:"#F97583"}},"="),r("span",{style:{color:"#E1E4E8"}}," (StringRedisTemplate) distributedCache."),r("span",{style:{color:"#B392F0"}},"getInstance"),r("span",{style:{color:"#E1E4E8"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"            stringRedisTemplate."),r("span",{style:{color:"#B392F0"}},"opsForHash"),r("span",{style:{color:"#E1E4E8"}},"()."),r("span",{style:{color:"#B392F0"}},"increment"),r("span",{style:{color:"#E1E4E8"}},"(TRAIN_STATION_REMAINING_TICKET "),r("span",{style:{color:"#F97583"}},"+"),r("span",{style:{color:"#E1E4E8"}}," keySuffix, String."),r("span",{style:{color:"#B392F0"}},"valueOf"),r("span",{style:{color:"#E1E4E8"}},"(requestParam."),r("span",{style:{color:"#B392F0"}},"getSeatType"),r("span",{style:{color:"#E1E4E8"}},"()), "),r("span",{style:{color:"#F97583"}},"-"),r("span",{style:{color:"#E1E4E8"}},"actualResult."),r("span",{style:{color:"#B392F0"}},"size"),r("span",{style:{color:"#E1E4E8"}},"());")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        "),r("span",{style:{color:"#F97583"}},"return"),r("span",{style:{color:"#E1E4E8"}}," actualResult;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    }")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    @"),r("span",{style:{color:"#F97583"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"void"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"run"),r("span",{style:{color:"#E1E4E8"}},"(String... "),r("span",{style:{color:"#FFAB70"}},"args"),r("span",{style:{color:"#E1E4E8"}},") "),r("span",{style:{color:"#F97583"}},"throws"),r("span",{style:{color:"#E1E4E8"}}," Exception {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        distributedCache "),r("span",{style:{color:"#F97583"}},"="),r("span",{style:{color:"#E1E4E8"}}," ApplicationContextHolder."),r("span",{style:{color:"#B392F0"}},"getBean"),r("span",{style:{color:"#E1E4E8"}},"(DistributedCache.class);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        ConfigurableEnvironment configurableEnvironment "),r("span",{style:{color:"#F97583"}},"="),r("span",{style:{color:"#E1E4E8"}}," ApplicationContextHolder."),r("span",{style:{color:"#B392F0"}},"getBean"),r("span",{style:{color:"#E1E4E8"}},"(ConfigurableEnvironment.class);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        ticketAvailabilityCacheUpdateType "),r("span",{style:{color:"#F97583"}},"="),r("span",{style:{color:"#E1E4E8"}}," configurableEnvironment."),r("span",{style:{color:"#B392F0"}},"getProperty"),r("span",{style:{color:"#E1E4E8"}},"("),r("span",{style:{color:"#9ECBFF"}},'"ticket.availability.cache-update.type"'),r("span",{style:{color:"#E1E4E8"}},", "),r("span",{style:{color:"#9ECBFF"}},'""'),r("span",{style:{color:"#E1E4E8"}},");")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"}")])])]),r("pre",{class:"shiki github-light vp-code-light"},[r("code",null,[r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"@"),r("span",{style:{color:"#D73A49"}},"FunctionalInterface")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"interface"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"CommandLineRunner"),r("span",{style:{color:"#24292E"}}," {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"void"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"run"),r("span",{style:{color:"#24292E"}},"(String... "),r("span",{style:{color:"#E36209"}},"args"),r("span",{style:{color:"#24292E"}},") "),r("span",{style:{color:"#D73A49"}},"throws"),r("span",{style:{color:"#24292E"}}," Exception;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"}")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"/**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}}," * 购票顶级抽象接口，为后续火车、高铁、汽车、飞机等出行工具规定行为约束")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}}," */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"interface"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"IPurchaseTicket"),r("span",{style:{color:"#24292E"}}," {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"}")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"abstract"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"class"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"AbstractTrainPurchaseTicketTemplate"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"implements"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"IPurchaseTicket"),r("span",{style:{color:"#24292E"}},", "),r("span",{style:{color:"#6F42C1"}},"CommandLineRunner"),r("span",{style:{color:"#24292E"}},", "),r("span",{style:{color:"#6F42C1"}},"AbstractExecuteStrategy"),r("span",{style:{color:"#24292E"}},"<"),r("span",{style:{color:"#D73A49"}},"SelectSeatDTO"),r("span",{style:{color:"#24292E"}},", List<"),r("span",{style:{color:"#D73A49"}},"TrainPurchaseTicketRespDTO"),r("span",{style:{color:"#24292E"}},">> {")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"private"),r("span",{style:{color:"#24292E"}}," DistributedCache distributedCache;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"private"),r("span",{style:{color:"#24292E"}}," String ticketAvailabilityCacheUpdateType;")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"    /**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * 选择座位")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     *")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * "),r("span",{style:{color:"#D73A49"}},"@param"),r("span",{style:{color:"#6A737D"}}," "),r("span",{style:{color:"#E36209"}},"requestParam"),r("span",{style:{color:"#6A737D"}}," 购票请求入参")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * "),r("span",{style:{color:"#D73A49"}},"@return"),r("span",{style:{color:"#6A737D"}}," 乘车人座位")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"protected"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"abstract"),r("span",{style:{color:"#24292E"}}," List<"),r("span",{style:{color:"#D73A49"}},"TrainPurchaseTicketRespDTO"),r("span",{style:{color:"#24292E"}},"> "),r("span",{style:{color:"#6F42C1"}},"selectSeats"),r("span",{style:{color:"#24292E"}},"(SelectSeatDTO "),r("span",{style:{color:"#E36209"}},"requestParam"),r("span",{style:{color:"#24292E"}},");")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"protected"),r("span",{style:{color:"#24292E"}}," TrainSeatBaseDTO "),r("span",{style:{color:"#6F42C1"}},"buildTrainSeatBaseDTO"),r("span",{style:{color:"#24292E"}},"(SelectSeatDTO "),r("span",{style:{color:"#E36209"}},"requestParam"),r("span",{style:{color:"#24292E"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        "),r("span",{style:{color:"#D73A49"}},"return"),r("span",{style:{color:"#24292E"}}," TrainSeatBaseDTO."),r("span",{style:{color:"#6F42C1"}},"builder"),r("span",{style:{color:"#24292E"}},"()")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"                ."),r("span",{style:{color:"#6F42C1"}},"trainId"),r("span",{style:{color:"#24292E"}},"(requestParam."),r("span",{style:{color:"#6F42C1"}},"getRequestParam"),r("span",{style:{color:"#24292E"}},"()."),r("span",{style:{color:"#6F42C1"}},"getTrainId"),r("span",{style:{color:"#24292E"}},"())")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"                ."),r("span",{style:{color:"#6F42C1"}},"departure"),r("span",{style:{color:"#24292E"}},"(requestParam."),r("span",{style:{color:"#6F42C1"}},"getRequestParam"),r("span",{style:{color:"#24292E"}},"()."),r("span",{style:{color:"#6F42C1"}},"getDeparture"),r("span",{style:{color:"#24292E"}},"())")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"                ."),r("span",{style:{color:"#6F42C1"}},"arrival"),r("span",{style:{color:"#24292E"}},"(requestParam."),r("span",{style:{color:"#6F42C1"}},"getRequestParam"),r("span",{style:{color:"#24292E"}},"()."),r("span",{style:{color:"#6F42C1"}},"getArrival"),r("span",{style:{color:"#24292E"}},"())")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"                ."),r("span",{style:{color:"#6F42C1"}},"chooseSeatList"),r("span",{style:{color:"#24292E"}},"(requestParam."),r("span",{style:{color:"#6F42C1"}},"getRequestParam"),r("span",{style:{color:"#24292E"}},"()."),r("span",{style:{color:"#6F42C1"}},"getChooseSeats"),r("span",{style:{color:"#24292E"}},"())")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"                ."),r("span",{style:{color:"#6F42C1"}},"passengerSeatDetails"),r("span",{style:{color:"#24292E"}},"(requestParam."),r("span",{style:{color:"#6F42C1"}},"getPassengerSeatDetails"),r("span",{style:{color:"#24292E"}},"())")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"                ."),r("span",{style:{color:"#6F42C1"}},"build"),r("span",{style:{color:"#24292E"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    }")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    @"),r("span",{style:{color:"#D73A49"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," List<"),r("span",{style:{color:"#D73A49"}},"TrainPurchaseTicketRespDTO"),r("span",{style:{color:"#24292E"}},"> "),r("span",{style:{color:"#6F42C1"}},"executeResp"),r("span",{style:{color:"#24292E"}},"(SelectSeatDTO "),r("span",{style:{color:"#E36209"}},"requestParam"),r("span",{style:{color:"#24292E"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        List<"),r("span",{style:{color:"#D73A49"}},"TrainPurchaseTicketRespDTO"),r("span",{style:{color:"#24292E"}},"> actualResult "),r("span",{style:{color:"#D73A49"}},"="),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"selectSeats"),r("span",{style:{color:"#24292E"}},"(requestParam);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        "),r("span",{style:{color:"#6A737D"}},"// 扣减车厢余票缓存，扣减站点余票缓存")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        "),r("span",{style:{color:"#D73A49"}},"if"),r("span",{style:{color:"#24292E"}}," (CollUtil."),r("span",{style:{color:"#6F42C1"}},"isNotEmpty"),r("span",{style:{color:"#24292E"}},"(actualResult) "),r("span",{style:{color:"#D73A49"}},"&&"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"!"),r("span",{style:{color:"#24292E"}},"StrUtil."),r("span",{style:{color:"#6F42C1"}},"equals"),r("span",{style:{color:"#24292E"}},"(ticketAvailabilityCacheUpdateType, "),r("span",{style:{color:"#032F62"}},'"binlog"'),r("span",{style:{color:"#24292E"}},")) {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"            String trainId "),r("span",{style:{color:"#D73A49"}},"="),r("span",{style:{color:"#24292E"}}," requestParam."),r("span",{style:{color:"#6F42C1"}},"getRequestParam"),r("span",{style:{color:"#24292E"}},"()."),r("span",{style:{color:"#6F42C1"}},"getTrainId"),r("span",{style:{color:"#24292E"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"            String departure "),r("span",{style:{color:"#D73A49"}},"="),r("span",{style:{color:"#24292E"}}," requestParam."),r("span",{style:{color:"#6F42C1"}},"getRequestParam"),r("span",{style:{color:"#24292E"}},"()."),r("span",{style:{color:"#6F42C1"}},"getDeparture"),r("span",{style:{color:"#24292E"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"            String arrival "),r("span",{style:{color:"#D73A49"}},"="),r("span",{style:{color:"#24292E"}}," requestParam."),r("span",{style:{color:"#6F42C1"}},"getRequestParam"),r("span",{style:{color:"#24292E"}},"()."),r("span",{style:{color:"#6F42C1"}},"getArrival"),r("span",{style:{color:"#24292E"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"            String keySuffix "),r("span",{style:{color:"#D73A49"}},"="),r("span",{style:{color:"#24292E"}}," StrUtil."),r("span",{style:{color:"#6F42C1"}},"join"),r("span",{style:{color:"#24292E"}},"("),r("span",{style:{color:"#032F62"}},'"_"'),r("span",{style:{color:"#24292E"}},", trainId, departure, arrival);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"            StringRedisTemplate stringRedisTemplate "),r("span",{style:{color:"#D73A49"}},"="),r("span",{style:{color:"#24292E"}}," (StringRedisTemplate) distributedCache."),r("span",{style:{color:"#6F42C1"}},"getInstance"),r("span",{style:{color:"#24292E"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"            stringRedisTemplate."),r("span",{style:{color:"#6F42C1"}},"opsForHash"),r("span",{style:{color:"#24292E"}},"()."),r("span",{style:{color:"#6F42C1"}},"increment"),r("span",{style:{color:"#24292E"}},"(TRAIN_STATION_REMAINING_TICKET "),r("span",{style:{color:"#D73A49"}},"+"),r("span",{style:{color:"#24292E"}}," keySuffix, String."),r("span",{style:{color:"#6F42C1"}},"valueOf"),r("span",{style:{color:"#24292E"}},"(requestParam."),r("span",{style:{color:"#6F42C1"}},"getSeatType"),r("span",{style:{color:"#24292E"}},"()), "),r("span",{style:{color:"#D73A49"}},"-"),r("span",{style:{color:"#24292E"}},"actualResult."),r("span",{style:{color:"#6F42C1"}},"size"),r("span",{style:{color:"#24292E"}},"());")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        "),r("span",{style:{color:"#D73A49"}},"return"),r("span",{style:{color:"#24292E"}}," actualResult;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    }")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    @"),r("span",{style:{color:"#D73A49"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"void"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"run"),r("span",{style:{color:"#24292E"}},"(String... "),r("span",{style:{color:"#E36209"}},"args"),r("span",{style:{color:"#24292E"}},") "),r("span",{style:{color:"#D73A49"}},"throws"),r("span",{style:{color:"#24292E"}}," Exception {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        distributedCache "),r("span",{style:{color:"#D73A49"}},"="),r("span",{style:{color:"#24292E"}}," ApplicationContextHolder."),r("span",{style:{color:"#6F42C1"}},"getBean"),r("span",{style:{color:"#24292E"}},"(DistributedCache.class);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        ConfigurableEnvironment configurableEnvironment "),r("span",{style:{color:"#D73A49"}},"="),r("span",{style:{color:"#24292E"}}," ApplicationContextHolder."),r("span",{style:{color:"#6F42C1"}},"getBean"),r("span",{style:{color:"#24292E"}},"(ConfigurableEnvironment.class);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        ticketAvailabilityCacheUpdateType "),r("span",{style:{color:"#D73A49"}},"="),r("span",{style:{color:"#24292E"}}," configurableEnvironment."),r("span",{style:{color:"#6F42C1"}},"getProperty"),r("span",{style:{color:"#24292E"}},"("),r("span",{style:{color:"#032F62"}},'"ticket.availability.cache-update.type"'),r("span",{style:{color:"#24292E"}},", "),r("span",{style:{color:"#032F62"}},'""'),r("span",{style:{color:"#24292E"}},");")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"}")])])])],-1),Os={id:"高铁各座位类型购票组件",tabindex:"-1"},qs=r("div",{class:"language-java"},[r("button",{title:"Copy Code",class:"copy"}),r("span",{class:"lang"},"java"),r("pre",{class:"shiki github-dark vp-code-dark"},[r("code",null,[r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"/**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}}," * 高铁商务座购票组件")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}}," */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"@"),r("span",{style:{color:"#F97583"}},"Component")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"@"),r("span",{style:{color:"#F97583"}},"RequiredArgsConstructor")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"class"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"TrainBusinessClassPurchaseTicketHandler"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"extends"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"AbstractTrainPurchaseTicketTemplate"),r("span",{style:{color:"#E1E4E8"}}," {")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"private"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"final"),r("span",{style:{color:"#E1E4E8"}}," SeatService seatService;")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"private"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"static"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"final"),r("span",{style:{color:"#E1E4E8"}}," Map<"),r("span",{style:{color:"#F97583"}},"Character"),r("span",{style:{color:"#E1E4E8"}},", "),r("span",{style:{color:"#F97583"}},"Integer"),r("span",{style:{color:"#E1E4E8"}},"> SEAT_Y_INT "),r("span",{style:{color:"#F97583"}},"="),r("span",{style:{color:"#E1E4E8"}}," Map."),r("span",{style:{color:"#B392F0"}},"of"),r("span",{style:{color:"#E1E4E8"}},"("),r("span",{style:{color:"#9ECBFF"}},"'A'"),r("span",{style:{color:"#E1E4E8"}},", "),r("span",{style:{color:"#79B8FF"}},"0"),r("span",{style:{color:"#E1E4E8"}},", "),r("span",{style:{color:"#9ECBFF"}},"'C'"),r("span",{style:{color:"#E1E4E8"}},", "),r("span",{style:{color:"#79B8FF"}},"1"),r("span",{style:{color:"#E1E4E8"}},", "),r("span",{style:{color:"#9ECBFF"}},"'F'"),r("span",{style:{color:"#E1E4E8"}},", "),r("span",{style:{color:"#79B8FF"}},"2"),r("span",{style:{color:"#E1E4E8"}},");")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    @"),r("span",{style:{color:"#F97583"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," String "),r("span",{style:{color:"#B392F0"}},"mark"),r("span",{style:{color:"#E1E4E8"}},"() {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        "),r("span",{style:{color:"#F97583"}},"return"),r("span",{style:{color:"#E1E4E8"}}," VehicleTypeEnum.HIGH_SPEED_RAIN."),r("span",{style:{color:"#B392F0"}},"getName"),r("span",{style:{color:"#E1E4E8"}},"() "),r("span",{style:{color:"#F97583"}},"+"),r("span",{style:{color:"#E1E4E8"}}," VehicleSeatTypeEnum.BUSINESS_CLASS."),r("span",{style:{color:"#B392F0"}},"getName"),r("span",{style:{color:"#E1E4E8"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    }")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    @"),r("span",{style:{color:"#F97583"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"protected"),r("span",{style:{color:"#E1E4E8"}}," List<"),r("span",{style:{color:"#F97583"}},"TrainPurchaseTicketRespDTO"),r("span",{style:{color:"#E1E4E8"}},"> "),r("span",{style:{color:"#B392F0"}},"selectSeats"),r("span",{style:{color:"#E1E4E8"}},"(SelectSeatDTO "),r("span",{style:{color:"#FFAB70"}},"requestParam"),r("span",{style:{color:"#E1E4E8"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        ......")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"\t......")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"}")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"/**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}}," * 高铁一等座购票组件")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}}," */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"@"),r("span",{style:{color:"#F97583"}},"Component")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"@"),r("span",{style:{color:"#F97583"}},"RequiredArgsConstructor")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"class"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"TrainFirstClassPurchaseTicketHandler"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"extends"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"AbstractTrainPurchaseTicketTemplate"),r("span",{style:{color:"#E1E4E8"}}," {")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"private"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"final"),r("span",{style:{color:"#E1E4E8"}}," SeatService seatService;")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"private"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"static"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"final"),r("span",{style:{color:"#E1E4E8"}}," Map<"),r("span",{style:{color:"#F97583"}},"Character"),r("span",{style:{color:"#E1E4E8"}},", "),r("span",{style:{color:"#F97583"}},"Integer"),r("span",{style:{color:"#E1E4E8"}},"> SEAT_Y_INT "),r("span",{style:{color:"#F97583"}},"="),r("span",{style:{color:"#E1E4E8"}}," Map."),r("span",{style:{color:"#B392F0"}},"of"),r("span",{style:{color:"#E1E4E8"}},"("),r("span",{style:{color:"#9ECBFF"}},"'A'"),r("span",{style:{color:"#E1E4E8"}},", "),r("span",{style:{color:"#79B8FF"}},"0"),r("span",{style:{color:"#E1E4E8"}},", "),r("span",{style:{color:"#9ECBFF"}},"'C'"),r("span",{style:{color:"#E1E4E8"}},", "),r("span",{style:{color:"#79B8FF"}},"1"),r("span",{style:{color:"#E1E4E8"}},", "),r("span",{style:{color:"#9ECBFF"}},"'D'"),r("span",{style:{color:"#E1E4E8"}},", "),r("span",{style:{color:"#79B8FF"}},"2"),r("span",{style:{color:"#E1E4E8"}},", "),r("span",{style:{color:"#9ECBFF"}},"'F'"),r("span",{style:{color:"#E1E4E8"}},", "),r("span",{style:{color:"#79B8FF"}},"3"),r("span",{style:{color:"#E1E4E8"}},");")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    @"),r("span",{style:{color:"#F97583"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," String "),r("span",{style:{color:"#B392F0"}},"mark"),r("span",{style:{color:"#E1E4E8"}},"() {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        "),r("span",{style:{color:"#F97583"}},"return"),r("span",{style:{color:"#E1E4E8"}}," VehicleTypeEnum.HIGH_SPEED_RAIN."),r("span",{style:{color:"#B392F0"}},"getName"),r("span",{style:{color:"#E1E4E8"}},"() "),r("span",{style:{color:"#F97583"}},"+"),r("span",{style:{color:"#E1E4E8"}}," VehicleSeatTypeEnum.FIRST_CLASS."),r("span",{style:{color:"#B392F0"}},"getName"),r("span",{style:{color:"#E1E4E8"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    }")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    @"),r("span",{style:{color:"#F97583"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"protected"),r("span",{style:{color:"#E1E4E8"}}," List<"),r("span",{style:{color:"#F97583"}},"TrainPurchaseTicketRespDTO"),r("span",{style:{color:"#E1E4E8"}},"> "),r("span",{style:{color:"#B392F0"}},"selectSeats"),r("span",{style:{color:"#E1E4E8"}},"(SelectSeatDTO "),r("span",{style:{color:"#FFAB70"}},"requestParam"),r("span",{style:{color:"#E1E4E8"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"         ......")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"\t......")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"}")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"/**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}}," * 高铁二等座购票组件")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}}," */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"@"),r("span",{style:{color:"#F97583"}},"Component")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"@"),r("span",{style:{color:"#F97583"}},"RequiredArgsConstructor")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"class"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"TrainSecondClassPurchaseTicketHandler"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"extends"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"AbstractTrainPurchaseTicketTemplate"),r("span",{style:{color:"#E1E4E8"}}," {")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"private"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"final"),r("span",{style:{color:"#E1E4E8"}}," SeatService seatService;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"private"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"final"),r("span",{style:{color:"#E1E4E8"}}," DistributedCache distributedCache;")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    @"),r("span",{style:{color:"#F97583"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," String "),r("span",{style:{color:"#B392F0"}},"mark"),r("span",{style:{color:"#E1E4E8"}},"() {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        "),r("span",{style:{color:"#F97583"}},"return"),r("span",{style:{color:"#E1E4E8"}}," VehicleTypeEnum.HIGH_SPEED_RAIN."),r("span",{style:{color:"#B392F0"}},"getName"),r("span",{style:{color:"#E1E4E8"}},"() "),r("span",{style:{color:"#F97583"}},"+"),r("span",{style:{color:"#E1E4E8"}}," VehicleSeatTypeEnum.SECOND_CLASS."),r("span",{style:{color:"#B392F0"}},"getName"),r("span",{style:{color:"#E1E4E8"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    }")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    @"),r("span",{style:{color:"#F97583"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"protected"),r("span",{style:{color:"#E1E4E8"}}," List<"),r("span",{style:{color:"#F97583"}},"TrainPurchaseTicketRespDTO"),r("span",{style:{color:"#E1E4E8"}},"> "),r("span",{style:{color:"#B392F0"}},"selectSeats"),r("span",{style:{color:"#E1E4E8"}},"(SelectSeatDTO "),r("span",{style:{color:"#FFAB70"}},"requestParam"),r("span",{style:{color:"#E1E4E8"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"          ......")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"\t......")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"}")])])]),r("pre",{class:"shiki github-light vp-code-light"},[r("code",null,[r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"/**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}}," * 高铁商务座购票组件")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}}," */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"@"),r("span",{style:{color:"#D73A49"}},"Component")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"@"),r("span",{style:{color:"#D73A49"}},"RequiredArgsConstructor")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"class"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"TrainBusinessClassPurchaseTicketHandler"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"extends"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"AbstractTrainPurchaseTicketTemplate"),r("span",{style:{color:"#24292E"}}," {")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"private"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"final"),r("span",{style:{color:"#24292E"}}," SeatService seatService;")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"private"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"static"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"final"),r("span",{style:{color:"#24292E"}}," Map<"),r("span",{style:{color:"#D73A49"}},"Character"),r("span",{style:{color:"#24292E"}},", "),r("span",{style:{color:"#D73A49"}},"Integer"),r("span",{style:{color:"#24292E"}},"> SEAT_Y_INT "),r("span",{style:{color:"#D73A49"}},"="),r("span",{style:{color:"#24292E"}}," Map."),r("span",{style:{color:"#6F42C1"}},"of"),r("span",{style:{color:"#24292E"}},"("),r("span",{style:{color:"#032F62"}},"'A'"),r("span",{style:{color:"#24292E"}},", "),r("span",{style:{color:"#005CC5"}},"0"),r("span",{style:{color:"#24292E"}},", "),r("span",{style:{color:"#032F62"}},"'C'"),r("span",{style:{color:"#24292E"}},", "),r("span",{style:{color:"#005CC5"}},"1"),r("span",{style:{color:"#24292E"}},", "),r("span",{style:{color:"#032F62"}},"'F'"),r("span",{style:{color:"#24292E"}},", "),r("span",{style:{color:"#005CC5"}},"2"),r("span",{style:{color:"#24292E"}},");")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    @"),r("span",{style:{color:"#D73A49"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," String "),r("span",{style:{color:"#6F42C1"}},"mark"),r("span",{style:{color:"#24292E"}},"() {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        "),r("span",{style:{color:"#D73A49"}},"return"),r("span",{style:{color:"#24292E"}}," VehicleTypeEnum.HIGH_SPEED_RAIN."),r("span",{style:{color:"#6F42C1"}},"getName"),r("span",{style:{color:"#24292E"}},"() "),r("span",{style:{color:"#D73A49"}},"+"),r("span",{style:{color:"#24292E"}}," VehicleSeatTypeEnum.BUSINESS_CLASS."),r("span",{style:{color:"#6F42C1"}},"getName"),r("span",{style:{color:"#24292E"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    }")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    @"),r("span",{style:{color:"#D73A49"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"protected"),r("span",{style:{color:"#24292E"}}," List<"),r("span",{style:{color:"#D73A49"}},"TrainPurchaseTicketRespDTO"),r("span",{style:{color:"#24292E"}},"> "),r("span",{style:{color:"#6F42C1"}},"selectSeats"),r("span",{style:{color:"#24292E"}},"(SelectSeatDTO "),r("span",{style:{color:"#E36209"}},"requestParam"),r("span",{style:{color:"#24292E"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        ......")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"\t......")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"}")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"/**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}}," * 高铁一等座购票组件")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}}," */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"@"),r("span",{style:{color:"#D73A49"}},"Component")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"@"),r("span",{style:{color:"#D73A49"}},"RequiredArgsConstructor")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"class"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"TrainFirstClassPurchaseTicketHandler"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"extends"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"AbstractTrainPurchaseTicketTemplate"),r("span",{style:{color:"#24292E"}}," {")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"private"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"final"),r("span",{style:{color:"#24292E"}}," SeatService seatService;")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"private"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"static"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"final"),r("span",{style:{color:"#24292E"}}," Map<"),r("span",{style:{color:"#D73A49"}},"Character"),r("span",{style:{color:"#24292E"}},", "),r("span",{style:{color:"#D73A49"}},"Integer"),r("span",{style:{color:"#24292E"}},"> SEAT_Y_INT "),r("span",{style:{color:"#D73A49"}},"="),r("span",{style:{color:"#24292E"}}," Map."),r("span",{style:{color:"#6F42C1"}},"of"),r("span",{style:{color:"#24292E"}},"("),r("span",{style:{color:"#032F62"}},"'A'"),r("span",{style:{color:"#24292E"}},", "),r("span",{style:{color:"#005CC5"}},"0"),r("span",{style:{color:"#24292E"}},", "),r("span",{style:{color:"#032F62"}},"'C'"),r("span",{style:{color:"#24292E"}},", "),r("span",{style:{color:"#005CC5"}},"1"),r("span",{style:{color:"#24292E"}},", "),r("span",{style:{color:"#032F62"}},"'D'"),r("span",{style:{color:"#24292E"}},", "),r("span",{style:{color:"#005CC5"}},"2"),r("span",{style:{color:"#24292E"}},", "),r("span",{style:{color:"#032F62"}},"'F'"),r("span",{style:{color:"#24292E"}},", "),r("span",{style:{color:"#005CC5"}},"3"),r("span",{style:{color:"#24292E"}},");")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    @"),r("span",{style:{color:"#D73A49"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," String "),r("span",{style:{color:"#6F42C1"}},"mark"),r("span",{style:{color:"#24292E"}},"() {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        "),r("span",{style:{color:"#D73A49"}},"return"),r("span",{style:{color:"#24292E"}}," VehicleTypeEnum.HIGH_SPEED_RAIN."),r("span",{style:{color:"#6F42C1"}},"getName"),r("span",{style:{color:"#24292E"}},"() "),r("span",{style:{color:"#D73A49"}},"+"),r("span",{style:{color:"#24292E"}}," VehicleSeatTypeEnum.FIRST_CLASS."),r("span",{style:{color:"#6F42C1"}},"getName"),r("span",{style:{color:"#24292E"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    }")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    @"),r("span",{style:{color:"#D73A49"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"protected"),r("span",{style:{color:"#24292E"}}," List<"),r("span",{style:{color:"#D73A49"}},"TrainPurchaseTicketRespDTO"),r("span",{style:{color:"#24292E"}},"> "),r("span",{style:{color:"#6F42C1"}},"selectSeats"),r("span",{style:{color:"#24292E"}},"(SelectSeatDTO "),r("span",{style:{color:"#E36209"}},"requestParam"),r("span",{style:{color:"#24292E"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"         ......")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"\t......")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"}")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"/**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}}," * 高铁二等座购票组件")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}}," */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"@"),r("span",{style:{color:"#D73A49"}},"Component")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"@"),r("span",{style:{color:"#D73A49"}},"RequiredArgsConstructor")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"class"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"TrainSecondClassPurchaseTicketHandler"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"extends"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"AbstractTrainPurchaseTicketTemplate"),r("span",{style:{color:"#24292E"}}," {")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"private"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"final"),r("span",{style:{color:"#24292E"}}," SeatService seatService;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"private"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"final"),r("span",{style:{color:"#24292E"}}," DistributedCache distributedCache;")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    @"),r("span",{style:{color:"#D73A49"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," String "),r("span",{style:{color:"#6F42C1"}},"mark"),r("span",{style:{color:"#24292E"}},"() {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        "),r("span",{style:{color:"#D73A49"}},"return"),r("span",{style:{color:"#24292E"}}," VehicleTypeEnum.HIGH_SPEED_RAIN."),r("span",{style:{color:"#6F42C1"}},"getName"),r("span",{style:{color:"#24292E"}},"() "),r("span",{style:{color:"#D73A49"}},"+"),r("span",{style:{color:"#24292E"}}," VehicleSeatTypeEnum.SECOND_CLASS."),r("span",{style:{color:"#6F42C1"}},"getName"),r("span",{style:{color:"#24292E"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    }")]),c("\n"),r("span",{class:"line"}),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    @"),r("span",{style:{color:"#D73A49"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"protected"),r("span",{style:{color:"#24292E"}}," List<"),r("span",{style:{color:"#D73A49"}},"TrainPurchaseTicketRespDTO"),r("span",{style:{color:"#24292E"}},"> "),r("span",{style:{color:"#6F42C1"}},"selectSeats"),r("span",{style:{color:"#24292E"}},"(SelectSeatDTO "),r("span",{style:{color:"#E36209"}},"requestParam"),r("span",{style:{color:"#24292E"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"          ......")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"\t......")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"}")])])])],-1),xs={id:"应用选择器选择并执行具体策略处理器",tabindex:"-1"},_s=r("div",{class:"language-java"},[r("button",{title:"Copy Code",class:"copy"}),r("span",{class:"lang"},"java"),r("pre",{class:"shiki github-dark vp-code-dark"},[r("code",null,[r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"/**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}}," * 车票接口实现")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}}," */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"@"),r("span",{style:{color:"#F97583"}},"Slf4j")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"@"),r("span",{style:{color:"#F97583"}},"Service")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"@"),r("span",{style:{color:"#F97583"}},"RequiredArgsConstructor")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"class"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"TicketServiceImpl"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"extends"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"ServiceImpl"),r("span",{style:{color:"#E1E4E8"}},"<"),r("span",{style:{color:"#F97583"}},"TicketMapper"),r("span",{style:{color:"#E1E4E8"}},", "),r("span",{style:{color:"#F97583"}},"TicketDO"),r("span",{style:{color:"#E1E4E8"}},"> "),r("span",{style:{color:"#F97583"}},"implements"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"TicketService"),r("span",{style:{color:"#E1E4E8"}}," {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"private"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"final"),r("span",{style:{color:"#E1E4E8"}}," TrainSeatTypeSelector trainSeatTypeSelector;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ......")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    @"),r("span",{style:{color:"#F97583"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    @"),r("span",{style:{color:"#F97583"}},"Transactional"),r("span",{style:{color:"#E1E4E8"}},"("),r("span",{style:{color:"#79B8FF"}},"rollbackFor"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"="),r("span",{style:{color:"#E1E4E8"}}," Throwable.class)")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," TicketPurchaseRespDTO "),r("span",{style:{color:"#B392F0"}},"executePurchaseTickets"),r("span",{style:{color:"#E1E4E8"}},"(PurchaseTicketReqDTO "),r("span",{style:{color:"#FFAB70"}},"requestParam"),r("span",{style:{color:"#E1E4E8"}},") \t   {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        ......")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        List<"),r("span",{style:{color:"#F97583"}},"TrainPurchaseTicketRespDTO"),r("span",{style:{color:"#E1E4E8"}},"> trainPurchaseTicketResults "),r("span",{style:{color:"#F97583"}},"="),r("span",{style:{color:"#E1E4E8"}}," trainSeatTypeSelector."),r("span",{style:{color:"#B392F0"}},"select"),r("span",{style:{color:"#E1E4E8"}},"(trainDO."),r("span",{style:{color:"#B392F0"}},"getTrainType"),r("span",{style:{color:"#E1E4E8"}},"(), requestParam);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        ......")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ......")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"}")])])]),r("pre",{class:"shiki github-light vp-code-light"},[r("code",null,[r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"/**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}}," * 车票接口实现")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}}," */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"@"),r("span",{style:{color:"#D73A49"}},"Slf4j")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"@"),r("span",{style:{color:"#D73A49"}},"Service")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"@"),r("span",{style:{color:"#D73A49"}},"RequiredArgsConstructor")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"class"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"TicketServiceImpl"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"extends"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"ServiceImpl"),r("span",{style:{color:"#24292E"}},"<"),r("span",{style:{color:"#D73A49"}},"TicketMapper"),r("span",{style:{color:"#24292E"}},", "),r("span",{style:{color:"#D73A49"}},"TicketDO"),r("span",{style:{color:"#24292E"}},"> "),r("span",{style:{color:"#D73A49"}},"implements"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"TicketService"),r("span",{style:{color:"#24292E"}}," {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"private"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"final"),r("span",{style:{color:"#24292E"}}," TrainSeatTypeSelector trainSeatTypeSelector;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ......")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    @"),r("span",{style:{color:"#D73A49"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    @"),r("span",{style:{color:"#D73A49"}},"Transactional"),r("span",{style:{color:"#24292E"}},"("),r("span",{style:{color:"#005CC5"}},"rollbackFor"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"="),r("span",{style:{color:"#24292E"}}," Throwable.class)")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," TicketPurchaseRespDTO "),r("span",{style:{color:"#6F42C1"}},"executePurchaseTickets"),r("span",{style:{color:"#24292E"}},"(PurchaseTicketReqDTO "),r("span",{style:{color:"#E36209"}},"requestParam"),r("span",{style:{color:"#24292E"}},") \t   {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        ......")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        List<"),r("span",{style:{color:"#D73A49"}},"TrainPurchaseTicketRespDTO"),r("span",{style:{color:"#24292E"}},"> trainPurchaseTicketResults "),r("span",{style:{color:"#D73A49"}},"="),r("span",{style:{color:"#24292E"}}," trainSeatTypeSelector."),r("span",{style:{color:"#6F42C1"}},"select"),r("span",{style:{color:"#24292E"}},"(trainDO."),r("span",{style:{color:"#6F42C1"}},"getTrainType"),r("span",{style:{color:"#24292E"}},"(), requestParam);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        ......")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ......")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"}")])])])],-1),Is={id:"登录选择",tabindex:"-1"},Ls={id:"账号登录",tabindex:"-1"},Ns={id:"登录策略执行处理器",tabindex:"-1"},Ms=r("div",{class:"language-java"},[r("button",{title:"Copy Code",class:"copy"}),r("span",{class:"lang"},"java"),r("pre",{class:"shiki github-dark vp-code-dark"},[r("code",null,[r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"@"),r("span",{style:{color:"#F97583"}},"Component")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"@"),r("span",{style:{color:"#F97583"}},"AllArgsConstructor")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"class"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"AccountLoginCommandHandler"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"implements"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"AbstractExecuteStrategy"),r("span",{style:{color:"#E1E4E8"}},"<"),r("span",{style:{color:"#F97583"}},"UserLoginCommand"),r("span",{style:{color:"#E1E4E8"}},", "),r("span",{style:{color:"#F97583"}},"UserLoginRespDTO"),r("span",{style:{color:"#E1E4E8"}},"> {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"private"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"final"),r("span",{style:{color:"#E1E4E8"}}," DistributedCache distributedCache;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"private"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"final"),r("span",{style:{color:"#E1E4E8"}}," CustomerUserRepository customerUserRepository;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    @"),r("span",{style:{color:"#F97583"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," String "),r("span",{style:{color:"#B392F0"}},"mark"),r("span",{style:{color:"#E1E4E8"}},"() {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        "),r("span",{style:{color:"#F97583"}},"return"),r("span",{style:{color:"#E1E4E8"}}," UserLoginTypeEnum.USER_LOGIN_ACCOUNT."),r("span",{style:{color:"#B392F0"}},"toString"),r("span",{style:{color:"#E1E4E8"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    @"),r("span",{style:{color:"#F97583"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," UserLoginRespDTO "),r("span",{style:{color:"#B392F0"}},"executeResp"),r("span",{style:{color:"#E1E4E8"}},"(UserLoginCommand "),r("span",{style:{color:"#FFAB70"}},"requestParam"),r("span",{style:{color:"#E1E4E8"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        CustomerUser customerUser "),r("span",{style:{color:"#F97583"}},"="),r("span",{style:{color:"#E1E4E8"}}," CustomerUser."),r("span",{style:{color:"#B392F0"}},"builder"),r("span",{style:{color:"#E1E4E8"}},"()")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"                ."),r("span",{style:{color:"#B392F0"}},"accountNumber"),r("span",{style:{color:"#E1E4E8"}},"("),r("span",{style:{color:"#F97583"}},"new"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"CustomerUserAccountNumber"),r("span",{style:{color:"#E1E4E8"}},"(requestParam."),r("span",{style:{color:"#B392F0"}},"getAccountNumber"),r("span",{style:{color:"#E1E4E8"}},"()))")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"                ."),r("span",{style:{color:"#B392F0"}},"password"),r("span",{style:{color:"#E1E4E8"}},"("),r("span",{style:{color:"#F97583"}},"new"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"CustomerUserPassword"),r("span",{style:{color:"#E1E4E8"}},"(requestParam."),r("span",{style:{color:"#B392F0"}},"getPassword"),r("span",{style:{color:"#E1E4E8"}},"()))")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"                ."),r("span",{style:{color:"#B392F0"}},"build"),r("span",{style:{color:"#E1E4E8"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        CustomerUser actual "),r("span",{style:{color:"#F97583"}},"="),r("span",{style:{color:"#E1E4E8"}}," customerUserRepository."),r("span",{style:{color:"#B392F0"}},"findByAccountNumber"),r("span",{style:{color:"#E1E4E8"}},"(requestParam."),r("span",{style:{color:"#B392F0"}},"getAccountNumber"),r("span",{style:{color:"#E1E4E8"}},"());")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        "),r("span",{style:{color:"#F97583"}},"if"),r("span",{style:{color:"#E1E4E8"}}," (actual "),r("span",{style:{color:"#F97583"}},"=="),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#79B8FF"}},"null"),r("span",{style:{color:"#E1E4E8"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"            "),r("span",{style:{color:"#F97583"}},"throw"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"new"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"ClientException"),r("span",{style:{color:"#E1E4E8"}},"("),r("span",{style:{color:"#9ECBFF"}},'"用户名不存在"'),r("span",{style:{color:"#E1E4E8"}},");")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        "),r("span",{style:{color:"#F97583"}},"if"),r("span",{style:{color:"#E1E4E8"}}," ("),r("span",{style:{color:"#F97583"}},"!"),r("span",{style:{color:"#E1E4E8"}},"Objects."),r("span",{style:{color:"#B392F0"}},"equals"),r("span",{style:{color:"#E1E4E8"}},"(customerUser."),r("span",{style:{color:"#B392F0"}},"getPassword"),r("span",{style:{color:"#E1E4E8"}},"(), actual."),r("span",{style:{color:"#B392F0"}},"getPassword"),r("span",{style:{color:"#E1E4E8"}},"())) {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"            "),r("span",{style:{color:"#F97583"}},"throw"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"new"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"ClientException"),r("span",{style:{color:"#E1E4E8"}},"("),r("span",{style:{color:"#9ECBFF"}},'"用户名密码错误"'),r("span",{style:{color:"#E1E4E8"}},");")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        String accessToken "),r("span",{style:{color:"#F97583"}},"="),r("span",{style:{color:"#E1E4E8"}}," actual."),r("span",{style:{color:"#B392F0"}},"generateAccessToken"),r("span",{style:{color:"#E1E4E8"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        distributedCache."),r("span",{style:{color:"#B392F0"}},"put"),r("span",{style:{color:"#E1E4E8"}},"(accessToken, JSON."),r("span",{style:{color:"#B392F0"}},"toJSONString"),r("span",{style:{color:"#E1E4E8"}},"(actual), "),r("span",{style:{color:"#79B8FF"}},"30"),r("span",{style:{color:"#E1E4E8"}},", TimeUnit.MINUTES);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        "),r("span",{style:{color:"#F97583"}},"return"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"new"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"UserLoginRespDTO"),r("span",{style:{color:"#E1E4E8"}},"(actual."),r("span",{style:{color:"#B392F0"}},"getCustomerUserId"),r("span",{style:{color:"#E1E4E8"}},"(), actual."),r("span",{style:{color:"#B392F0"}},"getUsername"),r("span",{style:{color:"#E1E4E8"}},"(), actual."),r("span",{style:{color:"#B392F0"}},"getAccountNumber"),r("span",{style:{color:"#E1E4E8"}},"(), accessToken);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"}")])])]),r("pre",{class:"shiki github-light vp-code-light"},[r("code",null,[r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"@"),r("span",{style:{color:"#D73A49"}},"Component")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"@"),r("span",{style:{color:"#D73A49"}},"AllArgsConstructor")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"class"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"AccountLoginCommandHandler"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"implements"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"AbstractExecuteStrategy"),r("span",{style:{color:"#24292E"}},"<"),r("span",{style:{color:"#D73A49"}},"UserLoginCommand"),r("span",{style:{color:"#24292E"}},", "),r("span",{style:{color:"#D73A49"}},"UserLoginRespDTO"),r("span",{style:{color:"#24292E"}},"> {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"private"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"final"),r("span",{style:{color:"#24292E"}}," DistributedCache distributedCache;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"private"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"final"),r("span",{style:{color:"#24292E"}}," CustomerUserRepository customerUserRepository;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    @"),r("span",{style:{color:"#D73A49"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," String "),r("span",{style:{color:"#6F42C1"}},"mark"),r("span",{style:{color:"#24292E"}},"() {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        "),r("span",{style:{color:"#D73A49"}},"return"),r("span",{style:{color:"#24292E"}}," UserLoginTypeEnum.USER_LOGIN_ACCOUNT."),r("span",{style:{color:"#6F42C1"}},"toString"),r("span",{style:{color:"#24292E"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    @"),r("span",{style:{color:"#D73A49"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," UserLoginRespDTO "),r("span",{style:{color:"#6F42C1"}},"executeResp"),r("span",{style:{color:"#24292E"}},"(UserLoginCommand "),r("span",{style:{color:"#E36209"}},"requestParam"),r("span",{style:{color:"#24292E"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        CustomerUser customerUser "),r("span",{style:{color:"#D73A49"}},"="),r("span",{style:{color:"#24292E"}}," CustomerUser."),r("span",{style:{color:"#6F42C1"}},"builder"),r("span",{style:{color:"#24292E"}},"()")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"                ."),r("span",{style:{color:"#6F42C1"}},"accountNumber"),r("span",{style:{color:"#24292E"}},"("),r("span",{style:{color:"#D73A49"}},"new"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"CustomerUserAccountNumber"),r("span",{style:{color:"#24292E"}},"(requestParam."),r("span",{style:{color:"#6F42C1"}},"getAccountNumber"),r("span",{style:{color:"#24292E"}},"()))")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"                ."),r("span",{style:{color:"#6F42C1"}},"password"),r("span",{style:{color:"#24292E"}},"("),r("span",{style:{color:"#D73A49"}},"new"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"CustomerUserPassword"),r("span",{style:{color:"#24292E"}},"(requestParam."),r("span",{style:{color:"#6F42C1"}},"getPassword"),r("span",{style:{color:"#24292E"}},"()))")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"                ."),r("span",{style:{color:"#6F42C1"}},"build"),r("span",{style:{color:"#24292E"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        CustomerUser actual "),r("span",{style:{color:"#D73A49"}},"="),r("span",{style:{color:"#24292E"}}," customerUserRepository."),r("span",{style:{color:"#6F42C1"}},"findByAccountNumber"),r("span",{style:{color:"#24292E"}},"(requestParam."),r("span",{style:{color:"#6F42C1"}},"getAccountNumber"),r("span",{style:{color:"#24292E"}},"());")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        "),r("span",{style:{color:"#D73A49"}},"if"),r("span",{style:{color:"#24292E"}}," (actual "),r("span",{style:{color:"#D73A49"}},"=="),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#005CC5"}},"null"),r("span",{style:{color:"#24292E"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"            "),r("span",{style:{color:"#D73A49"}},"throw"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"new"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"ClientException"),r("span",{style:{color:"#24292E"}},"("),r("span",{style:{color:"#032F62"}},'"用户名不存在"'),r("span",{style:{color:"#24292E"}},");")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        "),r("span",{style:{color:"#D73A49"}},"if"),r("span",{style:{color:"#24292E"}}," ("),r("span",{style:{color:"#D73A49"}},"!"),r("span",{style:{color:"#24292E"}},"Objects."),r("span",{style:{color:"#6F42C1"}},"equals"),r("span",{style:{color:"#24292E"}},"(customerUser."),r("span",{style:{color:"#6F42C1"}},"getPassword"),r("span",{style:{color:"#24292E"}},"(), actual."),r("span",{style:{color:"#6F42C1"}},"getPassword"),r("span",{style:{color:"#24292E"}},"())) {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"            "),r("span",{style:{color:"#D73A49"}},"throw"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"new"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"ClientException"),r("span",{style:{color:"#24292E"}},"("),r("span",{style:{color:"#032F62"}},'"用户名密码错误"'),r("span",{style:{color:"#24292E"}},");")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        String accessToken "),r("span",{style:{color:"#D73A49"}},"="),r("span",{style:{color:"#24292E"}}," actual."),r("span",{style:{color:"#6F42C1"}},"generateAccessToken"),r("span",{style:{color:"#24292E"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        distributedCache."),r("span",{style:{color:"#6F42C1"}},"put"),r("span",{style:{color:"#24292E"}},"(accessToken, JSON."),r("span",{style:{color:"#6F42C1"}},"toJSONString"),r("span",{style:{color:"#24292E"}},"(actual), "),r("span",{style:{color:"#005CC5"}},"30"),r("span",{style:{color:"#24292E"}},", TimeUnit.MINUTES);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        "),r("span",{style:{color:"#D73A49"}},"return"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"new"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"UserLoginRespDTO"),r("span",{style:{color:"#24292E"}},"(actual."),r("span",{style:{color:"#6F42C1"}},"getCustomerUserId"),r("span",{style:{color:"#24292E"}},"(), actual."),r("span",{style:{color:"#6F42C1"}},"getUsername"),r("span",{style:{color:"#24292E"}},"(), actual."),r("span",{style:{color:"#6F42C1"}},"getAccountNumber"),r("span",{style:{color:"#24292E"}},"(), accessToken);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"}")])])])],-1),Vs={id:"邮箱登录",tabindex:"-1"},ws={id:"登录策略执行处理器-1",tabindex:"-1"},js=r("div",{class:"language-java"},[r("button",{title:"Copy Code",class:"copy"}),r("span",{class:"lang"},"java"),r("pre",{class:"shiki github-dark vp-code-dark"},[r("code",null,[r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"@"),r("span",{style:{color:"#F97583"}},"Component")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"@"),r("span",{style:{color:"#F97583"}},"AllArgsConstructor")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"class"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"MailLoginCommandHandler"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"implements"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"AbstractExecuteStrategy"),r("span",{style:{color:"#E1E4E8"}},"<"),r("span",{style:{color:"#F97583"}},"UserLoginCommand"),r("span",{style:{color:"#E1E4E8"}},", "),r("span",{style:{color:"#F97583"}},"UserLoginRespDTO"),r("span",{style:{color:"#E1E4E8"}},"> {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"private"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"final"),r("span",{style:{color:"#E1E4E8"}}," DistributedCache distributedCache;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"private"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"final"),r("span",{style:{color:"#E1E4E8"}}," CustomerUserRepository customerUserRepository;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    @"),r("span",{style:{color:"#F97583"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," String "),r("span",{style:{color:"#B392F0"}},"mark"),r("span",{style:{color:"#E1E4E8"}},"() {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        "),r("span",{style:{color:"#F97583"}},"return"),r("span",{style:{color:"#E1E4E8"}}," UserLoginTypeEnum.USER_LOGIN_MAIL."),r("span",{style:{color:"#B392F0"}},"name"),r("span",{style:{color:"#E1E4E8"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    @"),r("span",{style:{color:"#F97583"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," UserLoginRespDTO "),r("span",{style:{color:"#B392F0"}},"executeResp"),r("span",{style:{color:"#E1E4E8"}},"(UserLoginCommand "),r("span",{style:{color:"#FFAB70"}},"requestParam"),r("span",{style:{color:"#E1E4E8"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        CustomerUser customerUser "),r("span",{style:{color:"#F97583"}},"="),r("span",{style:{color:"#E1E4E8"}}," CustomerUser."),r("span",{style:{color:"#B392F0"}},"builder"),r("span",{style:{color:"#E1E4E8"}},"()."),r("span",{style:{color:"#B392F0"}},"verifyCode"),r("span",{style:{color:"#E1E4E8"}},"(requestParam."),r("span",{style:{color:"#B392F0"}},"getMailValidCode"),r("span",{style:{color:"#E1E4E8"}},"())."),r("span",{style:{color:"#B392F0"}},"build"),r("span",{style:{color:"#E1E4E8"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        "),r("span",{style:{color:"#6A737D"}},"// 获取缓存中的验证码")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        String verifyCode "),r("span",{style:{color:"#F97583"}},"="),r("span",{style:{color:"#E1E4E8"}}," distributedCache."),r("span",{style:{color:"#B392F0"}},"get"),r("span",{style:{color:"#E1E4E8"}},"(CacheUtil."),r("span",{style:{color:"#B392F0"}},"buildKey"),r("span",{style:{color:"#E1E4E8"}},"(LOGIN_USER_VERIFY_CODE, requestParam."),r("span",{style:{color:"#B392F0"}},"getMail"),r("span",{style:{color:"#E1E4E8"}},"()), String.class);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        "),r("span",{style:{color:"#6A737D"}},"// 检查验证码正确性")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        customerUser."),r("span",{style:{color:"#B392F0"}},"checkoutValidCode"),r("span",{style:{color:"#E1E4E8"}},"(verifyCode);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        CustomerUser actual "),r("span",{style:{color:"#F97583"}},"="),r("span",{style:{color:"#E1E4E8"}}," customerUserRepository."),r("span",{style:{color:"#B392F0"}},"findByMail"),r("span",{style:{color:"#E1E4E8"}},"(requestParam."),r("span",{style:{color:"#B392F0"}},"getMail"),r("span",{style:{color:"#E1E4E8"}},"());")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        String accessToken "),r("span",{style:{color:"#F97583"}},"="),r("span",{style:{color:"#E1E4E8"}}," actual."),r("span",{style:{color:"#B392F0"}},"generateAccessToken"),r("span",{style:{color:"#E1E4E8"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        "),r("span",{style:{color:"#6A737D"}},"//todo")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        distributedCache."),r("span",{style:{color:"#B392F0"}},"put"),r("span",{style:{color:"#E1E4E8"}},"(accessToken, JSON."),r("span",{style:{color:"#B392F0"}},"toJSONString"),r("span",{style:{color:"#E1E4E8"}},"(actual), "),r("span",{style:{color:"#79B8FF"}},"30"),r("span",{style:{color:"#E1E4E8"}},", TimeUnit.MINUTES);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        "),r("span",{style:{color:"#F97583"}},"return"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"new"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"UserLoginRespDTO"),r("span",{style:{color:"#E1E4E8"}},"(actual."),r("span",{style:{color:"#B392F0"}},"getCustomerUserId"),r("span",{style:{color:"#E1E4E8"}},"(), actual."),r("span",{style:{color:"#B392F0"}},"getUsername"),r("span",{style:{color:"#E1E4E8"}},"(), actual."),r("span",{style:{color:"#B392F0"}},"getAccountNumber"),r("span",{style:{color:"#E1E4E8"}},"(), accessToken);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"}")])])]),r("pre",{class:"shiki github-light vp-code-light"},[r("code",null,[r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"@"),r("span",{style:{color:"#D73A49"}},"Component")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"@"),r("span",{style:{color:"#D73A49"}},"AllArgsConstructor")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"class"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"MailLoginCommandHandler"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"implements"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"AbstractExecuteStrategy"),r("span",{style:{color:"#24292E"}},"<"),r("span",{style:{color:"#D73A49"}},"UserLoginCommand"),r("span",{style:{color:"#24292E"}},", "),r("span",{style:{color:"#D73A49"}},"UserLoginRespDTO"),r("span",{style:{color:"#24292E"}},"> {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"private"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"final"),r("span",{style:{color:"#24292E"}}," DistributedCache distributedCache;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"private"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"final"),r("span",{style:{color:"#24292E"}}," CustomerUserRepository customerUserRepository;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    @"),r("span",{style:{color:"#D73A49"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," String "),r("span",{style:{color:"#6F42C1"}},"mark"),r("span",{style:{color:"#24292E"}},"() {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        "),r("span",{style:{color:"#D73A49"}},"return"),r("span",{style:{color:"#24292E"}}," UserLoginTypeEnum.USER_LOGIN_MAIL."),r("span",{style:{color:"#6F42C1"}},"name"),r("span",{style:{color:"#24292E"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    @"),r("span",{style:{color:"#D73A49"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," UserLoginRespDTO "),r("span",{style:{color:"#6F42C1"}},"executeResp"),r("span",{style:{color:"#24292E"}},"(UserLoginCommand "),r("span",{style:{color:"#E36209"}},"requestParam"),r("span",{style:{color:"#24292E"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        CustomerUser customerUser "),r("span",{style:{color:"#D73A49"}},"="),r("span",{style:{color:"#24292E"}}," CustomerUser."),r("span",{style:{color:"#6F42C1"}},"builder"),r("span",{style:{color:"#24292E"}},"()."),r("span",{style:{color:"#6F42C1"}},"verifyCode"),r("span",{style:{color:"#24292E"}},"(requestParam."),r("span",{style:{color:"#6F42C1"}},"getMailValidCode"),r("span",{style:{color:"#24292E"}},"())."),r("span",{style:{color:"#6F42C1"}},"build"),r("span",{style:{color:"#24292E"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        "),r("span",{style:{color:"#6A737D"}},"// 获取缓存中的验证码")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        String verifyCode "),r("span",{style:{color:"#D73A49"}},"="),r("span",{style:{color:"#24292E"}}," distributedCache."),r("span",{style:{color:"#6F42C1"}},"get"),r("span",{style:{color:"#24292E"}},"(CacheUtil."),r("span",{style:{color:"#6F42C1"}},"buildKey"),r("span",{style:{color:"#24292E"}},"(LOGIN_USER_VERIFY_CODE, requestParam."),r("span",{style:{color:"#6F42C1"}},"getMail"),r("span",{style:{color:"#24292E"}},"()), String.class);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        "),r("span",{style:{color:"#6A737D"}},"// 检查验证码正确性")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        customerUser."),r("span",{style:{color:"#6F42C1"}},"checkoutValidCode"),r("span",{style:{color:"#24292E"}},"(verifyCode);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        CustomerUser actual "),r("span",{style:{color:"#D73A49"}},"="),r("span",{style:{color:"#24292E"}}," customerUserRepository."),r("span",{style:{color:"#6F42C1"}},"findByMail"),r("span",{style:{color:"#24292E"}},"(requestParam."),r("span",{style:{color:"#6F42C1"}},"getMail"),r("span",{style:{color:"#24292E"}},"());")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        String accessToken "),r("span",{style:{color:"#D73A49"}},"="),r("span",{style:{color:"#24292E"}}," actual."),r("span",{style:{color:"#6F42C1"}},"generateAccessToken"),r("span",{style:{color:"#24292E"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        "),r("span",{style:{color:"#6A737D"}},"//todo")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        distributedCache."),r("span",{style:{color:"#6F42C1"}},"put"),r("span",{style:{color:"#24292E"}},"(accessToken, JSON."),r("span",{style:{color:"#6F42C1"}},"toJSONString"),r("span",{style:{color:"#24292E"}},"(actual), "),r("span",{style:{color:"#005CC5"}},"30"),r("span",{style:{color:"#24292E"}},", TimeUnit.MINUTES);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        "),r("span",{style:{color:"#D73A49"}},"return"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"new"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"UserLoginRespDTO"),r("span",{style:{color:"#24292E"}},"(actual."),r("span",{style:{color:"#6F42C1"}},"getCustomerUserId"),r("span",{style:{color:"#24292E"}},"(), actual."),r("span",{style:{color:"#6F42C1"}},"getUsername"),r("span",{style:{color:"#24292E"}},"(), actual."),r("span",{style:{color:"#6F42C1"}},"getAccountNumber"),r("span",{style:{color:"#24292E"}},"(), accessToken);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"}")])])])],-1),Hs={id:"抽象邮箱验证码发送",tabindex:"-1"},Ks=r("div",{class:"language-java"},[r("button",{title:"Copy Code",class:"copy"}),r("span",{class:"lang"},"java"),r("pre",{class:"shiki github-dark vp-code-dark"},[r("code",null,[r("span",{class:"line"},[r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"abstract"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"class"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"AbstractMailVerifySender"),r("span",{style:{color:"#E1E4E8"}}," {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    @"),r("span",{style:{color:"#F97583"}},"Value"),r("span",{style:{color:"#E1E4E8"}},"("),r("span",{style:{color:"#9ECBFF"}},'"${customer.user.register.verify.sender}"'),r("span",{style:{color:"#E1E4E8"}},")")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"private"),r("span",{style:{color:"#E1E4E8"}}," String sender;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    @"),r("span",{style:{color:"#F97583"}},"Value"),r("span",{style:{color:"#E1E4E8"}},"("),r("span",{style:{color:"#9ECBFF"}},'"${customer.user.register.verify.template-id}"'),r("span",{style:{color:"#E1E4E8"}},")")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"private"),r("span",{style:{color:"#E1E4E8"}}," String templateId;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    @"),r("span",{style:{color:"#F97583"}},"Resource")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"private"),r("span",{style:{color:"#E1E4E8"}}," MessageSendRemoteService messageSendRemoteService;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    @"),r("span",{style:{color:"#F97583"}},"Resource")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"private"),r("span",{style:{color:"#E1E4E8"}}," DistributedCache distributedCache;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"    /**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * 用户注册验证码超时时间")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"private"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"static"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"final"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"long"),r("span",{style:{color:"#E1E4E8"}}," REGISTER_USER_VERIFY_CODE_TIMEOUT "),r("span",{style:{color:"#F97583"}},"="),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#79B8FF"}},"300000"),r("span",{style:{color:"#E1E4E8"}},";")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"    /**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * 获取缓存前置 Key")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     *")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * "),r("span",{style:{color:"#F97583"}},"@return")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"protected"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"abstract"),r("span",{style:{color:"#E1E4E8"}}," String "),r("span",{style:{color:"#B392F0"}},"getCachePrefixKey"),r("span",{style:{color:"#E1E4E8"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"    /**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * 邮箱验证发送")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     *")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * "),r("span",{style:{color:"#F97583"}},"@param"),r("span",{style:{color:"#6A737D"}}," "),r("span",{style:{color:"#FFAB70"}},"requestParam")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"void"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"mailVerifySend"),r("span",{style:{color:"#E1E4E8"}},"(UserVerifyCodeCommand "),r("span",{style:{color:"#FFAB70"}},"requestParam"),r("span",{style:{color:"#E1E4E8"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        String verifyCode "),r("span",{style:{color:"#F97583"}},"="),r("span",{style:{color:"#E1E4E8"}}," RandomUtil."),r("span",{style:{color:"#B392F0"}},"randomNumbers"),r("span",{style:{color:"#E1E4E8"}},"("),r("span",{style:{color:"#79B8FF"}},"6"),r("span",{style:{color:"#E1E4E8"}},");")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        "),r("span",{style:{color:"#6A737D"}},"// 模板方法模式: 验证码放入缓存，并设置超时时间")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        distributedCache."),r("span",{style:{color:"#B392F0"}},"put"),r("span",{style:{color:"#E1E4E8"}},"(CacheUtil."),r("span",{style:{color:"#B392F0"}},"buildKey"),r("span",{style:{color:"#E1E4E8"}},"("),r("span",{style:{color:"#B392F0"}},"getCachePrefixKey"),r("span",{style:{color:"#E1E4E8"}},"(), requestParam."),r("span",{style:{color:"#B392F0"}},"getReceiver"),r("span",{style:{color:"#E1E4E8"}},"()), verifyCode, REGISTER_USER_VERIFY_CODE_TIMEOUT);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        MailSendRemoteCommand remoteCommand "),r("span",{style:{color:"#F97583"}},"="),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"new"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"MailSendRemoteCommand"),r("span",{style:{color:"#E1E4E8"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        remoteCommand."),r("span",{style:{color:"#B392F0"}},"setTitle"),r("span",{style:{color:"#E1E4E8"}},"("),r("span",{style:{color:"#9ECBFF"}},'"邮箱验证码提醒"'),r("span",{style:{color:"#E1E4E8"}},")")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"                ."),r("span",{style:{color:"#B392F0"}},"setReceiver"),r("span",{style:{color:"#E1E4E8"}},"(requestParam."),r("span",{style:{color:"#B392F0"}},"getReceiver"),r("span",{style:{color:"#E1E4E8"}},"())")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"                ."),r("span",{style:{color:"#B392F0"}},"setSender"),r("span",{style:{color:"#E1E4E8"}},"(sender)")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"                ."),r("span",{style:{color:"#B392F0"}},"setTemplateId"),r("span",{style:{color:"#E1E4E8"}},"(templateId)")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"                ."),r("span",{style:{color:"#B392F0"}},"setParamList"),r("span",{style:{color:"#E1E4E8"}},"(Lists."),r("span",{style:{color:"#B392F0"}},"newArrayList"),r("span",{style:{color:"#E1E4E8"}},"(verifyCode));")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        messageSendRemoteService."),r("span",{style:{color:"#B392F0"}},"mailMessageSend"),r("span",{style:{color:"#E1E4E8"}},"(remoteCommand);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"}")])])]),r("pre",{class:"shiki github-light vp-code-light"},[r("code",null,[r("span",{class:"line"},[r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"abstract"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"class"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"AbstractMailVerifySender"),r("span",{style:{color:"#24292E"}}," {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    @"),r("span",{style:{color:"#D73A49"}},"Value"),r("span",{style:{color:"#24292E"}},"("),r("span",{style:{color:"#032F62"}},'"${customer.user.register.verify.sender}"'),r("span",{style:{color:"#24292E"}},")")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"private"),r("span",{style:{color:"#24292E"}}," String sender;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    @"),r("span",{style:{color:"#D73A49"}},"Value"),r("span",{style:{color:"#24292E"}},"("),r("span",{style:{color:"#032F62"}},'"${customer.user.register.verify.template-id}"'),r("span",{style:{color:"#24292E"}},")")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"private"),r("span",{style:{color:"#24292E"}}," String templateId;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    @"),r("span",{style:{color:"#D73A49"}},"Resource")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"private"),r("span",{style:{color:"#24292E"}}," MessageSendRemoteService messageSendRemoteService;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    @"),r("span",{style:{color:"#D73A49"}},"Resource")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"private"),r("span",{style:{color:"#24292E"}}," DistributedCache distributedCache;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"    /**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * 用户注册验证码超时时间")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"private"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"static"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"final"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"long"),r("span",{style:{color:"#24292E"}}," REGISTER_USER_VERIFY_CODE_TIMEOUT "),r("span",{style:{color:"#D73A49"}},"="),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#005CC5"}},"300000"),r("span",{style:{color:"#24292E"}},";")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"    /**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * 获取缓存前置 Key")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     *")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * "),r("span",{style:{color:"#D73A49"}},"@return")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"protected"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"abstract"),r("span",{style:{color:"#24292E"}}," String "),r("span",{style:{color:"#6F42C1"}},"getCachePrefixKey"),r("span",{style:{color:"#24292E"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"    /**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * 邮箱验证发送")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     *")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     * "),r("span",{style:{color:"#D73A49"}},"@param"),r("span",{style:{color:"#6A737D"}}," "),r("span",{style:{color:"#E36209"}},"requestParam")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"     */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"void"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"mailVerifySend"),r("span",{style:{color:"#24292E"}},"(UserVerifyCodeCommand "),r("span",{style:{color:"#E36209"}},"requestParam"),r("span",{style:{color:"#24292E"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        String verifyCode "),r("span",{style:{color:"#D73A49"}},"="),r("span",{style:{color:"#24292E"}}," RandomUtil."),r("span",{style:{color:"#6F42C1"}},"randomNumbers"),r("span",{style:{color:"#24292E"}},"("),r("span",{style:{color:"#005CC5"}},"6"),r("span",{style:{color:"#24292E"}},");")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        "),r("span",{style:{color:"#6A737D"}},"// 模板方法模式: 验证码放入缓存，并设置超时时间")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        distributedCache."),r("span",{style:{color:"#6F42C1"}},"put"),r("span",{style:{color:"#24292E"}},"(CacheUtil."),r("span",{style:{color:"#6F42C1"}},"buildKey"),r("span",{style:{color:"#24292E"}},"("),r("span",{style:{color:"#6F42C1"}},"getCachePrefixKey"),r("span",{style:{color:"#24292E"}},"(), requestParam."),r("span",{style:{color:"#6F42C1"}},"getReceiver"),r("span",{style:{color:"#24292E"}},"()), verifyCode, REGISTER_USER_VERIFY_CODE_TIMEOUT);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        MailSendRemoteCommand remoteCommand "),r("span",{style:{color:"#D73A49"}},"="),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"new"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"MailSendRemoteCommand"),r("span",{style:{color:"#24292E"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        remoteCommand."),r("span",{style:{color:"#6F42C1"}},"setTitle"),r("span",{style:{color:"#24292E"}},"("),r("span",{style:{color:"#032F62"}},'"邮箱验证码提醒"'),r("span",{style:{color:"#24292E"}},")")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"                ."),r("span",{style:{color:"#6F42C1"}},"setReceiver"),r("span",{style:{color:"#24292E"}},"(requestParam."),r("span",{style:{color:"#6F42C1"}},"getReceiver"),r("span",{style:{color:"#24292E"}},"())")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"                ."),r("span",{style:{color:"#6F42C1"}},"setSender"),r("span",{style:{color:"#24292E"}},"(sender)")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"                ."),r("span",{style:{color:"#6F42C1"}},"setTemplateId"),r("span",{style:{color:"#24292E"}},"(templateId)")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"                ."),r("span",{style:{color:"#6F42C1"}},"setParamList"),r("span",{style:{color:"#24292E"}},"(Lists."),r("span",{style:{color:"#6F42C1"}},"newArrayList"),r("span",{style:{color:"#24292E"}},"(verifyCode));")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        messageSendRemoteService."),r("span",{style:{color:"#6F42C1"}},"mailMessageSend"),r("span",{style:{color:"#24292E"}},"(remoteCommand);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"}")])])])],-1),Gs={id:"用户注册使用邮箱验证策略执行处理器",tabindex:"-1"},Qs=r("div",{class:"language-java"},[r("button",{title:"Copy Code",class:"copy"}),r("span",{class:"lang"},"java"),r("pre",{class:"shiki github-dark vp-code-dark"},[r("code",null,[r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"@"),r("span",{style:{color:"#F97583"}},"Component")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"@"),r("span",{style:{color:"#F97583"}},"RequiredArgsConstructor")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"class"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"MailRegisterVerifyCommandHandler"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"extends"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"AbstractMailVerifySender"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"implements"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"AbstractExecuteStrategy"),r("span",{style:{color:"#E1E4E8"}},"<"),r("span",{style:{color:"#F97583"}},"UserVerifyCodeCommand"),r("span",{style:{color:"#E1E4E8"}},", "),r("span",{style:{color:"#F97583"}},"Void"),r("span",{style:{color:"#E1E4E8"}},"> {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    @"),r("span",{style:{color:"#F97583"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," String "),r("span",{style:{color:"#B392F0"}},"mark"),r("span",{style:{color:"#E1E4E8"}},"() {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        "),r("span",{style:{color:"#F97583"}},"return"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#9ECBFF"}},'"customer_user_register_mail"'),r("span",{style:{color:"#E1E4E8"}},";")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    @"),r("span",{style:{color:"#F97583"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"void"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"execute"),r("span",{style:{color:"#E1E4E8"}},"(UserVerifyCodeCommand "),r("span",{style:{color:"#FFAB70"}},"requestParam"),r("span",{style:{color:"#E1E4E8"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        "),r("span",{style:{color:"#B392F0"}},"mailVerifySend"),r("span",{style:{color:"#E1E4E8"}},"(requestParam);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    @"),r("span",{style:{color:"#F97583"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"protected"),r("span",{style:{color:"#E1E4E8"}}," String "),r("span",{style:{color:"#B392F0"}},"getCachePrefixKey"),r("span",{style:{color:"#E1E4E8"}},"() {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        "),r("span",{style:{color:"#F97583"}},"return"),r("span",{style:{color:"#E1E4E8"}}," CacheConstant.REGISTER_USER_VERIFY_CODE;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"}")])])]),r("pre",{class:"shiki github-light vp-code-light"},[r("code",null,[r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"@"),r("span",{style:{color:"#D73A49"}},"Component")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"@"),r("span",{style:{color:"#D73A49"}},"RequiredArgsConstructor")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"class"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"MailRegisterVerifyCommandHandler"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"extends"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"AbstractMailVerifySender"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"implements"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"AbstractExecuteStrategy"),r("span",{style:{color:"#24292E"}},"<"),r("span",{style:{color:"#D73A49"}},"UserVerifyCodeCommand"),r("span",{style:{color:"#24292E"}},", "),r("span",{style:{color:"#D73A49"}},"Void"),r("span",{style:{color:"#24292E"}},"> {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    @"),r("span",{style:{color:"#D73A49"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," String "),r("span",{style:{color:"#6F42C1"}},"mark"),r("span",{style:{color:"#24292E"}},"() {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        "),r("span",{style:{color:"#D73A49"}},"return"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#032F62"}},'"customer_user_register_mail"'),r("span",{style:{color:"#24292E"}},";")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    @"),r("span",{style:{color:"#D73A49"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"void"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"execute"),r("span",{style:{color:"#24292E"}},"(UserVerifyCodeCommand "),r("span",{style:{color:"#E36209"}},"requestParam"),r("span",{style:{color:"#24292E"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        "),r("span",{style:{color:"#6F42C1"}},"mailVerifySend"),r("span",{style:{color:"#24292E"}},"(requestParam);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    @"),r("span",{style:{color:"#D73A49"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"protected"),r("span",{style:{color:"#24292E"}}," String "),r("span",{style:{color:"#6F42C1"}},"getCachePrefixKey"),r("span",{style:{color:"#24292E"}},"() {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        "),r("span",{style:{color:"#D73A49"}},"return"),r("span",{style:{color:"#24292E"}}," CacheConstant.REGISTER_USER_VERIFY_CODE;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"}")])])])],-1),$s={id:"用户登录使用邮箱验证策略执行处理器",tabindex:"-1"},zs=r("div",{class:"language-java"},[r("button",{title:"Copy Code",class:"copy"}),r("span",{class:"lang"},"java"),r("pre",{class:"shiki github-dark vp-code-dark"},[r("code",null,[r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"@"),r("span",{style:{color:"#F97583"}},"Component")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"class"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"MailLoginVerifyCommandHandler"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"extends"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"AbstractMailVerifySender"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"implements"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"AbstractExecuteStrategy"),r("span",{style:{color:"#E1E4E8"}},"<"),r("span",{style:{color:"#F97583"}},"UserVerifyCodeCommand"),r("span",{style:{color:"#E1E4E8"}},", "),r("span",{style:{color:"#F97583"}},"Void"),r("span",{style:{color:"#E1E4E8"}},"> {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    @"),r("span",{style:{color:"#F97583"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," String "),r("span",{style:{color:"#B392F0"}},"mark"),r("span",{style:{color:"#E1E4E8"}},"() {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        "),r("span",{style:{color:"#F97583"}},"return"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#9ECBFF"}},'"customer_user_login_verify_mail"'),r("span",{style:{color:"#E1E4E8"}},";")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    @"),r("span",{style:{color:"#F97583"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"void"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"execute"),r("span",{style:{color:"#E1E4E8"}},"(UserVerifyCodeCommand "),r("span",{style:{color:"#FFAB70"}},"requestParam"),r("span",{style:{color:"#E1E4E8"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        "),r("span",{style:{color:"#B392F0"}},"mailVerifySend"),r("span",{style:{color:"#E1E4E8"}},"(requestParam);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    @"),r("span",{style:{color:"#F97583"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"protected"),r("span",{style:{color:"#E1E4E8"}}," String "),r("span",{style:{color:"#B392F0"}},"getCachePrefixKey"),r("span",{style:{color:"#E1E4E8"}},"() {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        "),r("span",{style:{color:"#F97583"}},"return"),r("span",{style:{color:"#E1E4E8"}}," CacheConstant.LOGIN_USER_VERIFY_CODE;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"}")])])]),r("pre",{class:"shiki github-light vp-code-light"},[r("code",null,[r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"@"),r("span",{style:{color:"#D73A49"}},"Component")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"class"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"MailLoginVerifyCommandHandler"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"extends"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"AbstractMailVerifySender"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"implements"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"AbstractExecuteStrategy"),r("span",{style:{color:"#24292E"}},"<"),r("span",{style:{color:"#D73A49"}},"UserVerifyCodeCommand"),r("span",{style:{color:"#24292E"}},", "),r("span",{style:{color:"#D73A49"}},"Void"),r("span",{style:{color:"#24292E"}},"> {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    @"),r("span",{style:{color:"#D73A49"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," String "),r("span",{style:{color:"#6F42C1"}},"mark"),r("span",{style:{color:"#24292E"}},"() {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        "),r("span",{style:{color:"#D73A49"}},"return"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#032F62"}},'"customer_user_login_verify_mail"'),r("span",{style:{color:"#24292E"}},";")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    @"),r("span",{style:{color:"#D73A49"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"void"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"execute"),r("span",{style:{color:"#24292E"}},"(UserVerifyCodeCommand "),r("span",{style:{color:"#E36209"}},"requestParam"),r("span",{style:{color:"#24292E"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        "),r("span",{style:{color:"#6F42C1"}},"mailVerifySend"),r("span",{style:{color:"#24292E"}},"(requestParam);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    @"),r("span",{style:{color:"#D73A49"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"protected"),r("span",{style:{color:"#24292E"}}," String "),r("span",{style:{color:"#6F42C1"}},"getCachePrefixKey"),r("span",{style:{color:"#24292E"}},"() {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        "),r("span",{style:{color:"#D73A49"}},"return"),r("span",{style:{color:"#24292E"}}," CacheConstant.LOGIN_USER_VERIFY_CODE;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"}")])])])],-1),Ys={id:"c-端用户接口选择并执行具体策略处理器",tabindex:"-1"},Js=r("div",{class:"language-java"},[r("button",{title:"Copy Code",class:"copy"}),r("span",{class:"lang"},"java"),r("pre",{class:"shiki github-dark vp-code-dark"},[r("code",null,[r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"@"),r("span",{style:{color:"#F97583"}},"Service")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"@"),r("span",{style:{color:"#F97583"}},"AllArgsConstructor")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"class"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"CustomerUserServiceImpl"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"implements"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"CustomerUserService"),r("span",{style:{color:"#E1E4E8"}}," {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"private"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"final"),r("span",{style:{color:"#E1E4E8"}}," DistributedCache distributedCache;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"private"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"final"),r("span",{style:{color:"#E1E4E8"}}," AbstractStrategyChoose abstractStrategyChoose;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"private"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"final"),r("span",{style:{color:"#E1E4E8"}}," CommandHandler<"),r("span",{style:{color:"#F97583"}},"UserRegisterCommand"),r("span",{style:{color:"#E1E4E8"}},", "),r("span",{style:{color:"#F97583"}},"UserRegisterRespDTO"),r("span",{style:{color:"#E1E4E8"}},"> customerUserRegisterCommandHandler;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    @"),r("span",{style:{color:"#F97583"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"void"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"verifyCodeSend"),r("span",{style:{color:"#E1E4E8"}},"(UserVerifyCodeCommand "),r("span",{style:{color:"#FFAB70"}},"requestParam"),r("span",{style:{color:"#E1E4E8"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        String mark "),r("span",{style:{color:"#F97583"}},"="),r("span",{style:{color:"#E1E4E8"}}," requestParam."),r("span",{style:{color:"#B392F0"}},"getType"),r("span",{style:{color:"#E1E4E8"}},"() "),r("span",{style:{color:"#F97583"}},"+"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#9ECBFF"}},'"_"'),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"+"),r("span",{style:{color:"#E1E4E8"}}," requestParam."),r("span",{style:{color:"#B392F0"}},"getPlatform"),r("span",{style:{color:"#E1E4E8"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        "),r("span",{style:{color:"#6A737D"}},"/**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"         * site")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"         * {@link MailLoginVerifyCommandHandler}")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"         * {@link MailRegisterVerifyCommandHandler}")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"         * ...")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"         */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        "),r("span",{style:{color:"#6A737D"}},"// 策略模式: 根据 mark 选择用户登录或者注册逻辑")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        abstractStrategyChoose."),r("span",{style:{color:"#B392F0"}},"chooseAndExecute"),r("span",{style:{color:"#E1E4E8"}},"(mark, requestParam);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    @"),r("span",{style:{color:"#F97583"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," UserRegisterRespDTO "),r("span",{style:{color:"#B392F0"}},"register"),r("span",{style:{color:"#E1E4E8"}},"(UserRegisterCommand "),r("span",{style:{color:"#FFAB70"}},"requestParam"),r("span",{style:{color:"#E1E4E8"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        UserRegisterRespDTO result "),r("span",{style:{color:"#F97583"}},"="),r("span",{style:{color:"#E1E4E8"}}," customerUserRegisterCommandHandler."),r("span",{style:{color:"#B392F0"}},"handler"),r("span",{style:{color:"#E1E4E8"}},"(requestParam);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        "),r("span",{style:{color:"#F97583"}},"return"),r("span",{style:{color:"#E1E4E8"}}," result;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    @"),r("span",{style:{color:"#F97583"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," UserLoginRespDTO "),r("span",{style:{color:"#B392F0"}},"login"),r("span",{style:{color:"#E1E4E8"}},"(UserLoginCommand "),r("span",{style:{color:"#FFAB70"}},"requestParam"),r("span",{style:{color:"#E1E4E8"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        "),r("span",{style:{color:"#6A737D"}},"/**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"         * site")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"         * {@link MailLoginCommandHandler}")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"         */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        "),r("span",{style:{color:"#F97583"}},"return"),r("span",{style:{color:"#E1E4E8"}}," abstractStrategyChoose."),r("span",{style:{color:"#B392F0"}},"chooseAndExecuteResp"),r("span",{style:{color:"#E1E4E8"}},"(requestParam."),r("span",{style:{color:"#B392F0"}},"getLoginType"),r("span",{style:{color:"#E1E4E8"}},"(), requestParam);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    @"),r("span",{style:{color:"#F97583"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," UserLoginRespDTO "),r("span",{style:{color:"#B392F0"}},"checkLogin"),r("span",{style:{color:"#E1E4E8"}},"(String "),r("span",{style:{color:"#FFAB70"}},"accessToken"),r("span",{style:{color:"#E1E4E8"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        "),r("span",{style:{color:"#F97583"}},"return"),r("span",{style:{color:"#E1E4E8"}}," distributedCache."),r("span",{style:{color:"#B392F0"}},"get"),r("span",{style:{color:"#E1E4E8"}},"(accessToken, UserLoginRespDTO.class);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    @"),r("span",{style:{color:"#F97583"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"void"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"logout"),r("span",{style:{color:"#E1E4E8"}},"(String "),r("span",{style:{color:"#FFAB70"}},"accessToken"),r("span",{style:{color:"#E1E4E8"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        "),r("span",{style:{color:"#F97583"}},"if"),r("span",{style:{color:"#E1E4E8"}}," (StrUtil."),r("span",{style:{color:"#B392F0"}},"isNotBlank"),r("span",{style:{color:"#E1E4E8"}},"(accessToken)) {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"            distributedCache."),r("span",{style:{color:"#B392F0"}},"delete"),r("span",{style:{color:"#E1E4E8"}},"(accessToken);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"}")])])]),r("pre",{class:"shiki github-light vp-code-light"},[r("code",null,[r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"@"),r("span",{style:{color:"#D73A49"}},"Service")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"@"),r("span",{style:{color:"#D73A49"}},"AllArgsConstructor")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"class"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"CustomerUserServiceImpl"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"implements"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"CustomerUserService"),r("span",{style:{color:"#24292E"}}," {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"private"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"final"),r("span",{style:{color:"#24292E"}}," DistributedCache distributedCache;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"private"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"final"),r("span",{style:{color:"#24292E"}}," AbstractStrategyChoose abstractStrategyChoose;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"private"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"final"),r("span",{style:{color:"#24292E"}}," CommandHandler<"),r("span",{style:{color:"#D73A49"}},"UserRegisterCommand"),r("span",{style:{color:"#24292E"}},", "),r("span",{style:{color:"#D73A49"}},"UserRegisterRespDTO"),r("span",{style:{color:"#24292E"}},"> customerUserRegisterCommandHandler;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    @"),r("span",{style:{color:"#D73A49"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"void"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"verifyCodeSend"),r("span",{style:{color:"#24292E"}},"(UserVerifyCodeCommand "),r("span",{style:{color:"#E36209"}},"requestParam"),r("span",{style:{color:"#24292E"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        String mark "),r("span",{style:{color:"#D73A49"}},"="),r("span",{style:{color:"#24292E"}}," requestParam."),r("span",{style:{color:"#6F42C1"}},"getType"),r("span",{style:{color:"#24292E"}},"() "),r("span",{style:{color:"#D73A49"}},"+"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#032F62"}},'"_"'),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"+"),r("span",{style:{color:"#24292E"}}," requestParam."),r("span",{style:{color:"#6F42C1"}},"getPlatform"),r("span",{style:{color:"#24292E"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        "),r("span",{style:{color:"#6A737D"}},"/**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"         * site")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"         * {@link MailLoginVerifyCommandHandler}")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"         * {@link MailRegisterVerifyCommandHandler}")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"         * ...")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"         */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        "),r("span",{style:{color:"#6A737D"}},"// 策略模式: 根据 mark 选择用户登录或者注册逻辑")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        abstractStrategyChoose."),r("span",{style:{color:"#6F42C1"}},"chooseAndExecute"),r("span",{style:{color:"#24292E"}},"(mark, requestParam);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    @"),r("span",{style:{color:"#D73A49"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," UserRegisterRespDTO "),r("span",{style:{color:"#6F42C1"}},"register"),r("span",{style:{color:"#24292E"}},"(UserRegisterCommand "),r("span",{style:{color:"#E36209"}},"requestParam"),r("span",{style:{color:"#24292E"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        UserRegisterRespDTO result "),r("span",{style:{color:"#D73A49"}},"="),r("span",{style:{color:"#24292E"}}," customerUserRegisterCommandHandler."),r("span",{style:{color:"#6F42C1"}},"handler"),r("span",{style:{color:"#24292E"}},"(requestParam);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        "),r("span",{style:{color:"#D73A49"}},"return"),r("span",{style:{color:"#24292E"}}," result;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    @"),r("span",{style:{color:"#D73A49"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," UserLoginRespDTO "),r("span",{style:{color:"#6F42C1"}},"login"),r("span",{style:{color:"#24292E"}},"(UserLoginCommand "),r("span",{style:{color:"#E36209"}},"requestParam"),r("span",{style:{color:"#24292E"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        "),r("span",{style:{color:"#6A737D"}},"/**")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"         * site")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"         * {@link MailLoginCommandHandler}")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#6A737D"}},"         */")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        "),r("span",{style:{color:"#D73A49"}},"return"),r("span",{style:{color:"#24292E"}}," abstractStrategyChoose."),r("span",{style:{color:"#6F42C1"}},"chooseAndExecuteResp"),r("span",{style:{color:"#24292E"}},"(requestParam."),r("span",{style:{color:"#6F42C1"}},"getLoginType"),r("span",{style:{color:"#24292E"}},"(), requestParam);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    @"),r("span",{style:{color:"#D73A49"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," UserLoginRespDTO "),r("span",{style:{color:"#6F42C1"}},"checkLogin"),r("span",{style:{color:"#24292E"}},"(String "),r("span",{style:{color:"#E36209"}},"accessToken"),r("span",{style:{color:"#24292E"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        "),r("span",{style:{color:"#D73A49"}},"return"),r("span",{style:{color:"#24292E"}}," distributedCache."),r("span",{style:{color:"#6F42C1"}},"get"),r("span",{style:{color:"#24292E"}},"(accessToken, UserLoginRespDTO.class);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    @"),r("span",{style:{color:"#D73A49"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"void"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"logout"),r("span",{style:{color:"#24292E"}},"(String "),r("span",{style:{color:"#E36209"}},"accessToken"),r("span",{style:{color:"#24292E"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        "),r("span",{style:{color:"#D73A49"}},"if"),r("span",{style:{color:"#24292E"}}," (StrUtil."),r("span",{style:{color:"#6F42C1"}},"isNotBlank"),r("span",{style:{color:"#24292E"}},"(accessToken)) {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"            distributedCache."),r("span",{style:{color:"#6F42C1"}},"delete"),r("span",{style:{color:"#24292E"}},"(accessToken);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"}")])])])],-1),Zs=r("p",null,[r("strong",null,"C 端用户注册处理器")],-1),Ws=r("div",{class:"language-java"},[r("button",{title:"Copy Code",class:"copy"}),r("span",{class:"lang"},"java"),r("pre",{class:"shiki github-dark vp-code-dark"},[r("code",null,[r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"@"),r("span",{style:{color:"#F97583"}},"Component")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"@"),r("span",{style:{color:"#F97583"}},"AllArgsConstructor")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"class"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"CustomerUserRegisterCommandHandler"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"implements"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"CommandHandler"),r("span",{style:{color:"#E1E4E8"}},"<"),r("span",{style:{color:"#F97583"}},"UserRegisterCommand"),r("span",{style:{color:"#E1E4E8"}},", "),r("span",{style:{color:"#F97583"}},"UserRegisterRespDTO"),r("span",{style:{color:"#E1E4E8"}},"> {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"private"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"final"),r("span",{style:{color:"#E1E4E8"}}," CustomerUserRepository customerUserRepository;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"private"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"final"),r("span",{style:{color:"#E1E4E8"}}," CustomerUserToDTOAssembler customerUserAssembler;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"private"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#F97583"}},"final"),r("span",{style:{color:"#E1E4E8"}}," DistributedCache distributedCache;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    @"),r("span",{style:{color:"#F97583"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    "),r("span",{style:{color:"#F97583"}},"public"),r("span",{style:{color:"#E1E4E8"}}," UserRegisterRespDTO "),r("span",{style:{color:"#B392F0"}},"handler"),r("span",{style:{color:"#E1E4E8"}},"(UserRegisterCommand "),r("span",{style:{color:"#FFAB70"}},"requestParam"),r("span",{style:{color:"#E1E4E8"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        CustomerUser customerUser "),r("span",{style:{color:"#F97583"}},"="),r("span",{style:{color:"#E1E4E8"}}," CustomerUser."),r("span",{style:{color:"#B392F0"}},"builder"),r("span",{style:{color:"#E1E4E8"}},"()")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"                ."),r("span",{style:{color:"#B392F0"}},"username"),r("span",{style:{color:"#E1E4E8"}},"("),r("span",{style:{color:"#F97583"}},"new"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"CustomerUserName"),r("span",{style:{color:"#E1E4E8"}},"(requestParam."),r("span",{style:{color:"#B392F0"}},"getUsername"),r("span",{style:{color:"#E1E4E8"}},"()))")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"                ."),r("span",{style:{color:"#B392F0"}},"phone"),r("span",{style:{color:"#E1E4E8"}},"("),r("span",{style:{color:"#F97583"}},"new"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"CustomerUserPhone"),r("span",{style:{color:"#E1E4E8"}},"(requestParam."),r("span",{style:{color:"#B392F0"}},"getPhone"),r("span",{style:{color:"#E1E4E8"}},"()))")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"                ."),r("span",{style:{color:"#B392F0"}},"accountNumber"),r("span",{style:{color:"#E1E4E8"}},"("),r("span",{style:{color:"#F97583"}},"new"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"CustomerUserAccountNumber"),r("span",{style:{color:"#E1E4E8"}},"(requestParam."),r("span",{style:{color:"#B392F0"}},"getAccountNumber"),r("span",{style:{color:"#E1E4E8"}},"()))")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"                ."),r("span",{style:{color:"#B392F0"}},"password"),r("span",{style:{color:"#E1E4E8"}},"("),r("span",{style:{color:"#F97583"}},"new"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"CustomerUserPassword"),r("span",{style:{color:"#E1E4E8"}},"(requestParam."),r("span",{style:{color:"#B392F0"}},"getPassword"),r("span",{style:{color:"#E1E4E8"}},"()))")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"                ."),r("span",{style:{color:"#B392F0"}},"mail"),r("span",{style:{color:"#E1E4E8"}},"("),r("span",{style:{color:"#F97583"}},"new"),r("span",{style:{color:"#E1E4E8"}}," "),r("span",{style:{color:"#B392F0"}},"CustomerUserMail"),r("span",{style:{color:"#E1E4E8"}},"(requestParam."),r("span",{style:{color:"#B392F0"}},"getMail"),r("span",{style:{color:"#E1E4E8"}},"()))")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"                ."),r("span",{style:{color:"#B392F0"}},"receiver"),r("span",{style:{color:"#E1E4E8"}},"(requestParam."),r("span",{style:{color:"#B392F0"}},"getMail"),r("span",{style:{color:"#E1E4E8"}},"())")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"                ."),r("span",{style:{color:"#B392F0"}},"verifyCode"),r("span",{style:{color:"#E1E4E8"}},"(requestParam."),r("span",{style:{color:"#B392F0"}},"getMailValidCode"),r("span",{style:{color:"#E1E4E8"}},"())")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"                ."),r("span",{style:{color:"#B392F0"}},"build"),r("span",{style:{color:"#E1E4E8"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        "),r("span",{style:{color:"#6A737D"}},"// 获取缓存中的验证码")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        String buildKey "),r("span",{style:{color:"#F97583"}},"="),r("span",{style:{color:"#E1E4E8"}}," CacheUtil."),r("span",{style:{color:"#B392F0"}},"buildKey"),r("span",{style:{color:"#E1E4E8"}},"(REGISTER_USER_VERIFY_CODE, customerUser."),r("span",{style:{color:"#B392F0"}},"getReceiver"),r("span",{style:{color:"#E1E4E8"}},"());")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        String verifyCode "),r("span",{style:{color:"#F97583"}},"="),r("span",{style:{color:"#E1E4E8"}}," distributedCache."),r("span",{style:{color:"#B392F0"}},"get"),r("span",{style:{color:"#E1E4E8"}},"(buildKey, String.class);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        "),r("span",{style:{color:"#6A737D"}},"// 检查验证码正确性")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        customerUser."),r("span",{style:{color:"#B392F0"}},"checkoutValidCode"),r("span",{style:{color:"#E1E4E8"}},"(verifyCode);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        CustomerUser result "),r("span",{style:{color:"#F97583"}},"="),r("span",{style:{color:"#E1E4E8"}}," customerUserRepository."),r("span",{style:{color:"#B392F0"}},"register"),r("span",{style:{color:"#E1E4E8"}},"(customerUser);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        "),r("span",{style:{color:"#6A737D"}},"// 删除缓存验证码")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        distributedCache."),r("span",{style:{color:"#B392F0"}},"delete"),r("span",{style:{color:"#E1E4E8"}},"(buildKey);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"        "),r("span",{style:{color:"#F97583"}},"return"),r("span",{style:{color:"#E1E4E8"}}," customerUserAssembler."),r("span",{style:{color:"#B392F0"}},"customerUserToUserRegisterRespDTO"),r("span",{style:{color:"#E1E4E8"}},"(result);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#E1E4E8"}},"}")])])]),r("pre",{class:"shiki github-light vp-code-light"},[r("code",null,[r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"@"),r("span",{style:{color:"#D73A49"}},"Component")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"@"),r("span",{style:{color:"#D73A49"}},"AllArgsConstructor")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"class"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"CustomerUserRegisterCommandHandler"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"implements"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"CommandHandler"),r("span",{style:{color:"#24292E"}},"<"),r("span",{style:{color:"#D73A49"}},"UserRegisterCommand"),r("span",{style:{color:"#24292E"}},", "),r("span",{style:{color:"#D73A49"}},"UserRegisterRespDTO"),r("span",{style:{color:"#24292E"}},"> {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"private"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"final"),r("span",{style:{color:"#24292E"}}," CustomerUserRepository customerUserRepository;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"private"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"final"),r("span",{style:{color:"#24292E"}}," CustomerUserToDTOAssembler customerUserAssembler;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"private"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#D73A49"}},"final"),r("span",{style:{color:"#24292E"}}," DistributedCache distributedCache;")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    ")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    @"),r("span",{style:{color:"#D73A49"}},"Override")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    "),r("span",{style:{color:"#D73A49"}},"public"),r("span",{style:{color:"#24292E"}}," UserRegisterRespDTO "),r("span",{style:{color:"#6F42C1"}},"handler"),r("span",{style:{color:"#24292E"}},"(UserRegisterCommand "),r("span",{style:{color:"#E36209"}},"requestParam"),r("span",{style:{color:"#24292E"}},") {")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        CustomerUser customerUser "),r("span",{style:{color:"#D73A49"}},"="),r("span",{style:{color:"#24292E"}}," CustomerUser."),r("span",{style:{color:"#6F42C1"}},"builder"),r("span",{style:{color:"#24292E"}},"()")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"                ."),r("span",{style:{color:"#6F42C1"}},"username"),r("span",{style:{color:"#24292E"}},"("),r("span",{style:{color:"#D73A49"}},"new"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"CustomerUserName"),r("span",{style:{color:"#24292E"}},"(requestParam."),r("span",{style:{color:"#6F42C1"}},"getUsername"),r("span",{style:{color:"#24292E"}},"()))")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"                ."),r("span",{style:{color:"#6F42C1"}},"phone"),r("span",{style:{color:"#24292E"}},"("),r("span",{style:{color:"#D73A49"}},"new"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"CustomerUserPhone"),r("span",{style:{color:"#24292E"}},"(requestParam."),r("span",{style:{color:"#6F42C1"}},"getPhone"),r("span",{style:{color:"#24292E"}},"()))")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"                ."),r("span",{style:{color:"#6F42C1"}},"accountNumber"),r("span",{style:{color:"#24292E"}},"("),r("span",{style:{color:"#D73A49"}},"new"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"CustomerUserAccountNumber"),r("span",{style:{color:"#24292E"}},"(requestParam."),r("span",{style:{color:"#6F42C1"}},"getAccountNumber"),r("span",{style:{color:"#24292E"}},"()))")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"                ."),r("span",{style:{color:"#6F42C1"}},"password"),r("span",{style:{color:"#24292E"}},"("),r("span",{style:{color:"#D73A49"}},"new"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"CustomerUserPassword"),r("span",{style:{color:"#24292E"}},"(requestParam."),r("span",{style:{color:"#6F42C1"}},"getPassword"),r("span",{style:{color:"#24292E"}},"()))")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"                ."),r("span",{style:{color:"#6F42C1"}},"mail"),r("span",{style:{color:"#24292E"}},"("),r("span",{style:{color:"#D73A49"}},"new"),r("span",{style:{color:"#24292E"}}," "),r("span",{style:{color:"#6F42C1"}},"CustomerUserMail"),r("span",{style:{color:"#24292E"}},"(requestParam."),r("span",{style:{color:"#6F42C1"}},"getMail"),r("span",{style:{color:"#24292E"}},"()))")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"                ."),r("span",{style:{color:"#6F42C1"}},"receiver"),r("span",{style:{color:"#24292E"}},"(requestParam."),r("span",{style:{color:"#6F42C1"}},"getMail"),r("span",{style:{color:"#24292E"}},"())")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"                ."),r("span",{style:{color:"#6F42C1"}},"verifyCode"),r("span",{style:{color:"#24292E"}},"(requestParam."),r("span",{style:{color:"#6F42C1"}},"getMailValidCode"),r("span",{style:{color:"#24292E"}},"())")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"                ."),r("span",{style:{color:"#6F42C1"}},"build"),r("span",{style:{color:"#24292E"}},"();")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        "),r("span",{style:{color:"#6A737D"}},"// 获取缓存中的验证码")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        String buildKey "),r("span",{style:{color:"#D73A49"}},"="),r("span",{style:{color:"#24292E"}}," CacheUtil."),r("span",{style:{color:"#6F42C1"}},"buildKey"),r("span",{style:{color:"#24292E"}},"(REGISTER_USER_VERIFY_CODE, customerUser."),r("span",{style:{color:"#6F42C1"}},"getReceiver"),r("span",{style:{color:"#24292E"}},"());")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        String verifyCode "),r("span",{style:{color:"#D73A49"}},"="),r("span",{style:{color:"#24292E"}}," distributedCache."),r("span",{style:{color:"#6F42C1"}},"get"),r("span",{style:{color:"#24292E"}},"(buildKey, String.class);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        "),r("span",{style:{color:"#6A737D"}},"// 检查验证码正确性")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        customerUser."),r("span",{style:{color:"#6F42C1"}},"checkoutValidCode"),r("span",{style:{color:"#24292E"}},"(verifyCode);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        CustomerUser result "),r("span",{style:{color:"#D73A49"}},"="),r("span",{style:{color:"#24292E"}}," customerUserRepository."),r("span",{style:{color:"#6F42C1"}},"register"),r("span",{style:{color:"#24292E"}},"(customerUser);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        "),r("span",{style:{color:"#6A737D"}},"// 删除缓存验证码")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        distributedCache."),r("span",{style:{color:"#6F42C1"}},"delete"),r("span",{style:{color:"#24292E"}},"(buildKey);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"        "),r("span",{style:{color:"#D73A49"}},"return"),r("span",{style:{color:"#24292E"}}," customerUserAssembler."),r("span",{style:{color:"#6F42C1"}},"customerUserToUserRegisterRespDTO"),r("span",{style:{color:"#24292E"}},"(result);")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"    }")]),c("\n"),r("span",{class:"line"},[r("span",{style:{color:"#24292E"}},"}")])])])],-1),Xs={id:"文末总结",tabindex:"-1"},sl=r("p",null,"总的来说，策略模式是一种非常有用的设计模式，它可以帮助我们在运行时动态地选择不同的算法实现，从而提高代码的灵活性、可维护性和可扩展性。",-1),ll=r("p",null,"通过将算法实现封装在不同的策略类中，并定义一个策略接口来描述算法，策略模式使得客户端可以独立于算法实现进行编程，同时也可以方便地更换算法实现或者添加新的算法实现。",-1),ol=r("p",null,"策略模式的优点包括提高代码的灵活性、可维护性、可扩展性和复用性，同时也可以避免使用大量的条件语句和提高代码的可读性。",-1),el=r("p",null,"需要注意的是，在使用策略模式时需要遵循一些设计原则，例如开闭原则、单一职责原则和依赖倒置原则等，以确保代码的高内聚性和低耦合度。",-1),nl=r("p",null,"此外，策略模式适用于需要在运行时动态选择不同算法实现的场景，如果算法实现不需要动态切换或者算法实现较为简单，策略模式可能会显得过于复杂。",-1),al=r("p",null,"因此，在使用策略模式时需要根据具体的需求和场景进行判断和选择。",-1);const tl=s(F,[["render",function(s,l,o,i,u,F){const tl=y,rl=a;return t(),e(rl,{frontmatter:u.frontmatter,data:u.data},{"main-content-md":n((()=>[r("h1",d,[c("死磕设计模式之抽象策略模式 "),p(tl,{class:"header-anchor",href:"#死磕设计模式之抽象策略模式","aria-hidden":"true"},{default:n((()=>[c("#")])),_:1})]),r("h2",A,[c("策略模式是什么 "),p(tl,{class:"header-anchor",href:"#策略模式是什么","aria-hidden":"true"},{default:n((()=>[c("#")])),_:1})]),m,D,g,C,S,h,b,r("h2",T,[c("优惠类型实战 "),p(tl,{class:"header-anchor",href:"#优惠类型实战","aria-hidden":"true"},{default:n((()=>[c("#")])),_:1})]),v,B,f,R,P,k,U,O,q,x,_,I,L,N,r("h2",M,[c("策略模式结合 Spring "),p(tl,{class:"header-anchor",href:"#策略模式结合-spring","aria-hidden":"true"},{default:n((()=>[c("#")])),_:1})]),V,w,j,H,K,G,Q,$,z,Y,J,Z,r("h2",W,[c("策略模式优缺点 "),p(tl,{class:"header-anchor",href:"#策略模式优缺点","aria-hidden":"true"},{default:n((()=>[c("#")])),_:1})]),X,ss,ls,os,r("h2",es,[c("框架源码应用 "),p(tl,{class:"header-anchor",href:"#框架源码应用","aria-hidden":"true"},{default:n((()=>[c("#")])),_:1})]),ns,as,ts,rs,cs,ps,Es,ys,is,us,Fs,ds,As,r("h2",ms,[c("策略模式抽象 "),p(tl,{class:"header-anchor",href:"#策略模式抽象","aria-hidden":"true"},{default:n((()=>[c("#")])),_:1})]),Ds,gs,Cs,Ss,hs,bs,Ts,vs,r("h2",Bs,[c("策略模式实现 "),p(tl,{class:"header-anchor",href:"#策略模式实现","aria-hidden":"true"},{default:n((()=>[c("#")])),_:1})]),r("h3",fs,[c("列车座位选择器 "),p(tl,{class:"header-anchor",href:"#列车座位选择器","aria-hidden":"true"},{default:n((()=>[c("#")])),_:1})]),r("h4",Rs,[c("购票时列车座位选择器 "),p(tl,{class:"header-anchor",href:"#购票时列车座位选择器","aria-hidden":"true"},{default:n((()=>[c("#")])),_:1})]),Ps,r("h4",ks,[c("抽象高铁购票模板基础服务 "),p(tl,{class:"header-anchor",href:"#抽象高铁购票模板基础服务","aria-hidden":"true"},{default:n((()=>[c("#")])),_:1})]),Us,r("h4",Os,[c("高铁各座位类型购票组件 "),p(tl,{class:"header-anchor",href:"#高铁各座位类型购票组件","aria-hidden":"true"},{default:n((()=>[c("#")])),_:1})]),qs,r("h4",xs,[c("应用选择器选择并执行具体策略处理器 "),p(tl,{class:"header-anchor",href:"#应用选择器选择并执行具体策略处理器","aria-hidden":"true"},{default:n((()=>[c("#")])),_:1})]),_s,r("h3",Is,[c("登录选择 "),p(tl,{class:"header-anchor",href:"#登录选择","aria-hidden":"true"},{default:n((()=>[c("#")])),_:1})]),r("h4",Ls,[c("账号登录 "),p(tl,{class:"header-anchor",href:"#账号登录","aria-hidden":"true"},{default:n((()=>[c("#")])),_:1})]),r("h5",Ns,[c("登录策略执行处理器 "),p(tl,{class:"header-anchor",href:"#登录策略执行处理器","aria-hidden":"true"},{default:n((()=>[c("#")])),_:1})]),Ms,r("h4",Vs,[c("邮箱登录 "),p(tl,{class:"header-anchor",href:"#邮箱登录","aria-hidden":"true"},{default:n((()=>[c("#")])),_:1})]),r("h5",ws,[c("登录策略执行处理器 "),p(tl,{class:"header-anchor",href:"#登录策略执行处理器-1","aria-hidden":"true"},{default:n((()=>[c("#")])),_:1})]),js,r("h5",Hs,[c("抽象邮箱验证码发送 "),p(tl,{class:"header-anchor",href:"#抽象邮箱验证码发送","aria-hidden":"true"},{default:n((()=>[c("#")])),_:1})]),Ks,r("h5",Gs,[c("用户注册使用邮箱验证策略执行处理器 "),p(tl,{class:"header-anchor",href:"#用户注册使用邮箱验证策略执行处理器","aria-hidden":"true"},{default:n((()=>[c("#")])),_:1})]),Qs,r("h5",$s,[c("用户登录使用邮箱验证策略执行处理器 "),p(tl,{class:"header-anchor",href:"#用户登录使用邮箱验证策略执行处理器","aria-hidden":"true"},{default:n((()=>[c("#")])),_:1})]),zs,r("h5",Ys,[c("C 端用户接口选择并执行具体策略处理器 "),p(tl,{class:"header-anchor",href:"#c-端用户接口选择并执行具体策略处理器","aria-hidden":"true"},{default:n((()=>[c("#")])),_:1})]),Js,Zs,Ws,r("h2",Xs,[c("文末总结 "),p(tl,{class:"header-anchor",href:"#文末总结","aria-hidden":"true"},{default:n((()=>[c("#")])),_:1})]),sl,ll,ol,el,nl,al])),"main-header":n((()=>[E(s.$slots,"main-header")])),"main-header-after":n((()=>[E(s.$slots,"main-header-after")])),"main-nav":n((()=>[E(s.$slots,"main-nav")])),"main-content":n((()=>[E(s.$slots,"main-content")])),"main-content-after":n((()=>[E(s.$slots,"main-content-after")])),"main-nav-before":n((()=>[E(s.$slots,"main-nav-before")])),"main-nav-after":n((()=>[E(s.$slots,"main-nav-after")])),comment:n((()=>[E(s.$slots,"comment")])),footer:n((()=>[E(s.$slots,"footer")])),aside:n((()=>[E(s.$slots,"aside")])),"aside-custom":n((()=>[E(s.$slots,"aside-custom")])),default:n((()=>[E(s.$slots,"default")])),_:3},8,["frontmatter","data"])}]]);export{i as __pageData,tl as default};
