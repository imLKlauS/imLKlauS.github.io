var ye=Object.defineProperty;var le=Object.getOwnPropertySymbols;var Se=Object.prototype.hasOwnProperty,ve=Object.prototype.propertyIsEnumerable;var re=(a,e,n)=>e in a?ye(a,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[e]=n,U=(a,e)=>{for(var n in e||(e={}))Se.call(e,n)&&re(a,n,e[n]);if(le)for(var n of le(e))ve.call(e,n)&&re(a,n,e[n]);return a};var se=(a,e,n)=>new Promise((l,o)=>{var c=u=>{try{p(n.next(u))}catch(s){o(s)}},d=u=>{try{p(n.throw(u))}catch(s){o(s)}},p=u=>u.done?l(u.value):Promise.resolve(u.value).then(c,d);p((n=n.apply(a,e)).next())});import{_ as C,F as ie,G as oe,K as xe,e as be,l as Q,aZ as P,d as Y,b as we,a as Ce,q as Te,t as Le,g as $e,s as Ae,H as Fe,a_ as ke,z as Ne}from"./mermaid.core.D2zM9SEG.js";import{s as Me}from"./chunk-QN33PNHL.DnCRU57T.js";import{p as _e}from"./chunk-4BX2VUAB.Dd5jMATZ.js";import{p as ze}from"./treemap-KMMF4GRG.DvKfTcus.js";import{b as O}from"./defaultLocale.C4B-KCzX.js";import{o as J}from"./ordinal.BYWQX77i.js";import"./framework.CyQERZzy.js";import"./chunks/dayjs.BSMtxqtT.js";import"./_baseUniq.cWSKQw2E.js";import"./_basePickBy.C0jAyh0h.js";import"./clone.C7w96FSo.js";import"./init.Gi6I4Gst.js";function Ve(a){var e=0,n=a.children,l=n&&n.length;if(!l)e=1;else for(;--l>=0;)e+=n[l].value;a.value=e}function De(){return this.eachAfter(Ve)}function Pe(a,e){let n=-1;for(const l of this)a.call(e,l,++n,this);return this}function Be(a,e){for(var n=this,l=[n],o,c,d=-1;n=l.pop();)if(a.call(e,n,++d,this),o=n.children)for(c=o.length-1;c>=0;--c)l.push(o[c]);return this}function Re(a,e){for(var n=this,l=[n],o=[],c,d,p,u=-1;n=l.pop();)if(o.push(n),c=n.children)for(d=0,p=c.length;d<p;++d)l.push(c[d]);for(;n=o.pop();)a.call(e,n,++u,this);return this}function Ee(a,e){let n=-1;for(const l of this)if(a.call(e,l,++n,this))return l}function We(a){return this.eachAfter(function(e){for(var n=+a(e.data)||0,l=e.children,o=l&&l.length;--o>=0;)n+=l[o].value;e.value=n})}function He(a){return this.eachBefore(function(e){e.children&&e.children.sort(a)})}function Ie(a){for(var e=this,n=Oe(e,a),l=[e];e!==n;)e=e.parent,l.push(e);for(var o=l.length;a!==n;)l.splice(o,0,a),a=a.parent;return l}function Oe(a,e){if(a===e)return a;var n=a.ancestors(),l=e.ancestors(),o=null;for(a=n.pop(),e=l.pop();a===e;)o=a,a=n.pop(),e=l.pop();return o}function Ge(){for(var a=this,e=[a];a=a.parent;)e.push(a);return e}function qe(){return Array.from(this)}function Xe(){var a=[];return this.eachBefore(function(e){e.children||a.push(e)}),a}function je(){var a=this,e=[];return a.each(function(n){n!==a&&e.push({source:n.parent,target:n})}),e}function*Ye(){var a=this,e,n=[a],l,o,c;do for(e=n.reverse(),n=[];a=e.pop();)if(yield a,l=a.children)for(o=0,c=l.length;o<c;++o)n.push(l[o]);while(n.length)}function ee(a,e){a instanceof Map?(a=[void 0,a],e===void 0&&(e=Ue)):e===void 0&&(e=Ke);for(var n=new Z(a),l,o=[n],c,d,p,u;l=o.pop();)if((d=e(l.data))&&(u=(d=Array.from(d)).length))for(l.children=d,p=u-1;p>=0;--p)o.push(c=d[p]=new Z(d[p])),c.parent=l,c.depth=l.depth+1;return n.eachBefore(Qe)}function Ze(){return ee(this).eachBefore(Je)}function Ke(a){return a.children}function Ue(a){return Array.isArray(a)?a[1]:null}function Je(a){a.data.value!==void 0&&(a.value=a.data.value),a.data=a.data.data}function Qe(a){var e=0;do a.height=e;while((a=a.parent)&&a.height<++e)}function Z(a){this.data=a,this.depth=this.height=0,this.parent=null}Z.prototype=ee.prototype={constructor:Z,count:De,each:Pe,eachAfter:Re,eachBefore:Be,find:Ee,sum:We,sort:He,path:Ie,ancestors:Ge,descendants:qe,leaves:Xe,links:je,copy:Ze,[Symbol.iterator]:Ye};function et(a){if(typeof a!="function")throw new Error;return a}function G(){return 0}function q(a){return function(){return a}}function tt(a){a.x0=Math.round(a.x0),a.y0=Math.round(a.y0),a.x1=Math.round(a.x1),a.y1=Math.round(a.y1)}function at(a,e,n,l,o){for(var c=a.children,d,p=-1,u=c.length,s=a.value&&(l-e)/a.value;++p<u;)d=c[p],d.y0=n,d.y1=o,d.x0=e,d.x1=e+=d.value*s}function nt(a,e,n,l,o){for(var c=a.children,d,p=-1,u=c.length,s=a.value&&(o-n)/a.value;++p<u;)d=c[p],d.x0=e,d.x1=l,d.y0=n,d.y1=n+=d.value*s}var lt=(1+Math.sqrt(5))/2;function rt(a,e,n,l,o,c){for(var d=[],p=e.children,u,s,h=0,m=0,r=p.length,y,S,v=e.value,f,x,N,k,V,E,M;h<r;){y=o-n,S=c-l;do f=p[m++].value;while(!f&&m<r);for(x=N=f,E=Math.max(S/y,y/S)/(v*a),M=f*f*E,V=Math.max(N/M,M/x);m<r;++m){if(f+=s=p[m].value,s<x&&(x=s),s>N&&(N=s),M=f*f*E,k=Math.max(N/M,M/x),k>V){f-=s;break}V=k}d.push(u={value:f,dice:y<S,children:p.slice(h,m)}),u.dice?at(u,n,l,o,v?l+=S*f/v:c):nt(u,n,l,v?n+=y*f/v:o,c),v-=f,h=m}return d}const st=(function a(e){function n(l,o,c,d,p){rt(e,l,o,c,d,p)}return n.ratio=function(l){return a((l=+l)>1?l:1)},n})(lt);function it(){var a=st,e=!1,n=1,l=1,o=[0],c=G,d=G,p=G,u=G,s=G;function h(r){return r.x0=r.y0=0,r.x1=n,r.y1=l,r.eachBefore(m),o=[0],e&&r.eachBefore(tt),r}function m(r){var y=o[r.depth],S=r.x0+y,v=r.y0+y,f=r.x1-y,x=r.y1-y;f<S&&(S=f=(S+f)/2),x<v&&(v=x=(v+x)/2),r.x0=S,r.y0=v,r.x1=f,r.y1=x,r.children&&(y=o[r.depth+1]=c(r)/2,S+=s(r)-y,v+=d(r)-y,f-=p(r)-y,x-=u(r)-y,f<S&&(S=f=(S+f)/2),x<v&&(v=x=(v+x)/2),a(r,S,v,f,x))}return h.round=function(r){return arguments.length?(e=!!r,h):e},h.size=function(r){return arguments.length?(n=+r[0],l=+r[1],h):[n,l]},h.tile=function(r){return arguments.length?(a=et(r),h):a},h.padding=function(r){return arguments.length?h.paddingInner(r).paddingOuter(r):h.paddingInner()},h.paddingInner=function(r){return arguments.length?(c=typeof r=="function"?r:q(+r),h):c},h.paddingOuter=function(r){return arguments.length?h.paddingTop(r).paddingRight(r).paddingBottom(r).paddingLeft(r):h.paddingTop()},h.paddingTop=function(r){return arguments.length?(d=typeof r=="function"?r:q(+r),h):d},h.paddingRight=function(r){return arguments.length?(p=typeof r=="function"?r:q(+r),h):p},h.paddingBottom=function(r){return arguments.length?(u=typeof r=="function"?r:q(+r),h):u},h.paddingLeft=function(r){return arguments.length?(s=typeof r=="function"?r:q(+r),h):s},h}var R,ce=(R=class{constructor(){this.nodes=[],this.levels=new Map,this.outerNodes=[],this.classes=new Map,this.setAccTitle=we,this.getAccTitle=Ce,this.setDiagramTitle=Te,this.getDiagramTitle=Le,this.getAccDescription=$e,this.setAccDescription=Ae}getNodes(){return this.nodes}getConfig(){var l;const e=Fe,n=oe();return ie(U(U({},e.treemap),(l=n.treemap)!=null?l:{}))}addNode(e,n){var l;this.nodes.push(e),this.levels.set(e,n),n===0&&(this.outerNodes.push(e),(l=this.root)!=null||(this.root=e))}getRoot(){return{name:"",children:this.outerNodes}}addClass(e,n){var c;const l=(c=this.classes.get(e))!=null?c:{id:e,styles:[],textStyles:[]},o=n.replace(/\\,/g,"§§§").replace(/,/g,";").replace(/§§§/g,",").split(";");o&&o.forEach(d=>{ke(d)&&(l!=null&&l.textStyles?l.textStyles.push(d):l.textStyles=[d]),l!=null&&l.styles?l.styles.push(d):l.styles=[d]}),this.classes.set(e,l)}getClasses(){return this.classes}getStylesForClass(e){var n,l;return(l=(n=this.classes.get(e))==null?void 0:n.styles)!=null?l:[]}clear(){Ne(),this.nodes=[],this.levels=new Map,this.outerNodes=[],this.classes=new Map,this.root=void 0}},C(R,"TreeMapDB"),R);function de(a){if(!a.length)return[];const e=[],n=[];return a.forEach(l=>{const o={name:l.name,children:l.type==="Leaf"?void 0:[]};for(o.classSelector=l==null?void 0:l.classSelector,l!=null&&l.cssCompiledStyles&&(o.cssCompiledStyles=[l.cssCompiledStyles]),l.type==="Leaf"&&l.value!==void 0&&(o.value=l.value);n.length>0&&n[n.length-1].level>=l.level;)n.pop();if(n.length===0)e.push(o);else{const c=n[n.length-1].node;c.children?c.children.push(o):c.children=[o]}l.type!=="Leaf"&&n.push({node:o,level:l.level})}),e}C(de,"buildHierarchy");var ot=C((a,e)=>{var c,d,p,u;_e(a,e);const n=[];for(const s of(c=a.TreemapRows)!=null?c:[])s.$type==="ClassDefStatement"&&e.addClass((d=s.className)!=null?d:"",(p=s.styleText)!=null?p:"");for(const s of(u=a.TreemapRows)!=null?u:[]){const h=s.item;if(!h)continue;const m=s.indent?parseInt(s.indent):0,r=ct(h),y=h.classSelector?e.getStylesForClass(h.classSelector):[],S=y.length>0?y.join(";"):void 0,v={level:m,name:r,type:h.$type,value:h.value,classSelector:h.classSelector,cssCompiledStyles:S};n.push(v)}const l=de(n),o=C((s,h)=>{for(const m of s)e.addNode(m,h),m.children&&m.children.length>0&&o(m.children,h+1)},"addNodesRecursively");o(l,0)},"populate"),ct=C(a=>a.name?String(a.name):"","getItemName"),he={parser:{yy:void 0},parse:C(a=>se(null,null,function*(){var e;try{const l=yield ze("treemap",a);Q.debug("Treemap AST:",l);const o=(e=he.parser)==null?void 0:e.yy;if(!(o instanceof ce))throw new Error("parser.parser?.yy was not a TreemapDB. This is due to a bug within Mermaid, please report this issue at https://github.com/mermaid-js/mermaid/issues.");ot(l,o)}catch(n){throw Q.error("Error parsing treemap:",n),n}}),"parse")},dt=10,B=10,X=25,ht=C((a,e,n,l)=>{var ae,ne;const o=l.db,c=o.getConfig(),d=(ae=c.padding)!=null?ae:dt,p=o.getDiagramTitle(),u=o.getRoot(),{themeVariables:s}=oe();if(!u)return;const h=p?30:0,m=xe(e),r=c.nodeWidth?c.nodeWidth*B:960,y=c.nodeHeight?c.nodeHeight*B:500,S=r,v=y+h;m.attr("viewBox",`0 0 ${S} ${v}`),be(m,v,S,c.useMaxWidth);let f;try{const t=c.valueFormat||",";if(t==="$0,0")f=C(i=>"$"+O(",")(i),"valueFormat");else if(t.startsWith("$")&&t.includes(",")){const i=/\.\d+/.exec(t),g=i?i[0]:"";f=C(w=>"$"+O(","+g)(w),"valueFormat")}else if(t.startsWith("$")){const i=t.substring(1);f=C(g=>"$"+O(i||"")(g),"valueFormat")}else f=O(t)}catch(t){Q.error("Error creating format function:",t),f=O(",")}const x=J().range(["transparent",s.cScale0,s.cScale1,s.cScale2,s.cScale3,s.cScale4,s.cScale5,s.cScale6,s.cScale7,s.cScale8,s.cScale9,s.cScale10,s.cScale11]),N=J().range(["transparent",s.cScalePeer0,s.cScalePeer1,s.cScalePeer2,s.cScalePeer3,s.cScalePeer4,s.cScalePeer5,s.cScalePeer6,s.cScalePeer7,s.cScalePeer8,s.cScalePeer9,s.cScalePeer10,s.cScalePeer11]),k=J().range([s.cScaleLabel0,s.cScaleLabel1,s.cScaleLabel2,s.cScaleLabel3,s.cScaleLabel4,s.cScaleLabel5,s.cScaleLabel6,s.cScaleLabel7,s.cScaleLabel8,s.cScaleLabel9,s.cScaleLabel10,s.cScaleLabel11]);p&&m.append("text").attr("x",S/2).attr("y",h/2).attr("class","treemapTitle").attr("text-anchor","middle").attr("dominant-baseline","middle").text(p);const V=m.append("g").attr("transform",`translate(0, ${h})`).attr("class","treemapContainer"),E=ee(u).sum(t=>{var i;return(i=t.value)!=null?i:0}).sort((t,i)=>{var g,w;return((g=i.value)!=null?g:0)-((w=t.value)!=null?w:0)}),te=it().size([r,y]).paddingTop(t=>t.children&&t.children.length>0?X+B:0).paddingInner(d).paddingLeft(t=>t.children&&t.children.length>0?B:0).paddingRight(t=>t.children&&t.children.length>0?B:0).paddingBottom(t=>t.children&&t.children.length>0?B:0).round(!0)(E),pe=te.descendants().filter(t=>t.children&&t.children.length>0),W=V.selectAll(".treemapSection").data(pe).enter().append("g").attr("class","treemapSection").attr("transform",t=>`translate(${t.x0},${t.y0})`);W.append("rect").attr("width",t=>t.x1-t.x0).attr("height",X).attr("class","treemapSectionHeader").attr("fill","none").attr("fill-opacity",.6).attr("stroke-width",.6).attr("style",t=>t.depth===0?"display: none;":""),W.append("clipPath").attr("id",(t,i)=>`clip-section-${e}-${i}`).append("rect").attr("width",t=>Math.max(0,t.x1-t.x0-12)).attr("height",X),W.append("rect").attr("width",t=>t.x1-t.x0).attr("height",t=>t.y1-t.y0).attr("class",(t,i)=>`treemapSection section${i}`).attr("fill",t=>x(t.data.name)).attr("fill-opacity",.6).attr("stroke",t=>N(t.data.name)).attr("stroke-width",2).attr("stroke-opacity",.4).attr("style",t=>{if(t.depth===0)return"display: none;";const i=P({cssCompiledStyles:t.data.cssCompiledStyles});return i.nodeStyles+";"+i.borderStyles.join(";")}),W.append("text").attr("class","treemapSectionLabel").attr("x",6).attr("y",X/2).attr("dominant-baseline","middle").text(t=>t.depth===0?"":t.data.name).attr("font-weight","bold").attr("style",t=>{if(t.depth===0)return"display: none;";const i="dominant-baseline: middle; font-size: 12px; fill:"+k(t.data.name)+"; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;",g=P({cssCompiledStyles:t.data.cssCompiledStyles});return i+g.labelStyles.replace("color:","fill:")}).each(function(t){if(t.depth===0)return;const i=Y(this),g=t.data.name;i.text(g);const w=t.x1-t.x0,L=6;let $;c.showValues!==!1&&t.value?$=w-10-30-10-L:$=w-L-6;const A=Math.max(15,$),b=i.node();if(b.getComputedTextLength()>A){let T=g;for(;T.length>0;){if(T=g.substring(0,T.length-1),T.length===0){i.text("..."),b.getComputedTextLength()>A&&i.text("");break}if(i.text(T+"..."),b.getComputedTextLength()<=A)break}}}),c.showValues!==!1&&W.append("text").attr("class","treemapSectionValue").attr("x",t=>t.x1-t.x0-10).attr("y",X/2).attr("text-anchor","end").attr("dominant-baseline","middle").text(t=>t.value?f(t.value):"").attr("font-style","italic").attr("style",t=>{if(t.depth===0)return"display: none;";const i="text-anchor: end; dominant-baseline: middle; font-size: 10px; fill:"+k(t.data.name)+"; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;",g=P({cssCompiledStyles:t.data.cssCompiledStyles});return i+g.labelStyles.replace("color:","fill:")});const ue=te.leaves(),j=V.selectAll(".treemapLeafGroup").data(ue).enter().append("g").attr("class",(t,i)=>`treemapNode treemapLeafGroup leaf${i}${t.data.classSelector?` ${t.data.classSelector}`:""}x`).attr("transform",t=>`translate(${t.x0},${t.y0})`);j.append("rect").attr("width",t=>t.x1-t.x0).attr("height",t=>t.y1-t.y0).attr("class","treemapLeaf").attr("fill",t=>t.parent?x(t.parent.data.name):x(t.data.name)).attr("style",t=>P({cssCompiledStyles:t.data.cssCompiledStyles}).nodeStyles).attr("fill-opacity",.3).attr("stroke",t=>t.parent?x(t.parent.data.name):x(t.data.name)).attr("stroke-width",3),j.append("clipPath").attr("id",(t,i)=>`clip-${e}-${i}`).append("rect").attr("width",t=>Math.max(0,t.x1-t.x0-4)).attr("height",t=>Math.max(0,t.y1-t.y0-4)),j.append("text").attr("class","treemapLabel").attr("x",t=>(t.x1-t.x0)/2).attr("y",t=>(t.y1-t.y0)/2).attr("style",t=>{const i="text-anchor: middle; dominant-baseline: middle; font-size: 38px;fill:"+k(t.data.name)+";",g=P({cssCompiledStyles:t.data.cssCompiledStyles});return i+g.labelStyles.replace("color:","fill:")}).attr("clip-path",(t,i)=>`url(#clip-${e}-${i})`).text(t=>t.data.name).each(function(t){const i=Y(this),g=t.x1-t.x0,w=t.y1-t.y0,L=i.node(),$=4,D=g-2*$,A=w-2*$;if(D<10||A<10){i.style("display","none");return}let b=parseInt(i.style("font-size"),10);const _=8,F=28,T=.6,z=6,H=2;for(;L.getComputedTextLength()>D&&b>_;)b--,i.style("font-size",`${b}px`);let I=Math.max(z,Math.min(F,Math.round(b*T))),K=b+H+I;for(;K>A&&b>_&&(b--,I=Math.max(z,Math.min(F,Math.round(b*T))),!(I<z&&b===_));)i.style("font-size",`${b}px`),K=b+H+I;i.style("font-size",`${b}px`),(L.getComputedTextLength()>D||b<_||A<b)&&i.style("display","none")}),c.showValues!==!1&&j.append("text").attr("class","treemapValue").attr("x",i=>(i.x1-i.x0)/2).attr("y",function(i){return(i.y1-i.y0)/2}).attr("style",i=>{const g="text-anchor: middle; dominant-baseline: hanging; font-size: 28px;fill:"+k(i.data.name)+";",w=P({cssCompiledStyles:i.data.cssCompiledStyles});return g+w.labelStyles.replace("color:","fill:")}).attr("clip-path",(i,g)=>`url(#clip-${e}-${g})`).text(i=>i.value?f(i.value):"").each(function(i){const g=Y(this),w=this.parentNode;if(!w){g.style("display","none");return}const L=Y(w).select(".treemapLabel");if(L.empty()||L.style("display")==="none"){g.style("display","none");return}const $=parseFloat(L.style("font-size")),D=28,A=.6,b=6,_=2,F=Math.max(b,Math.min(D,Math.round($*A)));g.style("font-size",`${F}px`);const z=(i.y1-i.y0)/2+$/2+_;g.attr("y",z);const H=i.x1-i.x0,ge=i.y1-i.y0-4,me=H-8;g.node().getComputedTextLength()>me||z+F>ge||F<b?g.style("display","none"):g.style("display",null)});const fe=(ne=c.diagramPadding)!=null?ne:8;Me(m,fe,"flowchart",(c==null?void 0:c.useMaxWidth)||!1)},"draw"),pt=C(function(a,e){return e.db.getClasses()},"getClasses"),ut={draw:ht,getClasses:pt},ft={sectionStrokeColor:"black",sectionStrokeWidth:"1",sectionFillColor:"#efefef",leafStrokeColor:"black",leafStrokeWidth:"1",leafFillColor:"#efefef",labelColor:"black",labelFontSize:"12px",valueFontSize:"10px",valueColor:"black",titleColor:"black",titleFontSize:"14px"},gt=C(({treemap:a}={})=>{const e=ie(ft,a);return`
  .treemapNode.section {
    stroke: ${e.sectionStrokeColor};
    stroke-width: ${e.sectionStrokeWidth};
    fill: ${e.sectionFillColor};
  }
  .treemapNode.leaf {
    stroke: ${e.leafStrokeColor};
    stroke-width: ${e.leafStrokeWidth};
    fill: ${e.leafFillColor};
  }
  .treemapLabel {
    fill: ${e.labelColor};
    font-size: ${e.labelFontSize};
  }
  .treemapValue {
    fill: ${e.valueColor};
    font-size: ${e.valueFontSize};
  }
  .treemapTitle {
    fill: ${e.titleColor};
    font-size: ${e.titleFontSize};
  }
  `},"getStyles"),mt=gt,Mt={parser:he,get db(){return new ce},renderer:ut,styles:mt};export{Mt as diagram};
