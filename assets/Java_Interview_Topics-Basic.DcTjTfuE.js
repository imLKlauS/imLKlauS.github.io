import{_ as s}from"./ValaxyMain.vue_vue_type_style_index_0_lang.BQZP6ubc.js";import{f as i,a as l,u as a}from"./chunks/vue-router.egQIxMkS.js";import{O as n,a0 as t,R as e,S as h,W as g,X as k,u as r,P as p,D as d}from"./framework.BHkQnU1p.js";import"./app.Z41ah3yz.js";import"./chunks/dayjs.CORIJbU0.js";import"./chunks/vue-i18n.CvY6KzGi.js";import"./chunks/nprogress.BHm3HSQC.js";import"./chunks/pinia.BY9HMtis.js";import"./chunks/@vueuse/motion.CUAOwWQQ.js";import"./YunComment.vue_vue_type_style_index_0_lang.C97RJbSL.js";import"./index.TQnGKZgq.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang.De5tC3Nd.js";import"./post.B3-J4xWS.js";const c=i("/posts/Java_Interview_Topics-Basic",(async s=>JSON.parse('{"title":"Java面试专题-基础篇","description":"","frontmatter":{"cover":"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/four_saber_page02.png","title":"Java面试专题-基础篇","date":"2023-4-18 14:52:05","categories":["Java","面试"],"tags":["ArrayList","LinkedList","HashMap","Hashtable","Singleton"],"top":121,"outline":"deep","excerpt_type":"html","end":false},"headers":[{"level":2,"title":"1. ArrayList","slug":"_1-arraylist","link":"#_1-arraylist","children":[{"level":3,"title":"补充","slug":"补充","link":"#补充","children":[]}]},{"level":2,"title":"2. Iterator","slug":"_2-iterator","link":"#_2-iterator","children":[]},{"level":2,"title":"3. LinkedList VS ArrayList","slug":"_3-linkedlist-vs-arraylist","link":"#_3-linkedlist-vs-arraylist","children":[]},{"level":2,"title":"4. HashMap","slug":"_4-hashmap","link":"#_4-hashmap","children":[{"level":3,"title":"1）基本数据结构","slug":"_1-基本数据结构","link":"#_1-基本数据结构","children":[]},{"level":3,"title":"2）树化与退化","slug":"_2-树化与退化","link":"#_2-树化与退化","children":[]},{"level":3,"title":"3）索引计算","slug":"_3-索引计算","link":"#_3-索引计算","children":[]},{"level":3,"title":"4）put 与扩容","slug":"_4-put-与扩容","link":"#_4-put-与扩容","children":[]},{"level":3,"title":"5）并发问题","slug":"_5-并发问题","link":"#_5-并发问题","children":[]},{"level":3,"title":"6）key 的设计","slug":"_6-key-的设计","link":"#_6-key-的设计","children":[]}]},{"level":2,"title":"4.1. HashMap-快速查找","slug":"_4-1-hashmap-快速查找","link":"#_4-1-hashmap-快速查找","children":[]},{"level":2,"title":"4.2. HashMap-链表过长的解决方案","slug":"_4-2-hashmap-链表过长的解决方案","link":"#_4-2-hashmap-链表过长的解决方案","children":[{"level":3,"title":"4.2.1.扩容","slug":"_4-2-1-扩容","link":"#_4-2-1-扩容","children":[]},{"level":3,"title":"4.2.2. 树化","slug":"_4-2-2-树化","link":"#_4-2-2-树化","children":[]}]},{"level":2,"title":"5. 单例模式","slug":"_5-单例模式","link":"#_5-单例模式","children":[{"level":3,"title":"饿汉式","slug":"饿汉式","link":"#饿汉式","children":[]},{"level":3,"title":"枚举饿汉式","slug":"枚举饿汉式","link":"#枚举饿汉式","children":[]},{"level":3,"title":"懒汉式","slug":"懒汉式","link":"#懒汉式","children":[]},{"level":3,"title":"双检锁懒汉式","slug":"双检锁懒汉式","link":"#双检锁懒汉式","children":[]},{"level":3,"title":"内部类懒汉式","slug":"内部类懒汉式","link":"#内部类懒汉式","children":[]},{"level":3,"title":"JDK 中单例的体现","slug":"jdk-中单例的体现","link":"#jdk-中单例的体现","children":[]}]}],"relativePath":"pages/posts/Java_Interview_Topics-Basic.md","lastUpdated":null}')),{lazy:(s,i)=>s.name===i.name}),u={__name:"Java_Interview_Topics-Basic",setup(i,{expose:u}){var y;const{data:m}=c(),o=a(),E=l(),F=Object.assign(E.meta.frontmatter||{},(null==(y=m.value)?void 0:y.frontmatter)||{});E.meta.frontmatter=F,o.currentRoute.value.data=m.value,d("valaxy:frontmatter",F),globalThis.$frontmatter=F;return u({frontmatter:{cover:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/four_saber_page02.png",title:"Java面试专题-基础篇",date:"2023-4-18 14:52:05",categories:["Java","面试"],tags:["ArrayList","LinkedList","HashMap","Hashtable","Singleton"],top:121,outline:"deep",excerpt_type:"html",end:!1}}),(i,l)=>{const a=s;return p(),n(a,{frontmatter:r(F)},{"main-content-md":t((()=>[l[0]||(l[0]=h("p",null,[k("参考视频："),h("a",{href:"https://www.bilibili.com/video/BV15b4y117RJ",target:"_blank",rel:"noreferrer"},"满神Java面试专题")],-1)),l[1]||(l[1]=h("p",null,"笔记的整体结构依据视频编写，并随着学习的深入补充了很多知识",-1)),g(" more "),l[2]||(l[2]=h("h2",{id:"_1-arraylist",tabindex:"-1"},[k("1. ArrayList "),h("a",{class:"header-anchor",href:"#_1-arraylist","aria-label":'Permalink to "1. ArrayList"'},"​")],-1)),l[3]||(l[3]=h("p",null,[h("strong",null,"要求")],-1)),l[4]||(l[4]=h("ul",null,[h("li",null,"掌握 ArrayList 扩容规则")],-1)),l[5]||(l[5]=h("p",null,[h("strong",null,"扩容规则")],-1)),l[6]||(l[6]=h("ol",null,[h("li",null,[h("strong",null,"ArrayList()"),k(" 会使用"),h("strong",null,"长度为零"),k("的数组")])],-1)),l[7]||(l[7]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418114304421.png",alt:"image-20230418114304421",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[8]||(l[8]=h("ol",{start:"2"},[h("li",null,[h("strong",null,"ArrayList(int initialCapacity)"),k(" 会使用"),h("strong",null,"指定容量"),k("的数组")])],-1)),l[9]||(l[9]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418114403174.png",alt:"image-20230418114403174",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[10]||(l[10]=h("ol",{start:"3"},[h("li",null,"public ArrayList(Collection<? extends E> c) 会使用 c 的大小作为数组容量")],-1)),l[11]||(l[11]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418114502997.png",alt:"image-20230418114502997",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[12]||(l[12]=h("ol",{start:"4"},[h("li",null,"add(Object o) 首次扩容为 10，再次扩容为上次容量的 1.5 倍")],-1)),l[13]||(l[13]=h("ul",null,[h("li",null,"第一次添加数组，数组为0，发生第一次扩容"),h("li",null,"第一个元素放入新数组索引0，新数组替换旧数组(首次为0)")],-1)),l[14]||(l[14]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418115017704.png",alt:"image-20230418115017704",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[15]||(l[15]=h("ul",null,[h("li",null,"再次扩容为上次容量的 1.5 倍，完成扩容并添加元素，新数组替换旧数组，旧数组没人引用就会被垃圾回收")],-1)),l[16]||(l[16]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418115545132.png",alt:"image-20230418115545132",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[17]||(l[17]=h("ul",null,[h("li",null,"以后扩容按上次容量+上次容量右移1位")],-1)),l[18]||(l[18]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418115811928.png",alt:"image-20230418115811928",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[19]||(l[19]=h("ul",null,[h("li",null,"此方式为调用的add方法得到的扩容结果")],-1)),l[20]||(l[20]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418120314176.png",alt:"image-20230418120314176",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[21]||(l[21]=h("ol",{start:"5"},[h("li",null,"addAll(Collection c) 没有元素时，扩容为 Math.max(10, 实际元素个数)，有元素时为 Math.max(原容量 1.5 倍, 实际元素个数)")],-1)),l[22]||(l[22]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418120611741.png",alt:"image-20230418120611741",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[23]||(l[23]=h("ul",null,[h("li",null,"第一次空数组扩容(元素个数<10)")],-1)),l[24]||(l[24]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418120727097.png",alt:"image-20230418120727097",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[25]||(l[25]=h("ul",null,[h("li",null,"第一次空数组扩容(10<元素个数<15，此时会拿当前元素个数与当前容量下次扩容的容量二者之间的较大值作为当前容量)")],-1)),l[26]||(l[26]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418121100137.png",alt:"image-20230418121100137",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[27]||(l[27]=h("ul",null,[h("li",null,"第一次非空数组扩容(规则一样)")],-1)),l[28]||(l[28]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418121501578.png",alt:"image-20230418121501578",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[29]||(l[29]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418121608015.png",alt:"image-20230418121608015",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[30]||(l[30]=h("p",null,"其中第 4 点必须知道，其它几点视个人情况而定",-1)),l[31]||(l[31]=h("p",null,[h("strong",null,"提示")],-1)),l[32]||(l[32]=h("ul",null,[h("li",null,[k("测试代码见 "),h("code",null,"day01.list.TestArrayList"),k(" ，这里不再列出")]),h("li",null,[k("要"),h("strong",null,"注意"),k("的是，示例中用反射方式来更直观地反映 ArrayList 的扩容特征，但从 JDK 9 由于模块化的影响，对反射做了较多限制，需要在运行测试代码时添加 VM 参数 "),h("code",null,"--add-opens java.base/java.util=ALL-UNNAMED"),k(" 方能运行通过，后面的例子都有相同问题")])],-1)),l[33]||(l[33]=h("blockquote",null,[h("p",null,[h("em",null,[h("strong",null,"代码说明")])]),h("ul",null,[h("li",null,"day01.list.TestArrayList#arrayListGrowRule 演示了 add(Object) 方法的扩容规则，输入参数 n 代表打印多少次扩容后的数组长度")])],-1)),l[34]||(l[34]=h("h3",{id:"补充",tabindex:"-1"},[k("补充 "),h("a",{class:"header-anchor",href:"#补充","aria-label":'Permalink to "补充"'},"​")],-1)),l[35]||(l[35]=h("blockquote",null,[h("p",null,[h("strong",null,"addAll扩容机制"),k("：添加元素后的元素个数与下一次扩容数作比较 0->10:3个->10,11->11;10->15:13->15,16->16")])],-1)),l[36]||(l[36]=h("h2",{id:"_2-iterator",tabindex:"-1"},[k("2. Iterator "),h("a",{class:"header-anchor",href:"#_2-iterator","aria-label":'Permalink to "2. Iterator"'},"​")],-1)),l[37]||(l[37]=h("p",null,[h("strong",null,"要求")],-1)),l[38]||(l[38]=h("ul",null,[h("li",null,"掌握什么是 Fail-Fast、什么是 Fail-Safe")],-1)),l[39]||(l[39]=h("p",null,"Fail-Fast 与 Fail-Safe",-1)),l[40]||(l[40]=h("ul",null,[h("li",null,"ArrayList 是 fail-fast 的典型代表，遍历的同时不能修改，尽快失败"),h("li",null,"fail-fast 一旦发现遍历的同时其它人来修改，则立刻抛异常")],-1)),l[41]||(l[41]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418133457466.png",alt:"image-20230418133457466",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[42]||(l[42]=h("ul",null,[h("li",null,"fail-fast实现原理")],-1)),l[43]||(l[43]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418135557765.png",alt:"image-20230418135557765",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[44]||(l[44]=h("ul",null,[h("li",null,"CopyOnWriteArrayList 是 fail-safe 的典型代表，遍历的同时可以修改，原理是读写分离"),h("li",null,"fail-safe 发现遍历的同时其它人来修改，应当能有应对策略，例如牺牲一致性来让整个遍历运行完成")],-1)),l[45]||(l[45]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418133702722.png",alt:"image-20230418133702722",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[46]||(l[46]=h("ul",null,[h("li",null,"fail-safe实现原理")],-1)),l[47]||(l[47]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418142258054.png",alt:"image-20230418142258054",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[48]||(l[48]=h("p",null,[h("strong",null,"提示")],-1)),l[49]||(l[49]=h("ul",null,[h("li",null,[h("p",null,[k("测试代码见 "),h("code",null,"day01.list.FailFastVsFailSafe"),k("，这里不再列出")])]),h("li",null,[h("p",null,"第一次笔记："),h("ul",null,[h("li",null,[h("p",null,[h("strong",null,"fail-fast:")]),h("ul",null,[h("li",null,[h("p",null,"​ 1.调用迭代器Iterator构造方法并初始化成员变量")]),h("li",null,[h("p",null,"​ 2.检查：expectedModCount(迭代一开始记录的修改次数)与modCount(外面list的修改次数)做对比，不等则抛异常")])])]),h("li",null,[h("p",null,[h("strong",null,"fail-safe:")]),h("ul",null,[h("li",null,"​ list.add中每次调用add方法时都会把旧的数组拷贝一份，并让长度加一，把新加的元素放到扩容数组(新数组)最后一个位置，即添加和遍历的数组不同，互不干扰")])])])]),h("li",null,[h("p",null,"第二次笔记："),h("ul",null,[h("li",null,[h("p",null,[h("strong",null,"failfast"),k("：")]),h("ul",null,[h("li",null,"增强for循环开始前的修改次数（crud）modCount"),h("li",null,"expectedModCount初始值=modCount"),h("li",null,"每次遍历元素前（迭代）都检查以上的值是否相等，在遍历期间并发修改了，等遍历下个元素时就会抛出异常")])]),h("li",null,[h("p",null,[h("strong",null,"failsafe"),k("：")]),h("ul",null,[h("li",null,"iterator遍历集合，list.add方法每次添加元素，都会拷贝一份原集合并让容量加一，在并发修改时迭代器是不知道，遍历的还是原集合，即添加是一个集合，遍历是另一个集合")])])])])],-1)),l[50]||(l[50]=h("h2",{id:"_3-linkedlist-vs-arraylist",tabindex:"-1"},[k("3. LinkedList VS "),h("strong",null,"ArrayList"),k(),h("a",{class:"header-anchor",href:"#_3-linkedlist-vs-arraylist","aria-label":'Permalink to "3. LinkedList VS **ArrayList**"'},"​")],-1)),l[51]||(l[51]=h("p",null,[h("strong",null,"要求")],-1)),l[52]||(l[52]=h("ul",null,[h("li",null,"能够说清楚 LinkedList 对比 ArrayList 的区别，并重视纠正部分错误的认知")],-1)),l[53]||(l[53]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418144031416.png",alt:"image-20230418144031416",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[54]||(l[54]=h("ul",null,[h("li",null,"两者查询元素内容的时间复杂度都是O(n)，都不太适合用来查询，查询可以选择更高效的数据结构，如HashMap、TreeMap等")],-1)),l[55]||(l[55]=h("p",null,[h("strong",null,"LinkedList")],-1)),l[56]||(l[56]=h("ol",null,[h("li",null,"基于双向链表，无需连续内存")],-1)),l[57]||(l[57]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418143629513.png",alt:"image-20230418143629513",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[58]||(l[58]=h("ol",{start:"2"},[h("li",null,"随机访问慢（要沿着链表遍历）")],-1)),l[59]||(l[59]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418143509162.png",alt:"image-20230418143509162",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[60]||(l[60]=h("ol",{start:"3"},[h("li",null,"头尾插入删除性能高"),h("li",null,"占用内存多")],-1)),l[61]||(l[61]=h("p",null,[h("strong",null,"ArrayList")],-1)),l[62]||(l[62]=h("ol",null,[h("li",null,"基于数组，需要连续内存")],-1)),l[63]||(l[63]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418143617488.png",alt:"image-20230418143617488",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[64]||(l[64]=h("ol",{start:"2"},[h("li",null,"随机访问快（指根据下标访问）")],-1)),l[65]||(l[65]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418143527810.png",alt:"image-20230418143527810",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[66]||(l[66]=h("ol",{start:"3"},[h("li",null,"尾部插入、删除性能可以，其它部分插入、删除都会移动数据，因此性能会低")],-1)),l[67]||(l[67]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418144640481.png",alt:"image-20230418144640481",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[68]||(l[68]=h("ol",{start:"4"},[h("li",null,"可以利用 cpu 缓存，局部性原理（将读取变量和其相邻的变量也一次读到CPU缓存中）")],-1)),l[69]||(l[69]=h("blockquote",null,[h("p",null,[h("em",null,[h("strong",null,"代码说明")])]),h("ul",null,[h("li",null,"day01.list.ArrayListVsLinkedList#randomAccess 对比随机访问性能")]),h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418143722912.png",alt:"image-20230418143722912",loading:"lazy",decoding:"async",class:"lazy"})]),h("ul",null,[h("li",null,"day01.list.ArrayListVsLinkedList#addMiddle 对比向中间插入性能"),h("li",null,"day01.list.ArrayListVsLinkedList#addFirst 对比头部插入性能"),h("li",null,"day01.list.ArrayListVsLinkedList#addLast 对比尾部插入性能")]),h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418145338167.png",alt:"image-20230418145338167",loading:"lazy",decoding:"async",class:"lazy"})]),h("ul",null,[h("li",null,"day01.list.ArrayListVsLinkedList#linkedListSize 打印一个 LinkedList 占用内存"),h("li",null,"day01.list.ArrayListVsLinkedList#arrayListSize 打印一个 ArrayList 占用内存")]),h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418153454935.png",alt:"image-20230418153454935",loading:"lazy",decoding:"async",class:"lazy"})]),h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418150308326.png",alt:"image-20230418150308326",loading:"lazy",decoding:"async",class:"lazy"})]),h("ul",null,[h("li",null,[h("p",null,"CPU进行计算的数据还是来自内存中的，比如进行加法运算，首先将内存中a的变量的读取到CPU的寄存器中，然后将b的值读到另一个寄存器中，数据都有了就进行接下来的加法运算，计算后的结果也会写到内存中的c变量，这样就完成了一次加法运算的计算过程，在这个计算过程里瓶颈在于内存变量的读和写上，因为内存的读写效率是非常低的，读一次、写一次大约需要花几百纳秒，对于CPU来讲这个时间是非常漫长的，CPU执行一次计算是少于纳秒级别的，也许花了不到1纳秒就完成了，但等待数据读进来写出去就要花费成百倍的时间，显然是不可接受的；")]),h("li",null,[h("p",null,"因此需要在CPU与内存之间加入CPU缓存，这个缓存的读写性能就比内存高很多了，CPU缓存又分为1级、2级、3级缓存，速度快的能达到10纳秒，速度慢的也能到达几十纳秒，对比内存的几百纳秒就快了很多")])]),h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418151824705.png",alt:"image-20230418151824705",loading:"lazy",decoding:"async",class:"lazy"})]),h("ul",null,[h("li",null,[k("局部性原理 "),h("ul",null,[h("li",null,"往缓存中读数据时的一种规则，一种优化措施"),h("li",null,"将某个数据以及它相邻的数据都读取到缓存中，它会出于这样一种假设，当读取某个变量时，它相邻的变量也会有很大几率被访问到，即拿到某个元素后，有很大几率会遍历数组，即可以直接在缓存中遍历了，无需再到内存中遍历")])])]),h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418152143557.png",alt:"image-20230418152143557",loading:"lazy",decoding:"async",class:"lazy"})]),h("ul",null,[h("li",null,"链表的局部性原理就不可行，因为第一个元素与第二个元素相邻的有点远")]),h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418152725657.png",alt:"image-20230418152725657",loading:"lazy",decoding:"async",class:"lazy"})]),h("ul",null,[h("li",null,"CPU缓存的空间也是有限的，如果将2和3也读到缓存，就会把之前的数据清空掉了，因此链表就不能很好的配合CPU缓存(局部性原理)来提升性能")]),h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418152845212.png",alt:"image-20230418152845212",loading:"lazy",decoding:"async",class:"lazy"})])],-1)),l[70]||(l[70]=h("h2",{id:"_4-hashmap",tabindex:"-1"},[k("4. HashMap "),h("a",{class:"header-anchor",href:"#_4-hashmap","aria-label":'Permalink to "4. HashMap"'},"​")],-1)),l[71]||(l[71]=h("p",null,[h("strong",null,"要求")],-1)),l[72]||(l[72]=h("ul",null,[h("li",null,"掌握 HashMap 的基本数据结构"),h("li",null,"掌握树化"),h("li",null,"理解索引计算方法、二次 hash 的意义、容量对索引计算的影响"),h("li",null,"掌握 put 流程、扩容、扩容因子"),h("li",null,"理解并发使用 HashMap 可能导致的问题"),h("li",null,"理解 key 的设计")],-1)),l[73]||(l[73]=h("h3",{id:"_1-基本数据结构",tabindex:"-1"},[k("1）基本数据结构 "),h("a",{class:"header-anchor",href:"#_1-基本数据结构","aria-label":'Permalink to "1）基本数据结构"'},"​")],-1)),l[74]||(l[74]=h("ul",null,[h("li",null,"1.7 数组 + 链表"),h("li",null,"1.8 数组 + （链表 | 红黑树）")],-1)),l[75]||(l[75]=h("blockquote",null,[h("p",null,"更形象的演示，见资料中的 hash-demo.jar，运行需要 jdk14 以上环境，进入 jar 包目录，执行下面命令"),h("div",{style:{"max-height":"300px"},class:"language- vp-adaptive-theme"},[h("button",{title:"Copy Code",class:"copy"}),h("span",{class:"lang"}),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",null,"java -jar --add-exports java.base/jdk.internal.misc=ALL-UNNAMED hash-demo.jar")])])]),h("button",{class:"collapse"})])],-1)),l[76]||(l[76]=h("h3",{id:"_2-树化与退化",tabindex:"-1"},[k("2）树化与退化 "),h("a",{class:"header-anchor",href:"#_2-树化与退化","aria-label":'Permalink to "2）树化与退化"'},"​")],-1)),l[77]||(l[77]=h("p",null,[h("strong",null,"树化意义")],-1)),l[78]||(l[78]=h("ul",null,[h("li",null,"红黑树用来避免 DoS 攻击，防止链表超长时性能下降，树化应当是偶然情况，是保底策略"),h("li",null,[k("hash 表的查找，更新的时间复杂度是 "),h("span",{class:"katex"},[h("span",{class:"katex-mathml"},[h("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[h("semantics",null,[h("mrow",null,[h("mi",null,"O"),h("mo",{stretchy:"false"},"("),h("mn",null,"1"),h("mo",{stretchy:"false"},")")]),h("annotation",{encoding:"application/x-tex"},"O(1)")])])]),h("span",{class:"katex-html","aria-hidden":"true"},[h("span",{class:"base"},[h("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),h("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em"}},"O"),h("span",{class:"mopen"},"("),h("span",{class:"mord"},"1"),h("span",{class:"mclose"},")")])])]),k("，而红黑树的查找，更新的时间复杂度是 "),h("span",{class:"katex"},[h("span",{class:"katex-mathml"},[h("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[h("semantics",null,[h("mrow",null,[h("mi",null,"O"),h("mo",{stretchy:"false"},"("),h("mi",null,"l"),h("mi",null,"o"),h("msub",null,[h("mi",null,"g"),h("mn",null,"2")]),h("mi",null,"n"),h("mo",{stretchy:"false"},")")]),h("annotation",{encoding:"application/x-tex"},"O(log_2n)")])])]),h("span",{class:"katex-html","aria-hidden":"true"},[h("span",{class:"base"},[h("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),h("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em"}},"O"),h("span",{class:"mopen"},"("),h("span",{class:"mord mathnormal",style:{"margin-right":"0.01968em"}},"l"),h("span",{class:"mord mathnormal"},"o"),h("span",{class:"mord"},[h("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),h("span",{class:"msupsub"},[h("span",{class:"vlist-t vlist-t2"},[h("span",{class:"vlist-r"},[h("span",{class:"vlist",style:{height:"0.3011em"}},[h("span",{style:{top:"-2.55em","margin-left":"-0.0359em","margin-right":"0.05em"}},[h("span",{class:"pstrut",style:{height:"2.7em"}}),h("span",{class:"sizing reset-size6 size3 mtight"},[h("span",{class:"mord mtight"},"2")])])]),h("span",{class:"vlist-s"},"​")]),h("span",{class:"vlist-r"},[h("span",{class:"vlist",style:{height:"0.15em"}},[h("span")])])])])]),h("span",{class:"mord mathnormal"},"n"),h("span",{class:"mclose"},")")])])]),k(" ，TreeNode 占用空间也比普通 Node 的大，如非必要，尽量还是使用链表")]),h("li",null,"hash 值如果足够随机，则在 hash 表内按泊松分布，在负载因子 0.75 的情况下，长度超过 8 的链表出现概率是 0.00000006，树化阈值选择 8 就是为了让树化几率足够小")],-1)),l[79]||(l[79]=h("p",null,[h("strong",null,"树化规则")],-1)),l[80]||(l[80]=h("ul",null,[h("li",null,"当链表长度超过树化阈值 8 时，先尝试扩容来减少链表长度，如果数组容量已经 >=64，才会进行树化")],-1)),l[81]||(l[81]=h("p",null,[h("strong",null,"退化规则")],-1)),l[82]||(l[82]=h("ul",null,[h("li",null,"情况1：在扩容时如果拆分树时，树元素个数 <= 6 则会退化链表"),h("li",null,"情况2：remove 树节点时，若 root、root.left、root.right、root.left.left 有一个为 null ，也会退化为链表")],-1)),l[83]||(l[83]=h("h3",{id:"_3-索引计算",tabindex:"-1"},[k("3）索引计算 "),h("a",{class:"header-anchor",href:"#_3-索引计算","aria-label":'Permalink to "3）索引计算"'},"​")],-1)),l[84]||(l[84]=h("ul",null,[h("li",null,[h("p",null,"前置知识"),h("ul",null,[h("li",null,"与运算（&）")]),h("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[h("button",{title:"Copy Code",class:"copy"}),h("span",{class:"lang"},"java"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"参加运算的两个数据，按二进制位进行“与”运算。")]),k("\n"),h("span",{class:"line"}),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"运算规则："),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"&"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";   "),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"&"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";    "),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"&"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";     "),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"&"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),k("\n"),h("span",{class:"line"}),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"即：两位同时为“"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"”，结果才为“"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"”，否则为0")]),k("\n"),h("span",{class:"line"}),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"例如："),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"3"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"&"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"5"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  即 "),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0000"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0011"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," &"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0000"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0101"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0000"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0001"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"   因此，"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"3"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"&"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"5的值得1。")]),k("\n"),h("span",{class:"line"}),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"例如："),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"9"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"&"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"5"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  即 "),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0000"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 1001"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (9的二进制补码)"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"&"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"00000101"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (5的二进制补码) "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"00000001"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (1的二进制补码)可见9"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"&"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"5"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"。")])])]),h("button",{class:"collapse"})]),h("ul",null,[h("li",null,[h("p",null,"或运算（|）"),h("div",{style:{"max-height":"300px"},class:"language- vp-adaptive-theme"},[h("button",{title:"Copy Code",class:"copy"}),h("span",{class:"lang"}),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",null,"参加运算的两个对象，按二进制位进行“或”运算。")]),k("\n"),h("span",{class:"line"},[h("span")]),k("\n"),h("span",{class:"line"},[h("span",null,"运算规则：0|0=0；   0|1=1；   1|0=1；    1|1=1；")]),k("\n"),h("span",{class:"line"},[h("span")]),k("\n"),h("span",{class:"line"},[h("span",null,"即 ：参加运算的两个对象只要有一个为1，其值为1。")]),k("\n"),h("span",{class:"line"},[h("span")]),k("\n"),h("span",{class:"line"},[h("span",null,"例如:3|5　即 0000 0011 | 0000 0101 = 0000 0111   因此，3|5的值得7。　")]),k("\n"),h("span",{class:"line"},[h("span")]),k("\n"),h("span",{class:"line"},[h("span",null,"例如：9|5可写算式如下： 00001001|00000101 =00001101 (十进制为13)可见9|5=13")])])]),h("button",{class:"collapse"})])]),h("li",null,[h("p",null,"异或运算（^）")])]),h("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[h("button",{title:"Copy Code",class:"copy"}),h("span",{class:"lang"},"java"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"参加运算的两个数据，按二进制位进行“异或”运算。")]),k("\n"),h("span",{class:"line"}),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"运算规则："),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"^"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"；   "),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"^"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"；   "),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"^"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"；   "),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"^"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"；")]),k("\n"),h("span",{class:"line"}),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"即：参加运算的两个对象，如果两个相应位为“异”（值不同），则该位结果为1，否则为0。")]),k("\n"),h("span",{class:"line"}),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"例如："),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"9"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"^"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"5可写成算式如下： "),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"00001001"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"^"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"00000101"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"00001100"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (十进制为12)可见9"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"^"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"5"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"12")])])]),h("button",{class:"collapse"})]),h("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[h("button",{title:"Copy Code",class:"copy"}),h("span",{class:"lang"},"java"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 01010"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"10"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 10000"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"16"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 11010"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"26"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"----------"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"10"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"&"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"16"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"----------"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"26"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"&"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"16"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 16"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"newHash "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 16"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"10")])])]),h("button",{class:"collapse"})])])],-1)),l[85]||(l[85]=h("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[h("button",{title:"Copy Code",class:"copy"}),h("span",{class:"lang"},"java"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"8421码指的是四位二进制数，从0000"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"~"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1001"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"，分别代表十进制0"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"~"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"9"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"，其每位的权分别为$2"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"^"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"3$（"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"8"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"）、$2"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"^"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"2$（"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"4"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"）、$2"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"^"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"1$（"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"）、$2"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"^"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"0$（"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"）。除了8421码外，类似的还有5421码。")])])]),h("button",{class:"collapse"})],-1)),l[86]||(l[86]=h("ul",null,[h("li",null,"索引如何计算？hashCode都有了，为何还要提供hash()方法？数组容量为何是2的n次幂？")],-1)),l[87]||(l[87]=h("p",null,[h("strong",null,"索引计算方法"),k("（"),h("strong",null,"为了配合容量是 2 的 n 次幂的优化手段"),k(" ）")],-1)),l[88]||(l[88]=h("ul",null,[h("li",null,[h("p",null,"首先，计算对象的 hashCode()")]),h("li",null,[h("p",null,"再进行调用 HashMap 的 hash() 方法进行二次哈希"),h("ul",null,[h("li",null,[h("p",null,[k("二次 hash() 是为了综合高位数据，让哈希分布更为均匀；"),h("strong",null,"计算hashCode的值越随机，hashCode分布得越均匀，链表就越不会有过长的情况")]),h("ul",null,[h("li",null,"HashMap1.8二次hash")]),h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418201334955.png",alt:"image-20230418201334955",loading:"lazy",decoding:"async",class:"lazy"})]),h("ul",null,[h("li",null,"HashMap1.7二次hash")]),h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418201418625.png",alt:"image-20230418201418625",loading:"lazy",decoding:"async",class:"lazy"})])]),h("li",null,[h("p",null,"hashCode足够均匀")])]),h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418202517544.png",alt:"image-20230418202517544",loading:"lazy",decoding:"async",class:"lazy"})]),h("ul",null,[h("li",null,"hashCode选取不够好，不够随机")]),h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418202727603.png",alt:"image-20230418202727603",loading:"lazy",decoding:"async",class:"lazy"})]),h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418202829734.png",alt:"image-20230418202829734",loading:"lazy",decoding:"async",class:"lazy"})]),h("ul",null,[h("li",null,"进行二次hash扰动函数，使得hashCode分布更均匀，防止超长链表的产生")]),h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418203040744.png",alt:"image-20230418203040744",loading:"lazy",decoding:"async",class:"lazy"})]),h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418203513964.png",alt:"image-20230418203513964",loading:"lazy",decoding:"async",class:"lazy"})])]),h("li",null,[h("p",null,"最后 & (capacity – 1) 得到索引（容量capacity必须为2的n次幂）")])],-1)),l[89]||(l[89]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418195049973.png",alt:"image-20230418195049973",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[90]||(l[90]=h("p",null,[h("strong",null,"数组容量为何是 2 的 n 次幂")],-1)),l[91]||(l[91]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418195337120.png",alt:"image-20230418195337120",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[92]||(l[92]=h("ol",null,[h("li",null,"计算索引时效率更高：如果是 2 的 n 次幂可以使用位与运算代替取模"),h("li",null,"扩容时重新计算索引效率更高： hash & oldCap == 0 的元素留在原来位置 ，否则新位置 = 旧位置 + oldCap = 10 + 16")],-1)),l[93]||(l[93]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418204559461.png",alt:"image-20230418204559461",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[94]||(l[94]=h("p",null,[h("strong",null,"注意")],-1)),l[95]||(l[95]=h("ul",null,[h("li",null,[k("二次 hash 是为了配合 "),h("strong",null,"容量是 2 的 n 次幂"),k(" 这一设计前提，如果 hash 表的容量不是 2 的 n 次幂，则不必二次 hash，即想要更好的hash分布性，容量值就选择质数")])],-1)),l[96]||(l[96]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418210235261.png",alt:"image-20230418210235261",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[97]||(l[97]=h("ul",null,[h("li",null,[h("strong",null,"容量是 2 的 n 次幂"),k(" 这一设计计算索引效率更好（追求性能），但 hash 的分散性就不好，需要二次 hash 来作为补偿，没有采用这一设计的典型例子是 Hashtable，以下为 Hashtable 的扩容规律")])],-1)),l[98]||(l[98]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418210834027.png",alt:"image-20230418210834027",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[99]||(l[99]=h("h3",{id:"_4-put-与扩容",tabindex:"-1"},[k("4）put 与扩容 "),h("a",{class:"header-anchor",href:"#_4-put-与扩容","aria-label":'Permalink to "4）put 与扩容"'},"​")],-1)),l[100]||(l[100]=h("p",null,[h("strong",null,"put 流程")],-1)),l[101]||(l[101]=h("ul",null,[h("li",null,"1.8put流程")],-1)),l[102]||(l[102]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419110228837.png",alt:"image-20230419110228837",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[103]||(l[103]=h("ol",null,[h("li",null,"HashMap 是懒惰创建数组的，首次使用才创建数组"),h("li",null,"计算索引（桶下标）"),h("li",null,"如果桶下标还没人占用，创建 Node 占位返回"),h("li",null,[k("如果桶下标已经有人占用 "),h("ol",null,[h("li",null,"已经是 TreeNode 走红黑树的添加或更新逻辑"),h("li",null,"是普通 Node，走链表的添加或更新逻辑，如果链表长度超过树化阈值，走树化逻辑")])]),h("li",null,"返回前检查容量是否超过阈值，一旦超过进行扩容")],-1)),l[104]||(l[104]=h("p",null,[h("strong",null,"1.7 与 1.8 的区别")],-1)),l[105]||(l[105]=h("ol",null,[h("li",null,[h("p",null,"链表插入节点时"),h("ol",null,[h("li",null,"1.7 是头插法")]),h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419110745737.png",alt:"image-20230419110745737",loading:"lazy",decoding:"async",class:"lazy"})]),h("ol",{start:"2"},[h("li",null,"1.8 是尾插法")]),h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419110538952.png",alt:"image-20230419110538952",loading:"lazy",decoding:"async",class:"lazy"})])]),h("li",null,[h("p",null,"1.7 是大于等于阈值且没有空位时才扩容"),h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419112014919.png",alt:"image-20230419112014919",loading:"lazy",decoding:"async",class:"lazy"})])]),h("li",null,[h("p",null,"而 1.8 是大于阈值就扩容")]),h("li",null,[h("p",null,"1.8 在扩容计算 Node 索引时，会优化"),h("ul",null,[h("li",null,"hash & oldCap == 0 的元素留在原来位置 ，否则新位置 = 旧位置 + oldCap = 10 + 16")])])],-1)),l[106]||(l[106]=h("p",null,[h("strong",null,"扩容（加载）因子为何默认是 0.75f")],-1)),l[107]||(l[107]=h("ol",null,[h("li",null,[h("p",null,"在空间占用与查询时间之间取得较好的权衡")]),h("li",null,[h("p",null,"大于这个值，空间节省了，但链表就会比较长影响性能"),h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419112518996.png",alt:"image-20230419112518996",loading:"lazy",decoding:"async",class:"lazy"})])]),h("li",null,[h("p",null,"小于这个值，冲突减少了，但扩容就会更频繁，空间占用也更多")])],-1)),l[108]||(l[108]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419112817313.png",alt:"image-20230419112817313",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[109]||(l[109]=h("blockquote",null,[h("p",null,[k("计算桶下标：hash()→"),h("code",null,"(hashcode >>> 16 ^ hashcode )&(capacity-1)"),k(" capacity为2的n次幂，计算索引效率更高，但哈希分布不均匀；capacity为质数时哈希分布均匀（hashtable）。 hashmap1.8:超过容量扩容阈值（＞¾），先创建扩容新数组再将数据迁移到新数组；链表插入方式为尾插法 1.7:链表插入方式为头插法；")])],-1)),l[110]||(l[110]=h("h3",{id:"_5-并发问题",tabindex:"-1"},[k("5）并发问题 "),h("a",{class:"header-anchor",href:"#_5-并发问题","aria-label":'Permalink to "5）并发问题"'},"​")],-1)),l[111]||(l[111]=h("p",null,"1.7链表迁移过程(a和b迁移前后都是同一个对象，只是改变了它们的一些引用地址，并没有发生对象的创建)",-1)),l[112]||(l[112]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419121302636.png",alt:"image-20230419121302636",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[113]||(l[113]=h("p",null,[h("strong",null,"扩容死链（1.7 会存在）")],-1)),l[114]||(l[114]=h("p",null,"1.7 源码如下：",-1)),l[115]||(l[115]=h("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[h("button",{title:"Copy Code",class:"copy"}),h("span",{class:"lang"},"java"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"void"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," transfer"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Entry"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[] newTable, "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"boolean"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," rehash) {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    int"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," newCapacity "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," newTable.length;")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    for"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (Entry<"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"K"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},","),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"V"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> e "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," table) {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        while"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"null"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," !="),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," e) {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            Entry<"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"K"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},","),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"V"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> next "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," e.next;")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            if"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (rehash) {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                e.hash "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," =="),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," e.key "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"?"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," :"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," hash"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(e.key);")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            }")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            int"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," i "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," indexFor"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(e.hash, newCapacity);")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            e.next "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," newTable[i];")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            newTable[i] "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," e;")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            e "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," next;")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),h("button",{class:"collapse"})],-1)),l[116]||(l[116]=h("ul",null,[h("li",null,"e 和 next 都是局部变量，用来指向当前节点和下一个节点"),h("li",null,"线程1（绿色）的临时变量 e 和 next 刚引用了这俩节点，还未来得及移动节点，发生了线程切换，由线程2（蓝色）完成扩容和迁移")],-1)),l[117]||(l[117]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210831084325075.png",alt:"image-20210831084325075",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[118]||(l[118]=h("ul",null,[h("li",null,"线程2 扩容完成，由于头插法，链表顺序颠倒。但线程1 的临时变量 e 和 next 还引用了这俩节点，还要再来一遍迁移")],-1)),l[119]||(l[119]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210831084723383.png",alt:"image-20210831084723383",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[120]||(l[120]=h("ul",null,[h("li",null,[h("p",null,"第一次循环"),h("ul",null,[h("li",null,"循环接着线程切换前运行，注意此时 e 指向的是节点 a，next 指向的是节点 b"),h("li",null,"e 头插 a 节点，注意图中画了两份 a 节点，但事实上只有一个（为了不让箭头特别乱画了两份）")]),h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210831084855348.png",alt:"image-20210831084855348",loading:"lazy",decoding:"async",class:"lazy"})]),h("ul",null,[h("li",null,"当循环结束是 e 会指向 next 也就是 b 节点")])])],-1)),l[121]||(l[121]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419121935915.png",alt:"image-20230419121935915",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[122]||(l[122]=h("ul",null,[h("li",null,[h("p",null,"第二次循环"),h("ul",null,[h("li",null,"第二轮开始，next 指向了节点 a"),h("li",null,"e 头插节点 b")]),h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210831085329449.png",alt:"image-20210831085329449",loading:"lazy",decoding:"async",class:"lazy"})]),h("ul",null,[h("li",null,"当循环结束时，e 指向 next 也就是节点 a")])])],-1)),l[123]||(l[123]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419122220312.png",alt:"image-20230419122220312",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[124]||(l[124]=h("ul",null,[h("li",null,[h("p",null,"第三次循环"),h("ul",null,[h("li",null,"next 指向了 null")]),h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419133332478.png",alt:"image-20230419133332478",loading:"lazy",decoding:"async",class:"lazy"})]),h("ul",null,[h("li",null,[k("e 头插节点 a，"),h("strong",null,"a 的 next 指向了 b"),k("（之前 a.next 一直是 null），b 的 next 指向 a，死链已成")])]),h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210831085543224.png",alt:"image-20210831085543224",loading:"lazy",decoding:"async",class:"lazy"})]),h("ul",null,[h("li",null,"当循环结束时，e 指向 next 也就是 null，因此第四次循环时会正常退出")])])],-1)),l[125]||(l[125]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419133643654.png",alt:"image-20230419133643654",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[126]||(l[126]=h("p",null,[h("strong",null,"数据错乱（1.7，1.8 都会存在）")],-1)),l[127]||(l[127]=h("ul",null,[h("li",null,[k("代码参考 "),h("code",null,"day01.map.HashMapMissData"),k("，具体调试步骤参考视频")])],-1)),l[128]||(l[128]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419115103985.png",alt:"image-20230419115103985",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[129]||(l[129]=h("blockquote",null,[h("p",null,[h("em",null,[h("strong",null,"补充代码说明")])]),h("ul",null,[h("li",null,"day01.map.HashMapDistribution 演示 map 中链表长度符合泊松分布"),h("li",null,[k("day01.map.DistributionAffectedByCapacity 演示容量及 hashCode 取值对分布的影响 "),h("ul",null,[h("li",null,"day01.map.DistributionAffectedByCapacity#hashtableGrowRule 演示了 Hashtable 的扩容规律"),h("li",null,"day01.sort.Utils#randomArray 如果 hashCode 足够随机，容量是否是 2 的 n 次幂影响不大"),h("li",null,"day01.sort.Utils#lowSameArray 如果 hashCode 低位一样的多，容量是 2 的 n 次幂会导致分布不均匀"),h("li",null,"day01.sort.Utils#evenArray 如果 hashCode 偶数的多，容量是 2 的 n 次幂会导致分布不均匀"),h("li",null,"由此得出对于容量是 2 的 n 次幂的设计来讲，二次 hash 非常重要")])]),h("li",null,"day01.map.HashMapVsHashtable 演示了对于同样数量的单词字符串放入 HashMap 和 Hashtable 分布上的区别")])],-1)),l[130]||(l[130]=h("h3",{id:"_6-key-的设计",tabindex:"-1"},[k("6）key 的设计 "),h("a",{class:"header-anchor",href:"#_6-key-的设计","aria-label":'Permalink to "6）key 的设计"'},"​")],-1)),l[131]||(l[131]=h("p",null,[h("strong",null,"key 的设计要求")],-1)),l[132]||(l[132]=h("ol",null,[h("li",null,[h("p",null,"HashMap 的 key 可以为 null，但 Map 的其他实现则不然")]),h("li",null,[h("p",null,[k("作为 key 的对象，必须实现 hashCode 和 equals，并且 "),h("strong",null,"key 的内容不能修改（不可变）")]),h("ul",null,[h("li",null,"重写hashCode方法是为了让我们的key在整个HashMap中有更好的分布性，提高查询性能"),h("li",null,"重写equals方法是为了将来如果计算两个对象的key的索引都一样，进一步需要用equals进行比较，看看是不是两个相同的对象"),h("li",null,"两个对象的hashCode相等，equals不一定相等；两个对象的equals相等，hashCode一定相等")])]),h("li",null,[h("p",null,"key 的 hashCode 应该有良好的散列性")])],-1)),l[133]||(l[133]=h("p",null,"如果 key 可变，例如修改了 age 会导致再次查询时查询不到，因此平时用整数、字符串等作为key，这些类的内容不可变",-1)),l[134]||(l[134]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419134838699.png",alt:"image-20230419134838699",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[135]||(l[135]=h("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[h("button",{title:"Copy Code",class:"copy"}),h("span",{class:"lang"},"java"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HashMapMutableKey"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," main"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"String"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[] "),h("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"args"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        HashMap<"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Student"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Object"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> map "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," HashMap<>();")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        Student stu "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Student"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"张三"'),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"18"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        map."),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"put"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(stu, "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"new"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Object"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),k("\n"),h("span",{class:"line"}),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        System.out."),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(map."),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"get"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(stu));")]),k("\n"),h("span",{class:"line"}),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        stu.age "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 19"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        System.out."),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(map."),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"get"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(stu));")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),k("\n"),h("span",{class:"line"}),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    static"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Student"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        String name;")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        int"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," age;")]),k("\n"),h("span",{class:"line"}),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        public"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Student"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(String "),h("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"name"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"int"),h("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," age"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"            this"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".name "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," name;")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"            this"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".age "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," age;")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),k("\n"),h("span",{class:"line"}),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        public"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String "),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getName"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            return"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," name;")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),k("\n"),h("span",{class:"line"}),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        public"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," setName"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(String "),h("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"name"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"            this"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".name "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," name;")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),k("\n"),h("span",{class:"line"}),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        public"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," int"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getAge"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            return"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," age;")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),k("\n"),h("span",{class:"line"}),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        public"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," setAge"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"int"),h("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," age"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"            this"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".age "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," age;")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),k("\n"),h("span",{class:"line"}),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        @"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Override")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        public"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," boolean"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," equals"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Object "),h("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"o"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            if"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ("),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"this"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," =="),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," o) "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"return"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," true"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            if"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (o "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=="),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ||"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getClass"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," o."),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getClass"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()) "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"return"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," false"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            Student student "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (Student) o;")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            return"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," age "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=="),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," student.age "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"&&"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Objects."),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"equals"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(name, student.name);")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),k("\n"),h("span",{class:"line"}),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        @"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Override")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        public"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," int"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," hashCode"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            return"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Objects."),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"hash"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(name, age);")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),h("button",{class:"collapse"})],-1)),l[136]||(l[136]=h("p",null,[h("strong",null,"String 对象的 hashCode() 设计")],-1)),l[137]||(l[137]=h("ul",null,[h("li",null,"目标是达到较为均匀的散列效果，每个字符串的 hashCode 足够独特"),h("li",null,[k("字符串中的每个字符都可以表现为一个数字，称为 "),h("span",{class:"katex"},[h("span",{class:"katex-mathml"},[h("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[h("semantics",null,[h("mrow",null,[h("msub",null,[h("mi",null,"S"),h("mi",null,"i")])]),h("annotation",{encoding:"application/x-tex"},"S_i")])])]),h("span",{class:"katex-html","aria-hidden":"true"},[h("span",{class:"base"},[h("span",{class:"strut",style:{height:"0.8333em","vertical-align":"-0.15em"}}),h("span",{class:"mord"},[h("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"S"),h("span",{class:"msupsub"},[h("span",{class:"vlist-t vlist-t2"},[h("span",{class:"vlist-r"},[h("span",{class:"vlist",style:{height:"0.3117em"}},[h("span",{style:{top:"-2.55em","margin-left":"-0.0576em","margin-right":"0.05em"}},[h("span",{class:"pstrut",style:{height:"2.7em"}}),h("span",{class:"sizing reset-size6 size3 mtight"},[h("span",{class:"mord mathnormal mtight"},"i")])])]),h("span",{class:"vlist-s"},"​")]),h("span",{class:"vlist-r"},[h("span",{class:"vlist",style:{height:"0.15em"}},[h("span")])])])])])])])]),k("，其中 i 的范围是 0 ~ n - 1")]),h("li",null,[k("散列公式为："),h("span",{class:"katex"},[h("span",{class:"katex-mathml"},[h("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[h("semantics",null,[h("mrow",null,[h("msub",null,[h("mi",null,"S"),h("mn",null,"0")]),h("mo",null,"∗"),h("msup",null,[h("mn",null,"31"),h("mrow",null,[h("mi",null,"n"),h("mo",null,"−"),h("mn",null,"1")])]),h("mo",null,"+"),h("msub",null,[h("mi",null,"S"),h("mn",null,"1")]),h("mo",null,"∗"),h("msup",null,[h("mn",null,"31"),h("mrow",null,[h("mi",null,"n"),h("mo",null,"−"),h("mn",null,"2")])]),h("mo",null,"+"),h("mo",null,"…"),h("msub",null,[h("mi",null,"S"),h("mi",null,"i")]),h("mo",null,"∗"),h("msup",null,[h("mn",null,"31"),h("mrow",null,[h("mi",null,"n"),h("mo",null,"−"),h("mn",null,"1"),h("mo",null,"−"),h("mi",null,"i")])]),h("mo",null,"+"),h("mo",null,"…"),h("msub",null,[h("mi",null,"S"),h("mrow",null,[h("mi",null,"n"),h("mo",null,"−"),h("mn",null,"1")])]),h("mo",null,"∗"),h("msup",null,[h("mn",null,"31"),h("mn",null,"0")])]),h("annotation",{encoding:"application/x-tex"},"S_0∗31^{n-1}+S_1∗31^{n-2}+… S_i∗31^{n-1-i}+…S_{n-1}∗31^0")])])]),h("span",{class:"katex-html","aria-hidden":"true"},[h("span",{class:"base"},[h("span",{class:"strut",style:{height:"0.8333em","vertical-align":"-0.15em"}}),h("span",{class:"mord"},[h("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"S"),h("span",{class:"msupsub"},[h("span",{class:"vlist-t vlist-t2"},[h("span",{class:"vlist-r"},[h("span",{class:"vlist",style:{height:"0.3011em"}},[h("span",{style:{top:"-2.55em","margin-left":"-0.0576em","margin-right":"0.05em"}},[h("span",{class:"pstrut",style:{height:"2.7em"}}),h("span",{class:"sizing reset-size6 size3 mtight"},[h("span",{class:"mord mtight"},"0")])])]),h("span",{class:"vlist-s"},"​")]),h("span",{class:"vlist-r"},[h("span",{class:"vlist",style:{height:"0.15em"}},[h("span")])])])])]),h("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),h("span",{class:"mbin"},"∗"),h("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),h("span",{class:"base"},[h("span",{class:"strut",style:{height:"0.8974em","vertical-align":"-0.0833em"}}),h("span",{class:"mord"},"3"),h("span",{class:"mord"},[h("span",{class:"mord"},"1"),h("span",{class:"msupsub"},[h("span",{class:"vlist-t"},[h("span",{class:"vlist-r"},[h("span",{class:"vlist",style:{height:"0.8141em"}},[h("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[h("span",{class:"pstrut",style:{height:"2.7em"}}),h("span",{class:"sizing reset-size6 size3 mtight"},[h("span",{class:"mord mtight"},[h("span",{class:"mord mathnormal mtight"},"n"),h("span",{class:"mbin mtight"},"−"),h("span",{class:"mord mtight"},"1")])])])])])])])]),h("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),h("span",{class:"mbin"},"+"),h("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),h("span",{class:"base"},[h("span",{class:"strut",style:{height:"0.8333em","vertical-align":"-0.15em"}}),h("span",{class:"mord"},[h("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"S"),h("span",{class:"msupsub"},[h("span",{class:"vlist-t vlist-t2"},[h("span",{class:"vlist-r"},[h("span",{class:"vlist",style:{height:"0.3011em"}},[h("span",{style:{top:"-2.55em","margin-left":"-0.0576em","margin-right":"0.05em"}},[h("span",{class:"pstrut",style:{height:"2.7em"}}),h("span",{class:"sizing reset-size6 size3 mtight"},[h("span",{class:"mord mtight"},"1")])])]),h("span",{class:"vlist-s"},"​")]),h("span",{class:"vlist-r"},[h("span",{class:"vlist",style:{height:"0.15em"}},[h("span")])])])])]),h("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),h("span",{class:"mbin"},"∗"),h("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),h("span",{class:"base"},[h("span",{class:"strut",style:{height:"0.8974em","vertical-align":"-0.0833em"}}),h("span",{class:"mord"},"3"),h("span",{class:"mord"},[h("span",{class:"mord"},"1"),h("span",{class:"msupsub"},[h("span",{class:"vlist-t"},[h("span",{class:"vlist-r"},[h("span",{class:"vlist",style:{height:"0.8141em"}},[h("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[h("span",{class:"pstrut",style:{height:"2.7em"}}),h("span",{class:"sizing reset-size6 size3 mtight"},[h("span",{class:"mord mtight"},[h("span",{class:"mord mathnormal mtight"},"n"),h("span",{class:"mbin mtight"},"−"),h("span",{class:"mord mtight"},"2")])])])])])])])]),h("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),h("span",{class:"mbin"},"+"),h("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),h("span",{class:"base"},[h("span",{class:"strut",style:{height:"0.8333em","vertical-align":"-0.15em"}}),h("span",{class:"minner"},"…"),h("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),h("span",{class:"mord"},[h("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"S"),h("span",{class:"msupsub"},[h("span",{class:"vlist-t vlist-t2"},[h("span",{class:"vlist-r"},[h("span",{class:"vlist",style:{height:"0.3117em"}},[h("span",{style:{top:"-2.55em","margin-left":"-0.0576em","margin-right":"0.05em"}},[h("span",{class:"pstrut",style:{height:"2.7em"}}),h("span",{class:"sizing reset-size6 size3 mtight"},[h("span",{class:"mord mathnormal mtight"},"i")])])]),h("span",{class:"vlist-s"},"​")]),h("span",{class:"vlist-r"},[h("span",{class:"vlist",style:{height:"0.15em"}},[h("span")])])])])]),h("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),h("span",{class:"mbin"},"∗"),h("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),h("span",{class:"base"},[h("span",{class:"strut",style:{height:"0.908em","vertical-align":"-0.0833em"}}),h("span",{class:"mord"},"3"),h("span",{class:"mord"},[h("span",{class:"mord"},"1"),h("span",{class:"msupsub"},[h("span",{class:"vlist-t"},[h("span",{class:"vlist-r"},[h("span",{class:"vlist",style:{height:"0.8247em"}},[h("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[h("span",{class:"pstrut",style:{height:"2.7em"}}),h("span",{class:"sizing reset-size6 size3 mtight"},[h("span",{class:"mord mtight"},[h("span",{class:"mord mathnormal mtight"},"n"),h("span",{class:"mbin mtight"},"−"),h("span",{class:"mord mtight"},"1"),h("span",{class:"mbin mtight"},"−"),h("span",{class:"mord mathnormal mtight"},"i")])])])])])])])]),h("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),h("span",{class:"mbin"},"+"),h("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),h("span",{class:"base"},[h("span",{class:"strut",style:{height:"0.8917em","vertical-align":"-0.2083em"}}),h("span",{class:"minner"},"…"),h("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),h("span",{class:"mord"},[h("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"S"),h("span",{class:"msupsub"},[h("span",{class:"vlist-t vlist-t2"},[h("span",{class:"vlist-r"},[h("span",{class:"vlist",style:{height:"0.3011em"}},[h("span",{style:{top:"-2.55em","margin-left":"-0.0576em","margin-right":"0.05em"}},[h("span",{class:"pstrut",style:{height:"2.7em"}}),h("span",{class:"sizing reset-size6 size3 mtight"},[h("span",{class:"mord mtight"},[h("span",{class:"mord mathnormal mtight"},"n"),h("span",{class:"mbin mtight"},"−"),h("span",{class:"mord mtight"},"1")])])])]),h("span",{class:"vlist-s"},"​")]),h("span",{class:"vlist-r"},[h("span",{class:"vlist",style:{height:"0.2083em"}},[h("span")])])])])]),h("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),h("span",{class:"mbin"},"∗"),h("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),h("span",{class:"base"},[h("span",{class:"strut",style:{height:"0.8141em"}}),h("span",{class:"mord"},"3"),h("span",{class:"mord"},[h("span",{class:"mord"},"1"),h("span",{class:"msupsub"},[h("span",{class:"vlist-t"},[h("span",{class:"vlist-r"},[h("span",{class:"vlist",style:{height:"0.8141em"}},[h("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[h("span",{class:"pstrut",style:{height:"2.7em"}}),h("span",{class:"sizing reset-size6 size3 mtight"},[h("span",{class:"mord mtight"},"0")])])])])])])])])])])]),h("li",null,[k("31 代入公式有较好的散列特性，并且 31 * h 可以被优化为 "),h("ul",null,[h("li",null,[k("即 "),h("span",{class:"katex"},[h("span",{class:"katex-mathml"},[h("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[h("semantics",null,[h("mrow",null,[h("mn",null,"32"),h("mo",null,"∗"),h("mi",null,"h"),h("mo",null,"−"),h("mi",null,"h")]),h("annotation",{encoding:"application/x-tex"},"32 ∗h -h")])])]),h("span",{class:"katex-html","aria-hidden":"true"},[h("span",{class:"base"},[h("span",{class:"strut",style:{height:"0.6444em"}}),h("span",{class:"mord"},"32"),h("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),h("span",{class:"mbin"},"∗"),h("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),h("span",{class:"base"},[h("span",{class:"strut",style:{height:"0.7778em","vertical-align":"-0.0833em"}}),h("span",{class:"mord mathnormal"},"h"),h("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),h("span",{class:"mbin"},"−"),h("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),h("span",{class:"base"},[h("span",{class:"strut",style:{height:"0.6944em"}}),h("span",{class:"mord mathnormal"},"h")])])])]),h("li",null,[k("即 "),h("span",{class:"katex"},[h("span",{class:"katex-mathml"},[h("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[h("semantics",null,[h("mrow",null,[h("msup",null,[h("mn",null,"2"),h("mn",null,"5")]),h("mo",null,"∗"),h("mi",null,"h"),h("mo",null,"−"),h("mi",null,"h")]),h("annotation",{encoding:"application/x-tex"},"2^5 ∗h -h")])])]),h("span",{class:"katex-html","aria-hidden":"true"},[h("span",{class:"base"},[h("span",{class:"strut",style:{height:"0.8141em"}}),h("span",{class:"mord"},[h("span",{class:"mord"},"2"),h("span",{class:"msupsub"},[h("span",{class:"vlist-t"},[h("span",{class:"vlist-r"},[h("span",{class:"vlist",style:{height:"0.8141em"}},[h("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[h("span",{class:"pstrut",style:{height:"2.7em"}}),h("span",{class:"sizing reset-size6 size3 mtight"},[h("span",{class:"mord mtight"},"5")])])])])])])]),h("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),h("span",{class:"mbin"},"∗"),h("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),h("span",{class:"base"},[h("span",{class:"strut",style:{height:"0.7778em","vertical-align":"-0.0833em"}}),h("span",{class:"mord mathnormal"},"h"),h("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),h("span",{class:"mbin"},"−"),h("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),h("span",{class:"base"},[h("span",{class:"strut",style:{height:"0.6944em"}}),h("span",{class:"mord mathnormal"},"h")])])])]),h("li",null,[k("即 "),h("span",{class:"katex"},[h("span",{class:"katex-mathml"},[h("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[h("semantics",null,[h("mrow",null,[h("mi",null,"h"),h("mo",null,"≪"),h("mn",null,"5"),h("mo",null,"−"),h("mi",null,"h")]),h("annotation",{encoding:"application/x-tex"},"h≪5 -h")])])]),h("span",{class:"katex-html","aria-hidden":"true"},[h("span",{class:"base"},[h("span",{class:"strut",style:{height:"0.7335em","vertical-align":"-0.0391em"}}),h("span",{class:"mord mathnormal"},"h"),h("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),h("span",{class:"mrel"},"≪"),h("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),h("span",{class:"base"},[h("span",{class:"strut",style:{height:"0.7278em","vertical-align":"-0.0833em"}}),h("span",{class:"mord"},"5"),h("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),h("span",{class:"mbin"},"−"),h("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),h("span",{class:"base"},[h("span",{class:"strut",style:{height:"0.6944em"}}),h("span",{class:"mord mathnormal"},"h")])])])])])])],-1)),l[138]||(l[138]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419135639704.png",alt:"image-20230419135639704",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[139]||(l[139]=h("h2",{id:"_4-1-hashmap-快速查找",tabindex:"-1"},[k("4.1. HashMap-快速查找 "),h("a",{class:"header-anchor",href:"#_4-1-hashmap-快速查找","aria-label":'Permalink to "4.1. HashMap-快速查找"'},"​")],-1)),l[140]||(l[140]=h("ul",null,[h("li",null,"ArrayList查找效率较低")],-1)),l[141]||(l[141]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418161635803.png",alt:"image-20230418161635803",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[142]||(l[142]=h("ul",null,[h("li",null,"HashMap通过索引计算直接找到元素(hash运算)，无链表情况查找时间复杂度为O(1)，有链表情况就看链表长度了，时间复杂度为O(n)")],-1)),l[143]||(l[143]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418161857746.png",alt:"image-20230418161857746",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[144]||(l[144]=h("h2",{id:"_4-2-hashmap-链表过长的解决方案",tabindex:"-1"},[k("4.2. HashMap-链表过长的解决方案 "),h("a",{class:"header-anchor",href:"#_4-2-hashmap-链表过长的解决方案","aria-label":'Permalink to "4.2. HashMap-链表过长的解决方案"'},"​")],-1)),l[145]||(l[145]=h("ul",null,[h("li",null,"形成链表：keys相同的固定hash；keys的hash%容量相同")],-1)),l[146]||(l[146]=h("h3",{id:"_4-2-1-扩容",tabindex:"-1"},[k("4.2.1.扩容 "),h("a",{class:"header-anchor",href:"#_4-2-1-扩容","aria-label":'Permalink to "4.2.1.扩容"'},"​")],-1)),l[147]||(l[147]=h("ul",null,[h("li",null,"正常情况")],-1)),l[148]||(l[148]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418162855531.png",alt:"image-20230418162855531",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[149]||(l[149]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418162904156.png",alt:"image-20230418162904156",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[150]||(l[150]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418162909932.png",alt:"image-20230418162909932",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[151]||(l[151]=h("ul",null,[h("li",null,"极端情况，只能树化为红黑树了")],-1)),l[152]||(l[152]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418162935840.png",alt:"image-20230418162935840",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[153]||(l[153]=h("h3",{id:"_4-2-2-树化",tabindex:"-1"},[k("4.2.2. 树化 "),h("a",{class:"header-anchor",href:"#_4-2-2-树化","aria-label":'Permalink to "4.2.2. 树化"'},"​")],-1)),l[154]||(l[154]=h("ul",null,[h("li",null,"链表->红黑树：当容量为16，在某个桶下标形成链表的8个元素添加元素，仅进行扩容为32，再添加扩容到64才会树化")],-1)),l[155]||(l[155]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418164530243.png",alt:"image-20230418164530243",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[156]||(l[156]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418165555721.png",alt:"image-20230418165555721",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[157]||(l[157]=h("ul",null,[h("li",null,"满足树化条件(容量>=64且链表长度>8)，红黑树父节点左侧都是比它小的元素，右侧都是比它大的元素，子节点同理，hash码相同时才比较，按照key的字符串值比较，查找的时间复杂度为O(log2(n))")],-1)),l[158]||(l[158]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418165707584.png",alt:"image-20230418165707584",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[159]||(l[159]=h("ul",null,[h("li",null,"链表长度是可能出现超过8的情况")],-1)),l[160]||(l[160]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418170758857.png",alt:"image-20230418170758857",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[161]||(l[161]=h("h4",{id:"红黑树的意义-树化阈值",tabindex:"-1"},[k("红黑树的意义-树化阈值 "),h("a",{class:"header-anchor",href:"#红黑树的意义-树化阈值","aria-label":'Permalink to "红黑树的意义-树化阈值"'},"​")],-1)),l[162]||(l[162]=h("ul",null,[h("li",null,[h("p",null,"为何要用红黑树，为何一上来不树化，树化阈值为何是8，何时会树化，何时会退化为链表？"),h("ul",null,[h("li",null,[h("p",null,"因为链表较长时会影响整个HashMap的性能，1.8之后引入红黑树，即使链表较长也不会对性能有太大的影响")]),h("li",null,[h("p",null,"链表->红黑树：当容量为16，在某个桶下标形成链表的8个元素添加元素，仅进行扩容为32，再添加扩容到64才会树化")]),h("li",null,[h("p",null,"链表短的时候，链表性能大于红黑树，链表长时性能才远远不如红黑树，且红黑树占用内存比链表大得多，非必要不树化")]),h("li",null,[h("p",null,"红黑树是一种非正常情况，下图为23W多个正常单词的hash分布情况，若没有刻意构造hash码，在负载因子0.75的情况下，链表出现8的概率非常低，为0.00000006")])]),h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418181214309.png",alt:"image-20230418181214309",loading:"lazy",decoding:"async",class:"lazy"})]),h("ul",null,[h("li",null,"红黑树用来避免 DoS 攻击，防止链表超长时性能下降，树化应当是偶然情况，是保底策略")])])],-1)),l[163]||(l[163]=h("h4",{id:"树退化链表-情况1",tabindex:"-1"},[k("树退化链表-情况1 "),h("a",{class:"header-anchor",href:"#树退化链表-情况1","aria-label":'Permalink to "树退化链表-情况1"'},"​")],-1)),l[164]||(l[164]=h("ul",null,[h("li",null,"在扩容时如果拆分树时，树元素个数 <= 6 则会退化链表")],-1)),l[165]||(l[165]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418183806555.png",alt:"image-20230418183806555",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[166]||(l[166]=h("ul",null,[h("li",null,"在扩容时如果拆分树时，树元素个数 > 6 则不会退化链表")],-1)),l[167]||(l[167]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418184454141.png",alt:"image-20230418184454141",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[168]||(l[168]=h("h4",{id:"树退化链表-情况2",tabindex:"-1"},[k("树退化链表-情况2 "),h("a",{class:"header-anchor",href:"#树退化链表-情况2","aria-label":'Permalink to "树退化链表-情况2"'},"​")],-1)),l[169]||(l[169]=h("ul",null,[h("li",null,"remove 树节点时，若 root(爷)、root.left(左孩子)、root.right(右孩子)、root.left.left(左孙子) 有一个为 null ，也会退化为链表")],-1)),l[170]||(l[170]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418192832140.png",alt:"image-20230418192832140",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[171]||(l[171]=h("ul",null,[h("li",null,"例子2")],-1)),l[172]||(l[172]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418193518600.png",alt:"image-20230418193518600",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[173]||(l[173]=h("h2",{id:"_5-单例模式",tabindex:"-1"},[k("5. 单例模式 "),h("a",{class:"header-anchor",href:"#_5-单例模式","aria-label":'Permalink to "5. 单例模式"'},"​")],-1)),l[174]||(l[174]=h("p",null,[h("strong",null,"要求")],-1)),l[175]||(l[175]=h("ul",null,[h("li",null,"掌握五种单例模式的实现方式"),h("li",null,"理解为何 DCL 实现时要使用 volatile 修饰静态变量"),h("li",null,"了解 jdk 中用到单例的场景")],-1)),l[176]||(l[176]=h("h3",{id:"饿汉式",tabindex:"-1"},[h("strong",null,"饿汉式"),k(),h("a",{class:"header-anchor",href:"#饿汉式","aria-label":'Permalink to "**饿汉式**"'},"​")],-1)),l[177]||(l[177]=h("ul",null,[h("li",null,"提前创建单例对象")],-1)),l[178]||(l[178]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419141144975.png",alt:"image-20230419141144975",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[179]||(l[179]=h("ul",null,[h("li",null,"实现Serializable接口利用反射破坏单例")],-1)),l[180]||(l[180]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419141539054.png",alt:"image-20230419141539054",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[181]||(l[181]=h("ul",null,[h("li",null,"反序列化破坏单例")],-1)),l[182]||(l[182]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419142100218.png",alt:"image-20230419142100218",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[183]||(l[183]=h("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[h("button",{title:"Copy Code",class:"copy"}),h("span",{class:"lang"},"java"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Singleton1"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," implements"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Serializable"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Singleton1"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        if"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (INSTANCE "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            throw"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," RuntimeException"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"单例对象不能重复创建"'),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        System.out."),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"private Singleton1()"'),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),k("\n"),h("span",{class:"line"}),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," final"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Singleton1 INSTANCE "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Singleton1"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),k("\n"),h("span",{class:"line"}),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Singleton1 "),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getInstance"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," INSTANCE;")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),k("\n"),h("span",{class:"line"}),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," otherMethod"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        System.out."),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"otherMethod()"'),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),k("\n"),h("span",{class:"line"}),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Object "),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"readResolve"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," INSTANCE;")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),h("button",{class:"collapse"})],-1)),l[184]||(l[184]=h("ul",null,[h("li",null,"构造方法抛出异常是防止反射破坏单例")],-1)),l[185]||(l[185]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419141740516.png",alt:"image-20230419141740516",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[186]||(l[186]=h("ul",null,[h("li",null,[h("code",null,"readResolve()"),k(" 是防止反序列化破坏单例")])],-1)),l[187]||(l[187]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419142253512.png",alt:"image-20230419142253512",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[188]||(l[188]=h("ul",null,[h("li",null,"unsafe破坏单例")],-1)),l[189]||(l[189]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419142613493.png",alt:"image-20230419142613493",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[190]||(l[190]=h("h3",{id:"枚举饿汉式",tabindex:"-1"},[h("strong",null,"枚举饿汉式"),k(),h("a",{class:"header-anchor",href:"#枚举饿汉式","aria-label":'Permalink to "**枚举饿汉式**"'},"​")],-1)),l[191]||(l[191]=h("ul",null,[h("li",null,"枚举类一加载并初始化，就会把枚举对象创建出来")],-1)),l[192]||(l[192]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419143438750.png",alt:"image-20230419143438750",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[193]||(l[193]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419143148474.png",alt:"image-20230419143148474",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[194]||(l[194]=h("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[h("button",{title:"Copy Code",class:"copy"}),h("span",{class:"lang"},"java"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," enum"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Singleton2"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    INSTANCE"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),k("\n"),h("span",{class:"line"}),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Singleton2"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        System.out."),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"private Singleton2()"'),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),k("\n"),h("span",{class:"line"}),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Override")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String "),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"toString"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getClass"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getName"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "@"'),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer."),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"toHexString"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"hashCode"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),k("\n"),h("span",{class:"line"}),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Singleton2 "),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getInstance"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," INSTANCE;")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),k("\n"),h("span",{class:"line"}),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," otherMethod"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        System.out."),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"otherMethod()"'),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),h("button",{class:"collapse"})],-1)),l[195]||(l[195]=h("ul",null,[h("li",null,"枚举饿汉式能天然防止反射、反序列化破坏单例")],-1)),l[196]||(l[196]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419144121454.png",alt:"image-20230419144121454",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[197]||(l[197]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419143856798.png",alt:"image-20230419143856798",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[198]||(l[198]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419143639529.png",alt:"image-20230419143639529",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[199]||(l[199]=h("ul",null,[h("li",null,"unsafe依旧可以破坏枚举单例")],-1)),l[200]||(l[200]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419144327173.png",alt:"image-20230419144327173",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[201]||(l[201]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419144146527.png",alt:"image-20230419144146527",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[202]||(l[202]=h("h3",{id:"懒汉式",tabindex:"-1"},[h("strong",null,"懒汉式"),k(),h("a",{class:"header-anchor",href:"#懒汉式","aria-label":'Permalink to "**懒汉式**"'},"​")],-1)),l[203]||(l[203]=h("ul",null,[h("li",null,"第一次调用getInstance方法时才创建单例对象(非线程安全)")],-1)),l[204]||(l[204]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419144620623.png",alt:"image-20230419144620623",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[205]||(l[205]=h("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[h("button",{title:"Copy Code",class:"copy"}),h("span",{class:"lang"},"java"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Singleton3"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," implements"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Serializable"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Singleton3"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        System.out."),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"private Singleton3()"'),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),k("\n"),h("span",{class:"line"}),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Singleton3 INSTANCE "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),k("\n"),h("span",{class:"line"}),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // Singleton3.class  synchronized加在方法上，性能不是特别好，因为单例对象创建好以后，其他线程来访问该同步方法时无需再加锁了，后续的操作不用再进行同步和互斥保护了，不然就影响性能了，只有首次创建单例是才进行线程安全的保护")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," synchronized"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Singleton3 "),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getInstance"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        if"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (INSTANCE "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=="),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            INSTANCE "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Singleton3"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," INSTANCE;")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),k("\n"),h("span",{class:"line"}),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," otherMethod"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        System.out."),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"otherMethod()"'),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),k("\n"),h("span",{class:"line"}),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),h("button",{class:"collapse"})],-1)),l[206]||(l[206]=h("ul",null,[h("li",null,"其实只有首次创建单例对象时才需要同步，但该代码实际上每次调用都会同步"),h("li",null,"因此有了下面的双检锁改进")],-1)),l[207]||(l[207]=h("h3",{id:"双检锁懒汉式",tabindex:"-1"},[h("strong",null,"双检锁懒汉式"),k(),h("a",{class:"header-anchor",href:"#双检锁懒汉式","aria-label":'Permalink to "**双检锁懒汉式**"'},"​")],-1)),l[208]||(l[208]=h("ul",null,[h("li",null,"少了内层判断还是会重复创建对象")],-1)),l[209]||(l[209]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419145814990.png",alt:"image-20230419145814990",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[210]||(l[210]=h("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[h("button",{title:"Copy Code",class:"copy"}),h("span",{class:"lang"},"java"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Singleton4"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," implements"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Serializable"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Singleton4"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        System.out."),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"private Singleton4()"'),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),k("\n"),h("span",{class:"line"}),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," volatile"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Singleton4 INSTANCE "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"; "),h("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 可见性，有序性")]),k("\n"),h("span",{class:"line"}),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Singleton4 "),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getInstance"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        if"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (INSTANCE "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=="),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            synchronized"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (Singleton4.class) {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"                if"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (INSTANCE "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=="),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    INSTANCE "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Singleton4"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                }")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            }")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," INSTANCE;")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),k("\n"),h("span",{class:"line"}),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," otherMethod"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        System.out."),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"otherMethod()"'),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),h("button",{class:"collapse"})],-1)),l[211]||(l[211]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419145942353.png",alt:"image-20230419145942353",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[212]||(l[212]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419151419398.png",alt:"image-20230419151419398",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[213]||(l[213]=h("p",null,"为何必须加 volatile：",-1)),l[214]||(l[214]=h("ul",null,[h("li",null,[h("code",null,"INSTANCE = new Singleton4()"),k(" 不是原子的，分成 3 步：创建对象、调用构造、给静态变量赋值，其中后两步可能被指令重排序优化，变成先赋值、再调用构造")]),h("li",null,[k("如果线程1 先执行了赋值，线程2 执行到第一个 "),h("code",null,"INSTANCE == null"),k(" 时发现 INSTANCE 已经不为 null，此时就会返回一个未完全构造的对象")])],-1)),l[215]||(l[215]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419153459527.png",alt:"image-20230419153459527",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[216]||(l[216]=h("h3",{id:"内部类懒汉式",tabindex:"-1"},[h("strong",null,"内部类懒汉式"),k(),h("a",{class:"header-anchor",href:"#内部类懒汉式","aria-label":'Permalink to "**内部类懒汉式**"'},"​")],-1)),l[217]||(l[217]=h("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[h("button",{title:"Copy Code",class:"copy"}),h("span",{class:"lang"},"java"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Singleton5"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," implements"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Serializable"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Singleton5"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        System.out."),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"private Singleton5()"'),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),k("\n"),h("span",{class:"line"}),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Holder"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        static"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Singleton5 INSTANCE "),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Singleton5"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),k("\n"),h("span",{class:"line"}),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Singleton5 "),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getInstance"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Holder.INSTANCE;")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),k("\n"),h("span",{class:"line"}),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," otherMethod"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        System.out."),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"otherMethod()"'),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),k("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),h("button",{class:"collapse"})],-1)),l[218]||(l[218]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419154215932.png",alt:"image-20230419154215932",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[219]||(l[219]=h("ul",null,[h("li",null,"避免了双检锁的缺点")],-1)),l[220]||(l[220]=h("blockquote",null,[h("p",null,"volatile修饰共享变量可以解决指令重排序(懒汉单例-DCL(双检索)) 给静态变量赋值肯定会放到静态代码块里执行，静态代码块里的代码由JVM来保证，则饿汉式不用考虑线程安全问题，枚举饿汉式同理")],-1)),l[221]||(l[221]=h("h3",{id:"jdk-中单例的体现",tabindex:"-1"},[h("strong",null,"JDK 中单例的体现"),k(),h("a",{class:"header-anchor",href:"#jdk-中单例的体现","aria-label":'Permalink to "**JDK 中单例的体现**"'},"​")],-1)),l[222]||(l[222]=h("ul",null,[h("li",null,"Runtime 体现了饿汉式单例")],-1)),l[223]||(l[223]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419154748392.png",alt:"image-20230419154748392",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[224]||(l[224]=h("ul",null,[h("li",null,"Console 体现了双检锁懒汉式单例")],-1)),l[225]||(l[225]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419154859774.png",alt:"image-20230419154859774",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[226]||(l[226]=h("ul",null,[h("li",null,"Collections 中的 EmptyNavigableSet 内部类懒汉式单例")],-1)),l[227]||(l[227]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419155254327.png",alt:"image-20230419155254327",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[228]||(l[228]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419155346324.png",alt:"image-20230419155346324",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[229]||(l[229]=h("ul",null,[h("li",null,"其他内部类懒汉式例子")],-1)),l[230]||(l[230]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419155525101.png",alt:"image-20230419155525101",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[231]||(l[231]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419155558145.png",alt:"image-20230419155558145",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[232]||(l[232]=h("ul",null,[h("li",null,"ReverseComparator.REVERSE_ORDER 内部类懒汉式单例")],-1)),l[233]||(l[233]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419155823830.png",alt:"image-20230419155823830",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[234]||(l[234]=h("ul",null,[h("li",null,"Comparators.NaturalOrderComparator.INSTANCE 枚举饿汉式单例")],-1)),l[235]||(l[235]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419160119770.png",alt:"image-20230419160119770",loading:"lazy",decoding:"async",class:"lazy"})],-1))])),"main-header":t((()=>[e(i.$slots,"main-header")])),"main-header-after":t((()=>[e(i.$slots,"main-header-after")])),"main-nav":t((()=>[e(i.$slots,"main-nav")])),"main-content-before":t((()=>[e(i.$slots,"main-content-before")])),"main-content":t((()=>[e(i.$slots,"main-content")])),"main-content-after":t((()=>[e(i.$slots,"main-content-after")])),"main-nav-before":t((()=>[e(i.$slots,"main-nav-before")])),"main-nav-after":t((()=>[e(i.$slots,"main-nav-after")])),comment:t((()=>[e(i.$slots,"comment")])),footer:t((()=>[e(i.$slots,"footer")])),aside:t((()=>[e(i.$slots,"aside")])),"aside-custom":t((()=>[e(i.$slots,"aside-custom")])),default:t((()=>[e(i.$slots,"default")])),_:3},8,["frontmatter"])}}};export{u as default,c as usePageData};
