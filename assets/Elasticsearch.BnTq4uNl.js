import{_ as i}from"./ValaxyMain.vue_vue_type_style_index_0_lang.9GM34vdY.js";import"./chunks/@vueuse/motion.BrTBiDBP.js";import{d as s,a as l,u as a}from"./chunks/vue-router.qltZjGpv.js";import{a1 as h,a3 as k,a4 as n,a5 as t,a6 as e,a7 as E,W as p,a0 as r,F as g,a2 as d,Z as y}from"./framework.CSpzLJwA.js";import"./app.DWzYFkU-.js";import"./chunks/dayjs.Dto65haK.js";import"./chunks/vue-i18n.C5QQbedb.js";import"./chunks/pinia.CKttsWmm.js";import"./chunks/nprogress.BEPa78Un.js";/* empty css                    */import"./YunComment.vue_vue_type_style_index_0_lang.DXgqq_ye.js";import"./index.TQnGKZgq.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang.DIveis5r.js";import"./post.CPG5nlba.js";const c=s("/posts/Elasticsearch",async i=>JSON.parse('{"title":"Elasticsearch 从入门到实战","description":"","frontmatter":{"title":"Elasticsearch 从入门到实战","author":"imklaus","tags":["Elasticsearch"],"categories":["中间件"],"date":"2025/12/7 22:51:00","outline":"deep","postTitleClass":"text-#fcd522","excerpt_type":"html","end":false},"headers":[],"relativePath":"pages/posts/Elasticsearch.md","lastUpdated":null}'),{lazy:(i,s)=>i.name===s.name}),F={__name:"Elasticsearch",setup(s,{expose:F}){const{data:o}=c(),u=a(),C=l(),B=Object.assign(C.meta.frontmatter||{},o.value?.frontmatter||{});u.currentRoute.value.data=o.value,y("valaxy:frontmatter",B),globalThis.$frontmatter=B;return F({frontmatter:{title:"Elasticsearch 从入门到实战",author:"imklaus",tags:["Elasticsearch"],categories:["中间件"],date:"2025/12/7 22:51:00",outline:"deep",postTitleClass:"text-#fcd522",excerpt_type:"html",end:!1}}),(s,l)=>{const a=r("font"),y=i;return d(),h(y,{frontmatter:g(B)},{"main-content-md":k(()=>[l[10]||(l[10]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/v2-37905c52c75915f998824731a75e8d38_720w.jpg",alt:"",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[11]||(l[11]=t("p",null,[E("参考视频："),t("a",{href:"https://www.bilibili.com/video/BV1LQ4y127n4",target:"_blank",rel:"noreferrer"},"黑马SpringCloud微服务技术栈Elasticsearch篇")],-1)),l[12]||(l[12]=t("p",null,"笔记的整体结构依据视频编写，并随着学习的深入补充了很多知识",-1)),l[13]||(l[13]=t("p",null,[t("strong",null,"目录指引"),E("：")],-1)),l[14]||(l[14]=t("nav",{class:"table-of-contents"},[t("ul",null,[t("li",null,[t("a",{href:"#_1-初识elasticsearch"},"1. 初识elasticsearch"),t("ul",null,[t("li",null,[t("a",{href:"#_1-1-了解es"},"1.1 了解ES")]),t("li",null,[t("a",{href:"#_1-2-倒排索引"},"1.2 倒排索引")]),t("li",null,[t("a",{href:"#_1-3-es的一些概念"},"1.3 es的一些概念")]),t("li",null,[t("a",{href:"#_1-4-安装es、kibana"},"1.4 安装es、kibana")])])]),t("li",null,[t("a",{href:"#_2-索引库操作"},"2. 索引库操作"),t("ul",null,[t("li",null,[t("a",{href:"#_2-1-mapping映射属性"},"2.1 mapping映射属性")]),t("li",null,[t("a",{href:"#_2-2-索引库的crud"},"2.2 索引库的CRUD")])])]),t("li",null,[t("a",{href:"#_3-文档操作"},"3. 文档操作"),t("ul",null,[t("li",null,[t("a",{href:"#_3-1-新增文档"},"3.1 新增文档")]),t("li",null,[t("a",{href:"#_3-2-查询文档"},"3.2 查询文档")]),t("li",null,[t("a",{href:"#_3-3-删除文档"},"3.3 删除文档")]),t("li",null,[t("a",{href:"#_3-4-修改文档"},"3.4 修改文档")]),t("li",null,[t("a",{href:"#_3-5-总结"},"3.5 总结")])])]),t("li",null,[t("a",{href:"#_4-restapi"},"4. RestAPI"),t("ul",null,[t("li",null,[t("a",{href:"#_4-0-导入demo工程"},"4.0 导入Demo工程")]),t("li",null,[t("a",{href:"#_4-1-创建索引库"},"4.1 创建索引库")]),t("li",null,[t("a",{href:"#_4-2-删除索引库"},"4.2 删除索引库")]),t("li",null,[t("a",{href:"#_4-3-判断索引库是否存在"},"4.3 判断索引库是否存在")]),t("li",null,[t("a",{href:"#_4-4-总结"},"4.4 总结")])])]),t("li",null,[t("a",{href:"#_5-restclient操作文档"},"5. RestClient操作文档"),t("ul",null,[t("li",null,[t("a",{href:"#_5-1-新增文档"},"5.1 新增文档")]),t("li",null,[t("a",{href:"#_5-2-查询文档"},"5.2 查询文档")]),t("li",null,[t("a",{href:"#_5-3-删除文档"},"5.3 删除文档")]),t("li",null,[t("a",{href:"#_5-4-修改文档"},"5.4 修改文档")]),t("li",null,[t("a",{href:"#_5-5-批量导入文档"},"5.5 批量导入文档")]),t("li",null,[t("a",{href:"#_5-6-小结"},"5.6 小结")])])]),t("li",null,[t("a",{href:"#_6-dsl查询文档"},"6. DSL查询文档"),t("ul",null,[t("li",null,[t("a",{href:"#_6-1-dsl查询分类"},"6.1 DSL查询分类")]),t("li",null,[t("a",{href:"#_6-2-全文检索查询"},"6.2 全文检索查询")]),t("li",null,[t("a",{href:"#_6-3-精准查询"},"6.3 精准查询")]),t("li",null,[t("a",{href:"#_6-4-地理坐标查询"},"6.4 地理坐标查询")]),t("li",null,[t("a",{href:"#_6-5-复合查询"},"6.5 复合查询")])])]),t("li",null,[t("a",{href:"#_7-搜索结果处理"},"7. 搜索结果处理"),t("ul",null,[t("li",null,[t("a",{href:"#_7-1-排序"},"7.1 排序")]),t("li",null,[t("a",{href:"#_7-2-分页"},"7.2 分页")]),t("li",null,[t("a",{href:"#_7-3-高亮"},"7.3 高亮")]),t("li",null,[t("a",{href:"#_7-4-总结"},"7.4 总结")])])]),t("li",null,[t("a",{href:"#_8-restclient查询文档"},"8. RestClient查询文档"),t("ul",null,[t("li",null,[t("a",{href:"#_8-1-快速入门"},"8.1 快速入门")]),t("li",null,[t("a",{href:"#_8-2-match查询"},"8.2 match查询")]),t("li",null,[t("a",{href:"#_8-3-精确查询"},"8.3 精确查询")]),t("li",null,[t("a",{href:"#_8-4-布尔查询"},"8.4 布尔查询")]),t("li",null,[t("a",{href:"#_8-5-排序、分页"},"8.5 排序、分页")]),t("li",null,[t("a",{href:"#_8-6-高亮"},"8.6 高亮")])])]),t("li",null,[t("a",{href:"#_9-黑马旅游案例"},"9. 黑马旅游案例"),t("ul",null,[t("li",null,[t("a",{href:"#_9-1-酒店搜索和分页"},"9.1 酒店搜索和分页")]),t("li",null,[t("a",{href:"#_9-2-酒店结果过滤"},"9.2 酒店结果过滤")]),t("li",null,[t("a",{href:"#_9-3-我周边的酒店"},"9.3 我周边的酒店")]),t("li",null,[t("a",{href:"#_9-4-酒店竞价排名"},"9.4 酒店竞价排名")])])]),t("li",null,[t("a",{href:"#_10-数据聚合"},"10. 数据聚合"),t("ul",null,[t("li",null,[t("a",{href:"#_10-1-聚合的种类"},"10.1 聚合的种类")]),t("li",null,[t("a",{href:"#_10-2-dsl实现聚合"},"10.2 DSL实现聚合")]),t("li",null,[t("a",{href:"#_10-3-restapi实现聚合"},"10.3 RestAPI实现聚合")])])]),t("li",null,[t("a",{href:"#_11-自动补全"},"11. 自动补全"),t("ul",null,[t("li",null,[t("a",{href:"#_11-1-拼音分词器"},"11.1.拼音分词器")]),t("li",null,[t("a",{href:"#_11-2-自定义分词器"},"11.2 自定义分词器")]),t("li",null,[t("a",{href:"#_11-3-自动补全查询"},"11.3 自动补全查询")]),t("li",null,[t("a",{href:"#_11-4-实现酒店搜索框自动补全"},"11.4 实现酒店搜索框自动补全")])])]),t("li",null,[t("a",{href:"#_12-数据同步"},"12. 数据同步"),t("ul",null,[t("li",null,[t("a",{href:"#_12-1-思路分析"},"12.1 思路分析")]),t("li",null,[t("a",{href:"#_12-2-实现数据同步"},"12.2 实现数据同步")])])]),t("li",null,[t("a",{href:"#_13-集群"},"13. 集群"),t("ul",null,[t("li",null,[t("a",{href:"#_13-1-搭建es集群"},"13.1 搭建ES集群")]),t("li",null,[t("a",{href:"#_13-2-集群脑裂问题"},"13.2 集群脑裂问题")]),t("li",null,[t("a",{href:"#_13-3-集群分布式存储"},"13.3 集群分布式存储")]),t("li",null,[t("a",{href:"#_13-4-集群分布式查询"},"13.4 集群分布式查询")]),t("li",null,[t("a",{href:"#_13-5-集群故障转移"},"13.5 集群故障转移")])])])])],-1)),l[15]||(l[15]=t("h2",{id:"_1-初识elasticsearch",tabindex:"-1"},[E("1. 初识elasticsearch "),t("a",{class:"header-anchor",href:"#_1-初识elasticsearch","aria-label":'Permalink to "1. 初识elasticsearch"'},"​")],-1)),l[16]||(l[16]=t("h3",{id:"_1-1-了解es",tabindex:"-1"},[E("1.1 了解ES "),t("a",{class:"header-anchor",href:"#_1-1-了解es","aria-label":'Permalink to "1.1 了解ES"'},"​")],-1)),l[17]||(l[17]=t("h4",{id:"_1-1-1-elasticsearch的作用",tabindex:"-1"},[E("1.1.1 elasticsearch的作用 "),t("a",{class:"header-anchor",href:"#_1-1-1-elasticsearch的作用","aria-label":'Permalink to "1.1.1 elasticsearch的作用"'},"​")],-1)),l[18]||(l[18]=t("p",null,"elasticsearch是一款非常强大的开源搜索引擎，具备非常多强大功能，可以帮助我们从海量数据中快速找到需要的内容",-1)),l[19]||(l[19]=t("p",null,"例如：",-1)),l[20]||(l[20]=t("ul",null,[t("li",null,[t("p",null,"在GitHub搜索代码"),t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720193623245.png",alt:"image-20210720193623245",loading:"lazy",decoding:"async",class:"lazy"})])])],-1)),e(" more "),l[21]||(l[21]=t("ul",null,[t("li",null,[t("p",null,"在电商网站搜索商品"),t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720193633483.png",alt:"image-20210720193633483",loading:"lazy",decoding:"async",class:"lazy"})])]),t("li",null,[t("p",null,"在百度搜索答案"),t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720193641907.png",alt:"image-20210720193641907",loading:"lazy",decoding:"async",class:"lazy"})])]),t("li",null,[t("p",null,"在打车软件搜索附近的车"),t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720193648044.png",alt:"image-20210720193648044",loading:"lazy",decoding:"async",class:"lazy"})])])],-1)),l[22]||(l[22]=t("h4",{id:"_1-1-2-elk技术栈",tabindex:"-1"},[E("1.1.2 ELK技术栈 "),t("a",{class:"header-anchor",href:"#_1-1-2-elk技术栈","aria-label":'Permalink to "1.1.2 ELK技术栈"'},"​")],-1)),l[23]||(l[23]=t("p",null,"elasticsearch结合kibana、Logstash、Beats，也就是elastic stack（ELK）。被广泛应用在日志数据分析、实时监控等领域：",-1)),l[24]||(l[24]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720194008781.png",alt:"image-20210720194008781",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[25]||(l[25]=t("p",null,"而elasticsearch是elastic stack的核心，负责存储、搜索、分析数据。",-1)),l[26]||(l[26]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720194230265.png",alt:"image-20210720194230265",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[27]||(l[27]=t("h4",{id:"_1-1-3-elasticsearch和lucene",tabindex:"-1"},[E("1.1.3 elasticsearch和lucene "),t("a",{class:"header-anchor",href:"#_1-1-3-elasticsearch和lucene","aria-label":'Permalink to "1.1.3 elasticsearch和lucene"'},"​")],-1)),l[28]||(l[28]=t("p",null,[E("elasticsearch底层是基于"),t("strong",null,"lucene"),E("来实现的。")],-1)),l[29]||(l[29]=t("p",null,[t("strong",null,"Lucene"),E("是一个Java语言的搜索引擎类库，是Apache公司的顶级项目，由DougCutting于1999年研发。官网地址："),t("a",{href:"https://lucene.apache.org/",target:"_blank",rel:"noreferrer"},"https://lucene.apache.org/"),E(" 。")],-1)),l[30]||(l[30]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720194547780.png",alt:"image-20210720194547780",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[31]||(l[31]=t("p",null,[t("strong",null,"elasticsearch"),E("的发展历史：")],-1)),l[32]||(l[32]=t("ul",null,[t("li",null,"2004年Shay Banon基于Lucene开发了Compass"),t("li",null,"2010年Shay Banon 重写了Compass，取名为Elasticsearch。")],-1)),l[33]||(l[33]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720195001221.png",alt:"image-20210720195001221",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[34]||(l[34]=t("h4",{id:"_1-1-4-为什么不是其他搜索技术",tabindex:"-1"},[E("1.1.4 为什么不是其他搜索技术？ "),t("a",{class:"header-anchor",href:"#_1-1-4-为什么不是其他搜索技术","aria-label":'Permalink to "1.1.4 为什么不是其他搜索技术？"'},"​")],-1)),l[35]||(l[35]=t("p",null,"目前比较知名的搜索引擎技术排名：",-1)),l[36]||(l[36]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720195142535.png",alt:"image-20210720195142535",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[37]||(l[37]=t("p",null,"虽然在早期，Apache Solr是最主要的搜索引擎技术，但随着发展elasticsearch已经渐渐超越了Solr，独占鳌头：",-1)),l[38]||(l[38]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720195306484.png",alt:"image-20210720195306484",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[39]||(l[39]=t("h4",{id:"_1-1-5-总结",tabindex:"-1"},[E("1.1.5 总结 "),t("a",{class:"header-anchor",href:"#_1-1-5-总结","aria-label":'Permalink to "1.1.5 总结"'},"​")],-1)),l[40]||(l[40]=t("blockquote",null,[t("ul",null,[t("li",null,[t("p",null,"什么是elasticsearch？"),t("ul",null,[t("li",null,"一个开源的分布式搜索引擎，可以用来实现搜索、日志统计、分析、系统监控等功能")])]),t("li",null,[t("p",null,"什么是elastic stack（ELK）？"),t("ul",null,[t("li",null,"是以elasticsearch为核心的技术栈，包括beats、Logstash、kibana、elasticsearch")])]),t("li",null,[t("p",null,"什么是Lucene？"),t("ul",null,[t("li",null,"是Apache的开源搜索引擎类库，提供了搜索引擎的核心API")])])])],-1)),l[41]||(l[41]=t("h3",{id:"_1-2-倒排索引",tabindex:"-1"},[E("1.2 倒排索引 "),t("a",{class:"header-anchor",href:"#_1-2-倒排索引","aria-label":'Permalink to "1.2 倒排索引"'},"​")],-1)),l[42]||(l[42]=t("p",null,"倒排索引的概念是基于MySQL这样的正向索引而言的。",-1)),l[43]||(l[43]=t("h4",{id:"_1-2-1-正向索引",tabindex:"-1"},[E("1.2.1 正向索引 "),t("a",{class:"header-anchor",href:"#_1-2-1-正向索引","aria-label":'Permalink to "1.2.1 正向索引"'},"​")],-1)),l[44]||(l[44]=t("p",null,"那么什么是正向索引呢？例如给下表（tb_goods）中的id创建索引：",-1)),l[45]||(l[45]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720195531539.png",alt:"image-20210720195531539",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[46]||(l[46]=t("p",null,"如果是根据id查询，那么直接走索引，查询速度非常快。",-1)),l[47]||(l[47]=t("p",null,"但如果是基于title做模糊查询，只能是逐行扫描数据，流程如下：",-1)),l[48]||(l[48]=t("p",null,[E("1）用户搜索数据，条件是title符合"),t("code",null,'"%手机%"')],-1)),l[49]||(l[49]=t("p",null,"2）逐行获取数据，比如id为1的数据",-1)),l[50]||(l[50]=t("p",null,"3）判断数据中的title是否符合用户搜索条件",-1)),l[51]||(l[51]=t("p",null,"4）如果符合则放入结果集，不符合则丢弃。回到步骤1",-1)),l[52]||(l[52]=t("p",null,"逐行扫描，也就是全表扫描，随着数据量增加，其查询效率也会越来越低。当数据量达到数百万时，就是一场灾难。",-1)),l[53]||(l[53]=t("h4",{id:"_1-2-2-倒排索引",tabindex:"-1"},[E("1.2.2 倒排索引 "),t("a",{class:"header-anchor",href:"#_1-2-2-倒排索引","aria-label":'Permalink to "1.2.2 倒排索引"'},"​")],-1)),l[54]||(l[54]=t("p",null,"倒排索引中有两个非常重要的概念：",-1)),l[55]||(l[55]=t("ul",null,[t("li",null,[E("文档（"),t("code",null,"Document"),E("）：用来搜索的数据，其中的每一条数据就是一个文档。例如一个网页、一个商品信息")]),t("li",null,[E("词条（"),t("code",null,"Term"),E("）：对文档数据或用户搜索数据，利用某种算法分词，得到的具备含义的词语就是词条。例如：我是中国人，就可以分为：我、是、中国人、中国、国人这样的几个词条")])],-1)),l[56]||(l[56]=t("p",null,[t("strong",null,"创建倒排索引"),E("是对正向索引的一种特殊处理，流程如下：")],-1)),l[57]||(l[57]=t("ul",null,[t("li",null,"将每一个文档的数据利用算法分词，得到一个个词条"),t("li",null,"创建表，每行数据包括词条、词条所在文档id、位置等信息"),t("li",null,"因为词条唯一性，可以给词条创建索引，例如hash表结构索引")],-1)),l[58]||(l[58]=t("p",null,"如图：",-1)),l[59]||(l[59]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720200457207.png",alt:"image-20210720200457207",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[60]||(l[60]=t("p",null,[E("倒排索引的"),t("strong",null,"搜索流程"),E('如下（以搜索"华为手机"为例）：')],-1)),l[61]||(l[61]=t("p",null,[E("1）用户输入条件"),t("code",null,'"华为手机"'),E("进行搜索。")],-1)),l[62]||(l[62]=t("p",null,[E("2）对用户输入内容"),t("strong",null,"分词"),E("，得到词条："),t("code",null,"华为"),E("、"),t("code",null,"手机"),E("。")],-1)),l[63]||(l[63]=t("p",null,"3）拿着词条在倒排索引中查找，可以得到包含词条的文档id：1、2、3。",-1)),l[64]||(l[64]=t("p",null,"4）拿着文档id到正向索引中查找具体文档。",-1)),l[65]||(l[65]=t("p",null,"如图：",-1)),l[66]||(l[66]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720201115192.png",alt:"image-20210720201115192",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[67]||(l[67]=t("p",null,"虽然要先查询倒排索引，再查询倒排索引，但是无论是词条、还是文档id都建立了索引，查询速度非常快！无需全表扫描。",-1)),l[68]||(l[68]=t("h4",{id:"_1-2-3-正向和倒排",tabindex:"-1"},[E("1.2.3 正向和倒排 "),t("a",{class:"header-anchor",href:"#_1-2-3-正向和倒排","aria-label":'Permalink to "1.2.3 正向和倒排"'},"​")],-1)),l[69]||(l[69]=t("p",null,"那么为什么一个叫做正向索引，一个叫做倒排索引呢？",-1)),l[70]||(l[70]=t("ul",null,[t("li",null,[t("p",null,[t("strong",null,"正向索引"),E("是最传统的，根据id索引的方式。但根据词条查询时，必须先逐条获取每个文档，然后判断文档中是否包含所需要的词条，是"),t("strong",null,"根据文档找词条的过程"),E("。")])]),t("li",null,[t("p",null,[E("而"),t("strong",null,"倒排索引"),E("则相反，是先找到用户要搜索的词条，根据词条得到保护词条的文档的id，然后根据id获取文档。是"),t("strong",null,"根据词条找文档的过程"),E("。")])])],-1)),l[71]||(l[71]=t("p",null,"是不是恰好反过来了？",-1)),l[72]||(l[72]=t("p",null,"那么两者方式的优缺点是什么呢？",-1)),l[73]||(l[73]=t("p",null,[t("strong",null,"正向索引"),E("：")],-1)),l[74]||(l[74]=t("ul",null,[t("li",null,[E("优点： "),t("ul",null,[t("li",null,"可以给多个字段创建索引"),t("li",null,"根据索引字段搜索、排序速度非常快")])]),t("li",null,[E("缺点： "),t("ul",null,[t("li",null,"根据非索引字段，或者索引字段中的部分词条查找时，只能全表扫描。")])])],-1)),l[75]||(l[75]=t("p",null,[t("strong",null,"倒排索引"),E("：")],-1)),l[76]||(l[76]=t("ul",null,[t("li",null,[E("优点： "),t("ul",null,[t("li",null,"根据词条搜索、模糊搜索时，速度非常快")])]),t("li",null,[E("缺点： "),t("ul",null,[t("li",null,"只能给词条创建索引，而不是字段"),t("li",null,"无法根据字段做排序")])])],-1)),l[77]||(l[77]=t("h3",{id:"_1-3-es的一些概念",tabindex:"-1"},[E("1.3 es的一些概念 "),t("a",{class:"header-anchor",href:"#_1-3-es的一些概念","aria-label":'Permalink to "1.3 es的一些概念"'},"​")],-1)),l[78]||(l[78]=t("p",null,"elasticsearch中有很多独有的概念，与mysql中略有差别，但也有相似之处。",-1)),l[79]||(l[79]=t("h4",{id:"_1-3-1-文档和字段",tabindex:"-1"},[E("1.3.1 文档和字段 "),t("a",{class:"header-anchor",href:"#_1-3-1-文档和字段","aria-label":'Permalink to "1.3.1 文档和字段"'},"​")],-1)),l[80]||(l[80]=t("p",null,"elasticsearch是面向**文档（Document）**存储的，可以是数据库中的一条商品数据，一个订单信息。文档数据会被序列化为json格式后存储在elasticsearch中：",-1)),l[81]||(l[81]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720202707797.png",alt:"image-20210720202707797",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[82]||(l[82]=t("p",null,[E("而Json文档中往往包含很多的"),t("strong",null,"字段（Field）"),E("，类似于数据库中的列。")],-1)),l[83]||(l[83]=t("h4",{id:"_1-3-2-索引和映射",tabindex:"-1"},[E("1.3.2 索引和映射 "),t("a",{class:"header-anchor",href:"#_1-3-2-索引和映射","aria-label":'Permalink to "1.3.2 索引和映射"'},"​")],-1)),l[84]||(l[84]=t("p",null,[t("strong",null,"索引（Index）"),E("，就是相同类型的文档的集合。")],-1)),l[85]||(l[85]=t("p",null,"例如：",-1)),l[86]||(l[86]=t("ul",null,[t("li",null,"所有用户文档，就可以组织在一起，称为用户的索引；"),t("li",null,"所有商品的文档，可以组织在一起，称为商品的索引；"),t("li",null,"所有订单的文档，可以组织在一起，称为订单的索引；")],-1)),l[87]||(l[87]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720203022172.png",alt:"image-20210720203022172",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[88]||(l[88]=t("p",null,"因此，我们可以把索引当做是数据库中的表。",-1)),l[89]||(l[89]=t("p",null,[E("数据库的表会有约束信息，用来定义表的结构、字段的名称、类型等信息。因此，索引库中就有"),t("strong",null,"映射（mapping）"),E("，是索引中文档的字段约束信息，类似表的结构约束。")],-1)),l[90]||(l[90]=t("h4",{id:"_1-3-3-mysql与elasticsearch",tabindex:"-1"},[E("1.3.3 mysql与elasticsearch "),t("a",{class:"header-anchor",href:"#_1-3-3-mysql与elasticsearch","aria-label":'Permalink to "1.3.3 mysql与elasticsearch"'},"​")],-1)),l[91]||(l[91]=t("p",null,"我们统一的把mysql与elasticsearch的概念做一下对比：",-1)),l[92]||(l[92]=t("table",null,[t("thead",null,[t("tr",null,[t("th",null,[t("strong",null,"MySQL")]),t("th",null,[t("strong",null,"Elasticsearch")]),t("th",null,[t("strong",null,"说明")])])]),t("tbody",null,[t("tr",null,[t("td",null,"Table"),t("td",null,"Index"),t("td",null,"索引(index)，就是文档的集合，类似数据库的表(table)")]),t("tr",null,[t("td",null,"Row"),t("td",null,"Document"),t("td",null,"文档（Document），就是一条条的数据，类似数据库中的行（Row），文档都是JSON格式")]),t("tr",null,[t("td",null,"Column"),t("td",null,"Field"),t("td",null,"字段（Field），就是JSON文档中的字段，类似数据库中的列（Column）")]),t("tr",null,[t("td",null,"Schema"),t("td",null,"Mapping"),t("td",null,"Mapping（映射）是索引中文档的约束，例如字段类型约束。类似数据库的表结构（Schema）")]),t("tr",null,[t("td",null,"SQL"),t("td",null,"DSL"),t("td",null,"DSL是elasticsearch提供的JSON风格的请求语句，用来操作elasticsearch，实现CRUD")])])],-1)),l[93]||(l[93]=t("p",null,"是不是说，我们学习了elasticsearch就不再需要mysql了呢？",-1)),l[94]||(l[94]=t("p",null,"并不是如此，两者各自有自己的擅长支出：",-1)),l[95]||(l[95]=t("ul",null,[t("li",null,[t("p",null,"Mysql：擅长事务类型操作，可以确保数据的安全和一致性")]),t("li",null,[t("p",null,"Elasticsearch：擅长海量数据的搜索、分析、计算")])],-1)),l[96]||(l[96]=t("p",null,"因此在企业中，往往是两者结合使用：",-1)),l[97]||(l[97]=t("ul",null,[t("li",null,"对安全性要求较高的写操作，使用mysql实现"),t("li",null,"对查询性能要求较高的搜索需求，使用elasticsearch实现"),t("li",null,"两者再基于某种方式，实现数据的同步，保证一致性")],-1)),l[98]||(l[98]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720203534945.png",alt:"image-20210720203534945",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[99]||(l[99]=t("h3",{id:"_1-4-安装es、kibana",tabindex:"-1"},[E("1.4 安装es、kibana "),t("a",{class:"header-anchor",href:"#_1-4-安装es、kibana","aria-label":'Permalink to "1.4 安装es、kibana"'},"​")],-1)),l[100]||(l[100]=t("h4",{id:"部署elasticsearch-单节点",tabindex:"-1"},[E("部署elasticsearch（单节点） "),t("a",{class:"header-anchor",href:"#部署elasticsearch-单节点","aria-label":'Permalink to "部署elasticsearch（单节点）"'},"​")],-1)),l[101]||(l[101]=t("h5",{id:"_1-创建网络",tabindex:"-1"},[E("1. 创建网络 "),t("a",{class:"header-anchor",href:"#_1-创建网络","aria-label":'Permalink to "1. 创建网络"'},"​")],-1)),l[102]||(l[102]=t("p",null,"因为我们还需要部署kibana容器，因此需要让es和kibana容器互联。这里先创建一个网络：",-1)),l[103]||(l[103]=t("div",{class:"language-sh max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"sh"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," network"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," create"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," es-net")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[104]||(l[104]=t("h5",{id:"_2-加载镜像",tabindex:"-1"},[E("2. 加载镜像 "),t("a",{class:"header-anchor",href:"#_2-加载镜像","aria-label":'Permalink to "2. 加载镜像"'},"​")],-1)),l[105]||(l[105]=t("p",null,"这里我们采用elasticsearch的7.12.1版本的镜像，这个镜像体积非常大，接近1G。不建议大家自己pull。",-1)),l[106]||(l[106]=t("p",null,"课前资料提供了镜像的tar包：",-1)),l[107]||(l[107]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210510165308064.png",alt:"image-20210510165308064",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[108]||(l[108]=t("p",null,"大家将其上传到虚拟机中，然后运行命令加载即可：",-1)),l[109]||(l[109]=t("div",{class:"language-sh max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"sh"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 导入数据")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," load"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -i"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," es.tar")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[110]||(l[110]=t("p",null,[E("同理还有"),t("code",null,"kibana"),E("的tar包也需要这样做。")],-1)),l[111]||(l[111]=t("h5",{id:"_3-运行",tabindex:"-1"},[E("3. 运行 "),t("a",{class:"header-anchor",href:"#_3-运行","aria-label":'Permalink to "3. 运行"'},"​")],-1)),l[112]||(l[112]=t("p",null,"运行docker命令，部署单点es：",-1)),l[113]||(l[113]=t("div",{class:"language-sh max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"sh"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," run"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -d"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\t--name"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," es"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    -e"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "ES_JAVA_OPTS=-Xms512m -Xmx512m"'),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    -e"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "discovery.type=single-node"'),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    -v"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," es-data:/usr/share/elasticsearch/data"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    -v"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," es-plugins:/usr/share/elasticsearch/plugins"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    --privileged"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    --network"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," es-net"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    -p"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 9200:9200"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    -p"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 9300:9300"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"elasticsearch:7.12.1")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[114]||(l[114]=t("p",null,"命令解释：",-1)),l[115]||(l[115]=t("ul",null,[t("li",null,[t("code",null,'-e "cluster.name=es-docker-cluster"'),E("：设置集群名称")]),t("li",null,[t("code",null,'-e "http.host=0.0.0.0"'),E("：监听的地址，可以外网访问")]),t("li",null,[t("code",null,'-e "ES_JAVA_OPTS=-Xms512m -Xmx512m"'),E("：内存大小")]),t("li",null,[t("code",null,'-e "discovery.type=single-node"'),E("：非集群模式")]),t("li",null,[t("code",null,"-v es-data:/usr/share/elasticsearch/data"),E("：挂载逻辑卷，绑定es的数据目录")]),t("li",null,[t("code",null,"-v es-logs:/usr/share/elasticsearch/logs"),E("：挂载逻辑卷，绑定es的日志目录")]),t("li",null,[t("code",null,"-v es-plugins:/usr/share/elasticsearch/plugins"),E("：挂载逻辑卷，绑定es的插件目录")]),t("li",null,[t("code",null,"--privileged"),E("：授予逻辑卷访问权")]),t("li",null,[t("code",null,"--network es-net"),E(" ：加入一个名为es-net的网络中")]),t("li",null,[t("code",null,"-p 9200:9200"),E("：端口映射配置")])],-1)),l[116]||(l[116]=t("p",null,[E("在浏览器中输入："),t("code",null,"http://192.168.150.101:9200"),E(" 即可看到elasticsearch的响应结果：")],-1)),l[117]||(l[117]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210506101053676.png",alt:"image-20210506101053676",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[118]||(l[118]=t("h4",{id:"部署kibana",tabindex:"-1"},[E("部署kibana "),t("a",{class:"header-anchor",href:"#部署kibana","aria-label":'Permalink to "部署kibana"'},"​")],-1)),l[119]||(l[119]=t("p",null,"kibana可以给我们提供一个elasticsearch的可视化界面，便于我们学习。",-1)),l[120]||(l[120]=t("h5",{id:"_1-运行",tabindex:"-1"},[E("1. 运行 "),t("a",{class:"header-anchor",href:"#_1-运行","aria-label":'Permalink to "1. 运行"'},"​")],-1)),l[121]||(l[121]=t("p",null,"运行docker命令，部署kibana",-1)),l[122]||(l[122]=t("div",{class:"language-sh max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"sh"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," run"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -d"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"--name "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"kibana"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"-e "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"ELASTICSEARCH_HOSTS=http://es:9200"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"--network=es-net "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"-p "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"5601:5601"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"  \\")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"kibana:7.12.1")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[123]||(l[123]=t("ul",null,[t("li",null,[t("code",null,"--network es-net"),E(" ：加入一个名为es-net的网络中，与elasticsearch在同一个网络中")]),t("li",null,[t("code",null,'-e ELASTICSEARCH_HOSTS=http://es:9200"'),E("：设置elasticsearch的地址，因为kibana已经与elasticsearch在一个网络，因此可以用容器名直接访问elasticsearch")]),t("li",null,[t("code",null,"-p 5601:5601"),E("：端口映射配置")])],-1)),l[124]||(l[124]=t("p",null,"kibana启动一般比较慢，需要多等待一会，可以通过命令：",-1)),l[125]||(l[125]=t("div",{class:"language-sh max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"sh"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," logs"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -f"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," kibana")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[126]||(l[126]=t("p",null,"查看运行日志，当查看到下面的日志，说明成功：",-1)),l[127]||(l[127]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210109105135812.png",alt:"image-20210109105135812",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[128]||(l[128]=t("p",null,[E("此时，在浏览器输入地址访问："),t("a",{href:"http://192.168.150.101:5601",target:"_blank",rel:"noreferrer"},"http://192.168.150.101:5601"),E("，即可看到结果")],-1)),l[129]||(l[129]=t("h5",{id:"_2-devtools",tabindex:"-1"},[E("2. DevTools "),t("a",{class:"header-anchor",href:"#_2-devtools","aria-label":'Permalink to "2. DevTools"'},"​")],-1)),l[130]||(l[130]=t("p",null,"kibana中提供了一个DevTools界面：",-1)),l[131]||(l[131]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210506102630393.png",alt:"image-20210506102630393",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[132]||(l[132]=t("p",null,"这个界面中可以编写DSL来操作elasticsearch。并且对DSL语句有自动补全功能。",-1)),l[133]||(l[133]=t("h4",{id:"安装ik分词器",tabindex:"-1"},[E("安装IK分词器 "),t("a",{class:"header-anchor",href:"#安装ik分词器","aria-label":'Permalink to "安装IK分词器"'},"​")],-1)),l[134]||(l[134]=t("h5",{id:"_1-在线安装ik插件-较慢",tabindex:"-1"},[E("1. 在线安装ik插件（较慢） "),t("a",{class:"header-anchor",href:"#_1-在线安装ik插件-较慢","aria-label":'Permalink to "1. 在线安装ik插件（较慢）"'},"​")],-1)),l[135]||(l[135]=t("div",{class:"language-shell max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"shell"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 进入容器内部")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," exec"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -it"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," elasticsearch"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /bin/bash")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 在线下载并安装")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"./bin/elasticsearch-plugin"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  install"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v7.12.1/elasticsearch-analysis-ik-7.12.1.zip")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"#退出")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"exit")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"#重启容器")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," restart"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," elasticsearch")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[136]||(l[136]=t("h5",{id:"_2-离线安装ik插件-推荐",tabindex:"-1"},[E("2. 离线安装ik插件（推荐） "),t("a",{class:"header-anchor",href:"#_2-离线安装ik插件-推荐","aria-label":'Permalink to "2. 离线安装ik插件（推荐）"'},"​")],-1)),l[137]||(l[137]=t("h6",{id:"_1-查看数据卷目录",tabindex:"-1"},[E("1）查看数据卷目录 "),t("a",{class:"header-anchor",href:"#_1-查看数据卷目录","aria-label":'Permalink to "1）查看数据卷目录"'},"​")],-1)),l[138]||(l[138]=t("p",null,"安装插件需要知道elasticsearch的plugins目录位置，而我们用了数据卷挂载，因此需要查看elasticsearch的数据卷目录，通过下面命令查看:",-1)),l[139]||(l[139]=t("div",{class:"language-sh max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"sh"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," volume"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," inspect"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," es-plugins")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[140]||(l[140]=t("p",null,"显示结果：",-1)),l[141]||(l[141]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "CreatedAt"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"2022-05-06T10:06:34+08:00"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "Driver"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"local"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "Labels"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"null"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "Mountpoint"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/var/lib/docker/volumes/es-plugins/_data"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "Name"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"es-plugins"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "Options"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"null"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "Scope"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"local"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[142]||(l[142]=t("p",null,[E("说明plugins目录被挂载到了："),t("code",null,"/var/lib/docker/volumes/es-plugins/_data "),E("这个目录中。")],-1)),l[143]||(l[143]=t("h6",{id:"_2-解压缩分词器安装包",tabindex:"-1"},[E("2）解压缩分词器安装包 "),t("a",{class:"header-anchor",href:"#_2-解压缩分词器安装包","aria-label":'Permalink to "2）解压缩分词器安装包"'},"​")],-1)),l[144]||(l[144]=t("p",null,"下面我们需要把课前资料中的ik分词器解压缩，重命名为ik",-1)),l[145]||(l[145]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210506110249144.png",alt:"image-20210506110249144",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[146]||(l[146]=t("h6",{id:"_3-上传到es容器的插件数据卷中",tabindex:"-1"},[E("3）上传到es容器的插件数据卷中 "),t("a",{class:"header-anchor",href:"#_3-上传到es容器的插件数据卷中","aria-label":'Permalink to "3）上传到es容器的插件数据卷中"'},"​")],-1)),l[147]||(l[147]=t("p",null,[E("也就是"),t("code",null,"/var/lib/docker/volumes/es-plugins/_data "),E("：")],-1)),l[148]||(l[148]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210506110704293.png",alt:"image-20210506110704293",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[149]||(l[149]=t("h6",{id:"_4-重启容器",tabindex:"-1"},[E("4）重启容器 "),t("a",{class:"header-anchor",href:"#_4-重启容器","aria-label":'Permalink to "4）重启容器"'},"​")],-1)),l[150]||(l[150]=t("div",{class:"language-shell max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"shell"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 4、重启容器")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," restart"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," es")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[151]||(l[151]=t("div",{class:"language-sh max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"sh"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 查看es日志")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," logs"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -f"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," es")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[152]||(l[152]=t("h6",{id:"_5-测试",tabindex:"-1"},[E("5）测试 "),t("a",{class:"header-anchor",href:"#_5-测试","aria-label":'Permalink to "5）测试"'},"​")],-1)),l[153]||(l[153]=t("p",null,"IK分词器包含两种模式：",-1)),l[154]||(l[154]=t("ul",null,[t("li",null,[t("p",null,[t("code",null,"ik_smart"),E("：最少切分")])]),t("li",null,[t("p",null,[t("code",null,"ik_max_word"),E("：最细切分")])])],-1)),l[155]||(l[155]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /_analyze")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "analyzer"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"ik_max_word"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "text"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"黑马程序员学习java太棒了"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[156]||(l[156]=t("p",null,"结果：",-1)),l[157]||(l[157]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "tokens"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : [")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "token"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"黑马"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "start_offset"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "end_offset"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"CN_WORD"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "position"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "token"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"程序员"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "start_offset"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "end_offset"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"5"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"CN_WORD"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "position"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "token"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"程序"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "start_offset"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "end_offset"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"4"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"CN_WORD"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "position"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "token"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"员"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "start_offset"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"4"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "end_offset"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"5"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"CN_CHAR"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "position"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"3")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "token"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"学习"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "start_offset"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"5"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "end_offset"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"7"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"CN_WORD"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "position"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"4")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "token"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"java"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "start_offset"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"7"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "end_offset"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"11"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"ENGLISH"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "position"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"5")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "token"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"太棒了"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "start_offset"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"11"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "end_offset"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"14"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"CN_WORD"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "position"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"6")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "token"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"太棒"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "start_offset"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"11"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "end_offset"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"13"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"CN_WORD"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "position"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"7")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "token"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"了"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "start_offset"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"13"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "end_offset"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"14"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"CN_CHAR"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "position"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"8")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  ]")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[158]||(l[158]=t("h5",{id:"_3-扩展词词典",tabindex:"-1"},[E("3. 扩展词词典 "),t("a",{class:"header-anchor",href:"#_3-扩展词词典","aria-label":'Permalink to "3. 扩展词词典"'},"​")],-1)),l[159]||(l[159]=t("p",null,"随着互联网的发展，“造词运动”也越发的频繁。出现了很多新的词语，在原有的词汇列表中并不存在。比如：“奥力给”，“传智播客” 等。",-1)),l[160]||(l[160]=t("p",null,"所以我们的词汇也需要不断的更新，IK分词器提供了扩展词汇的功能。",-1)),l[161]||(l[161]=t("p",null,"1）打开IK分词器config目录：",-1)),l[162]||(l[162]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210506112225508.png",alt:"image-20210506112225508",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[163]||(l[163]=t("p",null,"2）在IKAnalyzer.cfg.xml配置文件内容添加：",-1)),l[164]||(l[164]=t("div",{class:"language-xml max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"xml"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<?"),t("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"xml"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," version"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"1.0"'),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," encoding"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"UTF-8"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"?>")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<!"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"DOCTYPE"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," properties"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},' SYSTEM "http://java.sun.com/dtd/properties.dtd">')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),t("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"properties"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        <"),t("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"comment"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">IK Analyzer 扩展配置</"),t("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"comment"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        \x3c!--用户可以在这里配置自己的扩展字典 *** 添加扩展词典--\x3e")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        <"),t("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"entry"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," key"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"ext_dict"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">ext.dic</"),t("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"entry"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"</"),t("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"properties"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[165]||(l[165]=t("p",null,"3）新建一个 ext.dic，可以参考config目录下复制一个配置文件进行修改",-1)),l[166]||(l[166]=t("div",{class:"language-properties max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"properties"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"传智播客")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"奥力给")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[167]||(l[167]=t("p",null,"4）重启elasticsearch",-1)),l[168]||(l[168]=t("div",{class:"language-sh max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"sh"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," restart"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," es")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 查看 日志")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," logs"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -f"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," elasticsearch")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[169]||(l[169]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20201115230900504.png",alt:"image-20201115230900504",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[170]||(l[170]=t("p",null,"日志中已经成功加载ext.dic配置文件",-1)),l[171]||(l[171]=t("p",null,"5）测试效果：",-1)),l[172]||(l[172]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /_analyze")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "analyzer"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"ik_max_word"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "text"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"传智播客Java就业超过90%,奥力给！"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[173]||(l[173]=t("blockquote",null,[t("p",null,"注意当前文件的编码必须是 UTF-8 格式，严禁使用Windows记事本编辑")],-1)),l[174]||(l[174]=t("h5",{id:"_4-停用词词典",tabindex:"-1"},[E("4. 停用词词典 "),t("a",{class:"header-anchor",href:"#_4-停用词词典","aria-label":'Permalink to "4. 停用词词典"'},"​")],-1)),l[175]||(l[175]=t("p",null,"在互联网项目中，在网络间传输的速度很快，所以很多语言是不允许在网络上传递的，如：关于宗教、政治等敏感词语，那么我们在搜索时也应该忽略当前词汇。",-1)),l[176]||(l[176]=t("p",null,"IK分词器也提供了强大的停用词功能，让我们在索引时就直接忽略当前的停用词汇表中的内容。",-1)),l[177]||(l[177]=t("p",null,"1）IKAnalyzer.cfg.xml配置文件内容添加：",-1)),l[178]||(l[178]=t("div",{class:"language-xml max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"xml"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<?"),t("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"xml"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," version"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"1.0"'),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," encoding"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"UTF-8"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"?>")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<!"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"DOCTYPE"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," properties"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},' SYSTEM "http://java.sun.com/dtd/properties.dtd">')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),t("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"properties"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        <"),t("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"comment"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">IK Analyzer 扩展配置</"),t("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"comment"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        \x3c!--用户可以在这里配置自己的扩展字典--\x3e")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        <"),t("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"entry"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," key"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"ext_dict"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">ext.dic</"),t("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"entry"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"         \x3c!--用户可以在这里配置自己的扩展停止词字典  *** 添加停用词词典--\x3e")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        <"),t("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"entry"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," key"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"ext_stopwords"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">stopword.dic</"),t("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"entry"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"</"),t("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"properties"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[179]||(l[179]=t("p",null,"3）在 stopword.dic 添加停用词",-1)),l[180]||(l[180]=t("div",{class:"language-properties max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"properties"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"习大大")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[181]||(l[181]=t("p",null,"4）重启elasticsearch",-1)),l[182]||(l[182]=t("div",{class:"language-sh max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"sh"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 重启服务")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," restart"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," elasticsearch")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," restart"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," kibana")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 查看 日志")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," logs"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -f"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," elasticsearch")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[183]||(l[183]=t("p",null,"日志中已经成功加载stopword.dic配置文件",-1)),l[184]||(l[184]=t("p",null,"5）测试效果：",-1)),l[185]||(l[185]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /_analyze")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "analyzer"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"ik_max_word"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "text"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"传智播客Java就业率超过95%,习大大都点赞,奥力给！"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[186]||(l[186]=t("blockquote",null,[t("p",null,"注意当前文件的编码必须是 UTF-8 格式，严禁使用Windows记事本编辑")],-1)),l[187]||(l[187]=t("h4",{id:"总结",tabindex:"-1"},[E("总结 "),t("a",{class:"header-anchor",href:"#总结","aria-label":'Permalink to "总结"'},"​")],-1)),l[188]||(l[188]=t("blockquote",null,[t("ul",null,[t("li",null,[t("p",null,"分词器的作用是什么？"),t("ul",null,[t("li",null,[t("p",null,"创建倒排索引时对文档分词")]),t("li",null,[t("p",null,"用户搜索时，对输入的内容分词")])])]),t("li",null,[t("p",null,"IK分词器有几种模式？"),t("ul",null,[t("li",null,[t("p",null,"ik_smart：智能切分，粗粒度")]),t("li",null,[t("p",null,"ik_max_word：最细切分，细粒度")])])]),t("li",null,[t("p",null,"IK分词器如何拓展词条？如何停用词条？"),t("ul",null,[t("li",null,[t("p",null,"利用config目录的IkAnalyzer.cfg.xml文件添加拓展词典和停用词典")]),t("li",null,[t("p",null,"在词典中添加拓展词条或者停用词条")])])])])],-1)),l[189]||(l[189]=t("hr",null,null,-1)),l[190]||(l[190]=t("h2",{id:"_2-索引库操作",tabindex:"-1"},[E("2. 索引库操作 "),t("a",{class:"header-anchor",href:"#_2-索引库操作","aria-label":'Permalink to "2. 索引库操作"'},"​")],-1)),l[191]||(l[191]=t("p",null,"索引库就类似数据库表，mapping映射就类似表的结构。",-1)),l[192]||(l[192]=t("p",null,"我们要向es中存储数据，必须先创建“库”和“表”。",-1)),l[193]||(l[193]=t("h3",{id:"_2-1-mapping映射属性",tabindex:"-1"},[E("2.1 mapping映射属性 "),t("a",{class:"header-anchor",href:"#_2-1-mapping映射属性","aria-label":'Permalink to "2.1 mapping映射属性"'},"​")],-1)),l[194]||(l[194]=t("p",null,"mapping是对索引库中文档的约束，常见的mapping属性包括：",-1)),l[195]||(l[195]=t("ul",null,[t("li",null,[E("type：字段数据类型，常见的简单类型有： "),t("ul",null,[t("li",null,"字符串：text（可分词的文本）、keyword（精确值，例如：品牌、国家、ip地址）"),t("li",null,"数值：long、integer、short、byte、double、float、"),t("li",null,"布尔：boolean"),t("li",null,"日期：date"),t("li",null,"对象：object")])]),t("li",null,"index：是否创建索引，默认为true"),t("li",null,"analyzer：使用哪种分词器"),t("li",null,"properties：该字段的子字段")],-1)),l[196]||(l[196]=t("p",null,"例如下面的json文档：",-1)),l[197]||(l[197]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "age"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"21"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "weight"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"52.1"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "isMarried"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"false"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "info"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"黑马程序员Java讲师"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "email"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"zy@itcast.cn"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "score"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": ["),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"99.1"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"99.5"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"98.9"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"],")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "name"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "firstName"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"云"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "lastName"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"赵"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[198]||(l[198]=t("p",null,"对应的每个字段映射（mapping）：",-1)),l[199]||(l[199]=t("ul",null,[t("li",null,"age：类型为 integer；参与搜索，因此需要index为true；无需分词器"),t("li",null,"weight：类型为float；参与搜索，因此需要index为true；无需分词器"),t("li",null,"isMarried：类型为boolean；参与搜索，因此需要index为true；无需分词器"),t("li",null,"info：类型为字符串，需要分词，因此是text；参与搜索，因此需要index为true；分词器可以用ik_smart"),t("li",null,"email：类型为字符串，但是不需要分词，因此是keyword；不参与搜索，因此需要index为false；无需分词器"),t("li",null,"score：虽然是数组，但是我们只看元素的类型，类型为float；参与搜索，因此需要index为true；无需分词器"),t("li",null,[E("name：类型为object，需要定义多个子属性 "),t("ul",null,[t("li",null,"name.firstName；类型为字符串，但是不需要分词，因此是keyword；参与搜索，因此需要index为true；无需分词器"),t("li",null,"name.lastName；类型为字符串，但是不需要分词，因此是keyword；参与搜索，因此需要index为true；无需分词器")])])],-1)),l[200]||(l[200]=t("h3",{id:"_2-2-索引库的crud",tabindex:"-1"},[E("2.2 索引库的CRUD "),t("a",{class:"header-anchor",href:"#_2-2-索引库的crud","aria-label":'Permalink to "2.2 索引库的CRUD"'},"​")],-1)),l[201]||(l[201]=t("p",null,"这里我们统一使用Kibana编写DSL的方式来演示。",-1)),l[202]||(l[202]=t("h4",{id:"_2-2-1-创建索引库和映射",tabindex:"-1"},[E("2.2.1 创建索引库和映射 "),t("a",{class:"header-anchor",href:"#_2-2-1-创建索引库和映射","aria-label":'Permalink to "2.2.1 创建索引库和映射"'},"​")],-1)),l[203]||(l[203]=t("h4",{id:"基本语法",tabindex:"-1"},[E("基本语法： "),t("a",{class:"header-anchor",href:"#基本语法","aria-label":'Permalink to "基本语法："'},"​")],-1)),l[204]||(l[204]=t("ul",null,[t("li",null,"请求方式：PUT"),t("li",null,"请求路径：/索引库名，可以自定义"),t("li",null,"请求参数：mapping映射")],-1)),l[205]||(l[205]=t("p",null,"格式：",-1)),l[206]||(l[206]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"PUT /索引库名称")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "mappings"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "properties"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "字段名"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"text"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "analyzer"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"ik_smart"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "字段名2"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"keyword"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "index"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"false"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "字段名3"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "properties"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "子字段"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'            "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"keyword"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"          }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"      // ...略")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[207]||(l[207]=t("h4",{id:"示例",tabindex:"-1"},[E("示例： "),t("a",{class:"header-anchor",href:"#示例","aria-label":'Permalink to "示例："'},"​")],-1)),l[208]||(l[208]=t("div",{class:"language-sh max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"sh"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"PUT /heima")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},'  "mappings"'),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},":"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},'    "properties"'),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},":"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},'      "info"'),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},":"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},'        "type"'),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},":"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},' "text"'),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},'        "analyzer"'),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},":"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},' "ik_smart"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},'      "email"'),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},":"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},'        "type"'),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},":"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},' "keyword"'),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},'        "index"'),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},":"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},' "falsae"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},'      "name"'),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},":"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},'        "properties"'),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},":"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},'          "firstName"'),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},":"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},'            "type"'),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},":"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},' "keyword"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"          }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      //"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ..."),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 略")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[209]||(l[209]=t("h4",{id:"_2-2-2-查询索引库",tabindex:"-1"},[E("2.2.2 查询索引库 "),t("a",{class:"header-anchor",href:"#_2-2-2-查询索引库","aria-label":'Permalink to "2.2.2 查询索引库"'},"​")],-1)),l[210]||(l[210]=t("p",null,[t("strong",null,"基本语法"),E("：")],-1)),l[211]||(l[211]=t("ul",null,[t("li",null,[t("p",null,"请求方式：GET")]),t("li",null,[t("p",null,"请求路径：/索引库名")]),t("li",null,[t("p",null,"请求参数：无")])],-1)),l[212]||(l[212]=t("p",null,[t("strong",null,"格式"),E("：")],-1)),l[213]||(l[213]=t("div",{class:"language- max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"}),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",null,"GET /索引库名")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[214]||(l[214]=t("p",null,[t("strong",null,"示例"),E("：")],-1)),l[215]||(l[215]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720211019329.png",alt:"image-20210720211019329",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[216]||(l[216]=t("h4",{id:"_2-2-3-修改索引库",tabindex:"-1"},[E("2.2.3 修改索引库 "),t("a",{class:"header-anchor",href:"#_2-2-3-修改索引库","aria-label":'Permalink to "2.2.3 修改索引库"'},"​")],-1)),l[217]||(l[217]=t("p",null,[E("倒排索引结构虽然不复杂，但是一旦数据结构改变（比如改变了分词器），就需要重新创建倒排索引，这简直是灾难。因此索引库"),t("strong",null,"一旦创建，无法修改mapping"),E("。")],-1)),l[218]||(l[218]=t("p",null,"虽然无法修改mapping中已有的字段，但是却允许添加新的字段到mapping中，因为不会对倒排索引产生影响。",-1)),l[219]||(l[219]=t("p",null,[t("strong",null,"语法说明"),E("：")],-1)),l[220]||(l[220]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"PUT /索引库名/_mapping")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "properties"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "新字段名"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"integer"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[221]||(l[221]=t("p",null,[t("strong",null,"示例"),E("：")],-1)),l[222]||(l[222]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720212357390.png",alt:"image-20210720212357390",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[223]||(l[223]=t("h4",{id:"_2-2-4-删除索引库",tabindex:"-1"},[E("2.2.4 删除索引库 "),t("a",{class:"header-anchor",href:"#_2-2-4-删除索引库","aria-label":'Permalink to "2.2.4 删除索引库"'},"​")],-1)),l[224]||(l[224]=t("p",null,[t("strong",null,"语法：")],-1)),l[225]||(l[225]=t("ul",null,[t("li",null,[t("p",null,"请求方式：DELETE")]),t("li",null,[t("p",null,"请求路径：/索引库名")]),t("li",null,[t("p",null,"请求参数：无")])],-1)),l[226]||(l[226]=t("p",null,[t("strong",null,"格式：")],-1)),l[227]||(l[227]=t("div",{class:"language- max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"}),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",null,"DELETE /索引库名")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[228]||(l[228]=t("p",null,"在kibana中测试：",-1)),l[229]||(l[229]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720212123420.png",alt:"image-20210720212123420",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[230]||(l[230]=t("h4",{id:"_2-2-5-总结",tabindex:"-1"},[E("2.2.5 总结 "),t("a",{class:"header-anchor",href:"#_2-2-5-总结","aria-label":'Permalink to "2.2.5 总结"'},"​")],-1)),l[231]||(l[231]=t("p",null,"索引库操作有哪些？",-1)),l[232]||(l[232]=t("ul",null,[t("li",null,"创建索引库：PUT /索引库名"),t("li",null,"查询索引库：GET /索引库名"),t("li",null,"删除索引库：DELETE /索引库名"),t("li",null,"添加字段：PUT /索引库名/_mapping")],-1)),l[233]||(l[233]=t("hr",null,null,-1)),l[234]||(l[234]=t("h2",{id:"_3-文档操作",tabindex:"-1"},[E("3. 文档操作 "),t("a",{class:"header-anchor",href:"#_3-文档操作","aria-label":'Permalink to "3. 文档操作"'},"​")],-1)),l[235]||(l[235]=t("h3",{id:"_3-1-新增文档",tabindex:"-1"},[E("3.1 新增文档 "),t("a",{class:"header-anchor",href:"#_3-1-新增文档","aria-label":'Permalink to "3.1 新增文档"'},"​")],-1)),l[236]||(l[236]=t("p",null,[t("strong",null,"语法：")],-1)),l[237]||(l[237]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"POST /索引库名/_doc/文档id")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "字段1"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"值1"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "字段2"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"值2"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "字段3"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "子属性1"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"值3"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "子属性2"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"值4"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // ...")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[238]||(l[238]=t("p",null,[t("strong",null,"示例：")],-1)),l[239]||(l[239]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"POST /heima/_doc/"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "info"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"黑马程序员Java讲师"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "email"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"zy@itcast.cn"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "name"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "firstName"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"云"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "lastName"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"赵"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[240]||(l[240]=t("p",null,[t("strong",null,"响应：")],-1)),l[241]||(l[241]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720212933362.png",alt:"image-20210720212933362",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[242]||(l[242]=t("h3",{id:"_3-2-查询文档",tabindex:"-1"},[E("3.2 查询文档 "),t("a",{class:"header-anchor",href:"#_3-2-查询文档","aria-label":'Permalink to "3.2 查询文档"'},"​")],-1)),l[243]||(l[243]=t("p",null,"根据rest风格，新增是post，查询应该是get，不过查询一般都需要条件，这里我们把文档id带上。",-1)),l[244]||(l[244]=t("p",null,[t("strong",null,"语法：")],-1)),l[245]||(l[245]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /{"),t("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"索引库名称"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}/_doc/{"),t("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"id"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[246]||(l[246]=t("p",null,[t("strong",null,"通过kibana查看数据：")],-1)),l[247]||(l[247]=t("div",{class:"language-js max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"js"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"GET"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," /"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"heima"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"_doc"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[248]||(l[248]=t("p",null,[t("strong",null,"查看结果：")],-1)),l[249]||(l[249]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720213345003.png",alt:"image-20210720213345003",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[250]||(l[250]=t("h3",{id:"_3-3-删除文档",tabindex:"-1"},[E("3.3 删除文档 "),t("a",{class:"header-anchor",href:"#_3-3-删除文档","aria-label":'Permalink to "3.3 删除文档"'},"​")],-1)),l[251]||(l[251]=t("p",null,"删除使用DELETE请求，同样，需要根据id进行删除：",-1)),l[252]||(l[252]=t("p",null,[t("strong",null,"语法：")],-1)),l[253]||(l[253]=t("div",{class:"language-js max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"js"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"DELETE"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," /"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{索引库名}"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"_doc"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"id值")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[254]||(l[254]=t("p",null,[t("strong",null,"示例：")],-1)),l[255]||(l[255]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"# 根据id删除数据")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"DELETE /heima/_doc/"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[256]||(l[256]=t("p",null,[t("strong",null,"结果：")],-1)),l[257]||(l[257]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720213634918.png",alt:"image-20210720213634918",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[258]||(l[258]=t("h3",{id:"_3-4-修改文档",tabindex:"-1"},[E("3.4 修改文档 "),t("a",{class:"header-anchor",href:"#_3-4-修改文档","aria-label":'Permalink to "3.4 修改文档"'},"​")],-1)),l[259]||(l[259]=t("p",null,"修改有两种方式：",-1)),l[260]||(l[260]=t("ul",null,[t("li",null,"全量修改：直接覆盖原来的文档"),t("li",null,"增量修改：修改文档中的部分字段")],-1)),l[261]||(l[261]=t("h4",{id:"_3-4-1-全量修改",tabindex:"-1"},[E("3.4.1 全量修改 "),t("a",{class:"header-anchor",href:"#_3-4-1-全量修改","aria-label":'Permalink to "3.4.1 全量修改"'},"​")],-1)),l[262]||(l[262]=t("p",null,"全量修改是覆盖原来的文档，其本质是：",-1)),l[263]||(l[263]=t("ul",null,[t("li",null,"根据指定的id删除文档"),t("li",null,"新增一个相同id的文档")],-1)),l[264]||(l[264]=t("p",null,[t("strong",null,"注意"),E("：如果根据id删除时，id不存在，第二步的新增也会执行，也就从修改变成了新增操作了。")],-1)),l[265]||(l[265]=t("p",null,[t("strong",null,"语法：")],-1)),l[266]||(l[266]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"PUT /{"),t("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"索引库名"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}/_doc/文档id")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "字段1"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"值1"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "字段2"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"值2"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // ... 略")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[267]||(l[267]=t("p",null,[t("strong",null,"示例：")],-1)),l[268]||(l[268]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"PUT /heima/_doc/"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "info"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"黑马程序员高级Java讲师"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "email"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"zy@itcast.cn"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "name"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "firstName"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"云"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "lastName"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"赵"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[269]||(l[269]=t("h4",{id:"_3-4-2-增量修改",tabindex:"-1"},[E("3.4.2 增量修改 "),t("a",{class:"header-anchor",href:"#_3-4-2-增量修改","aria-label":'Permalink to "3.4.2 增量修改"'},"​")],-1)),l[270]||(l[270]=t("p",null,"增量修改是只修改指定id匹配的文档中的部分字段。",-1)),l[271]||(l[271]=t("p",null,[t("strong",null,"语法：")],-1)),l[272]||(l[272]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"POST /{"),t("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"索引库名"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}/_update/文档id")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "doc"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'         "字段名"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"新的值"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[273]||(l[273]=t("p",null,[t("strong",null,"示例：")],-1)),l[274]||(l[274]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"POST /heima/_update/"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "doc"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "email"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"ZhaoYun@itcast.cn"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[275]||(l[275]=t("h3",{id:"_3-5-总结",tabindex:"-1"},[E("3.5 总结 "),t("a",{class:"header-anchor",href:"#_3-5-总结","aria-label":'Permalink to "3.5 总结"'},"​")],-1)),l[276]||(l[276]=t("blockquote",null,[t("ul",null,[t("li",null,[t("p",null,"文档操作有哪些？"),t("ul",null,[t("li",{"json文档":""},[t("p",null,"创建文档：POST /{索引库名}/_doc/文档id ")]),t("li",null,[t("p",null,"查询文档：GET /{索引库名}/_doc/文档id")]),t("li",null,[t("p",null,"删除文档：DELETE /{索引库名}/_doc/文档id")]),t("li",null,[t("p",null,"修改文档："),t("ul",null,[t("li",{"json文档":""},[E("全量修改：PUT /{索引库名}/_doc/文档id "),t("ul",null,[t("li",null,'增量修改：POST /{索引库名}/_update/文档id { "doc": {字段}}')])])])])])])])],-1)),l[277]||(l[277]=t("hr",null,null,-1)),l[278]||(l[278]=t("h2",{id:"_4-restapi",tabindex:"-1"},[E("4. RestAPI "),t("a",{class:"header-anchor",href:"#_4-restapi","aria-label":'Permalink to "4. RestAPI"'},"​")],-1)),l[279]||(l[279]=t("p",null,[E("ES官方提供了各种不同语言的客户端，用来操作ES。这些客户端的本质就是组装DSL语句，通过http请求发送给ES。官方文档地址："),t("a",{href:"https://www.elastic.co/guide/en/elasticsearch/client/index.html",target:"_blank",rel:"noreferrer"},"https://www.elastic.co/guide/en/elasticsearch/client/index.html")],-1)),l[280]||(l[280]=t("p",null,"其中的Java Rest Client又包括两种：",-1)),l[281]||(l[281]=t("ul",null,[t("li",null,"Java Low Level Rest Client"),t("li",null,"Java High Level Rest Client")],-1)),l[282]||(l[282]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720214555863.png",alt:"image-20210720214555863",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[283]||(l[283]=t("p",null,"我们学习的是Java HighLevel Rest Client客户端API",-1)),l[284]||(l[284]=t("h3",{id:"_4-0-导入demo工程",tabindex:"-1"},[E("4.0 导入Demo工程 "),t("a",{class:"header-anchor",href:"#_4-0-导入demo工程","aria-label":'Permalink to "4.0 导入Demo工程"'},"​")],-1)),l[285]||(l[285]=t("h4",{id:"_4-0-1-导入数据",tabindex:"-1"},[E("4.0.1 导入数据 "),t("a",{class:"header-anchor",href:"#_4-0-1-导入数据","aria-label":'Permalink to "4.0.1 导入数据"'},"​")],-1)),l[286]||(l[286]=t("p",null,"首先导入课前资料提供的数据库数据：",-1)),l[287]||(l[287]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720220400297.png",alt:"image-20210720220400297",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[288]||(l[288]=t("p",null,"数据结构如下：",-1)),l[289]||(l[289]=t("div",{class:"language-sql max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"sql"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"CREATE"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," TABLE"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," `"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"tb_hotel"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"` (")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  `id`"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," bigint"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"20"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"NOT NULL"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," COMMENT "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'酒店id'"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  `name`"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," varchar"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"255"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"NOT NULL"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," COMMENT "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'酒店名称；例：7天酒店'"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  `address`"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," varchar"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"255"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"NOT NULL"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," COMMENT "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'酒店地址；例：航头路'"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  `price`"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," int"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"10"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"NOT NULL"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," COMMENT "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'酒店价格；例：329'"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  `score`"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," int"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"NOT NULL"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," COMMENT "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'酒店评分；例：45，就是4.5分'"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  `brand`"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," varchar"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"32"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"NOT NULL"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," COMMENT "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'酒店品牌；例：如家'"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  `city`"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," varchar"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"32"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"NOT NULL"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," COMMENT "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'所在城市；例：上海'"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  `star_name`"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," varchar"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"16"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"DEFAULT"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," NULL"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," COMMENT "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'酒店星级，从低到高分别是：1星到5星，1钻到5钻'"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  `business`"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," varchar"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"255"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"DEFAULT"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," NULL"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," COMMENT "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'商圈；例：虹桥'"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  `latitude`"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," varchar"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"32"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"NOT NULL"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," COMMENT "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'纬度；例：31.2497'"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  `longitude`"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," varchar"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"32"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"NOT NULL"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," COMMENT "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'经度；例：120.3925'"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  `pic`"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," varchar"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"255"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"DEFAULT"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," NULL"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," COMMENT "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'酒店图片；例:/img/1.jpg'"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"  PRIMARY KEY"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"`id`"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") ENGINE"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"InnoDB "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"DEFAULT"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," CHARSET"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"utf8mb4;")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[290]||(l[290]=t("h4",{id:"_4-0-2-导入项目",tabindex:"-1"},[E("4.0.2 导入项目 "),t("a",{class:"header-anchor",href:"#_4-0-2-导入项目","aria-label":'Permalink to "4.0.2 导入项目"'},"​")],-1)),l[291]||(l[291]=t("p",null,"然后导入课前资料提供的项目:",-1)),l[292]||(l[292]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720220503411.png",alt:"image-20210720220503411",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[293]||(l[293]=t("p",null,"项目结构如图：",-1)),l[294]||(l[294]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720220647541.png",alt:"image-20210720220647541",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[295]||(l[295]=t("h4",{id:"_4-0-3-mapping映射分析",tabindex:"-1"},[E("4.0.3 mapping映射分析 "),t("a",{class:"header-anchor",href:"#_4-0-3-mapping映射分析","aria-label":'Permalink to "4.0.3 mapping映射分析"'},"​")],-1)),l[296]||(l[296]=t("p",null,"创建索引库，最关键的是mapping映射，而mapping映射要考虑的信息包括：",-1)),l[297]||(l[297]=t("ul",null,[t("li",null,"字段名"),t("li",null,"字段数据类型"),t("li",null,"是否参与搜索"),t("li",null,"是否需要分词"),t("li",null,"如果分词，分词器是什么？")],-1)),l[298]||(l[298]=t("p",null,"其中：",-1)),l[299]||(l[299]=t("ul",null,[t("li",null,"字段名、字段数据类型，可以参考数据表结构的名称和类型"),t("li",null,"是否参与搜索要分析业务来判断，例如图片地址，就无需参与搜索"),t("li",null,"是否分词呢要看内容，内容如果是一个整体就无需分词，反之则要分词"),t("li",null,"分词器，我们可以统一使用ik_max_word")],-1)),l[300]||(l[300]=t("p",null,"来看下酒店数据的索引库结构:",-1)),l[301]||(l[301]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"PUT /hotel")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "mappings"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "properties"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "id"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"keyword"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "name"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"text"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "analyzer"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"ik_max_word"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "copy_to"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"all"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "address"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"keyword"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "index"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"false")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "price"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"integer"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "score"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"integer"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "brand"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"keyword"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "copy_to"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"all"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "city"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"keyword"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "copy_to"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"all"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "starName"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"keyword"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "business"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"keyword"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "location"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"geo_point"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "pic"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"keyword"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "index"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"false")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "all"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"text"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "analyzer"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"ik_max_word"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[302]||(l[302]=t("p",null,"几个特殊字段说明：",-1)),l[303]||(l[303]=t("ul",null,[t("li",null,"location：地理坐标，里面包含精度、纬度"),t("li",null,"all：一个组合字段，其目的是将多字段的值 利用copy_to合并，提供给用户搜索")],-1)),l[304]||(l[304]=t("p",null,"地理坐标说明：",-1)),l[305]||(l[305]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720222110126.png",alt:"image-20210720222110126",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[306]||(l[306]=t("p",null,"copy_to说明：",-1)),l[307]||(l[307]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720222221516.png",alt:"image-20210720222221516",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[308]||(l[308]=t("h4",{id:"_4-0-4-初始化restclient",tabindex:"-1"},[E("4.0.4 初始化RestClient "),t("a",{class:"header-anchor",href:"#_4-0-4-初始化restclient","aria-label":'Permalink to "4.0.4 初始化RestClient"'},"​")],-1)),l[309]||(l[309]=t("p",null,"在elasticsearch提供的API中，与elasticsearch一切交互都封装在一个名为RestHighLevelClient的类中，必须先完成这个对象的初始化，建立与elasticsearch的连接。",-1)),l[310]||(l[310]=t("p",null,"分为三步：",-1)),l[311]||(l[311]=t("p",null,"1）引入es的RestHighLevelClient依赖：",-1)),l[312]||(l[312]=t("div",{class:"language-xml max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"xml"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),t("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"dependency"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    <"),t("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"groupId"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">org.elasticsearch.client</"),t("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"groupId"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    <"),t("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"artifactId"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">elasticsearch-rest-high-level-client</"),t("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"artifactId"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"</"),t("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"dependency"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[313]||(l[313]=t("p",null,"2）因为SpringBoot默认的ES版本是7.6.2，所以我们需要覆盖默认的ES版本：",-1)),l[314]||(l[314]=t("div",{class:"language-xml max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"xml"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),t("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"properties"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    <"),t("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"java.version"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">1.8</"),t("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"java.version"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    <"),t("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"elasticsearch.version"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">7.12.1</"),t("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"elasticsearch.version"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"</"),t("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"properties"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[315]||(l[315]=t("p",null,"3）初始化RestHighLevelClient：",-1)),l[316]||(l[316]=t("p",null,"初始化的代码如下：",-1)),l[317]||(l[317]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"RestHighLevelClient client "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," RestHighLevelClient"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(RestClient."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"builder"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        HttpHost."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"create"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"http://192.168.150.101:9200"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"));")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[318]||(l[318]=t("p",null,"这里为了单元测试方便，我们创建一个测试类HotelIndexTest，然后将初始化的代码编写在@BeforeEach方法中：",-1)),l[319]||(l[319]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"package"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," cn.itcast.hotel;")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.apache.http.HttpHost;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.elasticsearch.client.RestHighLevelClient;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.junit.jupiter.api.AfterEach;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.junit.jupiter.api.BeforeEach;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.junit.jupiter.api.Test;")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," java.io.IOException;")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HotelIndexTest"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RestHighLevelClient client;")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"BeforeEach")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    void"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," setUp"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".client "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," RestHighLevelClient"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(RestClient."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"builder"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                HttpHost."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"create"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"http://192.168.150.101:9200"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        ));")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"AfterEach")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    void"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," tearDown"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"throws"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," IOException {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".client."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"close"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[320]||(l[320]=t("h3",{id:"_4-1-创建索引库",tabindex:"-1"},[E("4.1 创建索引库 "),t("a",{class:"header-anchor",href:"#_4-1-创建索引库","aria-label":'Permalink to "4.1 创建索引库"'},"​")],-1)),l[321]||(l[321]=t("h4",{id:"_4-1-1-代码解读",tabindex:"-1"},[E("4.1.1 代码解读 "),t("a",{class:"header-anchor",href:"#_4-1-1-代码解读","aria-label":'Permalink to "4.1.1 代码解读"'},"​")],-1)),l[322]||(l[322]=t("p",null,"创建索引库的API如下：",-1)),l[323]||(l[323]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720223049408.png",alt:"image-20210720223049408",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[324]||(l[324]=t("p",null,"代码分为三步：",-1)),l[325]||(l[325]=t("ul",null,[t("li",null,"1）创建Request对象。因为是创建索引库的操作，因此Request是CreateIndexRequest。"),t("li",null,"2）添加请求参数，其实就是DSL的JSON参数部分。因为json字符串很长，这里是定义了静态字符串常量MAPPING_TEMPLATE，让代码看起来更加优雅。"),t("li",null,"3）发送请求，client.indices()方法的返回值是IndicesClient类型，封装了所有与索引库操作有关的方法。")],-1)),l[326]||(l[326]=t("h4",{id:"_4-1-2-完整示例",tabindex:"-1"},[E("4.1.2 完整示例 "),t("a",{class:"header-anchor",href:"#_4-1-2-完整示例","aria-label":'Permalink to "4.1.2 完整示例"'},"​")],-1)),l[327]||(l[327]=t("p",null,"在hotel-demo的cn.itcast.hotel.constants包下，创建一个类，定义mapping映射的JSON字符串常量：",-1)),l[328]||(l[328]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"package"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," cn.itcast.hotel.constants;")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HotelConstants"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," final"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String MAPPING_TEMPLATE "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "{'),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "  '),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"mappings"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": {"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "    '),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"properties"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": {"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      '),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"id"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": {"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"type"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"keyword"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"\\n'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      },'),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      '),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"name"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},":{"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"type"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"text"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},","),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"analyzer"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"ik_max_word"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},","),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"copy_to"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"all"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"\\n'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      },'),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      '),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"address"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},":{"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"type"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"keyword"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},","),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"index"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": false"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      },'),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      '),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"price"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},":{"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"type"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"integer"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"\\n'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      },'),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      '),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"score"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},":{"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"type"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"integer"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"\\n'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      },'),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      '),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"brand"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},":{"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"type"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"keyword"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},","),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"copy_to"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"all"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"\\n'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      },'),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      '),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"city"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},":{"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"type"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"keyword"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},","),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"copy_to"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"all"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"\\n'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      },'),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      '),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"starName"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},":{"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"type"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"keyword"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"\\n'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      },'),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      '),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"business"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},":{"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"type"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"keyword"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"\\n'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      },'),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      '),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"location"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},":{"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"type"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"geo_point"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"\\n'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      },'),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      '),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"pic"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},":{"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"type"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"keyword"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},","),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"index"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": false"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      },'),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      '),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"all"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},":{"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"type"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"text"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},","),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"analyzer"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"ik_max_word"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"\\n'),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      }'),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "    }'),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "  }'),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "}"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[329]||(l[329]=t("p",null,"在hotel-demo中的HotelIndexTest测试类中，编写单元测试，实现创建索引：",-1)),l[330]||(l[330]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Test")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"void"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," createHotelIndex"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() throws IOException {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 1.创建Request对象")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    CreateIndexRequest request "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," CreateIndexRequest"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.准备请求的参数：DSL语句")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    request."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(MAPPING_TEMPLATE, XContentType.JSON);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 3.发送请求")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    client."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"indices"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"create"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[331]||(l[331]=t("h3",{id:"_4-2-删除索引库",tabindex:"-1"},[E("4.2 删除索引库 "),t("a",{class:"header-anchor",href:"#_4-2-删除索引库","aria-label":'Permalink to "4.2 删除索引库"'},"​")],-1)),l[332]||(l[332]=t("p",null,"删除索引库的DSL语句非常简单：",-1)),l[333]||(l[333]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"DELETE /hotel")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[334]||(l[334]=t("p",null,"与创建索引库相比：",-1)),l[335]||(l[335]=t("ul",null,[t("li",null,"请求方式从PUT变为DELTE"),t("li",null,"请求路径不变"),t("li",null,"无请求参数")],-1)),l[336]||(l[336]=t("p",null,"所以代码的差异，注意体现在Request对象上。依然是三步走：",-1)),l[337]||(l[337]=t("ul",null,[t("li",null,"1）创建Request对象。这次是DeleteIndexRequest对象"),t("li",null,"2）准备参数。这里是无参"),t("li",null,"3）发送请求。改用delete方法")],-1)),l[338]||(l[338]=t("p",null,"在hotel-demo中的HotelIndexTest测试类中，编写单元测试，实现删除索引：",-1)),l[339]||(l[339]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Test")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"void"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testDeleteHotelIndex"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() throws IOException {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 1.创建Request对象")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    DeleteIndexRequest request "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," DeleteIndexRequest"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.发送请求")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    client."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"indices"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"delete"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[340]||(l[340]=t("h3",{id:"_4-3-判断索引库是否存在",tabindex:"-1"},[E("4.3 判断索引库是否存在 "),t("a",{class:"header-anchor",href:"#_4-3-判断索引库是否存在","aria-label":'Permalink to "4.3 判断索引库是否存在"'},"​")],-1)),l[341]||(l[341]=t("p",null,"判断索引库是否存在，本质就是查询，对应的DSL是：",-1)),l[342]||(l[342]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /hotel")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[343]||(l[343]=t("p",null,"因此与删除的Java代码流程是类似的。依然是三步走：",-1)),l[344]||(l[344]=t("ul",null,[t("li",null,"1）创建Request对象。这次是GetIndexRequest对象"),t("li",null,"2）准备参数。这里是无参"),t("li",null,"3）发送请求。改用exists方法")],-1)),l[345]||(l[345]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Test")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"void"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testExistsHotelIndex"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() throws IOException {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 1.创建Request对象")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    GetIndexRequest request "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," GetIndexRequest"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.发送请求")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    boolean"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," exists "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"indices"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"exists"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 3.输出")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    System.err."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(exists "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"?"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "索引库已经存在！"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," :"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "索引库不存在！"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[346]||(l[346]=t("h3",{id:"_4-4-总结",tabindex:"-1"},[E("4.4 总结 "),t("a",{class:"header-anchor",href:"#_4-4-总结","aria-label":'Permalink to "4.4 总结"'},"​")],-1)),l[347]||(l[347]=t("p",null,"JavaRestClient操作elasticsearch的流程基本类似。核心是client.indices()方法来获取索引库的操作对象。",-1)),l[348]||(l[348]=t("p",null,"索引库操作的基本步骤：",-1)),l[349]||(l[349]=t("ul",null,[t("li",null,"初始化RestHighLevelClient"),t("li",null,"创建XxxIndexRequest。XXX是Create、Get、Delete"),t("li",null,"准备DSL（ Create时需要，其它是无参）"),t("li",null,"发送请求。调用RestHighLevelClient#indices().xxx()方法，xxx是create、exists、delete")],-1)),l[350]||(l[350]=t("hr",null,null,-1)),l[351]||(l[351]=t("h2",{id:"_5-restclient操作文档",tabindex:"-1"},[E("5. RestClient操作文档 "),t("a",{class:"header-anchor",href:"#_5-restclient操作文档","aria-label":'Permalink to "5. RestClient操作文档"'},"​")],-1)),l[352]||(l[352]=t("p",null,"为了与索引库操作分离，我们再次参加一个测试类，做两件事情：",-1)),l[353]||(l[353]=t("ul",null,[t("li",null,"初始化RestHighLevelClient"),t("li",null,"我们的酒店数据在数据库，需要利用IHotelService去查询，所以注入这个接口")],-1)),l[354]||(l[354]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"package"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," cn.itcast.hotel;")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," cn.itcast.hotel.pojo.Hotel;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," cn.itcast.hotel.service.IHotelService;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.junit.jupiter.api.AfterEach;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.junit.jupiter.api.BeforeEach;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.junit.jupiter.api.Test;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.springframework.beans.factory.annotation.Autowired;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.springframework.boot.test.context.SpringBootTest;")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," java.io.IOException;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," java.util.List;")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"SpringBootTest")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HotelDocumentTest"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Autowired")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," IHotelService hotelService;")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RestHighLevelClient client;")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"BeforeEach")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    void"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," setUp"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".client "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," RestHighLevelClient"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(RestClient."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"builder"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                HttpHost."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"create"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"http://192.168.150.101:9200"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        ));")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"AfterEach")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    void"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," tearDown"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"throws"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," IOException {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".client."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"close"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[355]||(l[355]=t("h3",{id:"_5-1-新增文档",tabindex:"-1"},[E("5.1 新增文档 "),t("a",{class:"header-anchor",href:"#_5-1-新增文档","aria-label":'Permalink to "5.1 新增文档"'},"​")],-1)),l[356]||(l[356]=t("p",null,"我们要将数据库的酒店数据查询出来，写入elasticsearch中。",-1)),l[357]||(l[357]=t("h4",{id:"_5-1-1-索引库实体类",tabindex:"-1"},[E("5.1.1 索引库实体类 "),t("a",{class:"header-anchor",href:"#_5-1-1-索引库实体类","aria-label":'Permalink to "5.1.1 索引库实体类"'},"​")],-1)),l[358]||(l[358]=t("p",null,"数据库查询后的结果是一个Hotel类型的对象。结构如下：",-1)),l[359]||(l[359]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Data")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"TableName"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"tb_hotel"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Hotel"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"TableId"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"type"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," IdType.INPUT)")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Long id;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String name;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String address;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer price;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer score;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String brand;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String city;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String starName;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String business;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String longitude;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String latitude;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String pic;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[360]||(l[360]=t("p",null,"与我们的索引库结构存在差异：",-1)),l[361]||(l[361]=t("ul",null,[t("li",null,"longitude和latitude需要合并为location")],-1)),l[362]||(l[362]=t("p",null,"因此，我们需要定义一个新的类型，与索引库结构吻合：",-1)),l[363]||(l[363]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"package"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," cn.itcast.hotel.pojo;")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," lombok.Data;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," lombok.NoArgsConstructor;")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Data")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"NoArgsConstructor")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HotelDoc"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Long id;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String name;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String address;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer price;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer score;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String brand;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String city;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String starName;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String business;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String location;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String pic;")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HotelDoc"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Hotel "),t("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"hotel"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".id "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getId"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".name "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getName"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".address "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getAddress"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".price "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getPrice"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".score "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getScore"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".brand "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getBrand"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".city "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getCity"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".starName "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getStarName"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".business "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getBusiness"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".location "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getLatitude"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' ", "'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getLongitude"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".pic "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getPic"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[364]||(l[364]=t("h4",{id:"_5-1-2-语法说明",tabindex:"-1"},[E("5.1.2 语法说明 "),t("a",{class:"header-anchor",href:"#_5-1-2-语法说明","aria-label":'Permalink to "5.1.2 语法说明"'},"​")],-1)),l[365]||(l[365]=t("p",null,"新增文档的DSL语句如下：",-1)),l[366]||(l[366]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"POST /{"),t("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"索引库名"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}/_doc/"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "name"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Jack"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "age"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"21")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[367]||(l[367]=t("p",null,"对应的java代码如图：",-1)),l[368]||(l[368]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720230027240.png",alt:"image-20210720230027240",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[369]||(l[369]=t("p",null,"可以看到与创建索引库类似，同样是三步走：",-1)),l[370]||(l[370]=t("ul",null,[t("li",null,"1）创建Request对象"),t("li",null,"2）准备请求参数，也就是DSL中的JSON文档"),t("li",null,"3）发送请求")],-1)),l[371]||(l[371]=t("p",null,"变化的地方在于，这里直接使用client.xxx()的API，不再需要client.indices()了。",-1)),l[372]||(l[372]=t("h4",{id:"_5-1-3-完整代码",tabindex:"-1"},[E("5.1.3 完整代码 "),t("a",{class:"header-anchor",href:"#_5-1-3-完整代码","aria-label":'Permalink to "5.1.3 完整代码"'},"​")],-1)),l[373]||(l[373]=t("p",null,"我们导入酒店数据，基本流程一致，但是需要考虑几点变化：",-1)),l[374]||(l[374]=t("ul",null,[t("li",null,"酒店数据来自于数据库，我们需要先查询出来，得到hotel对象"),t("li",null,"hotel对象需要转为HotelDoc对象"),t("li",null,"HotelDoc需要序列化为json格式")],-1)),l[375]||(l[375]=t("p",null,"因此，代码整体步骤如下：",-1)),l[376]||(l[376]=t("ul",null,[t("li",null,"1）根据id查询酒店数据Hotel"),t("li",null,"2）将Hotel封装为HotelDoc"),t("li",null,"3）将HotelDoc序列化为JSON"),t("li",null,"4）创建IndexRequest，指定索引库名和id"),t("li",null,"5）准备请求参数，也就是JSON文档"),t("li",null,"6）发送请求")],-1)),l[377]||(l[377]=t("p",null,"在hotel-demo的HotelDocumentTest测试类中，编写单元测试：",-1)),l[378]||(l[378]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Test")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"void"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testAddDocument"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() throws IOException {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 1.根据id查询酒店数据")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    Hotel hotel "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotelService."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getById"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"61083L"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.转换为文档类型")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    HotelDoc hotelDoc "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HotelDoc"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(hotel);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 3.将HotelDoc转json")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String json "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," JSON."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"toJSONString"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(hotelDoc);")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 1.准备Request对象")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    IndexRequest request "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," IndexRequest"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"id"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(hotelDoc."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getId"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"toString"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.准备Json文档")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    request."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(json, XContentType.JSON);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 3.发送请求")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    client."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"index"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[379]||(l[379]=t("h3",{id:"_5-2-查询文档",tabindex:"-1"},[E("5.2 查询文档 "),t("a",{class:"header-anchor",href:"#_5-2-查询文档","aria-label":'Permalink to "5.2 查询文档"'},"​")],-1)),l[380]||(l[380]=t("h4",{id:"_5-2-1-语法说明",tabindex:"-1"},[E("5.2.1 语法说明 "),t("a",{class:"header-anchor",href:"#_5-2-1-语法说明","aria-label":'Permalink to "5.2.1 语法说明"'},"​")],-1)),l[381]||(l[381]=t("p",null,"查询的DSL语句如下：",-1)),l[382]||(l[382]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /hotel/_doc/{"),t("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"id"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[383]||(l[383]=t("p",null,"非常简单，因此代码大概分两步：",-1)),l[384]||(l[384]=t("ul",null,[t("li",null,"准备Request对象"),t("li",null,"发送请求")],-1)),l[385]||(l[385]=t("p",null,"不过查询的目的是得到结果，解析为HotelDoc，因此难点是结果的解析。完整代码如下：",-1)),l[386]||(l[386]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720230811674.png",alt:"image-20210720230811674",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[387]||(l[387]=t("p",null,[E("可以看到，结果是一个JSON，其中文档放在一个"),t("code",null,"_source"),E("属性中，因此解析就是拿到"),t("code",null,"_source"),E("，反序列化为Java对象即可。")],-1)),l[388]||(l[388]=t("p",null,"与之前类似，也是三步走：",-1)),l[389]||(l[389]=t("ul",null,[t("li",null,"1）准备Request对象。这次是查询，所以是GetRequest"),t("li",null,"2）发送请求，得到结果。因为是查询，这里调用client.get()方法"),t("li",null,"3）解析结果，就是对JSON做反序列化")],-1)),l[390]||(l[390]=t("h4",{id:"_5-2-2-完整代码",tabindex:"-1"},[E("5.2.2 完整代码 "),t("a",{class:"header-anchor",href:"#_5-2-2-完整代码","aria-label":'Permalink to "5.2.2 完整代码"'},"​")],-1)),l[391]||(l[391]=t("p",null,"在hotel-demo的HotelDocumentTest测试类中，编写单元测试：",-1)),l[392]||(l[392]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Test")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"void"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testGetDocumentById"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() throws IOException {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 1.准备Request")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    GetRequest request "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," GetRequest"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"61082"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.发送请求，得到响应")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    GetResponse response "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"get"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 3.解析响应结果")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String json "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," response."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getSourceAsString"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    HotelDoc hotelDoc "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," JSON."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"parseObject"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(json, HotelDoc.class);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    System.out."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(hotelDoc);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[393]||(l[393]=t("h3",{id:"_5-3-删除文档",tabindex:"-1"},[E("5.3 删除文档 "),t("a",{class:"header-anchor",href:"#_5-3-删除文档","aria-label":'Permalink to "5.3 删除文档"'},"​")],-1)),l[394]||(l[394]=t("p",null,"删除的DSL为是这样的：",-1)),l[395]||(l[395]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"DELETE /hotel/_doc/{"),t("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"id"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[396]||(l[396]=t("p",null,"与查询相比，仅仅是请求方式从DELETE变成GET，可以想象Java代码应该依然是三步走：",-1)),l[397]||(l[397]=t("ul",null,[t("li",null,"1）准备Request对象，因为是删除，这次是DeleteRequest对象。要指定索引库名和id"),t("li",null,"2）准备参数，无参"),t("li",null,"3）发送请求。因为是删除，所以是client.delete()方法")],-1)),l[398]||(l[398]=t("p",null,"在hotel-demo的HotelDocumentTest测试类中，编写单元测试：",-1)),l[399]||(l[399]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Test")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"void"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testDeleteDocument"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() throws IOException {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 1.准备Request")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    DeleteRequest request "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," DeleteRequest"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"61083"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.发送请求")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    client."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"delete"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[400]||(l[400]=t("h3",{id:"_5-4-修改文档",tabindex:"-1"},[E("5.4 修改文档 "),t("a",{class:"header-anchor",href:"#_5-4-修改文档","aria-label":'Permalink to "5.4 修改文档"'},"​")],-1)),l[401]||(l[401]=t("h4",{id:"_5-4-1-语法说明",tabindex:"-1"},[E("5.4.1 语法说明 "),t("a",{class:"header-anchor",href:"#_5-4-1-语法说明","aria-label":'Permalink to "5.4.1 语法说明"'},"​")],-1)),l[402]||(l[402]=t("p",null,"修改我们讲过两种方式：",-1)),l[403]||(l[403]=t("ul",null,[t("li",null,"全量修改：本质是先根据id删除，再新增"),t("li",null,"增量修改：修改文档中的指定字段值")],-1)),l[404]||(l[404]=t("p",null,"在RestClient的API中，全量修改与新增的API完全一致，判断依据是ID：",-1)),l[405]||(l[405]=t("ul",null,[t("li",null,"如果新增时，ID已经存在，则修改"),t("li",null,"如果新增时，ID不存在，则新增")],-1)),l[406]||(l[406]=t("p",null,"这里不再赘述，我们主要关注增量修改。",-1)),l[407]||(l[407]=t("p",null,"代码示例如图：",-1)),l[408]||(l[408]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720231040875.png",alt:"image-20210720231040875",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[409]||(l[409]=t("p",null,"与之前类似，也是三步走：",-1)),l[410]||(l[410]=t("ul",null,[t("li",null,"1）准备Request对象。这次是修改，所以是UpdateRequest"),t("li",null,"2）准备参数。也就是JSON文档，里面包含要修改的字段"),t("li",null,"3）更新文档。这里调用client.update()方法")],-1)),l[411]||(l[411]=t("h4",{id:"_5-4-2-完整代码",tabindex:"-1"},[E("5.4.2 完整代码 "),t("a",{class:"header-anchor",href:"#_5-4-2-完整代码","aria-label":'Permalink to "5.4.2 完整代码"'},"​")],-1)),l[412]||(l[412]=t("p",null,"在hotel-demo的HotelDocumentTest测试类中，编写单元测试：",-1)),l[413]||(l[413]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Test")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"void"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testUpdateDocument"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() throws IOException {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 1.准备Request")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    UpdateRequest request "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," UpdateRequest"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"61083"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.准备请求参数")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    request."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"doc"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'        "price"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"952"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'        "starName"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"四钻"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    );")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 3.发送请求")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    client."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"update"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[414]||(l[414]=t("h3",{id:"_5-5-批量导入文档",tabindex:"-1"},[E("5.5 批量导入文档 "),t("a",{class:"header-anchor",href:"#_5-5-批量导入文档","aria-label":'Permalink to "5.5 批量导入文档"'},"​")],-1)),l[415]||(l[415]=t("p",null,"案例需求：利用BulkRequest批量将数据库数据导入到索引库中。",-1)),l[416]||(l[416]=t("p",null,"步骤如下：",-1)),l[417]||(l[417]=t("ul",null,[t("li",null,[t("p",null,"利用mybatis-plus查询酒店数据")]),t("li",null,[t("p",null,"将查询到的酒店数据（Hotel）转换为文档类型数据（HotelDoc）")]),t("li",null,[t("p",null,"利用JavaRestClient中的BulkRequest批处理，实现批量新增文档")])],-1)),l[418]||(l[418]=t("h4",{id:"_5-5-1-语法说明",tabindex:"-1"},[E("5.5.1 语法说明 "),t("a",{class:"header-anchor",href:"#_5-5-1-语法说明","aria-label":'Permalink to "5.5.1 语法说明"'},"​")],-1)),l[419]||(l[419]=t("p",null,"批量处理BulkRequest，其本质就是将多个普通的CRUD请求组合在一起发送。",-1)),l[420]||(l[420]=t("p",null,"其中提供了一个add方法，用来添加其他请求：",-1)),l[421]||(l[421]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720232105943.png",alt:"image-20210720232105943",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[422]||(l[422]=t("p",null,"可以看到，能添加的请求包括：",-1)),l[423]||(l[423]=t("ul",null,[t("li",null,"IndexRequest，也就是新增"),t("li",null,"UpdateRequest，也就是修改"),t("li",null,"DeleteRequest，也就是删除")],-1)),l[424]||(l[424]=t("p",null,"因此Bulk中添加了多个IndexRequest，就是批量新增功能了。示例：",-1)),l[425]||(l[425]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720232431383.png",alt:"image-20210720232431383",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[426]||(l[426]=t("p",null,"其实还是三步走：",-1)),l[427]||(l[427]=t("ul",null,[t("li",null,"1）创建Request对象。这里是BulkRequest"),t("li",null,"2）准备参数。批处理的参数，就是其它Request对象，这里就是多个IndexRequest"),t("li",null,"3）发起请求。这里是批处理，调用的方法为client.bulk()方法")],-1)),l[428]||(l[428]=t("p",null,"我们在导入酒店数据时，将上述代码改造成for循环处理即可。",-1)),l[429]||(l[429]=t("h4",{id:"_5-5-2-完整代码",tabindex:"-1"},[E("5.5.2 完整代码 "),t("a",{class:"header-anchor",href:"#_5-5-2-完整代码","aria-label":'Permalink to "5.5.2 完整代码"'},"​")],-1)),l[430]||(l[430]=t("p",null,"在hotel-demo的HotelDocumentTest测试类中，编写单元测试：",-1)),l[431]||(l[431]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Test")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"void"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testBulkRequest"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() throws IOException {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 批量查询酒店数据")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    List<"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Hotel"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> hotels "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotelService."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"list"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 1.创建Request")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    BulkRequest request "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," BulkRequest"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.准备参数，添加多个新增的Request")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    for"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (Hotel hotel "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotels) {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 2.1.转换为文档类型HotelDoc")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        HotelDoc hotelDoc "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HotelDoc"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(hotel);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 2.2.创建新增文档的Request对象")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        request."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"add"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," IndexRequest"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    ."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"id"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(hotelDoc."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getId"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"toString"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    ."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(JSON."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"toJSONString"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(hotelDoc), XContentType.JSON));")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 3.发送请求")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    client."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bulk"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[432]||(l[432]=t("h3",{id:"_5-6-小结",tabindex:"-1"},[E("5.6 小结 "),t("a",{class:"header-anchor",href:"#_5-6-小结","aria-label":'Permalink to "5.6 小结"'},"​")],-1)),l[433]||(l[433]=t("blockquote",null,[t("ul",null,[t("li",null,[t("p",null,"文档操作的基本步骤："),t("ul",null,[t("li",null,[t("p",null,"初始化RestHighLevelClient")]),t("li",null,[t("p",null,"创建XxxRequest。XXX是Index、Get、Update、Delete、Bulk")]),t("li",null,[t("p",null,"准备参数（Index、Update、Bulk时需要）")]),t("li",null,[t("p",null,"发送请求。调用RestHighLevelClient#.xxx()方法，xxx是index、get、update、delete、bulk")]),t("li",null,[t("p",null,"解析结果（Get时需要）")])])])])],-1)),l[434]||(l[434]=t("hr",null,null,-1)),l[435]||(l[435]=t("h2",{id:"_6-dsl查询文档",tabindex:"-1"},[E("6. DSL查询文档 "),t("a",{class:"header-anchor",href:"#_6-dsl查询文档","aria-label":'Permalink to "6. DSL查询文档"'},"​")],-1)),l[436]||(l[436]=t("p",null,"elasticsearch的查询依然是基于JSON风格的DSL来实现的。",-1)),l[437]||(l[437]=t("h3",{id:"_6-1-dsl查询分类",tabindex:"-1"},[E("6.1 DSL查询分类 "),t("a",{class:"header-anchor",href:"#_6-1-dsl查询分类","aria-label":'Permalink to "6.1 DSL查询分类"'},"​")],-1)),l[438]||(l[438]=t("p",null,[E("Elasticsearch提供了基于JSON的DSL（"),t("a",{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl.html",target:"_blank",rel:"noreferrer"},"Domain Specific Language"),E("）来定义查询。常见的查询类型包括：")],-1)),l[439]||(l[439]=t("ul",null,[t("li",null,[t("p",null,[t("strong",null,"查询所有"),E("：查询出所有数据，一般测试用。例如：match_all")])]),t("li",null,[t("p",null,[t("strong",null,"全文检索（full text）查询"),E("：利用分词器对用户输入内容分词，然后去倒排索引库中匹配。例如：")]),t("ul",null,[t("li",null,"match_query"),t("li",null,"multi_match_query")])]),t("li",null,[t("p",null,[t("strong",null,"精确查询"),E("：根据精确词条值查找数据，一般是查找keyword、数值、日期、boolean等类型字段。例如：")]),t("ul",null,[t("li",null,"ids"),t("li",null,"range"),t("li",null,"term")])]),t("li",null,[t("p",null,[t("strong",null,"地理（geo）查询"),E("：根据经纬度查询。例如：")]),t("ul",null,[t("li",null,"geo_distance"),t("li",null,"geo_bounding_box")])]),t("li",null,[t("p",null,[t("strong",null,"复合（compound）查询"),E("：复合查询可以将上述各种查询条件组合起来，合并查询条件。例如：")]),t("ul",null,[t("li",null,"bool"),t("li",null,"function_score")])])],-1)),l[440]||(l[440]=t("p",null,"查询的语法基本一致：",-1)),l[441]||(l[441]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /indexName/_search")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "query"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "查询类型"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "查询条件"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"条件值"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[442]||(l[442]=t("p",null,"我们以查询所有为例，其中：",-1)),l[443]||(l[443]=t("ul",null,[t("li",null,"查询类型为match_all"),t("li",null,"没有查询条件")],-1)),l[444]||(l[444]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 查询所有")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /indexName/_search")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "query"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "match_all"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[445]||(l[445]=t("p",null,[E("其它查询无非就是"),t("strong",null,"查询类型"),E("、"),t("strong",null,"查询条件"),E("的变化。")],-1)),l[446]||(l[446]=t("h3",{id:"_6-2-全文检索查询",tabindex:"-1"},[E("6.2 全文检索查询 "),t("a",{class:"header-anchor",href:"#_6-2-全文检索查询","aria-label":'Permalink to "6.2 全文检索查询"'},"​")],-1)),l[447]||(l[447]=t("h4",{id:"_6-2-1-使用场景",tabindex:"-1"},[E("6.2.1 使用场景 "),t("a",{class:"header-anchor",href:"#_6-2-1-使用场景","aria-label":'Permalink to "6.2.1 使用场景"'},"​")],-1)),l[448]||(l[448]=t("p",null,"全文检索查询的基本流程如下：",-1)),l[449]||(l[449]=t("ul",null,[t("li",null,"对用户搜索的内容做分词，得到词条"),t("li",null,"根据词条去倒排索引库中匹配，得到文档id"),t("li",null,"根据文档id找到文档，返回给用户")],-1)),l[450]||(l[450]=t("p",null,"比较常用的场景包括：",-1)),l[451]||(l[451]=t("ul",null,[t("li",null,"商城的输入框搜索"),t("li",null,"百度输入框搜索")],-1)),l[452]||(l[452]=t("p",null,"例如京东：",-1)),l[453]||(l[453]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721165326938.png",alt:"image-20210721165326938",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[454]||(l[454]=t("p",null,"因为是拿着词条去匹配，因此参与搜索的字段也必须是可分词的text类型的字段。",-1)),l[455]||(l[455]=t("h4",{id:"_6-2-2-基本语法",tabindex:"-1"},[E("6.2.2 基本语法 "),t("a",{class:"header-anchor",href:"#_6-2-2-基本语法","aria-label":'Permalink to "6.2.2 基本语法"'},"​")],-1)),l[456]||(l[456]=t("p",null,"常见的全文检索查询包括：",-1)),l[457]||(l[457]=t("ul",null,[t("li",null,"match查询：单字段查询"),t("li",null,"multi_match查询：多字段查询，任意一个字段符合条件就算符合查询条件")],-1)),l[458]||(l[458]=t("p",null,"match查询语法如下：",-1)),l[459]||(l[459]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /indexName/_search")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "query"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "match"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "FIELD"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"TEXT"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[460]||(l[460]=t("p",null,"mulit_match语法如下：",-1)),l[461]||(l[461]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /indexName/_search")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "query"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "multi_match"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "query"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"TEXT"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "fields"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": ["),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"FIELD1"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'" FIELD12"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[462]||(l[462]=t("h4",{id:"_6-2-3-示例",tabindex:"-1"},[E("6.2.3 示例 "),t("a",{class:"header-anchor",href:"#_6-2-3-示例","aria-label":'Permalink to "6.2.3 示例"'},"​")],-1)),l[463]||(l[463]=t("p",null,"match查询示例：",-1)),l[464]||(l[464]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721170455419.png",alt:"image-20210721170455419",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[465]||(l[465]=t("p",null,"multi_match查询示例：",-1)),l[466]||(l[466]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721170720691.png",alt:"image-20210721170720691",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[467]||(l[467]=t("p",null,"可以看到，两种查询结果是一样的，为什么？",-1)),l[468]||(l[468]=t("p",null,"因为我们将brand、name、business值都利用copy_to复制到了all字段中。因此你根据三个字段搜索，和根据all字段搜索效果当然一样了。",-1)),l[469]||(l[469]=t("p",null,"但是，搜索字段越多，对查询性能影响越大，因此建议采用copy_to，然后单字段查询的方式。",-1)),l[470]||(l[470]=t("h4",{id:"_6-2-4-总结",tabindex:"-1"},[E("6.2.4 总结 "),t("a",{class:"header-anchor",href:"#_6-2-4-总结","aria-label":'Permalink to "6.2.4 总结"'},"​")],-1)),l[471]||(l[471]=t("blockquote",null,[t("ul",null,[t("li",null,[t("p",null,"match和multi_match的区别是什么？"),t("ul",null,[t("li",null,[t("p",null,"match：根据一个字段查询")]),t("li",null,[t("p",null,"multi_match：根据多个字段查询，参与查询字段越多，查询性能越差")])])])])],-1)),l[472]||(l[472]=t("h3",{id:"_6-3-精准查询",tabindex:"-1"},[E("6.3 精准查询 "),t("a",{class:"header-anchor",href:"#_6-3-精准查询","aria-label":'Permalink to "6.3 精准查询"'},"​")],-1)),l[473]||(l[473]=t("p",null,[E("精确查询一般是查找keyword、数值、日期、boolean等类型字段。所以"),t("strong",null,"不会"),E("对搜索条件分词。常见的有：")],-1)),l[474]||(l[474]=t("ul",null,[t("li",null,"term：根据词条精确值查询"),t("li",null,"range：根据值的范围查询")],-1)),l[475]||(l[475]=t("h4",{id:"_6-3-1-term查询",tabindex:"-1"},[E("6.3.1 term查询 "),t("a",{class:"header-anchor",href:"#_6-3-1-term查询","aria-label":'Permalink to "6.3.1 term查询"'},"​")],-1)),l[476]||(l[476]=t("p",null,[E("因为精确查询的字段搜是不分词的字段，因此查询的条件也必须是"),t("strong",null,"不分词"),E("的词条。查询时，用户输入的内容跟自动值完全匹配时才认为符合条件。如果用户输入的内容过多，反而搜索不到数据。")],-1)),l[477]||(l[477]=t("p",null,"语法说明：",-1)),l[478]||(l[478]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// term查询")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /indexName/_search")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "query"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "term"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "FIELD"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "value"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"VALUE"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[479]||(l[479]=t("p",null,"示例：",-1)),l[480]||(l[480]=t("p",null,"当我搜索的是精确词条时，能正确查询出结果：",-1)),l[481]||(l[481]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721171655308.png",alt:"image-20210721171655308",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[482]||(l[482]=t("p",null,"但是，当我搜索的内容不是词条，而是多个词语形成的短语时，反而搜索不到：",-1)),l[483]||(l[483]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721171838378.png",alt:"image-20210721171838378",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[484]||(l[484]=t("h4",{id:"_6-3-2-range查询",tabindex:"-1"},[E("6.3.2 range查询 "),t("a",{class:"header-anchor",href:"#_6-3-2-range查询","aria-label":'Permalink to "6.3.2 range查询"'},"​")],-1)),l[485]||(l[485]=t("p",null,"范围查询，一般应用在对数值类型做范围过滤的时候。比如做价格范围过滤。",-1)),l[486]||(l[486]=t("p",null,"基本语法：",-1)),l[487]||(l[487]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// range查询")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /indexName/_search")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "query"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "range"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "FIELD"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "gte"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"10"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 这里的gte代表大于等于，gt则代表大于")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "lte"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"20"),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," // lte代表小于等于，lt则代表小于")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[488]||(l[488]=t("p",null,"示例：",-1)),l[489]||(l[489]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721172307172.png",alt:"image-20210721172307172",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[490]||(l[490]=t("h4",{id:"_6-3-3-总结",tabindex:"-1"},[E("6.3.3 总结 "),t("a",{class:"header-anchor",href:"#_6-3-3-总结","aria-label":'Permalink to "6.3.3 总结"'},"​")],-1)),l[491]||(l[491]=t("blockquote",null,[t("ul",null,[t("li",null,[t("p",null,"精确查询常见的有哪些？"),t("ul",null,[t("li",null,[t("p",null,"term查询：根据词条精确匹配，一般搜索keyword类型、数值类型、布尔类型、日期类型字段")]),t("li",null,[t("p",null,"range查询：根据数值范围查询，可以是数值、日期的范围")])])])])],-1)),l[492]||(l[492]=t("h3",{id:"_6-4-地理坐标查询",tabindex:"-1"},[E("6.4 地理坐标查询 "),t("a",{class:"header-anchor",href:"#_6-4-地理坐标查询","aria-label":'Permalink to "6.4 地理坐标查询"'},"​")],-1)),l[493]||(l[493]=t("p",null,[E("所谓的地理坐标查询，其实就是根据经纬度查询，官方文档："),t("a",{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/geo-queries.html",target:"_blank",rel:"noreferrer"},"https://www.elastic.co/guide/en/elasticsearch/reference/current/geo-queries.html")],-1)),l[494]||(l[494]=t("p",null,"常见的使用场景包括：",-1)),l[495]||(l[495]=t("ul",null,[t("li",null,"携程：搜索我附近的酒店"),t("li",null,"滴滴：搜索我附近的出租车"),t("li",null,"微信：搜索我附近的人")],-1)),l[496]||(l[496]=t("p",null,"附近的酒店：",-1)),l[497]||(l[497]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721172645103.png",alt:"image-20210721172645103",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[498]||(l[498]=t("p",null,"附近的车：",-1)),l[499]||(l[499]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721172654880.png",alt:"image-20210721172654880",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[500]||(l[500]=t("h4",{id:"_6-4-1-矩形范围查询",tabindex:"-1"},[E("6.4.1 矩形范围查询 "),t("a",{class:"header-anchor",href:"#_6-4-1-矩形范围查询","aria-label":'Permalink to "6.4.1 矩形范围查询"'},"​")],-1)),l[501]||(l[501]=t("p",null,"矩形范围查询，也就是geo_bounding_box查询，查询坐标落在某个矩形范围的所有文档：",-1)),l[502]||(l[502]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/DKV9HZbVS6.gif",alt:"DKV9HZbVS6",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[503]||(l[503]=t("p",null,[E("查询时，需要指定矩形的"),t("strong",null,"左上"),E("、"),t("strong",null,"右下"),E("两个点的坐标，然后画出一个矩形，落在该矩形内的都是符合条件的点。")],-1)),l[504]||(l[504]=t("p",null,"语法如下：",-1)),l[505]||(l[505]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// geo_bounding_box查询")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /indexName/_search")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "query"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "geo_bounding_box"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "FIELD"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "top_left"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": { "),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 左上点")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "lat"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"31.1"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "lon"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"121.5")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "bottom_right"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": { "),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 右下点")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "lat"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"30.9"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "lon"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"121.7")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[506]||(l[506]=t("p",null,"这种并不符合“附近的人”这样的需求，所以我们就不做了。",-1)),l[507]||(l[507]=t("h4",{id:"_6-4-2-附近查询",tabindex:"-1"},[E("6.4.2 附近查询 "),t("a",{class:"header-anchor",href:"#_6-4-2-附近查询","aria-label":'Permalink to "6.4.2 附近查询"'},"​")],-1)),l[508]||(l[508]=t("p",null,"附近查询，也叫做距离查询（geo_distance）：查询到指定中心点小于某个距离值的所有文档。",-1)),l[509]||(l[509]=t("p",null,"换句话来说，在地图上找一个点作为圆心，以指定距离为半径，画一个圆，落在圆内的坐标都算符合条件：",-1)),l[510]||(l[510]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/vZrdKAh19C.gif",alt:"vZrdKAh19C",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[511]||(l[511]=t("p",null,"语法说明：",-1)),l[512]||(l[512]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// geo_distance 查询")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /indexName/_search")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "query"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "geo_distance"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "distance"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"15km"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 半径")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "FIELD"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"31.21,121.5"'),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," // 圆心")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[513]||(l[513]=t("p",null,"示例：",-1)),l[514]||(l[514]=t("p",null,"我们先搜索陆家嘴附近15km的酒店：",-1)),l[515]||(l[515]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721175443234.png",alt:"image-20210721175443234",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[516]||(l[516]=t("p",null,"发现共有47家酒店。",-1)),l[517]||(l[517]=t("p",null,"然后把半径缩短到3公里：",-1)),l[518]||(l[518]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721182031475.png",alt:"image-20210721182031475",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[519]||(l[519]=t("p",null,"可以发现，搜索到的酒店数量减少到了5家。",-1)),l[520]||(l[520]=t("h3",{id:"_6-5-复合查询",tabindex:"-1"},[E("6.5 复合查询 "),t("a",{class:"header-anchor",href:"#_6-5-复合查询","aria-label":'Permalink to "6.5 复合查询"'},"​")],-1)),l[521]||(l[521]=t("p",null,"复合（compound）查询：复合查询可以将其它简单查询组合起来，实现更复杂的搜索逻辑。常见的有两种：",-1)),l[522]||(l[522]=t("ul",null,[t("li",null,"fuction score：算分函数查询，可以控制文档相关性算分，控制文档排名"),t("li",null,"bool query：布尔查询，利用逻辑关系组合多个其它的查询，实现复杂搜索")],-1)),l[523]||(l[523]=t("h4",{id:"_6-5-1-相关性算分",tabindex:"-1"},[E("6.5.1 相关性算分 "),t("a",{class:"header-anchor",href:"#_6-5-1-相关性算分","aria-label":'Permalink to "6.5.1 相关性算分"'},"​")],-1)),l[524]||(l[524]=t("p",null,"当我们利用match查询时，文档结果会根据与搜索词条的关联度打分（_score），返回结果时按照分值降序排列。",-1)),l[525]||(l[525]=t("p",null,'例如，我们搜索 "虹桥如家"，结果如下：',-1)),l[526]||(l[526]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "_score"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"17.850193"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "_source"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "name"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"虹桥如家酒店真不错"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "_score"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"12.259849"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "_source"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "name"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"外滩如家酒店真不错"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "_score"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"11.91091"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "_source"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "name"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"迪士尼如家酒店真不错"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[527]||(l[527]=t("p",null,"在elasticsearch中，早期使用的打分算法是TF-IDF算法，公式如下：",-1)),l[528]||(l[528]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721190152134.png",alt:"image-20210721190152134",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[529]||(l[529]=t("p",null,"在后来的5.1版本升级中，elasticsearch将算法改进为BM25算法，公式如下：",-1)),l[530]||(l[530]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721190416214.png",alt:"image-20210721190416214",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[531]||(l[531]=t("p",null,"TF-IDF算法有一各缺陷，就是词条频率越高，文档得分也会越高，单个词条对文档影响较大。而BM25则会让单个词条的算分有一个上限，曲线更加平滑：",-1)),l[532]||(l[532]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721190907320.png",alt:"image-20210721190907320",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[533]||(l[533]=t("p",null,"小结：elasticsearch会根据词条和文档的相关度做打分，算法由两种：",-1)),l[534]||(l[534]=t("ul",null,[t("li",null,"TF-IDF算法"),t("li",null,"BM25算法，elasticsearch5.1版本后采用的算法")],-1)),l[535]||(l[535]=t("h4",{id:"_6-5-2-算分函数查询",tabindex:"-1"},[E("6.5.2 算分函数查询 "),t("a",{class:"header-anchor",href:"#_6-5-2-算分函数查询","aria-label":'Permalink to "6.5.2 算分函数查询"'},"​")],-1)),l[536]||(l[536]=t("p",null,[E("根据相关度打分是比较合理的需求，但"),t("strong",null,"合理的不一定是产品经理需要"),E("的。")],-1)),l[537]||(l[537]=t("p",null,"以百度为例，你搜索的结果中，并不是相关度越高排名越靠前，而是谁掏的钱多排名就越靠前。如图：",-1)),l[538]||(l[538]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721191144560.png",alt:"image-20210721191144560",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[539]||(l[539]=t("p",null,"要想认为控制相关性算分，就需要利用elasticsearch中的function score 查询了。",-1)),l[540]||(l[540]=t("h5",{id:"_1-语法说明",tabindex:"-1"},[E("1）语法说明 "),t("a",{class:"header-anchor",href:"#_1-语法说明","aria-label":'Permalink to "1）语法说明"'},"​")],-1)),l[541]||(l[541]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721191544750.png",alt:"image-20210721191544750",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[542]||(l[542]=t("p",null,"function score 查询中包含四部分内容：",-1)),l[543]||(l[543]=t("ul",null,[t("li",null,[t("strong",null,"原始查询"),E("条件：query部分，基于这个条件搜索文档，并且基于BM25算法给文档打分，"),t("strong",null,"原始算分"),E("（query score)")]),t("li",null,[t("strong",null,"过滤条件"),E("：filter部分，符合该条件的文档才会重新算分")]),t("li",null,[t("strong",null,"算分函数"),E("：符合filter条件的文档要根据这个函数做运算，得到的"),t("strong",null,"函数算分"),E("（function score），有四种函数 "),t("ul",null,[t("li",null,"weight：函数结果是常量"),t("li",null,"field_value_factor：以文档中的某个字段值作为函数结果"),t("li",null,"random_score：以随机数作为函数结果"),t("li",null,"script_score：自定义算分函数算法")])]),t("li",null,[t("strong",null,"运算模式"),E("：算分函数的结果、原始查询的相关性算分，两者之间的运算方式，包括： "),t("ul",null,[t("li",null,"multiply：相乘"),t("li",null,"replace：用function score替换query score"),t("li",null,"其它，例如：sum、avg、max、min")])])],-1)),l[544]||(l[544]=t("p",null,"function score的运行流程如下：",-1)),l[545]||(l[545]=t("ul",null,[t("li",null,[E("1）根据"),t("strong",null,"原始条件"),E("查询搜索文档，并且计算相关性算分，称为"),t("strong",null,"原始算分"),E("（query score）")]),t("li",null,[E("2）根据"),t("strong",null,"过滤条件"),E("，过滤文档")]),t("li",null,[E("3）符合"),t("strong",null,"过滤条件"),E("的文档，基于"),t("strong",null,"算分函数"),E("运算，得到"),t("strong",null,"函数算分"),E("（function score）")]),t("li",null,[E("4）将"),t("strong",null,"原始算分"),E("（query score）和"),t("strong",null,"函数算分"),E("（function score）基于"),t("strong",null,"运算模式"),E("做运算，得到最终结果，作为相关性算分。")])],-1)),l[546]||(l[546]=t("p",null,"因此，其中的关键点是：",-1)),l[547]||(l[547]=t("ul",null,[t("li",null,"过滤条件：决定哪些文档的算分被修改"),t("li",null,"算分函数：决定函数算分的算法"),t("li",null,"运算模式：决定最终算分结果")],-1)),l[548]||(l[548]=t("h5",{id:"_2-示例",tabindex:"-1"},[E("2）示例 "),t("a",{class:"header-anchor",href:"#_2-示例","aria-label":'Permalink to "2）示例"'},"​")],-1)),l[549]||(l[549]=t("p",null,"需求：给“如家”这个品牌的酒店排名靠前一些",-1)),l[550]||(l[550]=t("p",null,"翻译一下这个需求，转换为之前说的四个要点：",-1)),l[551]||(l[551]=t("ul",null,[t("li",null,"原始条件：不确定，可以任意变化"),t("li",null,'过滤条件：brand = "如家"'),t("li",null,"算分函数：可以简单粗暴，直接给固定的算分结果，weight"),t("li",null,"运算模式：比如求和")],-1)),l[552]||(l[552]=t("p",null,"因此最终的DSL语句如下：",-1)),l[553]||(l[553]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /hotel/_search")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "query"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "function_score"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "query"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {  "),t("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"...."),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," }, "),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 原始查询，可以是任意条件")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "functions"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": [ "),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 算分函数")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "filter"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": { "),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 满足的条件，品牌必须是如家")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'            "term"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'              "brand"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"如家"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"          },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "weight"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2"),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," // 算分权重为2")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      ],")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "boost_mode"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"sum"'),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," // 加权模式，求和")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[554]||(l[554]=t("p",null,"测试，在未添加算分函数时，如家得分如下：",-1)),l[555]||(l[555]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721193152520.png",alt:"image-20210721193152520",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[556]||(l[556]=t("p",null,"添加了算分函数后，如家得分就提升了：",-1)),l[557]||(l[557]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721193458182.png",alt:"image-20210721193458182",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[558]||(l[558]=t("h5",{id:"_3-小结",tabindex:"-1"},[E("3）小结 "),t("a",{class:"header-anchor",href:"#_3-小结","aria-label":'Permalink to "3）小结"'},"​")],-1)),l[559]||(l[559]=t("blockquote",null,[t("ul",null,[t("li",null,[t("p",null,"function score query定义的三要素是什么？"),t("ul",null,[t("li",null,[t("p",null,"过滤条件：哪些文档要加分")]),t("li",null,[t("p",null,"算分函数：如何计算function score")]),t("li",null,[t("p",null,"加权方式：function score 与 query score如何运算")])])])])],-1)),l[560]||(l[560]=t("h4",{id:"_6-5-3-布尔查询",tabindex:"-1"},[E("6.5.3 布尔查询 "),t("a",{class:"header-anchor",href:"#_6-5-3-布尔查询","aria-label":'Permalink to "6.5.3 布尔查询"'},"​")],-1)),l[561]||(l[561]=t("p",null,[E("布尔查询是一个或多个查询子句的组合，每一个子句就是一个"),t("strong",null,"子查询"),E("。子查询的组合方式有：")],-1)),l[562]||(l[562]=t("ul",null,[t("li",null,"must：必须匹配每个子查询，类似“与”"),t("li",null,"should：选择性匹配子查询，类似“或”"),t("li",null,[E("must_not：必须不匹配，"),t("strong",null,"不参与算分"),E("，类似“非”")]),t("li",null,[E("filter：必须匹配，"),t("strong",null,"不参与算分")])],-1)),l[563]||(l[563]=t("p",null,"比如在搜索酒店时，除了关键字搜索外，我们还可能根据品牌、价格、城市等字段做过滤：",-1)),l[564]||(l[564]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721193822848.png",alt:"image-20210721193822848",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[565]||(l[565]=t("p",null,"每一个不同的字段，其查询的条件、方式都不一样，必须是多个不同的查询，而要组合这些查询，就必须用bool查询了。",-1)),l[566]||(l[566]=t("p",null,[E("需要注意的是，搜索时，参与"),t("strong",null,"打分的字段越多，查询的性能也越差"),E("。因此这种多条件查询时，建议这样做：")],-1)),l[567]||(l[567]=t("ul",null,[t("li",null,"搜索框的关键字搜索，是全文检索查询，使用must查询，参与算分"),t("li",null,"其它过滤条件，采用filter查询。不参与算分")],-1)),l[568]||(l[568]=t("h5",{id:"_1-语法示例",tabindex:"-1"},[E("1）语法示例： "),t("a",{class:"header-anchor",href:"#_1-语法示例","aria-label":'Permalink to "1）语法示例："'},"​")],-1)),l[569]||(l[569]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /hotel/_search")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "query"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "bool"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "must"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": [")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        {"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'"term"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'"city"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"上海"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," }}")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      ],")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "should"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": [")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        {"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'"term"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'"brand"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"皇冠假日"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," }},")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        {"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'"term"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'"brand"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"华美达"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," }}")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      ],")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "must_not"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": [")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        { "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'"range"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": { "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'"price"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": { "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'"lte"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"500"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," } }}")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      ],")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "filter"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": [")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        { "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'"range"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'"score"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": { "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'"gte"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"45"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," } }}")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      ]")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[570]||(l[570]=t("h5",{id:"_2-示例-1",tabindex:"-1"},[E("2）示例 "),t("a",{class:"header-anchor",href:"#_2-示例-1","aria-label":'Permalink to "2）示例"'},"​")],-1)),l[571]||(l[571]=t("p",null,"需求：搜索名字包含“如家”，价格不高于400，在坐标31.21,121.5周围10km范围内的酒店。",-1)),l[572]||(l[572]=t("p",null,"分析：",-1)),l[573]||(l[573]=t("ul",null,[t("li",null,"名称搜索，属于全文检索查询，应该参与算分。放到must中"),t("li",null,"价格不高于400，用range查询，属于过滤条件，不参与算分。放到must_not中"),t("li",null,"周围10km范围内，用geo_distance查询，属于过滤条件，不参与算分。放到filter中")],-1)),l[574]||(l[574]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721194744183.png",alt:"image-20210721194744183",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[575]||(l[575]=t("h5",{id:"_3-小结-1",tabindex:"-1"},[E("3）小结 "),t("a",{class:"header-anchor",href:"#_3-小结-1","aria-label":'Permalink to "3）小结"'},"​")],-1)),l[576]||(l[576]=t("p",null,"bool查询有几种逻辑关系？",-1)),l[577]||(l[577]=t("ul",null,[t("li",null,"must：必须匹配的条件，可以理解为“与”"),t("li",null,"should：选择性匹配的条件，可以理解为“或”"),t("li",null,"must_not：必须不匹配的条件，不参与打分"),t("li",null,"filter：必须匹配的条件，不参与打分")],-1)),l[578]||(l[578]=t("hr",null,null,-1)),l[579]||(l[579]=t("h2",{id:"_7-搜索结果处理",tabindex:"-1"},[E("7. 搜索结果处理 "),t("a",{class:"header-anchor",href:"#_7-搜索结果处理","aria-label":'Permalink to "7. 搜索结果处理"'},"​")],-1)),l[580]||(l[580]=t("p",null,"搜索的结果可以按照用户指定的方式去处理或展示。",-1)),l[581]||(l[581]=t("h3",{id:"_7-1-排序",tabindex:"-1"},[E("7.1 排序 "),t("a",{class:"header-anchor",href:"#_7-1-排序","aria-label":'Permalink to "7.1 排序"'},"​")],-1)),l[582]||(l[582]=t("p",null,[E("elasticsearch默认是根据相关度算分（_score）来排序，但是也支持自定义方式对搜索"),t("a",{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/sort-search-results.html",target:"_blank",rel:"noreferrer"},"结果排序"),E("。可以排序字段类型有：keyword类型、数值类型、地理坐标类型、日期类型等。")],-1)),l[583]||(l[583]=t("h4",{id:"_7-1-1-普通字段排序",tabindex:"-1"},[E("7.1.1 普通字段排序 "),t("a",{class:"header-anchor",href:"#_7-1-1-普通字段排序","aria-label":'Permalink to "7.1.1 普通字段排序"'},"​")],-1)),l[584]||(l[584]=t("p",null,"keyword、数值、日期类型排序的语法基本一致。",-1)),l[585]||(l[585]=t("p",null,[t("strong",null,"语法"),E("：")],-1)),l[586]||(l[586]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /indexName/_search")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "query"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "match_all"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {}")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "sort"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": [")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "FIELD"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"desc"'),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  // 排序字段、排序方式ASC、DESC")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  ]")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[587]||(l[587]=t("p",null,"排序条件是一个数组，也就是可以写多个排序条件。按照声明的顺序，当第一个条件相等时，再按照第二个条件排序，以此类推",-1)),l[588]||(l[588]=t("p",null,[t("strong",null,"示例"),E("：")],-1)),l[589]||(l[589]=t("p",null,"需求描述：酒店数据按照用户评价（score)降序排序，评价相同的按照价格(price)升序排序",-1)),l[590]||(l[590]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721195728306.png",alt:"image-20210721195728306",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[591]||(l[591]=t("h4",{id:"_7-1-2-地理坐标排序",tabindex:"-1"},[E("7.1.2 地理坐标排序 "),t("a",{class:"header-anchor",href:"#_7-1-2-地理坐标排序","aria-label":'Permalink to "7.1.2 地理坐标排序"'},"​")],-1)),l[592]||(l[592]=t("p",null,"地理坐标排序略有不同。",-1)),l[593]||(l[593]=t("p",null,[t("strong",null,"语法说明"),E("：")],-1)),l[594]||(l[594]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /indexName/_search")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "query"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "match_all"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {}")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "sort"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": [")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "_geo_distance"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "FIELD"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"纬度，经度"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 文档中geo_point类型的字段名、目标坐标点")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "order"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"asc"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 排序方式")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "unit"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"km"'),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," // 排序的距离单位")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  ]")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[595]||(l[595]=t("p",null,"这个查询的含义是：",-1)),l[596]||(l[596]=t("ul",null,[t("li",null,"指定一个坐标，作为目标点"),t("li",null,"计算每一个文档中，指定字段（必须是geo_point类型）的坐标 到目标点的距离是多少"),t("li",null,"根据距离排序")],-1)),l[597]||(l[597]=t("p",null,[t("strong",null,"示例：")],-1)),l[598]||(l[598]=t("p",null,"需求描述：实现对酒店数据按照到你的位置坐标的距离升序排序",-1)),l[599]||(l[599]=t("p",null,[E("提示：获取你的位置的经纬度的方式："),t("a",{href:"https://lbs.amap.com/demo/jsapi-v2/example/map/click-to-get-lnglat/",target:"_blank",rel:"noreferrer"},"https://lbs.amap.com/demo/jsapi-v2/example/map/click-to-get-lnglat/")],-1)),l[600]||(l[600]=t("p",null,"假设我的位置是：31.034661，121.612282，寻找我周围距离最近的酒店。",-1)),l[601]||(l[601]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721200214690.png",alt:"image-20210721200214690",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[602]||(l[602]=t("h3",{id:"_7-2-分页",tabindex:"-1"},[E("7.2 分页 "),t("a",{class:"header-anchor",href:"#_7-2-分页","aria-label":'Permalink to "7.2 分页"'},"​")],-1)),l[603]||(l[603]=t("p",null,"elasticsearch 默认情况下只返回top10的数据。而如果要查询更多数据就需要修改分页参数了。elasticsearch中通过修改from、size参数来控制要返回的分页结果：",-1)),l[604]||(l[604]=t("ul",null,[t("li",null,"from：从第几个文档开始"),t("li",null,"size：总共查询几个文档")],-1)),l[605]||(l[605]=t("p",null,[E("类似于mysql中的"),t("code",null,"limit ?, ?")],-1)),l[606]||(l[606]=t("h4",{id:"_7-2-1-基本的分页",tabindex:"-1"},[E("7.2.1 基本的分页 "),t("a",{class:"header-anchor",href:"#_7-2-1-基本的分页","aria-label":'Permalink to "7.2.1 基本的分页"'},"​")],-1)),l[607]||(l[607]=t("p",null,"分页的基本语法如下：",-1)),l[608]||(l[608]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /hotel/_search")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "query"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "match_all"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {}")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "from"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 分页开始的位置，默认为0")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "size"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"10"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 期望获取的文档总数")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "sort"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": [")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'"price"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"asc"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  ]")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[609]||(l[609]=t("h4",{id:"_7-2-2-深度分页问题",tabindex:"-1"},[E("7.2.2 深度分页问题 "),t("a",{class:"header-anchor",href:"#_7-2-2-深度分页问题","aria-label":'Permalink to "7.2.2 深度分页问题"'},"​")],-1)),l[610]||(l[610]=t("p",null,"现在，我要查询990~1000的数据，查询逻辑要这么写：",-1)),l[611]||(l[611]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /hotel/_search")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "query"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "match_all"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {}")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "from"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"990"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 分页开始的位置，默认为0")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "size"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"10"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 期望获取的文档总数")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "sort"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": [")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'"price"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"asc"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  ]")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[612]||(l[612]=t("p",null,"这里是查询990开始的数据，也就是 第990~第1000条 数据。",-1)),l[613]||(l[613]=t("p",null,"不过，elasticsearch内部分页时，必须先查询 0~1000条，然后截取其中的990 ~ 1000的这10条：",-1)),l[614]||(l[614]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721200643029.png",alt:"image-20210721200643029",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[615]||(l[615]=t("p",null,"查询TOP1000，如果es是单点模式，这并无太大影响。",-1)),l[616]||(l[616]=t("p",null,"但是elasticsearch将来一定是集群，例如我集群有5个节点，我要查询TOP1000的数据，并不是每个节点查询200条就可以了。",-1)),l[617]||(l[617]=t("p",null,"因为节点A的TOP200，在另一个节点可能排到10000名以外了。",-1)),l[618]||(l[618]=t("p",null,"因此要想获取整个集群的TOP1000，必须先查询出每个节点的TOP1000，汇总结果后，重新排名，重新截取TOP1000。",-1)),l[619]||(l[619]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721201003229.png",alt:"image-20210721201003229",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[620]||(l[620]=t("p",null,"那如果我要查询9900~10000的数据呢？是不是要先查询TOP10000呢？那每个节点都要查询10000条？汇总到内存中？",-1)),l[621]||(l[621]=t("p",null,"当查询分页深度较大时，汇总数据过多，对内存和CPU会产生非常大的压力，因此elasticsearch会禁止from+ size 超过10000的请求。",-1)),l[622]||(l[622]=t("p",null,[E("针对深度分页，ES提供了两种解决方案，"),t("a",{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/paginate-search-results.html",target:"_blank",rel:"noreferrer"},"官方文档"),E("：")],-1)),l[623]||(l[623]=t("ul",null,[t("li",null,"search after：分页时需要排序，原理是从上一次的排序值开始，查询下一页数据。官方推荐使用的方式。"),t("li",null,"scroll：原理将排序后的文档id形成快照，保存在内存。官方已经不推荐使用。")],-1)),l[624]||(l[624]=t("h4",{id:"_7-2-3-小结",tabindex:"-1"},[E("7.2.3 小结 "),t("a",{class:"header-anchor",href:"#_7-2-3-小结","aria-label":'Permalink to "7.2.3 小结"'},"​")],-1)),l[625]||(l[625]=t("blockquote",null,[t("ul",null,[t("li",null,[t("p",null,"分页查询的常见实现方案以及优缺点："),t("ul",null,[t("li",null,[t("p",null,[t("code",null,"from + size"),E("：")]),t("ul",null,[t("li",null,[t("p",null,"优点：支持随机翻页")]),t("li",null,[t("p",null,"缺点：深度分页问题，默认查询上限（from + size）是10000")]),t("li",null,[t("p",null,"场景：百度、京东、谷歌、淘宝这样的随机翻页搜索")]),t("li",null,[t("p",null,[t("code",null,"after search"),E("：")]),t("ul",null,[t("li",null,"优点：没有查询上限（单次查询的size不超过10000）"),t("li",null,"缺点：只能向后逐页查询，不支持随机翻页"),t("li",null,"场景：没有随机翻页需求的搜索，例如手机向下滚动翻页")])])])]),t("li",null,[t("p",null,[t("code",null,"scroll"),E("：")]),t("ul",null,[t("li",null,[E("优点：没有查询上限（单次查询的size不超过10000） "),t("ul",null,[t("li",null,"缺点：会有额外内存消耗，并且搜索结果是非实时的"),t("li",null,"场景：海量数据的获取和迁移。从ES7.1开始不推荐，建议用 after search方案。")])])])])])])])],-1)),l[626]||(l[626]=t("h3",{id:"_7-3-高亮",tabindex:"-1"},[E("7.3 高亮 "),t("a",{class:"header-anchor",href:"#_7-3-高亮","aria-label":'Permalink to "7.3 高亮"'},"​")],-1)),l[627]||(l[627]=t("h4",{id:"_7-3-1-高亮原理",tabindex:"-1"},[E("7.3.1 高亮原理 "),t("a",{class:"header-anchor",href:"#_7-3-1-高亮原理","aria-label":'Permalink to "7.3.1 高亮原理"'},"​")],-1)),l[628]||(l[628]=t("p",null,"什么是高亮显示呢？",-1)),l[629]||(l[629]=t("p",null,"我们在百度，京东搜索时，关键字会变成红色，比较醒目，这叫高亮显示：",-1)),l[630]||(l[630]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721202705030.png",alt:"image-20210721202705030",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[631]||(l[631]=t("p",null,"高亮显示的实现分为两步：",-1)),l[632]||(l[632]=t("ul",null,[t("li",null,[E("1）给文档中的所有关键字都添加一个标签，例如"),t("code",null,"<em>"),E("标签")]),t("li",null,[E("2）页面给"),t("code",null,"<em>"),E("标签编写CSS样式")])],-1)),l[633]||(l[633]=t("h4",{id:"_7-3-2-实现高亮",tabindex:"-1"},[E("7.3.2 实现高亮 "),t("a",{class:"header-anchor",href:"#_7-3-2-实现高亮","aria-label":'Permalink to "7.3.2 实现高亮"'},"​")],-1)),l[634]||(l[634]=t("p",null,[t("strong",null,"高亮的语法"),E("：")],-1)),l[635]||(l[635]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /hotel/_search")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "query"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "match"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "FIELD"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"TEXT"'),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," // 查询条件，高亮一定要使用全文检索查询")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "highlight"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "fields"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": { "),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 指定要高亮的字段")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "FIELD"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "pre_tags"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"<em>"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",  "),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 用来标记高亮字段的前置标签")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "post_tags"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"</em>"'),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," // 用来标记高亮字段的后置标签")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[636]||(l[636]=t("p",null,[t("strong",null,"注意：")],-1)),l[637]||(l[637]=t("ul",null,[t("li",null,[E("高亮是对关键字高亮，因此"),t("strong",null,"搜索条件必须带有关键字"),E("，而不能是范围这样的查询。")]),t("li",null,[E("默认情况下，"),t("strong",null,"高亮的字段，必须与搜索指定的字段一致"),E("，否则无法高亮")]),t("li",null,"如果要对非搜索字段高亮，则需要添加一个属性：required_field_match=false")],-1)),l[638]||(l[638]=t("p",null,[t("strong",null,"示例"),E("：")],-1)),l[639]||(l[639]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721203349633.png",alt:"image-20210721203349633",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[640]||(l[640]=t("h3",{id:"_7-4-总结",tabindex:"-1"},[E("7.4 总结 "),t("a",{class:"header-anchor",href:"#_7-4-总结","aria-label":'Permalink to "7.4 总结"'},"​")],-1)),l[641]||(l[641]=t("blockquote",null,[t("ul",null,[t("li",null,[t("p",null,"查询的DSL是一个大的JSON对象，包含下列属性："),t("ul",null,[t("li",null,[t("p",null,"query：查询条件")]),t("li",null,[t("p",null,"from和size：分页条件")]),t("li",null,[t("p",null,"sort：排序条件")]),t("li",null,[t("p",null,"highlight：高亮条件")])])])]),t("p",null,"示例："),t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721203657850.png",alt:"image-20210721203657850",loading:"lazy",decoding:"async",class:"lazy"})])],-1)),l[642]||(l[642]=t("hr",null,null,-1)),l[643]||(l[643]=t("h2",{id:"_8-restclient查询文档",tabindex:"-1"},[E("8. RestClient查询文档 "),t("a",{class:"header-anchor",href:"#_8-restclient查询文档","aria-label":'Permalink to "8. RestClient查询文档"'},"​")],-1)),l[644]||(l[644]=t("p",null,"文档的查询同样适用昨天学习的 RestHighLevelClient对象，基本步骤包括：",-1)),l[645]||(l[645]=t("ol",null,[t("li",null,"准备Request对象"),t("li",null,"准备请求参数"),t("li",null,"发起请求"),t("li",null,"解析响应")],-1)),l[646]||(l[646]=t("h3",{id:"_8-1-快速入门",tabindex:"-1"},[E("8.1 快速入门 "),t("a",{class:"header-anchor",href:"#_8-1-快速入门","aria-label":'Permalink to "8.1 快速入门"'},"​")],-1)),l[647]||(l[647]=t("p",null,"我们以match_all查询为例",-1)),l[648]||(l[648]=t("h4",{id:"_8-1-1-发起查询请求",tabindex:"-1"},[E("8.1.1 发起查询请求 "),t("a",{class:"header-anchor",href:"#_8-1-1-发起查询请求","aria-label":'Permalink to "8.1.1 发起查询请求"'},"​")],-1)),l[649]||(l[649]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721203950559.png",alt:"image-20210721203950559",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[650]||(l[650]=t("p",null,"代码解读：",-1)),l[651]||(l[651]=t("ul",null,[t("li",null,[t("p",null,[E("第一步，创建"),t("code",null,"SearchRequest"),E("对象，指定索引库名")])]),t("li",null,[t("p",null,[E("第二步，利用"),t("code",null,"request.source()"),E("构建DSL，DSL中可以包含查询、分页、排序、高亮等")]),t("ul",null,[t("li",null,[t("code",null,"query()"),E("：代表查询条件，利用"),t("code",null,"QueryBuilders.matchAllQuery()"),E("构建一个match_all查询的DSL")])])]),t("li",null,[t("p",null,"第三步，利用client.search()发送请求，得到响应")])],-1)),l[652]||(l[652]=t("p",null,[E("这里关键的API有两个，一个是"),t("code",null,"request.source()"),E("，其中包含了查询、排序、分页、高亮等所有功能：")],-1)),l[653]||(l[653]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721215640790.png",alt:"image-20210721215640790",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[654]||(l[654]=t("p",null,[E("另一个是"),t("code",null,"QueryBuilders"),E("，其中包含match、term、function_score、bool等各种查询：")],-1)),l[655]||(l[655]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721215729236.png",alt:"image-20210721215729236",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[656]||(l[656]=t("h4",{id:"_8-1-2-解析响应",tabindex:"-1"},[E("8.1.2 解析响应 "),t("a",{class:"header-anchor",href:"#_8-1-2-解析响应","aria-label":'Permalink to "8.1.2 解析响应"'},"​")],-1)),l[657]||(l[657]=t("p",null,"响应结果的解析：",-1)),l[658]||(l[658]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721214221057.png",alt:"image-20210721214221057",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[659]||(l[659]=t("p",null,"elasticsearch返回的结果是一个JSON字符串，结构包含：",-1)),l[660]||(l[660]=t("ul",null,[t("li",null,[t("code",null,"hits"),E("：命中的结果 "),t("ul",null,[t("li",null,[t("code",null,"total"),E("：总条数，其中的value是具体的总条数值")]),t("li",null,[t("code",null,"max_score"),E("：所有结果中得分最高的文档的相关性算分")]),t("li",null,[t("code",null,"hits"),E("：搜索结果的文档数组，其中的每个文档都是一个json对象 "),t("ul",null,[t("li",null,[t("code",null,"_source"),E("：文档中的原始数据，也是json对象")])])])])])],-1)),l[661]||(l[661]=t("p",null,"因此，我们解析响应结果，就是逐层解析JSON字符串，流程如下：",-1)),l[662]||(l[662]=t("ul",null,[t("li",null,[t("code",null,"SearchHits"),E("：通过response.getHits()获取，就是JSON中的最外层的hits，代表命中的结果 "),t("ul",null,[t("li",null,[t("code",null,"SearchHits#getTotalHits().value"),E("：获取总条数信息")]),t("li",null,[t("code",null,"SearchHits#getHits()"),E("：获取SearchHit数组，也就是文档数组 "),t("ul",null,[t("li",null,[t("code",null,"SearchHit#getSourceAsString()"),E("：获取文档结果中的_source，也就是原始的json文档数据")])])])])])],-1)),l[663]||(l[663]=t("h4",{id:"_8-1-3-完整代码",tabindex:"-1"},[E("8.1.3 完整代码 "),t("a",{class:"header-anchor",href:"#_8-1-3-完整代码","aria-label":'Permalink to "8.1.3 完整代码"'},"​")],-1)),l[664]||(l[664]=t("p",null,"完整代码如下：",-1)),l[665]||(l[665]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Test")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"void"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testMatchAll"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() throws IOException {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 1.准备Request")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    SearchRequest request "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," SearchRequest"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.准备DSL")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    request."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        ."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"query"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"matchAllQuery"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 3.发送请求")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    SearchResponse response "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"search"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.解析响应")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    handleResponse"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(response);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"private"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," handleResponse"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(SearchResponse response) {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.解析响应")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    SearchHits searchHits "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," response."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getHits"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.1.获取总条数")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    long"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," total "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," searchHits."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getTotalHits"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"().value;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    System.out."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"共搜索到"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," total "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "条数据"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.2.文档数组")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    SearchHit"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[] hits "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," searchHits."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getHits"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.3.遍历")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    for"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (SearchHit hit "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hits) {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 获取文档source")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        String json "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hit."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getSourceAsString"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 反序列化")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        HotelDoc hotelDoc "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," JSON."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"parseObject"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(json, HotelDoc.class);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        System.out."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotelDoc = "'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotelDoc);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[666]||(l[666]=t("h4",{id:"_8-1-4-小结",tabindex:"-1"},[E("8.1.4 小结 "),t("a",{class:"header-anchor",href:"#_8-1-4-小结","aria-label":'Permalink to "8.1.4 小结"'},"​")],-1)),l[667]||(l[667]=t("blockquote",null,[t("p",null,"查询的基本步骤是："),t("ol",null,[t("li",null,[t("p",null,"创建SearchRequest对象")]),t("li",null,[t("p",null,"准备Request.source()，也就是DSL。"),t("p",null,"① QueryBuilders来构建查询条件"),t("p",null,"② 传入Request.source() 的 query() 方法")]),t("li",null,[t("p",null,"发送请求，得到结果")]),t("li",null,[t("p",null,"解析结果（参考JSON结果，从外到内，逐层解析）")])])],-1)),l[668]||(l[668]=t("h3",{id:"_8-2-match查询",tabindex:"-1"},[E("8.2 match查询 "),t("a",{class:"header-anchor",href:"#_8-2-match查询","aria-label":'Permalink to "8.2 match查询"'},"​")],-1)),l[669]||(l[669]=t("p",null,"全文检索的match和multi_match查询与match_all的API基本一致。差别是查询条件，也就是query的部分。",-1)),l[670]||(l[670]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721215923060.png",alt:"image-20210721215923060",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[671]||(l[671]=t("p",null,"因此，Java代码上的差异主要是request.source().query()中的参数了。同样是利用QueryBuilders提供的方法：",-1)),l[672]||(l[672]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721215843099.png",alt:"image-20210721215843099",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[673]||(l[673]=t("p",null,"而结果解析代码则完全一致，可以抽取并共享。",-1)),l[674]||(l[674]=t("p",null,"完整代码如下：",-1)),l[675]||(l[675]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Test")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"void"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testMatch"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() throws IOException {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 1.准备Request")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    SearchRequest request "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," SearchRequest"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.准备DSL")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    request."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        ."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"query"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"matchQuery"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"all"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"如家"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"));")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 3.发送请求")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    SearchResponse response "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"search"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.解析响应")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    handleResponse"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(response);")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[676]||(l[676]=t("h3",{id:"_8-3-精确查询",tabindex:"-1"},[E("8.3 精确查询 "),t("a",{class:"header-anchor",href:"#_8-3-精确查询","aria-label":'Permalink to "8.3 精确查询"'},"​")],-1)),l[677]||(l[677]=t("p",null,"精确查询主要是两者：",-1)),l[678]||(l[678]=t("ul",null,[t("li",null,"term：词条精确匹配"),t("li",null,"range：范围查询")],-1)),l[679]||(l[679]=t("p",null,"与之前的查询相比，差异同样在查询条件，其它都一样。",-1)),l[680]||(l[680]=t("p",null,"查询条件构造的API如下：",-1)),l[681]||(l[681]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721220305140.png",alt:"image-20210721220305140",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[682]||(l[682]=t("h3",{id:"_8-4-布尔查询",tabindex:"-1"},[E("8.4 布尔查询 "),t("a",{class:"header-anchor",href:"#_8-4-布尔查询","aria-label":'Permalink to "8.4 布尔查询"'},"​")],-1)),l[683]||(l[683]=t("p",null,"布尔查询是用must、must_not、filter等方式组合其它查询，代码示例如下：",-1)),l[684]||(l[684]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721220927286.png",alt:"image-20210721220927286",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[685]||(l[685]=t("p",null,"可以看到，API与其它查询的差别同样是在查询条件的构建，QueryBuilders，结果解析等其他代码完全不变。",-1)),l[686]||(l[686]=t("p",null,"完整代码如下：",-1)),l[687]||(l[687]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Test")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"void"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testBool"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() throws IOException {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 1.准备Request")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    SearchRequest request "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," SearchRequest"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.准备DSL")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.1.准备BooleanQuery")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    BoolQueryBuilder boolQuery "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," QueryBuilders."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"boolQuery"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.2.添加term")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    boolQuery."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"must"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"termQuery"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"city"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"杭州"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"));")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.3.添加range")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    boolQuery."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"filter"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"rangeQuery"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"price"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"lte"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"250"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"));")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    request."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"query"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(boolQuery);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 3.发送请求")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    SearchResponse response "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"search"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.解析响应")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    handleResponse"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(response);")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[688]||(l[688]=t("h3",{id:"_8-5-排序、分页",tabindex:"-1"},[E("8.5 排序、分页 "),t("a",{class:"header-anchor",href:"#_8-5-排序、分页","aria-label":'Permalink to "8.5 排序、分页"'},"​")],-1)),l[689]||(l[689]=t("p",null,"搜索结果的排序和分页是与query同级的参数，因此同样是使用request.source()来设置。",-1)),l[690]||(l[690]=t("p",null,"对应的API如下：",-1)),l[691]||(l[691]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721221121266.png",alt:"image-20210721221121266",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[692]||(l[692]=t("p",null,"完整代码示例：",-1)),l[693]||(l[693]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Test")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"void"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testPageAndSort"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() throws IOException {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 页码，每页大小")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    int"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," page "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 1"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", size "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 5"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 1.准备Request")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    SearchRequest request "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," SearchRequest"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.准备DSL")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.1.query")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    request."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"query"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"matchAllQuery"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.2.排序 sort")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    request."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"sort"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"price"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", SortOrder.ASC);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.3.分页 from、size")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    request."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"from"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"((page "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 1"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"*"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," size)."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"size"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"5"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 3.发送请求")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    SearchResponse response "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"search"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.解析响应")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    handleResponse"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(response);")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[694]||(l[694]=t("h3",{id:"_8-6-高亮",tabindex:"-1"},[E("8.6 高亮 "),t("a",{class:"header-anchor",href:"#_8-6-高亮","aria-label":'Permalink to "8.6 高亮"'},"​")],-1)),l[695]||(l[695]=t("p",null,"高亮的代码与之前代码差异较大，有两点：",-1)),l[696]||(l[696]=t("ul",null,[t("li",null,"查询的DSL：其中除了查询条件，还需要添加高亮条件，同样是与query同级。"),t("li",null,"结果解析：结果除了要解析_source文档数据，还要解析高亮结果")],-1)),l[697]||(l[697]=t("h4",{id:"_8-6-1-高亮请求构建",tabindex:"-1"},[E("8.6.1 高亮请求构建 "),t("a",{class:"header-anchor",href:"#_8-6-1-高亮请求构建","aria-label":'Permalink to "8.6.1 高亮请求构建"'},"​")],-1)),l[698]||(l[698]=t("p",null,"高亮请求的构建API如下：",-1)),l[699]||(l[699]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721221744883.png",alt:"image-20210721221744883",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[700]||(l[700]=t("p",null,"上述代码省略了查询条件部分，但是大家不要忘了：高亮查询必须使用全文检索查询，并且要有搜索关键字，将来才可以对关键字高亮。",-1)),l[701]||(l[701]=t("p",null,"完整代码如下：",-1)),l[702]||(l[702]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Test")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"void"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testHighlight"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() throws IOException {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 1.准备Request")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    SearchRequest request "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," SearchRequest"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.准备DSL")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.1.query")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    request."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"query"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"matchQuery"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"all"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"如家"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"));")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.2.高亮")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    request."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"highlighter"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HighlightBuilder"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"field"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"name"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"requireFieldMatch"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"false"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"));")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 3.发送请求")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    SearchResponse response "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"search"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.解析响应")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    handleResponse"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(response);")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[703]||(l[703]=t("h4",{id:"_8-6-2-高亮结果解析",tabindex:"-1"},[E("8.6.2 高亮结果解析 "),t("a",{class:"header-anchor",href:"#_8-6-2-高亮结果解析","aria-label":'Permalink to "8.6.2 高亮结果解析"'},"​")],-1)),l[704]||(l[704]=t("p",null,"高亮的结果与查询的文档结果默认是分离的，并不在一起。",-1)),l[705]||(l[705]=t("p",null,"因此解析高亮的代码需要额外处理：",-1)),l[706]||(l[706]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721222057212.png",alt:"image-20210721222057212",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[707]||(l[707]=t("p",null,"代码解读：",-1)),l[708]||(l[708]=t("ul",null,[t("li",null,"第一步：从结果中获取source。hit.getSourceAsString()，这部分是非高亮结果，json字符串。还需要反序列为HotelDoc对象"),t("li",null,"第二步：获取高亮结果。hit.getHighlightFields()，返回值是一个Map，key是高亮字段名称，值是HighlightField对象，代表高亮值"),t("li",null,"第三步：从map中根据高亮字段名称，获取高亮字段值对象HighlightField"),t("li",null,"第四步：从HighlightField中获取Fragments，并且转为字符串。这部分就是真正的高亮字符串了"),t("li",null,"第五步：用高亮的结果替换HotelDoc中的非高亮结果")],-1)),l[709]||(l[709]=t("p",null,"完整代码如下：",-1)),l[710]||(l[710]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"private"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," handleResponse"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(SearchResponse response) {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.解析响应")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    SearchHits searchHits "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," response."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getHits"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.1.获取总条数")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    long"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," total "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," searchHits."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getTotalHits"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"().value;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    System.out."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"共搜索到"'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," total "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "条数据"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.2.文档数组")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    SearchHit"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[] hits "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," searchHits."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getHits"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.3.遍历")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    for"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (SearchHit hit "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hits) {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 获取文档source")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        String json "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hit."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getSourceAsString"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 反序列化")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        HotelDoc hotelDoc "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," JSON."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"parseObject"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(json, HotelDoc.class);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 获取高亮结果")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        Map<"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"String"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"HighlightField"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> highlightFields "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hit."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getHighlightFields"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        if"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ("),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"CollectionUtils."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"isEmpty"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(highlightFields)) {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            // 根据字段名获取高亮结果")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            HighlightField highlightField "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," highlightFields."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"get"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"name"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            if"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (highlightField "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"                // 获取高亮值")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                String name "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," highlightField."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getFragments"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()["),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"string"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"                // 覆盖非高亮结果")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                hotelDoc."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setName"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(name);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        System.out."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotelDoc = "'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotelDoc);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[711]||(l[711]=t("hr",null,null,-1)),l[712]||(l[712]=t("h2",{id:"_9-黑马旅游案例",tabindex:"-1"},[E("9. 黑马旅游案例 "),t("a",{class:"header-anchor",href:"#_9-黑马旅游案例","aria-label":'Permalink to "9. 黑马旅游案例"'},"​")],-1)),l[713]||(l[713]=t("p",null,"下面，我们通过黑马旅游的案例来实战演练下之前学习的知识。",-1)),l[714]||(l[714]=t("p",null,"我们实现四部分功能：",-1)),l[715]||(l[715]=t("ul",null,[t("li",null,"酒店搜索和分页"),t("li",null,"酒店结果过滤"),t("li",null,"我周边的酒店"),t("li",null,"酒店竞价排名")],-1)),l[716]||(l[716]=t("p",null,[E("启动我们提供的hotel-demo项目，其默认端口是8089，访问"),t("code",null,"http://localhost:8090"),E("，就能看到项目页面了：")],-1)),l[717]||(l[717]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721223159598.png",alt:"image-20210721223159598",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[718]||(l[718]=t("h3",{id:"_9-1-酒店搜索和分页",tabindex:"-1"},[E("9.1 酒店搜索和分页 "),t("a",{class:"header-anchor",href:"#_9-1-酒店搜索和分页","aria-label":'Permalink to "9.1 酒店搜索和分页"'},"​")],-1)),l[719]||(l[719]=t("p",null,"案例需求：实现黑马旅游的酒店搜索功能，完成关键字搜索和分页",-1)),l[720]||(l[720]=t("h4",{id:"_9-1-1-需求分析",tabindex:"-1"},[E("9.1.1 需求分析 "),t("a",{class:"header-anchor",href:"#_9-1-1-需求分析","aria-label":'Permalink to "9.1.1 需求分析"'},"​")],-1)),l[721]||(l[721]=t("p",null,"在项目的首页，有一个大大的搜索框，还有分页按钮：",-1)),l[722]||(l[722]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721223859419.png",alt:"image-20210721223859419",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[723]||(l[723]=t("p",null,"点击搜索按钮，可以看到浏览器控制台发出了请求：",-1)),l[724]||(l[724]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721224033789.png",alt:"image-20210721224033789",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[725]||(l[725]=t("p",null,"请求参数如下：",-1)),l[726]||(l[726]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721224112708.png",alt:"image-20210721224112708",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[727]||(l[727]=t("p",null,"由此可以知道，我们这个请求的信息如下：",-1)),l[728]||(l[728]=t("ul",null,[t("li",null,"请求方式：POST"),t("li",null,"请求路径：/hotel/list"),t("li",null,[E("请求参数：JSON对象，包含4个字段： "),t("ul",null,[t("li",null,"key：搜索关键字"),t("li",null,"page：页码"),t("li",null,"size：每页大小"),t("li",null,"sortBy：排序，目前暂不实现")])]),t("li",null,[E("返回值：分页查询，需要返回分页结果PageResult，包含两个属性： "),t("ul",null,[t("li",null,[t("code",null,"total"),E("：总条数")]),t("li",null,[t("code",null,"List<HotelDoc>"),E("：当前页的数据")])])])],-1)),l[729]||(l[729]=t("p",null,"因此，我们实现业务的流程如下：",-1)),l[730]||(l[730]=t("ul",null,[t("li",null,"步骤一：定义实体类，接收请求参数的JSON对象"),t("li",null,"步骤二：编写controller，接收页面的请求"),t("li",null,"步骤三：编写业务实现，利用RestHighLevelClient实现搜索、分页")],-1)),l[731]||(l[731]=t("h4",{id:"_9-1-2-定义实体类",tabindex:"-1"},[E("9.1.2 定义实体类 "),t("a",{class:"header-anchor",href:"#_9-1-2-定义实体类","aria-label":'Permalink to "9.1.2 定义实体类"'},"​")],-1)),l[732]||(l[732]=t("p",null,"实体类有两个，一个是前端的请求参数实体，一个是服务端应该返回的响应结果实体。",-1)),l[733]||(l[733]=t("p",null,"1）请求参数",-1)),l[734]||(l[734]=t("p",null,"前端请求的json结构如下：",-1)),l[735]||(l[735]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "key"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"搜索关键字"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "page"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "size"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"3"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "sortBy"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"default"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[736]||(l[736]=t("p",null,[E("因此，我们在"),t("code",null,"cn.itcast.hotel.pojo"),E("包下定义一个实体类：")],-1)),l[737]||(l[737]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"package"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," cn.itcast.hotel.pojo;")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," lombok.Data;")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Data")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," RequestParams"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String key;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer page;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer size;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String sortBy;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[738]||(l[738]=t("p",null,"2）返回值",-1)),l[739]||(l[739]=t("p",null,"分页查询，需要返回分页结果PageResult，包含两个属性：",-1)),l[740]||(l[740]=t("ul",null,[t("li",null,[t("code",null,"total"),E("：总条数")]),t("li",null,[t("code",null,"List<HotelDoc>"),E("：当前页的数据")])],-1)),l[741]||(l[741]=t("p",null,[E("因此，我们在"),t("code",null,"cn.itcast.hotel.pojo"),E("中定义返回结果：")],-1)),l[742]||(l[742]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"package"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," cn.itcast.hotel.pojo;")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," lombok.Data;")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," java.util.List;")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Data")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," PageResult"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Long total;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," List<"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"HotelDoc"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> hotels;")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," PageResult"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," PageResult"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Long "),t("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"total"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", List<"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"HotelDoc"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> "),t("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"hotels"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".total "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," total;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".hotels "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotels;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[743]||(l[743]=t("h4",{id:"_9-1-3-定义controller",tabindex:"-1"},[E("9.1.3 定义controller "),t("a",{class:"header-anchor",href:"#_9-1-3-定义controller","aria-label":'Permalink to "9.1.3 定义controller"'},"​")],-1)),l[744]||(l[744]=t("p",null,"定义一个HotelController，声明查询接口，满足下列要求：",-1)),l[745]||(l[745]=t("ul",null,[t("li",null,"请求方式：Post"),t("li",null,"请求路径：/hotel/list"),t("li",null,"请求参数：对象，类型为RequestParam"),t("li",null,[E("返回值：PageResult，包含两个属性 "),t("ul",null,[t("li",null,[t("code",null,"Long total"),E("：总条数")]),t("li",null,[t("code",null,"List<HotelDoc> hotels"),E("：酒店数据")])])])],-1)),l[746]||(l[746]=t("p",null,[E("因此，我们在"),t("code",null,"cn.itcast.hotel.web"),E("中定义HotelController：")],-1)),l[747]||(l[747]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RestController")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestMapping"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/hotel"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HotelController"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Autowired")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," IHotelService hotelService;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"\t// 搜索酒店数据")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"PostMapping"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/list"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," PageResult "),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"search"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestBody"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RequestParams "),t("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"params"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"){")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotelService."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"search"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(params);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[748]||(l[748]=t("h4",{id:"_9-1-4-实现搜索业务",tabindex:"-1"},[E("9.1.4 实现搜索业务 "),t("a",{class:"header-anchor",href:"#_9-1-4-实现搜索业务","aria-label":'Permalink to "9.1.4 实现搜索业务"'},"​")],-1)),l[749]||(l[749]=t("p",null,"我们在controller调用了IHotelService，并没有实现该方法，因此下面我们就在IHotelService中定义方法，并且去实现业务逻辑。",-1)),l[750]||(l[750]=t("p",null,[E("1）在"),t("code",null,"cn.itcast.hotel.service"),E("中的"),t("code",null,"IHotelService"),E("接口中定义一个方法：")],-1)),l[751]||(l[751]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"/**")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * 根据关键字搜索酒店信息")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),t("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," params"),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," 请求参数对象，包含用户输入的关键字 ")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@return"),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," 酒店文档列表")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," */")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"PageResult "),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"search"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(RequestParams params);")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[752]||(l[752]=t("p",null,[E("2）实现搜索业务，肯定离不开RestHighLevelClient，我们需要把它注册到Spring中作为一个Bean。在"),t("code",null,"cn.itcast.hotel"),E("中的"),t("code",null,"HotelDemoApplication"),E("中声明这个Bean：")],-1)),l[753]||(l[753]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Bean")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RestHighLevelClient "),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"client"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(){")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    return"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"  new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," RestHighLevelClient"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(RestClient."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"builder"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        HttpHost."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"create"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"http://192.168.150.101:9200"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    ));")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[754]||(l[754]=t("p",null,[E("3）在"),t("code",null,"cn.itcast.hotel.service.impl"),E("中的"),t("code",null,"HotelService"),E("中实现search方法：")],-1)),l[755]||(l[755]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Override")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," PageResult "),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"search"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(RequestParams params) {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    try"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 1.准备Request")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        SearchRequest request "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," SearchRequest"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 2.准备DSL")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 2.1.query")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        String key "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," params."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getKey"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        if"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (key "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=="),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ||"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' ""'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"equals"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(key)) {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            boolQuery."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"must"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"matchAllQuery"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        } "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"else"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            boolQuery."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"must"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"matchQuery"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"all"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", key));")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 2.2.分页")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        int"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," page "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," params."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getPage"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        int"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," size "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," params."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getSize"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        request."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"from"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"((page "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 1"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"*"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," size)."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"size"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(size);")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 3.发送请求")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        SearchResponse response "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"search"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 4.解析响应")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," handleResponse"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(response);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    } "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"catch"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (IOException "),t("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"e"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        throw"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," RuntimeException"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(e);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 结果解析")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," PageResult "),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"handleResponse"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(SearchResponse response) {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.解析响应")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    SearchHits searchHits "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," response."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getHits"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.1.获取总条数")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    long"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," total "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," searchHits."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getTotalHits"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"().value;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.2.文档数组")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    SearchHit"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[] hits "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," searchHits."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getHits"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.3.遍历")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    List<"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"HotelDoc"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> hotels "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ArrayList<>();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    for"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (SearchHit hit "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hits) {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 获取文档source")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        String json "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hit."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getSourceAsString"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 反序列化")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        HotelDoc hotelDoc "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," JSON."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"parseObject"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(json, HotelDoc.class);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"\t\t// 放入集合")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        hotels."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"add"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(hotelDoc);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.4.封装返回")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    return"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," PageResult"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(total, hotels);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[756]||(l[756]=t("h3",{id:"_9-2-酒店结果过滤",tabindex:"-1"},[E("9.2 酒店结果过滤 "),t("a",{class:"header-anchor",href:"#_9-2-酒店结果过滤","aria-label":'Permalink to "9.2 酒店结果过滤"'},"​")],-1)),l[757]||(l[757]=t("p",null,"需求：添加品牌、城市、星级、价格等过滤功能",-1)),l[758]||(l[758]=t("h4",{id:"_9-2-1-需求分析",tabindex:"-1"},[E("9.2.1 需求分析 "),t("a",{class:"header-anchor",href:"#_9-2-1-需求分析","aria-label":'Permalink to "9.2.1 需求分析"'},"​")],-1)),l[759]||(l[759]=t("p",null,"在页面搜索框下面，会有一些过滤项：",-1)),l[760]||(l[760]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210722091940726.png",alt:"image-20210722091940726",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[761]||(l[761]=t("p",null,"传递的参数如图：",-1)),l[762]||(l[762]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210722092051994.png",alt:"image-20210722092051994",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[763]||(l[763]=t("p",null,"包含的过滤条件有：",-1)),l[764]||(l[764]=t("ul",null,[t("li",null,"brand：品牌值"),t("li",null,"city：城市"),t("li",null,"minPrice~maxPrice：价格范围"),t("li",null,"starName：星级")],-1)),l[765]||(l[765]=t("p",null,"我们需要做两件事情：",-1)),l[766]||(l[766]=t("ul",null,[t("li",null,"修改请求参数的对象RequestParams，接收上述参数"),t("li",null,"修改业务逻辑，在搜索条件之外，添加一些过滤条件")],-1)),l[767]||(l[767]=t("h4",{id:"_9-2-2-修改实体类",tabindex:"-1"},[E("9.2.2 修改实体类 "),t("a",{class:"header-anchor",href:"#_9-2-2-修改实体类","aria-label":'Permalink to "9.2.2 修改实体类"'},"​")],-1)),l[768]||(l[768]=t("p",null,[E("修改在"),t("code",null,"cn.itcast.hotel.pojo"),E("包下的实体类RequestParams：")],-1)),l[769]||(l[769]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Data")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," RequestParams"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String key;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer page;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer size;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String sortBy;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 下面是新增的过滤条件参数")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String city;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String brand;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String starName;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer minPrice;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer maxPrice;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[770]||(l[770]=t("h4",{id:"_9-2-3-修改搜索业务",tabindex:"-1"},[E("9.2.3 修改搜索业务 "),t("a",{class:"header-anchor",href:"#_9-2-3-修改搜索业务","aria-label":'Permalink to "9.2.3 修改搜索业务"'},"​")],-1)),l[771]||(l[771]=t("p",null,"在HotelService的search方法中，只有一个地方需要修改：requet.source().query( … )其中的查询条件。",-1)),l[772]||(l[772]=t("p",null,"在之前的业务中，只有match查询，根据关键字搜索，现在要添加条件过滤，包括：",-1)),l[773]||(l[773]=t("ul",null,[t("li",null,"品牌过滤：是keyword类型，用term查询"),t("li",null,"星级过滤：是keyword类型，用term查询"),t("li",null,"价格过滤：是数值类型，用range查询"),t("li",null,"城市过滤：是keyword类型，用term查询")],-1)),l[774]||(l[774]=t("p",null,"多个查询条件组合，肯定是boolean查询来组合：",-1)),l[775]||(l[775]=t("ul",null,[t("li",null,"关键字搜索放到must中，参与算分"),t("li",null,"其它过滤条件放到filter中，不参与算分")],-1)),l[776]||(l[776]=t("p",null,"因为条件构建的逻辑比较复杂，这里先封装为一个函数：",-1)),l[777]||(l[777]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210722092935453.png",alt:"image-20210722092935453",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[778]||(l[778]=t("p",null,"buildBasicQuery的代码如下：",-1)),l[779]||(l[779]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"private"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," buildBasicQuery"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(RequestParams params, SearchRequest request) {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 1.构建BooleanQuery")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    BoolQueryBuilder boolQuery "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," QueryBuilders."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"boolQuery"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.关键字搜索")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String key "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," params."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getKey"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (key "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=="),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ||"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' ""'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"equals"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(key)) {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        boolQuery."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"must"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"matchAllQuery"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    } "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"else"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        boolQuery."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"must"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"matchQuery"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"all"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", key));")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 3.城市条件")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (params."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getCity"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," &&"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," !"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"params."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getCity"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"equals"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'""'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")) {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        boolQuery."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"filter"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"termQuery"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"city"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", params."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getCity"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()));")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.品牌条件")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (params."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getBrand"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," &&"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," !"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"params."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getBrand"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"equals"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'""'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")) {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        boolQuery."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"filter"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"termQuery"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"brand"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", params."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getBrand"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()));")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 5.星级条件")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (params."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getStarName"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," &&"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," !"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"params."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getStarName"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"equals"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'""'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")) {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        boolQuery."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"filter"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"termQuery"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"starName"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", params."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getStarName"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()));")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"\t// 6.价格")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (params."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getMinPrice"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," &&"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," params."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getMaxPrice"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        boolQuery."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"filter"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                         ."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"rangeQuery"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"price"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                         ."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"gte"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(params."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getMinPrice"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                         ."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"lte"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(params."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getMaxPrice"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                        );")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"\t// 7.放入source")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    request."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"query"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(boolQuery);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[780]||(l[780]=t("h3",{id:"_9-3-我周边的酒店",tabindex:"-1"},[E("9.3 我周边的酒店 "),t("a",{class:"header-anchor",href:"#_9-3-我周边的酒店","aria-label":'Permalink to "9.3 我周边的酒店"'},"​")],-1)),l[781]||(l[781]=t("p",null,"需求：我附近的酒店",-1)),l[782]||(l[782]=t("h4",{id:"_9-3-1-需求分析",tabindex:"-1"},[E("9.3.1 需求分析 "),t("a",{class:"header-anchor",href:"#_9-3-1-需求分析","aria-label":'Permalink to "9.3.1 需求分析"'},"​")],-1)),l[783]||(l[783]=t("p",null,"在酒店列表页的右侧，有一个小地图，点击地图的定位按钮，地图会找到你所在的位置：",-1)),l[784]||(l[784]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210722093414542.png",alt:"image-20210722093414542",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[785]||(l[785]=t("p",null,"并且，在前端会发起查询请求，将你的坐标发送到服务端：",-1)),l[786]||(l[786]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210722093642382.png",alt:"image-20210722093642382",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[787]||(l[787]=t("p",null,"我们要做的事情就是基于这个location坐标，然后按照距离对周围酒店排序。实现思路如下：",-1)),l[788]||(l[788]=t("ul",null,[t("li",null,"修改RequestParams参数，接收location字段"),t("li",null,"修改search方法业务逻辑，如果location有值，添加根据geo_distance排序的功能")],-1)),l[789]||(l[789]=t("h4",{id:"_9-3-2-修改实体类",tabindex:"-1"},[E("9.3.2 修改实体类 "),t("a",{class:"header-anchor",href:"#_9-3-2-修改实体类","aria-label":'Permalink to "9.3.2 修改实体类"'},"​")],-1)),l[790]||(l[790]=t("p",null,[E("修改在"),t("code",null,"cn.itcast.hotel.pojo"),E("包下的实体类RequestParams：")],-1)),l[791]||(l[791]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"package"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," cn.itcast.hotel.pojo;")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," lombok.Data;")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Data")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," RequestParams"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String key;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer page;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer size;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String sortBy;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String city;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String brand;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String starName;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer minPrice;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer maxPrice;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 我当前的地理坐标")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String location;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[792]||(l[792]=t("h4",{id:"_9-3-3-距离排序api",tabindex:"-1"},[E("9.3.3 距离排序API "),t("a",{class:"header-anchor",href:"#_9-3-3-距离排序api","aria-label":'Permalink to "9.3.3 距离排序API"'},"​")],-1)),l[793]||(l[793]=t("p",null,"我们以前学习过排序功能，包括两种：",-1)),l[794]||(l[794]=t("ul",null,[t("li",null,"普通字段排序"),t("li",null,"地理坐标排序")],-1)),l[795]||(l[795]=t("p",null,"我们只讲了普通字段排序对应的java写法。地理坐标排序只学过DSL语法，如下：",-1)),l[796]||(l[796]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /indexName/_search")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "query"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "match_all"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {}")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "sort"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": [")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "price"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"asc"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  ")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "_geo_distance"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "FIELD"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"纬度，经度"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "order"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"asc"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "unit"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"km"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  ]")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[797]||(l[797]=t("p",null,"对应的java代码示例：",-1)),l[798]||(l[798]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210722095227059.png",alt:"image-20210722095227059",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[799]||(l[799]=t("h4",{id:"_9-3-4-添加距离排序",tabindex:"-1"},[E("9.3.4 添加距离排序 "),t("a",{class:"header-anchor",href:"#_9-3-4-添加距离排序","aria-label":'Permalink to "9.3.4 添加距离排序"'},"​")],-1)),l[800]||(l[800]=t("p",null,[E("在"),t("code",null,"cn.itcast.hotel.service.impl"),E("的"),t("code",null,"HotelService"),E("的"),t("code",null,"search"),E("方法中，添加一个排序功能：")],-1)),l[801]||(l[801]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210722095902314.png",alt:"image-20210722095902314",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[802]||(l[802]=t("p",null,"完整代码：",-1)),l[803]||(l[803]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Override")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," PageResult "),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"search"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(RequestParams params) {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    try"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 1.准备Request")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        SearchRequest request "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," SearchRequest"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 2.准备DSL")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 2.1.query")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        buildBasicQuery"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(params, request);")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 2.2.分页")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        int"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," page "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," params."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getPage"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        int"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," size "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," params."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getSize"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        request."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"from"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"((page "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 1"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"*"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," size)."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"size"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(size);")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 2.3.排序")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        String location "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," params."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getLocation"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        if"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (location "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," &&"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," !"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"location."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"equals"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'""'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")) {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            request."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"sort"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(SortBuilders")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                  ."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"geoDistanceSort"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"location"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," GeoPoint"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(location))")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                  ."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"order"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(SortOrder.ASC)")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                  ."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"unit"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(DistanceUnit.KILOMETERS)")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                 );")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 3.发送请求")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        SearchResponse response "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"search"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 4.解析响应")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," handleResponse"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(response);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    } "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"catch"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (IOException "),t("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"e"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        throw"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," RuntimeException"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(e);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[804]||(l[804]=t("h4",{id:"_9-3-5-排序距离显示",tabindex:"-1"},[E("9.3.5 排序距离显示 "),t("a",{class:"header-anchor",href:"#_9-3-5-排序距离显示","aria-label":'Permalink to "9.3.5 排序距离显示"'},"​")],-1)),l[805]||(l[805]=t("p",null,"重启服务后，测试我的酒店功能：",-1)),l[806]||(l[806]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210722100040674.png",alt:"image-20210722100040674",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[807]||(l[807]=t("p",null,"发现确实可以实现对我附近酒店的排序，不过并没有看到酒店到底距离我多远，这该怎么办？",-1)),l[808]||(l[808]=t("p",null,[E("排序完成后，页面还要获取我附近每个酒店的具体"),t("strong",null,"距离"),E("值，这个值在响应结果中是独立的：")],-1)),l[809]||(l[809]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210722095648542.png",alt:"image-20210722095648542",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[810]||(l[810]=t("p",null,"因此，我们在结果解析阶段，除了解析source部分以外，还要得到sort部分，也就是排序的距离，然后放到响应结果中。",-1)),l[811]||(l[811]=t("p",null,"我们要做两件事：",-1)),l[812]||(l[812]=t("ul",null,[t("li",null,"修改HotelDoc，添加排序距离字段，用于页面显示"),t("li",null,"修改HotelService类中的handleResponse方法，添加对sort值的获取")],-1)),l[813]||(l[813]=t("p",null,"1）修改HotelDoc类，添加距离字段",-1)),l[814]||(l[814]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"package"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," cn.itcast.hotel.pojo;")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," lombok.Data;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," lombok.NoArgsConstructor;")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Data")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"NoArgsConstructor")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HotelDoc"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Long id;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String name;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String address;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer price;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer score;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String brand;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String city;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String starName;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String business;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String location;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String pic;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 排序时的 距离值")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Object distance;")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HotelDoc"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Hotel "),t("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"hotel"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".id "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getId"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".name "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getName"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".address "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getAddress"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".price "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getPrice"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".score "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getScore"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".brand "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getBrand"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".city "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getCity"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".starName "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getStarName"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".business "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getBusiness"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".location "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getLatitude"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' ", "'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getLongitude"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".pic "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getPic"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[815]||(l[815]=t("p",null,"2）修改HotelService中的handleResponse方法",-1)),l[816]||(l[816]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210722100613966.png",alt:"image-20210722100613966",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[817]||(l[817]=t("p",null,"重启后测试，发现页面能成功显示距离了：",-1)),l[818]||(l[818]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210722100838604.png",alt:"image-20210722100838604",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[819]||(l[819]=t("h3",{id:"_9-4-酒店竞价排名",tabindex:"-1"},[E("9.4 酒店竞价排名 "),t("a",{class:"header-anchor",href:"#_9-4-酒店竞价排名","aria-label":'Permalink to "9.4 酒店竞价排名"'},"​")],-1)),l[820]||(l[820]=t("p",null,"需求：让指定的酒店在搜索结果中排名置顶",-1)),l[821]||(l[821]=t("h4",{id:"_9-4-1-需求分析",tabindex:"-1"},[E("9.4.1 需求分析 "),t("a",{class:"header-anchor",href:"#_9-4-1-需求分析","aria-label":'Permalink to "9.4.1 需求分析"'},"​")],-1)),l[822]||(l[822]=t("p",null,"要让指定酒店在搜索结果中排名置顶，效果如图：",-1)),l[823]||(l[823]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210722100947292.png",alt:"image-20210722100947292",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[824]||(l[824]=t("p",null,[E("页面会给指定的酒店添加"),t("strong",null,"广告"),E("标记。")],-1)),l[825]||(l[825]=t("p",null,"那怎样才能让指定的酒店排名置顶呢？",-1)),l[826]||(l[826]=t("p",null,"我们之前学习过的function_score查询可以影响算分，算分高了，自然排名也就高了。而function_score包含3个要素：",-1)),l[827]||(l[827]=t("ul",null,[t("li",null,"过滤条件：哪些文档要加分"),t("li",null,"算分函数：如何计算function score"),t("li",null,"加权方式：function score 与 query score如何运算")],-1)),l[828]||(l[828]=t("p",null,[E("这里的需求是：让"),t("strong",null,"指定酒店"),E("排名靠前。因此我们需要给这些酒店添加一个标记，这样在过滤条件中就可以"),t("strong",null,"根据这个标记来判断，是否要提高算分"),E("。")],-1)),l[829]||(l[829]=t("p",null,"比如，我们给酒店添加一个字段：isAD，Boolean类型：",-1)),l[830]||(l[830]=t("ul",null,[t("li",null,"true：是广告"),t("li",null,"false：不是广告")],-1)),l[831]||(l[831]=t("p",null,"这样function_score包含3个要素就很好确定了：",-1)),l[832]||(l[832]=t("ul",null,[t("li",null,"过滤条件：判断isAD 是否为true"),t("li",null,"算分函数：我们可以用最简单暴力的weight，固定加权值"),t("li",null,"加权方式：可以用默认的相乘，大大提高算分")],-1)),l[833]||(l[833]=t("p",null,"因此，业务的实现步骤包括：",-1)),l[834]||(l[834]=t("ol",null,[t("li",null,[t("p",null,"给HotelDoc类添加isAD字段，Boolean类型")]),t("li",null,[t("p",null,"挑选几个你喜欢的酒店，给它的文档数据添加isAD字段，值为true")]),t("li",null,[t("p",null,"修改search方法，添加function score功能，给isAD值为true的酒店增加权重")])],-1)),l[835]||(l[835]=t("h4",{id:"_9-4-2-修改hoteldoc实体",tabindex:"-1"},[E("9.4.2 修改HotelDoc实体 "),t("a",{class:"header-anchor",href:"#_9-4-2-修改hoteldoc实体","aria-label":'Permalink to "9.4.2 修改HotelDoc实体"'},"​")],-1)),l[836]||(l[836]=t("p",null,[E("给"),t("code",null,"cn.itcast.hotel.pojo"),E("包下的HotelDoc类添加isAD字段：")],-1)),l[837]||(l[837]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210722101908062.png",alt:"image-20210722101908062",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[838]||(l[838]=t("h4",{id:"_9-4-3-添加广告标记",tabindex:"-1"},[E("9.4.3 添加广告标记 "),t("a",{class:"header-anchor",href:"#_9-4-3-添加广告标记","aria-label":'Permalink to "9.4.3 添加广告标记"'},"​")],-1)),l[839]||(l[839]=t("p",null,"接下来，我们挑几个酒店，添加isAD字段，设置为true：",-1)),l[840]||(l[840]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"POST /hotel/_update/"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1902197537")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "doc"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "isAD"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"POST /hotel/_update/"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2056126831")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "doc"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "isAD"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"POST /hotel/_update/"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1989806195")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "doc"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "isAD"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"POST /hotel/_update/"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2056105938")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "doc"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "isAD"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[841]||(l[841]=t("h4",{id:"_9-4-4-添加算分函数查询",tabindex:"-1"},[E("9.4.4 添加算分函数查询 "),t("a",{class:"header-anchor",href:"#_9-4-4-添加算分函数查询","aria-label":'Permalink to "9.4.4 添加算分函数查询"'},"​")],-1)),l[842]||(l[842]=t("p",null,"接下来我们就要修改查询条件了。之前是用的boolean 查询，现在要改成function_socre查询。",-1)),l[843]||(l[843]=t("p",null,"function_score查询结构如下：",-1)),l[844]||(l[844]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721191544750.png",alt:"image-20210721191544750",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[845]||(l[845]=t("p",null,"对应的JavaAPI如下：",-1)),l[846]||(l[846]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210722102850818.png",alt:"image-20210722102850818",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[847]||(l[847]=t("p",null,[E("我们可以将之前写的boolean查询作为"),t("strong",null,"原始查询"),E("条件放到query中，接下来就是添加"),t("strong",null,"过滤条件"),E("、"),t("strong",null,"算分函数"),E("、"),t("strong",null,"加权模式"),E("了。所以原来的代码依然可以沿用。")],-1)),l[848]||(l[848]=t("p",null,[E("修改"),t("code",null,"cn.itcast.hotel.service.impl"),E("包下的"),t("code",null,"HotelService"),E("类中的"),t("code",null,"buildBasicQuery"),E("方法，添加算分函数查询：")],-1)),l[849]||(l[849]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"private"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," buildBasicQuery"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(RequestParams params, SearchRequest request) {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 1.构建BooleanQuery")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    BoolQueryBuilder boolQuery "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," QueryBuilders."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"boolQuery"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 关键字搜索")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String key "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," params."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getKey"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (key "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=="),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ||"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' ""'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"equals"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(key)) {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        boolQuery."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"must"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"matchAllQuery"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    } "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"else"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        boolQuery."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"must"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"matchQuery"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"all"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", key));")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 城市条件")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (params."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getCity"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," &&"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," !"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"params."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getCity"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"equals"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'""'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")) {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        boolQuery."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"filter"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"termQuery"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"city"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", params."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getCity"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()));")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 品牌条件")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (params."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getBrand"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," &&"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," !"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"params."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getBrand"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"equals"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'""'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")) {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        boolQuery."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"filter"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"termQuery"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"brand"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", params."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getBrand"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()));")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 星级条件")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (params."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getStarName"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," &&"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," !"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"params."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getStarName"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"equals"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'""'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")) {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        boolQuery."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"filter"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"termQuery"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"starName"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", params."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getStarName"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()));")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 价格")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (params."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getMinPrice"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," &&"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," params."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getMaxPrice"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        boolQuery."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"filter"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                         ."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"rangeQuery"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"price"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                         ."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"gte"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(params."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getMinPrice"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                         ."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"lte"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(params."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getMaxPrice"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                        );")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.算分控制")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    FunctionScoreQueryBuilder functionScoreQuery "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        QueryBuilders."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"functionScoreQuery"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 原始查询，相关性算分的查询")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        boolQuery,")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // function score的数组")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        new"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," FunctionScoreQueryBuilder."),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"FilterFunctionBuilder"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[]{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            // 其中的一个function score 元素")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            new"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," FunctionScoreQueryBuilder."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"FilterFunctionBuilder"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"                // 过滤条件")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                QueryBuilders."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"termQuery"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"isAD"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"                // 算分函数")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                ScoreFunctionBuilders."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"weightFactorFunction"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"10"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            )")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        });")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    request."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"query"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(functionScoreQuery);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[850]||(l[850]=t("hr",null,null,-1)),l[851]||(l[851]=t("h2",{id:"_10-数据聚合",tabindex:"-1"},[E("10. 数据聚合 "),t("a",{class:"header-anchor",href:"#_10-数据聚合","aria-label":'Permalink to "10. 数据聚合"'},"​")],-1)),l[852]||(l[852]=t("p",null,[E("**"),t("a",{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/search-aggregations.html",target:"_blank",rel:"noreferrer"},"聚合（"),t("a",{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/search-aggregations.html",target:"_blank",rel:"noreferrer"},"aggregations"),t("a",{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/search-aggregations.html",target:"_blank",rel:"noreferrer"},"）"),E("**可以让我们极其方便的实现对数据的统计、分析、运算。例如：")],-1)),l[853]||(l[853]=t("ul",null,[t("li",null,"什么品牌的手机最受欢迎？"),t("li",null,"这些手机的平均价格、最高价格、最低价格？"),t("li",null,"这些手机每月的销售情况如何？")],-1)),l[854]||(l[854]=t("p",null,"实现这些统计功能的比数据库的sql要方便的多，而且查询速度非常快，可以实现近实时搜索效果。",-1)),l[855]||(l[855]=t("h3",{id:"_10-1-聚合的种类",tabindex:"-1"},[E("10.1 聚合的种类 "),t("a",{class:"header-anchor",href:"#_10-1-聚合的种类","aria-label":'Permalink to "10.1 聚合的种类"'},"​")],-1)),l[856]||(l[856]=t("p",null,"聚合常见的有三类：",-1)),l[857]||(l[857]=t("ul",null,[t("li",null,[t("p",null,"**桶（Bucket）**聚合：用来对文档做分组"),t("ul",null,[t("li",null,"TermAggregation：按照文档字段值分组，例如按照品牌值分组、按照国家分组"),t("li",null,"Date Histogram：按照日期阶梯分组，例如一周为一组，或者一月为一组")])]),t("li",null,[t("p",null,"**度量（Metric）**聚合：用以计算一些值，比如：最大值、最小值、平均值等"),t("ul",null,[t("li",null,"Avg：求平均值"),t("li",null,"Max：求最大值"),t("li",null,"Min：求最小值"),t("li",null,"Stats：同时求max、min、avg、sum等")])]),t("li",null,[t("p",null,"**管道（pipeline）**聚合：其它聚合的结果为基础做聚合")])],-1)),l[858]||(l[858]=t("blockquote",null,[t("p",null,"**注意：**参加聚合的字段必须是keyword、日期、数值、布尔类型")],-1)),l[859]||(l[859]=t("h3",{id:"_10-2-dsl实现聚合",tabindex:"-1"},[E("10.2 DSL实现聚合 "),t("a",{class:"header-anchor",href:"#_10-2-dsl实现聚合","aria-label":'Permalink to "10.2 DSL实现聚合"'},"​")],-1)),l[860]||(l[860]=t("p",null,"现在，我们要统计所有数据中的酒店品牌有几种，其实就是按照品牌对数据分组。此时可以根据酒店品牌的名称做聚合，也就是Bucket聚合。",-1)),l[861]||(l[861]=t("h4",{id:"_10-2-1-bucket聚合语法",tabindex:"-1"},[E("10.2.1 Bucket聚合语法 "),t("a",{class:"header-anchor",href:"#_10-2-1-bucket聚合语法","aria-label":'Permalink to "10.2.1 Bucket聚合语法"'},"​")],-1)),l[862]||(l[862]=t("p",null,"语法如下：",-1)),l[863]||(l[863]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /hotel/_search")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "size"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",  "),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 设置size为0，结果中不包含文档，只包含聚合结果")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "aggs"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": { "),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 定义聚合")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "brandAgg"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": { "),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//给聚合起个名字")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "terms"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": { "),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 聚合的类型，按照品牌值聚合，所以选择term")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "field"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"brand"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 参与聚合的字段")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "size"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"20"),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," // 希望获取的聚合结果数量")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[864]||(l[864]=t("p",null,"结果如图：",-1)),l[865]||(l[865]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723171948228.png",alt:"image-20210723171948228",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[866]||(l[866]=t("h4",{id:"_10-2-2-聚合结果排序",tabindex:"-1"},[E("10.2.2 聚合结果排序 "),t("a",{class:"header-anchor",href:"#_10-2-2-聚合结果排序","aria-label":'Permalink to "10.2.2 聚合结果排序"'},"​")],-1)),l[867]||(l[867]=t("p",null,"默认情况下，Bucket聚合会统计Bucket内的文档数量，记为_count，并且按照_count降序排序。",-1)),l[868]||(l[868]=t("p",null,"我们可以指定order属性，自定义聚合的排序方式：",-1)),l[869]||(l[869]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /hotel/_search")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "size"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", ")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "aggs"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "brandAgg"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "terms"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "field"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"brand"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "order"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "_count"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"asc"'),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," // 按照_count升序排列")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "size"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"20")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[870]||(l[870]=t("h4",{id:"_10-2-3-限定聚合范围",tabindex:"-1"},[E("10.2.3 限定聚合范围 "),t("a",{class:"header-anchor",href:"#_10-2-3-限定聚合范围","aria-label":'Permalink to "10.2.3 限定聚合范围"'},"​")],-1)),l[871]||(l[871]=t("p",null,"默认情况下，Bucket聚合是对索引库的所有文档做聚合，但真实场景下，用户会输入搜索条件，因此聚合必须是对搜索结果聚合。那么聚合必须添加限定条件。",-1)),l[872]||(l[872]=t("p",null,"我们可以限定要聚合的文档范围，只要添加query条件即可：",-1)),l[873]||(l[873]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /hotel/_search")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "query"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "range"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "price"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "lte"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"200"),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," // 只对200元以下的文档聚合")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }, ")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "size"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", ")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "aggs"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "brandAgg"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "terms"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "field"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"brand"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "size"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"20")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[874]||(l[874]=t("p",null,"这次，聚合得到的品牌明显变少了：",-1)),l[875]||(l[875]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723172404836.png",alt:"image-20210723172404836",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[876]||(l[876]=t("h4",{id:"_10-2-4-metric聚合语法",tabindex:"-1"},[E("10.2.4 Metric聚合语法 "),t("a",{class:"header-anchor",href:"#_10-2-4-metric聚合语法","aria-label":'Permalink to "10.2.4 Metric聚合语法"'},"​")],-1)),l[877]||(l[877]=t("p",null,"上节课，我们对酒店按照品牌分组，形成了一个个桶。现在我们需要对桶内的酒店做运算，获取每个品牌的用户评分的min、max、avg等值。",-1)),l[878]||(l[878]=t("p",null,"这就要用到Metric聚合了，例如stat聚合：就可以获取min、max、avg等结果。",-1)),l[879]||(l[879]=t("p",null,"语法如下：",-1)),l[880]||(l[880]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /hotel/_search")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "size"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", ")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "aggs"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "brandAgg"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": { ")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "terms"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": { ")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "field"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"brand"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", ")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "size"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"20")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "aggs"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": { "),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 是brands聚合的子聚合，也就是分组后对每组分别计算")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "score_stats"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": { "),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 聚合名称")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "stats"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": { "),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 聚合类型，这里stats可以计算min、max、avg等")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'            "field"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"score"'),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," // 聚合字段，这里是score")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"          }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[881]||(l[881]=t("p",null,"这次的score_stats聚合是在brandAgg的聚合内部嵌套的子聚合。因为我们需要在每个桶分别计算。",-1)),l[882]||(l[882]=t("p",null,"另外，我们还可以给聚合结果做个排序，例如按照每个桶的酒店平均分做排序：",-1)),l[883]||(l[883]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723172917636.png",alt:"image-20210723172917636",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[884]||(l[884]=t("h4",{id:"_10-2-5-小结",tabindex:"-1"},[E("10.2.5 小结 "),t("a",{class:"header-anchor",href:"#_10-2-5-小结","aria-label":'Permalink to "10.2.5 小结"'},"​")],-1)),l[885]||(l[885]=t("blockquote",null,[t("ul",null,[t("li",null,[t("p",null,"aggs代表聚合，与query同级，此时query的作用是？"),t("ul",null,[t("li",null,"限定聚合的的文档范围")])]),t("li",null,[t("p",null,"聚合必须的三要素："),t("ul",null,[t("li",null,[t("p",null,"聚合名称")]),t("li",null,[t("p",null,"聚合类型")]),t("li",null,[t("p",null,"聚合字段")])])]),t("li",null,[t("p",null,"聚合可配置属性有："),t("ul",null,[t("li",null,[t("p",null,"size：指定聚合结果数量")]),t("li",null,[t("p",null,"order：指定聚合结果排序方式")]),t("li",null,[t("p",null,"field：指定聚合字段")])])])])],-1)),l[886]||(l[886]=t("h3",{id:"_10-3-restapi实现聚合",tabindex:"-1"},[E("10.3 RestAPI实现聚合 "),t("a",{class:"header-anchor",href:"#_10-3-restapi实现聚合","aria-label":'Permalink to "10.3 RestAPI实现聚合"'},"​")],-1)),l[887]||(l[887]=t("h4",{id:"_10-3-1-api语法",tabindex:"-1"},[E("10.3.1 API语法 "),t("a",{class:"header-anchor",href:"#_10-3-1-api语法","aria-label":'Permalink to "10.3.1 API语法"'},"​")],-1)),l[888]||(l[888]=t("p",null,"聚合条件与query条件同级别，因此需要使用request.source()来指定聚合条件。",-1)),l[889]||(l[889]=t("p",null,"聚合条件的语法：",-1)),l[890]||(l[890]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723173057733.png",alt:"image-20210723173057733",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[891]||(l[891]=t("p",null,"聚合的结果也与查询结果不同，API也比较特殊。不过同样是JSON逐层解析：",-1)),l[892]||(l[892]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723173215728.png",alt:"image-20210723173215728",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[893]||(l[893]=t("h4",{id:"_10-3-2-业务需求",tabindex:"-1"},[E("10.3.2 业务需求 "),t("a",{class:"header-anchor",href:"#_10-3-2-业务需求","aria-label":'Permalink to "10.3.2 业务需求"'},"​")],-1)),l[894]||(l[894]=t("p",null,"需求：搜索页面的品牌、城市等信息不应该是在页面写死，而是通过聚合索引库中的酒店数据得来的：",-1)),l[895]||(l[895]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723192605566.png",alt:"image-20210723192605566",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[896]||(l[896]=t("p",null,"分析：",-1)),l[897]||(l[897]=t("p",null,"目前，页面的城市列表、星级列表、品牌列表都是写死的，并不会随着搜索结果的变化而变化。但是用户搜索条件改变时，搜索结果会跟着变化。",-1)),l[898]||(l[898]=t("p",null,"例如：用户搜索“东方明珠”，那搜索的酒店肯定是在上海东方明珠附近，因此，城市只能是上海，此时城市列表中就不应该显示北京、深圳、杭州这些信息了。",-1)),l[899]||(l[899]=t("p",null,"也就是说，搜索结果中包含哪些城市，页面就应该列出哪些城市；搜索结果中包含哪些品牌，页面就应该列出哪些品牌。",-1)),l[900]||(l[900]=t("p",null,"如何得知搜索结果中包含哪些品牌？如何得知搜索结果中包含哪些城市？",-1)),l[901]||(l[901]=t("p",null,"使用聚合功能，利用Bucket聚合，对搜索结果中的文档基于品牌分组、基于城市分组，就能得知包含哪些品牌、哪些城市了。",-1)),l[902]||(l[902]=t("p",null,[E("因为是对搜索结果聚合，因此聚合是"),t("strong",null,"限定范围的聚合"),E("，也就是说聚合的限定条件跟搜索文档的条件一致。")],-1)),l[903]||(l[903]=t("p",null,"查看浏览器可以发现，前端其实已经发出了这样的一个请求：",-1)),l[904]||(l[904]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723193730799.png",alt:"image-20210723193730799",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[905]||(l[905]=t("p",null,[E("请求"),t("strong",null,"参数与搜索文档的参数完全一致"),E("。")],-1)),l[906]||(l[906]=t("p",null,"返回值类型就是页面要展示的最终结果：",-1)),l[907]||(l[907]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723203915982.png",alt:"image-20210723203915982",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[908]||(l[908]=t("p",null,"结果是一个Map结构：",-1)),l[909]||(l[909]=t("ul",null,[t("li",null,"key是字符串，城市、星级、品牌、价格"),t("li",null,"value是集合，例如多个城市的名称")],-1)),l[910]||(l[910]=t("h4",{id:"_10-3-3-业务实现",tabindex:"-1"},[E("10.3.3 业务实现 "),t("a",{class:"header-anchor",href:"#_10-3-3-业务实现","aria-label":'Permalink to "10.3.3 业务实现"'},"​")],-1)),l[911]||(l[911]=t("p",null,[E("在"),t("code",null,"cn.itcast.hotel.web"),E("包的"),t("code",null,"HotelController"),E("中添加一个方法，遵循下面的要求：")],-1)),l[912]||(l[912]=t("ul",null,[t("li",null,[E("请求方式："),t("code",null,"POST")]),t("li",null,[E("请求路径："),t("code",null,"/hotel/filters")]),t("li",null,[E("请求参数："),t("code",null,"RequestParams"),E("，与搜索文档的参数一致")]),t("li",null,[E("返回值类型："),t("code",null,"Map<String, List<String>>")])],-1)),l[913]||(l[913]=t("p",null,"代码：",-1)),l[914]||(l[914]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"PostMapping"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"filters"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Map"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"String, List"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"String"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">>"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getFilters"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestBody"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RequestParams params){")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotelService."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getFilters"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(params);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[915]||(l[915]=t("p",null,"这里调用了IHotelService中的getFilters方法，尚未实现。",-1)),l[916]||(l[916]=t("p",null,[E("在"),t("code",null,"cn.itcast.hotel.service.IHotelService"),E("中定义新方法：")],-1)),l[917]||(l[917]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Map"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"String, List"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"String"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">>"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," filters"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(RequestParams params);")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[918]||(l[918]=t("p",null,[E("在"),t("code",null,"cn.itcast.hotel.service.impl.HotelService"),E("中实现该方法：")],-1)),l[919]||(l[919]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Override")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Map"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"String, List"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"String"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">>"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," filters"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(RequestParams params) {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    try"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 1.准备Request")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        SearchRequest request "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," SearchRequest"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 2.准备DSL")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 2.1.query")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        buildBasicQuery"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(params, request);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 2.2.设置size")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        request."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"size"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 2.3.聚合")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        buildAggregation"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 3.发出请求")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        SearchResponse response "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"search"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 4.解析结果")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        Map<"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"String"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", List<"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"String"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">> result "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," HashMap<>();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        Aggregations aggregations "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," response."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getAggregations"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 4.1.根据品牌名称，获取品牌结果")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        List<"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"String"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> brandList "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getAggByName"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(aggregations, "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"brandAgg"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        result."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"put"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"品牌"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", brandList);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 4.2.根据品牌名称，获取品牌结果")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        List<"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"String"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> cityList "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getAggByName"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(aggregations, "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"cityAgg"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        result."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"put"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"城市"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", cityList);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 4.3.根据品牌名称，获取品牌结果")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        List<"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"String"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> starList "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getAggByName"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(aggregations, "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"starAgg"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        result."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"put"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"星级"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", starList);")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," result;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    } "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"catch"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (IOException "),t("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"e"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        throw"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," RuntimeException"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(e);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"private"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," buildAggregation"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(SearchRequest request) {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    request."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"aggregation"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(AggregationBuilders")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                 ."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"terms"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"brandAgg"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                 ."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"field"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"brand"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                 ."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"size"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"100"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                );")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    request."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"aggregation"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(AggregationBuilders")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                 ."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"terms"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"cityAgg"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                 ."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"field"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"city"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                 ."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"size"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"100"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                );")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    request."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"aggregation"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(AggregationBuilders")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                 ."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"terms"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"starAgg"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                 ."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"field"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"starName"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                 ."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"size"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"100"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                );")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," List"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"String"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getAggByName"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Aggregations aggregations, String aggName) {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.1.根据聚合名称获取聚合结果")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    Terms brandTerms "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," aggregations."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"get"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(aggName);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.2.获取buckets")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    List<"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"?"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," extends"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," Terms"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Bucket"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> buckets "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," brandTerms."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getBuckets"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.3.遍历")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    List<"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"String"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> brandList "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ArrayList<>();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    for"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (Terms.Bucket bucket "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," buckets) {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 4.4.获取key")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        String key "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," bucket."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getKeyAsString"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        brandList."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"add"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(key);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    return"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," brandList;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[920]||(l[920]=t("hr",null,null,-1)),l[921]||(l[921]=t("h2",{id:"_11-自动补全",tabindex:"-1"},[E("11. 自动补全 "),t("a",{class:"header-anchor",href:"#_11-自动补全","aria-label":'Permalink to "11. 自动补全"'},"​")],-1)),l[922]||(l[922]=t("p",null,"当用户在搜索框输入字符时，我们应该提示出与该字符有关的搜索项，如图：",-1)),l[923]||(l[923]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723204936367.png",alt:"image-20210723204936367",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[924]||(l[924]=t("p",null,"这种根据用户输入的字母，提示完整词条的功能，就是自动补全了。",-1)),l[925]||(l[925]=t("p",null,"因为需要根据拼音字母来推断，因此要用到拼音分词功能。",-1)),l[926]||(l[926]=t("h3",{id:"_11-1-拼音分词器",tabindex:"-1"},[E("11.1.拼音分词器 "),t("a",{class:"header-anchor",href:"#_11-1-拼音分词器","aria-label":'Permalink to "11.1.拼音分词器"'},"​")],-1)),l[927]||(l[927]=t("p",null,[E("要实现根据字母做补全，就必须对文档按照拼音分词。在GitHub上恰好有elasticsearch的拼音分词插件。地址："),t("a",{href:"https://github.com/medcl/elasticsearch-analysis-pinyin",target:"_blank",rel:"noreferrer"},"https://github.com/medcl/elasticsearch-analysis-pinyin")],-1)),l[928]||(l[928]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723205932746.png",alt:"image-20210723205932746",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[929]||(l[929]=t("p",null,"课前资料中也提供了拼音分词器的安装包：",-1)),l[930]||(l[930]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723205722303.png",alt:"image-20210723205722303",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[931]||(l[931]=t("p",null,"安装方式与IK分词器一样，分三步：",-1)),l[932]||(l[932]=t("p",null,"​ ①解压",-1)),l[933]||(l[933]=t("p",null,"​ ②上传到虚拟机中，elasticsearch的plugin目录",-1)),l[934]||(l[934]=t("p",null,"​ ③重启elasticsearch",-1)),l[935]||(l[935]=t("p",null,"​ ④测试",-1)),l[936]||(l[936]=t("p",null,"详细安装步骤可以参考IK分词器的安装过程。",-1)),l[937]||(l[937]=t("p",null,"测试用法如下：",-1)),l[938]||(l[938]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"POST /_analyze")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "text"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"如家酒店还不错"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "analyzer"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"pinyin"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[939]||(l[939]=t("p",null,"结果：",-1)),l[940]||(l[940]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723210126506.png",alt:"image-20210723210126506",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[941]||(l[941]=t("h3",{id:"_11-2-自定义分词器",tabindex:"-1"},[E("11.2 自定义分词器 "),t("a",{class:"header-anchor",href:"#_11-2-自定义分词器","aria-label":'Permalink to "11.2 自定义分词器"'},"​")],-1)),l[942]||(l[942]=t("p",null,"默认的拼音分词器会将每个汉字单独分为拼音，而我们希望的是每个词条形成一组拼音，需要对拼音分词器做个性化定制，形成自定义分词器。",-1)),l[943]||(l[943]=t("p",null,"elasticsearch中分词器（analyzer）的组成包含三部分：",-1)),l[944]||(l[944]=t("ul",null,[t("li",null,"character filters：在tokenizer之前对文本进行处理。例如删除字符、替换字符"),t("li",null,"tokenizer：将文本按照一定的规则切割成词条（term）。例如keyword，就是不分词；还有ik_smart"),t("li",null,"tokenizer filter：将tokenizer输出的词条做进一步处理。例如大小写转换、同义词处理、拼音处理等")],-1)),l[945]||(l[945]=t("p",null,"文档分词时会依次由这三部分来处理文档：",-1)),l[946]||(l[946]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723210427878.png",alt:"image-20210723210427878",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[947]||(l[947]=t("p",null,"声明自定义分词器的语法如下：",-1)),l[948]||(l[948]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"PUT /test")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "settings"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "analysis"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "analyzer"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": { "),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 自定义分词器")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "my_analyzer"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {  "),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 分词器名称")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "tokenizer"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"ik_max_word"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "filter"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"py"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "filter"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": { "),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 自定义tokenizer filter")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "py"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": { "),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 过滤器名称")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"pinyin"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 过滤器类型，这里是pinyin")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\t\t  "keep_full_pinyin"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"false"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "keep_joined_full_pinyin"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "keep_original"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "limit_first_letter_length"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"16"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "remove_duplicated_term"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "none_chinese_pinyin_tokenize"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"false")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "mappings"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "properties"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "name"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"text"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "analyzer"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"my_analyzer"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "search_analyzer"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"ik_smart"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[949]||(l[949]=t("p",null,"测试：",-1)),l[950]||(l[950]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723211829150.png",alt:"image-20210723211829150",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[951]||(l[951]=t("p",null,"总结：",-1)),l[952]||(l[952]=t("p",null,"如何使用拼音分词器？",-1)),l[953]||(l[953]=t("ul",null,[t("li",null,[t("p",null,"①下载pinyin分词器")]),t("li",null,[t("p",null,"②解压并放到elasticsearch的plugin目录")]),t("li",null,[t("p",null,"③重启即可")])],-1)),l[954]||(l[954]=t("p",null,"如何自定义分词器？",-1)),l[955]||(l[955]=t("ul",null,[t("li",null,[t("p",null,"①创建索引库时，在settings中配置，可以包含三部分")]),t("li",null,[t("p",null,"②character filter")]),t("li",null,[t("p",null,"③tokenizer")]),t("li",null,[t("p",null,"④filter")])],-1)),l[956]||(l[956]=t("p",null,"拼音分词器注意事项？",-1)),l[957]||(l[957]=t("ul",null,[t("li",null,"为了避免搜索到同音字，搜索时不要使用拼音分词器")],-1)),l[958]||(l[958]=t("h3",{id:"_11-3-自动补全查询",tabindex:"-1"},[E("11.3 自动补全查询 "),t("a",{class:"header-anchor",href:"#_11-3-自动补全查询","aria-label":'Permalink to "11.3 自动补全查询"'},"​")],-1)),l[959]||(l[959]=t("p",null,[E("elasticsearch提供了"),t("a",{href:"https://www.elastic.co/guide/en/elasticsearch/reference/7.6/search-suggesters.html",target:"_blank",rel:"noreferrer"},"Completion Suggester"),E("查询来实现自动补全功能。这个查询会匹配以用户输入内容开头的词条并返回。为了提高补全查询的效率，对于文档中字段的类型有一些约束：")],-1)),l[960]||(l[960]=t("ul",null,[t("li",null,[t("p",null,"参与补全查询的字段必须是completion类型。")]),t("li",null,[t("p",null,"字段的内容一般是用来补全的多个词条形成的数组。")])],-1)),l[961]||(l[961]=t("p",null,"比如，一个这样的索引库：",-1)),l[962]||(l[962]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 创建索引库")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"PUT test")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "mappings"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "properties"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "title"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"completion"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[963]||(l[963]=t("p",null,"然后插入下面的数据：",-1)),l[964]||(l[964]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 示例数据")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"POST test/_doc")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "title"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": ["),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Sony"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"WH-1000XM3"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"POST test/_doc")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "title"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": ["),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"SK-II"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"PITERA"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"POST test/_doc")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "title"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": ["),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Nintendo"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"switch"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[965]||(l[965]=t("p",null,"查询的DSL语句如下：",-1)),l[966]||(l[966]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 自动补全查询")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /test/_search")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "suggest"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "title_suggest"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "text"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"s"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 关键字")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "completion"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "field"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"title"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 补全查询的字段")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "skip_duplicates"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 跳过重复的")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "size"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"10"),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," // 获取前10条结果")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[967]||(l[967]=t("h3",{id:"_11-4-实现酒店搜索框自动补全",tabindex:"-1"},[E("11.4 实现酒店搜索框自动补全 "),t("a",{class:"header-anchor",href:"#_11-4-实现酒店搜索框自动补全","aria-label":'Permalink to "11.4 实现酒店搜索框自动补全"'},"​")],-1)),l[968]||(l[968]=t("p",null,"现在，我们的hotel索引库还没有设置拼音分词器，需要修改索引库中的配置。但是我们知道索引库是无法修改的，只能删除然后重新创建。",-1)),l[969]||(l[969]=t("p",null,"另外，我们需要添加一个字段，用来做自动补全，将brand、suggestion、city等都放进去，作为自动补全的提示。",-1)),l[970]||(l[970]=t("p",null,"因此，总结一下，我们需要做的事情包括：",-1)),l[971]||(l[971]=t("ol",null,[t("li",null,[t("p",null,"修改hotel索引库结构，设置自定义拼音分词器")]),t("li",null,[t("p",null,"修改索引库的name、all字段，使用自定义分词器")]),t("li",null,[t("p",null,"索引库添加一个新字段suggestion，类型为completion类型，使用自定义的分词器")]),t("li",null,[t("p",null,"给HotelDoc类添加suggestion字段，内容包含brand、business")]),t("li",null,[t("p",null,"重新导入数据到hotel库")])],-1)),l[972]||(l[972]=t("h4",{id:"_11-4-1-修改酒店映射结构",tabindex:"-1"},[E("11.4.1 修改酒店映射结构 "),t("a",{class:"header-anchor",href:"#_11-4-1-修改酒店映射结构","aria-label":'Permalink to "11.4.1 修改酒店映射结构"'},"​")],-1)),l[973]||(l[973]=t("p",null,"代码如下：",-1)),l[974]||(l[974]=t("div",{class:"language-json max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"json"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 酒店数据索引库")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"PUT /hotel")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "settings"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "analysis"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "analyzer"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "text_anlyzer"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "tokenizer"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"ik_max_word"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "filter"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"py"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "completion_analyzer"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "tokenizer"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"keyword"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "filter"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"py"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "filter"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "py"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"pinyin"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "keep_full_pinyin"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"false"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "keep_joined_full_pinyin"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "keep_original"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "limit_first_letter_length"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"16"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "remove_duplicated_term"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "none_chinese_pinyin_tokenize"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"false")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "mappings"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "properties"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "id"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"keyword"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "name"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"text"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "analyzer"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"text_anlyzer"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "search_analyzer"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"ik_smart"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "copy_to"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"all"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "address"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"keyword"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "index"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"false")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "price"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"integer"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "score"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"integer"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "brand"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"keyword"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "copy_to"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"all"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "city"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"keyword"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "starName"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"keyword"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "business"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"keyword"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "copy_to"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"all"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "location"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"geo_point"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "pic"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"keyword"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "index"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"false")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "all"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"text"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "analyzer"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"text_anlyzer"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "search_analyzer"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"ik_smart"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "suggestion"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "type"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"completion"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "analyzer"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"completion_analyzer"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[975]||(l[975]=t("h4",{id:"_11-4-2-修改hoteldoc实体",tabindex:"-1"},[E("11.4.2 修改HotelDoc实体 "),t("a",{class:"header-anchor",href:"#_11-4-2-修改hoteldoc实体","aria-label":'Permalink to "11.4.2 修改HotelDoc实体"'},"​")],-1)),l[976]||(l[976]=t("p",null,"HotelDoc中要添加一个字段，用来做自动补全，内容可以是酒店品牌、城市、商圈等信息。按照自动补全字段的要求，最好是这些字段的数组。",-1)),l[977]||(l[977]=t("p",null,[E("因此我们在HotelDoc中添加一个suggestion字段，类型为"),t("code",null,"List<String>"),E("，然后将brand、city、business等信息放到里面。")],-1)),l[978]||(l[978]=t("p",null,"代码如下：",-1)),l[979]||(l[979]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"package"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," cn.itcast.hotel.pojo;")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," lombok.Data;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," lombok.NoArgsConstructor;")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," java.util.ArrayList;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," java.util.Arrays;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," java.util.Collections;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," java.util.List;")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Data")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"NoArgsConstructor")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HotelDoc"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Long id;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String name;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String address;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer price;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer score;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String brand;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String city;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String starName;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String business;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String location;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String pic;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Object distance;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Boolean isAD;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," List<"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"String"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> suggestion;")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HotelDoc"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Hotel "),t("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"hotel"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".id "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getId"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".name "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getName"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".address "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getAddress"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".price "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getPrice"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".score "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getScore"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".brand "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getBrand"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".city "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getCity"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".starName "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getStarName"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".business "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getBusiness"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".location "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getLatitude"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' ", "'),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getLongitude"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".pic "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getPic"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 组装suggestion")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        if"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".business."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"contains"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")){")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            // business有多个值，需要切割")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            String"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[] arr "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".business."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"split"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            // 添加元素")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"            this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".suggestion "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ArrayList<>();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"            this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".suggestion."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"add"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".brand);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            Collections."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"addAll"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".suggestion, arr);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"else"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"            this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".suggestion "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Arrays."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"asList"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".brand, "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"this"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".business);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[980]||(l[980]=t("h4",{id:"_11-4-3-重新导入",tabindex:"-1"},[E("11.4.3 重新导入 "),t("a",{class:"header-anchor",href:"#_11-4-3-重新导入","aria-label":'Permalink to "11.4.3 重新导入"'},"​")],-1)),l[981]||(l[981]=t("p",null,"重新执行之前编写的导入数据功能，可以看到新的酒店数据中包含了suggestion：",-1)),l[982]||(l[982]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723213546183.png",alt:"image-20210723213546183",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[983]||(l[983]=t("h4",{id:"_11-4-4-自动补全查询的javaapi",tabindex:"-1"},[E("11.4.4 自动补全查询的JavaAPI "),t("a",{class:"header-anchor",href:"#_11-4-4-自动补全查询的javaapi","aria-label":'Permalink to "11.4.4 自动补全查询的JavaAPI"'},"​")],-1)),l[984]||(l[984]=t("p",null,"之前我们学习了自动补全查询的DSL，而没有学习对应的JavaAPI，这里给出一个示例：",-1)),l[985]||(l[985]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723213759922.png",alt:"image-20210723213759922",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[986]||(l[986]=t("p",null,"而自动补全的结果也比较特殊，解析的代码如下：",-1)),l[987]||(l[987]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723213917524.png",alt:"image-20210723213917524",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[988]||(l[988]=t("h4",{id:"_11-4-5-实现搜索框自动补全",tabindex:"-1"},[E("11.4.5 实现搜索框自动补全 "),t("a",{class:"header-anchor",href:"#_11-4-5-实现搜索框自动补全","aria-label":'Permalink to "11.4.5 实现搜索框自动补全"'},"​")],-1)),l[989]||(l[989]=t("p",null,"查看前端页面，可以发现当我们在输入框键入时，前端会发起ajax请求：",-1)),l[990]||(l[990]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723214021062.png",alt:"image-20210723214021062",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[991]||(l[991]=t("p",null,[E("返回值是补全词条的集合，类型为"),t("code",null,"List<String>")],-1)),l[992]||(l[992]=t("p",null,[E("1）在"),t("code",null,"cn.itcast.hotel.web"),E("包下的"),t("code",null,"HotelController"),E("中添加新接口，接收新的请求：")],-1)),l[993]||(l[993]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"GetMapping"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"suggestion"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," List"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"String"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getSuggestions"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestParam"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"key"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") String prefix) {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    return"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotelService."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getSuggestions"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(prefix);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[994]||(l[994]=t("p",null,[E("2）在"),t("code",null,"cn.itcast.hotel.service"),E("包下的"),t("code",null,"IhotelService"),E("中添加方法：")],-1)),l[995]||(l[995]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"List"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"String"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getSuggestions"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(String prefix);")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[996]||(l[996]=t("p",null,[E("3）在"),t("code",null,"cn.itcast.hotel.service.impl.HotelService"),E("中实现该方法：")],-1)),l[997]||(l[997]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Override")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," List"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"String"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getSuggestions"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(String prefix) {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    try"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 1.准备Request")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        SearchRequest request "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," SearchRequest"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 2.准备DSL")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        request."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"suggest"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," SuggestBuilder"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"addSuggestion"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "suggestions"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            SuggestBuilders."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"completionSuggestion"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"suggestion"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            ."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"prefix"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(prefix)")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            ."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"skipDuplicates"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            ."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"size"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"10"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        ));")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 3.发起请求")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        SearchResponse response "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"search"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 4.解析结果")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        Suggest suggest "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," response."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getSuggest"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 4.1.根据补全查询名称，获取补全结果")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        CompletionSuggestion suggestions "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," suggest."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getSuggestion"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"suggestions"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 4.2.获取options")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        List<"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"CompletionSuggestion"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Entry"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Option"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> options "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," suggestions."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getOptions"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 4.3.遍历")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        List<"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"String"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> list "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ArrayList<>(options."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"size"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        for"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (CompletionSuggestion.Entry.Option option "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," options) {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            String text "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," option."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getText"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"toString"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            list."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"add"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(text);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," list;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    } "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"catch"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (IOException "),t("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"e"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        throw"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," RuntimeException"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(e);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[998]||(l[998]=t("hr",null,null,-1)),l[999]||(l[999]=t("h2",{id:"_12-数据同步",tabindex:"-1"},[E("12. 数据同步 "),t("a",{class:"header-anchor",href:"#_12-数据同步","aria-label":'Permalink to "12. 数据同步"'},"​")],-1)),l[1e3]||(l[1e3]=t("p",null,[E("elasticsearch中的酒店数据来自于mysql数据库，因此mysql数据发生改变时，elasticsearch也必须跟着改变，这个就是elasticsearch与mysql之间的"),t("strong",null,"数据同步"),E("。")],-1)),l[1001]||(l[1001]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723214758392.png",alt:"image-20210723214758392",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[1002]||(l[1002]=t("h3",{id:"_12-1-思路分析",tabindex:"-1"},[E("12.1 思路分析 "),t("a",{class:"header-anchor",href:"#_12-1-思路分析","aria-label":'Permalink to "12.1 思路分析"'},"​")],-1)),l[1003]||(l[1003]=t("p",null,"常见的数据同步方案有三种：",-1)),l[1004]||(l[1004]=t("ul",null,[t("li",null,"同步调用"),t("li",null,"异步通知"),t("li",null,"监听binlog")],-1)),l[1005]||(l[1005]=t("h4",{id:"_12-1-1-同步调用",tabindex:"-1"},[E("12.1.1 同步调用 "),t("a",{class:"header-anchor",href:"#_12-1-1-同步调用","aria-label":'Permalink to "12.1.1 同步调用"'},"​")],-1)),l[1006]||(l[1006]=t("p",null,"方案一：同步调用",-1)),l[1007]||(l[1007]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723214931869.png",alt:"image-20210723214931869",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[1008]||(l[1008]=t("p",null,"基本步骤如下：",-1)),l[1009]||(l[1009]=t("ul",null,[t("li",null,"hotel-demo对外提供接口，用来修改elasticsearch中的数据"),t("li",null,"酒店管理服务在完成数据库操作后，直接调用hotel-demo提供的接口，")],-1)),l[1010]||(l[1010]=t("h4",{id:"_12-1-2-异步通知",tabindex:"-1"},[E("12.1.2 异步通知 "),t("a",{class:"header-anchor",href:"#_12-1-2-异步通知","aria-label":'Permalink to "12.1.2 异步通知"'},"​")],-1)),l[1011]||(l[1011]=t("p",null,"方案二：异步通知",-1)),l[1012]||(l[1012]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723215140735.png",alt:"image-20210723215140735",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[1013]||(l[1013]=t("p",null,"流程如下：",-1)),l[1014]||(l[1014]=t("ul",null,[t("li",null,"hotel-admin对mysql数据库数据完成增、删、改后，发送MQ消息"),t("li",null,"hotel-demo监听MQ，接收到消息后完成elasticsearch数据修改")],-1)),l[1015]||(l[1015]=t("h4",{id:"_12-1-3-监听binlog",tabindex:"-1"},[E("12.1.3 监听binlog "),t("a",{class:"header-anchor",href:"#_12-1-3-监听binlog","aria-label":'Permalink to "12.1.3 监听binlog"'},"​")],-1)),l[1016]||(l[1016]=t("p",null,"方案三：监听binlog",-1)),l[1017]||(l[1017]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723215518541.png",alt:"image-20210723215518541",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[1018]||(l[1018]=t("p",null,"流程如下：",-1)),l[1019]||(l[1019]=t("ul",null,[t("li",null,"给mysql开启binlog功能"),t("li",null,"mysql完成增、删、改操作都会记录在binlog中"),t("li",null,"hotel-demo基于canal监听binlog变化，实时更新elasticsearch中的内容")],-1)),l[1020]||(l[1020]=t("h4",{id:"_12-1-4-选择",tabindex:"-1"},[E("12.1.4 选择 "),t("a",{class:"header-anchor",href:"#_12-1-4-选择","aria-label":'Permalink to "12.1.4 选择"'},"​")],-1)),l[1021]||(l[1021]=t("p",null,"方式一：同步调用",-1)),l[1022]||(l[1022]=t("ul",null,[t("li",null,"优点：实现简单，粗暴"),t("li",null,"缺点：业务耦合度高")],-1)),l[1023]||(l[1023]=t("p",null,"方式二：异步通知",-1)),l[1024]||(l[1024]=t("ul",null,[t("li",null,"优点：低耦合，实现难度一般"),t("li",null,"缺点：依赖mq的可靠性")],-1)),l[1025]||(l[1025]=t("p",null,"方式三：监听binlog",-1)),l[1026]||(l[1026]=t("ul",null,[t("li",null,"优点：完全解除服务间耦合"),t("li",null,"缺点：开启binlog增加数据库负担、实现复杂度高")],-1)),l[1027]||(l[1027]=t("h3",{id:"_12-2-实现数据同步",tabindex:"-1"},[E("12.2 实现数据同步 "),t("a",{class:"header-anchor",href:"#_12-2-实现数据同步","aria-label":'Permalink to "12.2 实现数据同步"'},"​")],-1)),l[1028]||(l[1028]=t("h4",{id:"_12-2-1-思路",tabindex:"-1"},[E("12.2.1 思路 "),t("a",{class:"header-anchor",href:"#_12-2-1-思路","aria-label":'Permalink to "12.2.1 思路"'},"​")],-1)),l[1029]||(l[1029]=t("p",null,"利用课前资料提供的hotel-admin项目作为酒店管理的微服务。当酒店数据发生增、删、改时，要求对elasticsearch中数据也要完成相同操作。",-1)),l[1030]||(l[1030]=t("p",null,"步骤：",-1)),l[1031]||(l[1031]=t("ul",null,[t("li",null,[t("p",null,"导入课前资料提供的hotel-admin项目，启动并测试酒店数据的CRUD")]),t("li",null,[t("p",null,"声明exchange、queue、RoutingKey")]),t("li",null,[t("p",null,"在hotel-admin中的增、删、改业务中完成消息发送")]),t("li",null,[t("p",null,"在hotel-demo中完成消息监听，并更新elasticsearch中数据")]),t("li",null,[t("p",null,"启动并测试数据同步功能")])],-1)),l[1032]||(l[1032]=t("h4",{id:"_12-2-2-导入demo",tabindex:"-1"},[E("12.2.2 导入demo "),t("a",{class:"header-anchor",href:"#_12-2-2-导入demo","aria-label":'Permalink to "12.2.2 导入demo"'},"​")],-1)),l[1033]||(l[1033]=t("p",null,"导入课前资料提供的hotel-admin项目：",-1)),l[1034]||(l[1034]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723220237930.png",alt:"image-20210723220237930",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[1035]||(l[1035]=t("p",null,[E("运行后，访问 "),t("a",{href:"http://localhost:8099",target:"_blank",rel:"noreferrer"},"http://localhost:8099")],-1)),l[1036]||(l[1036]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723220354464.png",alt:"image-20210723220354464",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[1037]||(l[1037]=t("p",null,"其中包含了酒店的CRUD功能：",-1)),l[1038]||(l[1038]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723220511090.png",alt:"image-20210723220511090",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[1039]||(l[1039]=t("h4",{id:"_12-2-3-声明交换机、队列",tabindex:"-1"},[E("12.2.3 声明交换机、队列 "),t("a",{class:"header-anchor",href:"#_12-2-3-声明交换机、队列","aria-label":'Permalink to "12.2.3 声明交换机、队列"'},"​")],-1)),l[1040]||(l[1040]=t("p",null,"MQ结构如图：",-1)),l[1041]||(l[1041]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723215850307.png",alt:"image-20210723215850307",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[1042]||(l[1042]=t("h5",{id:"_1-引入依赖",tabindex:"-1"},[E("1）引入依赖 "),t("a",{class:"header-anchor",href:"#_1-引入依赖","aria-label":'Permalink to "1）引入依赖"'},"​")],-1)),l[1043]||(l[1043]=t("p",null,"在hotel-admin、hotel-demo中引入rabbitmq的依赖：",-1)),l[1044]||(l[1044]=t("div",{class:"language-xml max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"xml"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"\x3c!--amqp--\x3e")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),t("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"dependency"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    <"),t("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"groupId"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">org.springframework.boot</"),t("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"groupId"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    <"),t("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"artifactId"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">spring-boot-starter-amqp</"),t("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"artifactId"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"</"),t("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"dependency"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[1045]||(l[1045]=t("h5",{id:"_2-声明队列交换机名称",tabindex:"-1"},[E("2）声明队列交换机名称 "),t("a",{class:"header-anchor",href:"#_2-声明队列交换机名称","aria-label":'Permalink to "2）声明队列交换机名称"'},"​")],-1)),l[1046]||(l[1046]=t("p",null,[E("在hotel-admin和hotel-demo中的"),t("code",null,"cn.itcast.hotel.constatnts"),E("包下新建一个类"),t("code",null,"MqConstants"),E("：")],-1)),l[1047]||(l[1047]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"package"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," cn.itcast.hotel.constatnts;")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," MqConstants"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    /**")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * 交换机")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     */")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," final"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String HOTEL_EXCHANGE "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "hotel.topic"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    /**")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * 监听新增和修改的队列")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     */")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," final"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String HOTEL_INSERT_QUEUE "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "hotel.insert.queue"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    /**")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * 监听删除的队列")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     */")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," final"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String HOTEL_DELETE_QUEUE "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "hotel.delete.queue"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    /**")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * 新增或修改的RoutingKey")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     */")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," final"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String HOTEL_INSERT_KEY "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "hotel.insert"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    /**")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * 删除的RoutingKey")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     */")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," final"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String HOTEL_DELETE_KEY "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "hotel.delete"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[1048]||(l[1048]=t("h5",{id:"_3-声明队列交换机",tabindex:"-1"},[E("3）声明队列交换机 "),t("a",{class:"header-anchor",href:"#_3-声明队列交换机","aria-label":'Permalink to "3）声明队列交换机"'},"​")],-1)),l[1049]||(l[1049]=t("p",null,"在hotel-demo中，定义配置类，声明队列、交换机：",-1)),l[1050]||(l[1050]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"package"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," cn.itcast.hotel.config;")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," cn.itcast.hotel.constants.MqConstants;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.springframework.amqp.core.Binding;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.springframework.amqp.core.BindingBuilder;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.springframework.amqp.core.Queue;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.springframework.amqp.core.TopicExchange;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.springframework.context.annotation.Bean;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.springframework.context.annotation.Configuration;")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Configuration")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," MqConfig"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Bean")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," TopicExchange "),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"topicExchange"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(){")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," TopicExchange"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(MqConstants.HOTEL_EXCHANGE, "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"false"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Bean")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Queue "),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"insertQueue"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(){")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Queue"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(MqConstants.HOTEL_INSERT_QUEUE, "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Bean")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Queue "),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"deleteQueue"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(){")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Queue"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(MqConstants.HOTEL_DELETE_QUEUE, "),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Bean")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Binding "),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"insertQueueBinding"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(){")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," BindingBuilder."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bind"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"insertQueue"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"to"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"topicExchange"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"with"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(MqConstants.HOTEL_INSERT_KEY);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Bean")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Binding "),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"deleteQueueBinding"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(){")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," BindingBuilder."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bind"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"deleteQueue"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"to"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"topicExchange"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"with"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(MqConstants.HOTEL_DELETE_KEY);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[1051]||(l[1051]=t("h4",{id:"_12-2-4-发送mq消息",tabindex:"-1"},[E("12.2.4 发送MQ消息 "),t("a",{class:"header-anchor",href:"#_12-2-4-发送mq消息","aria-label":'Permalink to "12.2.4 发送MQ消息"'},"​")],-1)),l[1052]||(l[1052]=t("p",null,"在hotel-admin中的增、删、改业务中分别发送MQ消息：",-1)),l[1053]||(l[1053]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723221843816.png",alt:"image-20210723221843816",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[1054]||(l[1054]=t("h4",{id:"_12-2-5-接收mq消息",tabindex:"-1"},[E("12.2.5 接收MQ消息 "),t("a",{class:"header-anchor",href:"#_12-2-5-接收mq消息","aria-label":'Permalink to "12.2.5 接收MQ消息"'},"​")],-1)),l[1055]||(l[1055]=t("p",null,"hotel-demo接收到MQ消息要做的事情包括：",-1)),l[1056]||(l[1056]=t("ul",null,[t("li",null,"新增消息：根据传递的hotel的id查询hotel信息，然后新增一条数据到索引库"),t("li",null,"删除消息：根据传递的hotel的id删除索引库中的一条数据")],-1)),l[1057]||(l[1057]=t("p",null,[E("1）首先在hotel-demo的"),t("code",null,"cn.itcast.hotel.service"),E("包下的"),t("code",null,"IHotelService"),E("中新增新增、删除业务")],-1)),l[1058]||(l[1058]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"void"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," deleteById"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Long id);")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"void"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," insertById"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Long id);")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[1059]||(l[1059]=t("p",null,[E("2）给hotel-demo中的"),t("code",null,"cn.itcast.hotel.service.impl"),E("包下的HotelService中实现业务：")],-1)),l[1060]||(l[1060]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Override")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," deleteById"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Long id) {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    try"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 1.准备Request")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        DeleteRequest request "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," DeleteRequest"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", id."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"toString"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 2.发送请求")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        client."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"delete"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    } "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"catch"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (IOException "),t("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"e"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        throw"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," RuntimeException"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(e);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Override")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," insertById"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Long id) {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    try"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 0.根据id查询酒店数据")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        Hotel hotel "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getById"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(id);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 转换为文档类型")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        HotelDoc hotelDoc "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HotelDoc"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(hotel);")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 1.准备Request对象")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        IndexRequest request "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," IndexRequest"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"id"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(hotel."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getId"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"toString"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 2.准备Json文档")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        request."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(JSON."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"toJSONString"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(hotelDoc), XContentType.JSON);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 3.发送请求")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        client."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"index"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    } "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"catch"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (IOException "),t("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"e"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        throw"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," RuntimeException"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(e);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[1061]||(l[1061]=t("p",null,"3）编写监听器",-1)),l[1062]||(l[1062]=t("p",null,[E("在hotel-demo中的"),t("code",null,"cn.itcast.hotel.mq"),E("包新增一个类：")],-1)),l[1063]||(l[1063]=t("div",{class:"language-java max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"java"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"package"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," cn.itcast.hotel.mq;")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," cn.itcast.hotel.constants.MqConstants;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," cn.itcast.hotel.service.IHotelService;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.springframework.amqp.rabbit.annotation.RabbitListener;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.springframework.beans.factory.annotation.Autowired;")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.springframework.stereotype.Component;")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Component")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HotelListener"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Autowired")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," IHotelService hotelService;")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    /**")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * 监听酒店新增或修改的业务")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),t("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," id"),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," 酒店id")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     */")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RabbitListener"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"queues"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," MqConstants.HOTEL_INSERT_QUEUE)")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," listenHotelInsertOrUpdate"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Long "),t("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"id"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"){")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        hotelService."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"insertById"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(id);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    /**")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * 监听酒店删除的业务")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * "),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),t("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," id"),t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," 酒店id")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     */")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RabbitListener"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"queues"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," MqConstants.HOTEL_DELETE_QUEUE)")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),t("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," listenHotelDelete"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Long "),t("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"id"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"){")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        hotelService."),t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"deleteById"),t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(id);")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[1064]||(l[1064]=t("hr",null,null,-1)),l[1065]||(l[1065]=t("h2",{id:"_13-集群",tabindex:"-1"},[E("13. 集群 "),t("a",{class:"header-anchor",href:"#_13-集群","aria-label":'Permalink to "13. 集群"'},"​")],-1)),l[1066]||(l[1066]=t("p",null,"单机的elasticsearch做数据存储，必然面临两个问题：海量数据存储问题、单点故障问题。",-1)),l[1067]||(l[1067]=t("ul",null,[t("li",null,"海量数据存储问题：将索引库从逻辑上拆分为N个分片（shard），存储到多个节点"),t("li",null,"单点故障问题：将分片数据在不同节点备份（replica ）")],-1)),l[1068]||(l[1068]=t("p",null,[t("strong",null,"ES集群相关概念"),E(":")],-1)),t("ul",null,[l[7]||(l[7]=t("li",null,[t("p",null,"集群（cluster）：一组拥有共同的 cluster name 的 节点。")],-1)),t("li",null,[p(a,{color:"red"},{default:k(()=>[...l[0]||(l[0]=[E("节点（node)",-1)])]),_:1}),l[1]||(l[1]=E(" ：集群中的一个 Elasticearch 实例",-1))]),t("li",null,[p(a,{color:"red"},{default:k(()=>[...l[2]||(l[2]=[E("分片（shard）",-1)])]),_:1}),l[3]||(l[3]=E("：索引可以被拆分为不同的部分进行存储，称为分片。在集群环境下，一个索引的不同分片可以拆分到不同的节点中",-1)),l[4]||(l[4]=t("p",null,"解决问题：数据量太大，单点存储量有限的问题。",-1)),l[5]||(l[5]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20200104124440086-5602723.png",alt:"image-20200104124440086",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[6]||(l[6]=t("blockquote",null,[t("p",null,"此处，我们把数据分成3片：shard0、shard1、shard2")],-1))]),l[8]||(l[8]=t("li",null,[t("p",null,"主分片（Primary shard）：相对于副本分片的定义。")],-1)),l[9]||(l[9]=t("li",null,[t("p",null,"副本分片（Replica shard）每个主分片可以有一个或者多个副本，数据和主分片一样。"),t("p",null,"​")],-1))]),l[1069]||(l[1069]=t("p",null,"数据备份可以保证高可用，但是每个分片备份一份，所需要的节点数量就会翻一倍，成本实在是太高了！",-1)),l[1070]||(l[1070]=t("p",null,"为了在高可用和成本间寻求平衡，我们可以这样做：",-1)),l[1071]||(l[1071]=t("ul",null,[t("li",null,"首先对数据分片，存储到不同节点"),t("li",null,"然后对每个分片进行备份，放到对方节点，完成互相备份")],-1)),l[1072]||(l[1072]=t("p",null,"这样可以大大减少所需要的服务节点数量，如图，我们以3分片，每个分片备份一份为例：",-1)),l[1073]||(l[1073]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20200104124551912.png",alt:"image-20200104124551912",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[1074]||(l[1074]=t("p",null,"现在，每个分片都有1个备份，存储在3个节点：",-1)),l[1075]||(l[1075]=t("ul",null,[t("li",null,"node0：保存了分片0和1"),t("li",null,"node1：保存了分片0和2"),t("li",null,"node2：保存了分片1和2")],-1)),l[1076]||(l[1076]=t("h3",{id:"_13-1-搭建es集群",tabindex:"-1"},[E("13.1 搭建ES集群 "),t("a",{class:"header-anchor",href:"#_13-1-搭建es集群","aria-label":'Permalink to "13.1 搭建ES集群"'},"​")],-1)),l[1077]||(l[1077]=t("h4",{id:"部署es集群",tabindex:"-1"},[E("部署es集群 "),t("a",{class:"header-anchor",href:"#部署es集群","aria-label":'Permalink to "部署es集群"'},"​")],-1)),l[1078]||(l[1078]=t("p",null,[E("部署es集群可以直接使用docker-compose来完成，不过要求你的Linux虚拟机至少有"),t("strong",null,"4G"),E("的内存空间")],-1)),l[1079]||(l[1079]=t("p",null,"首先编写一个docker-compose文件，内容如下：",-1)),l[1080]||(l[1080]=t("div",{class:"language-sh max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"sh"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"version:"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," '2.2'")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"services:")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  es01:")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    image:"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," docker.elastic.co/elasticsearch/elasticsearch:7.12.1")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    container_name:"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," es01")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    environment:")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," node.name=es01")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," cluster.name=es-docker-cluster")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," discovery.seed_hosts=es02,es03")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," cluster.initial_master_nodes=es01,es02,es03")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," bootstrap.memory_lock="),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "ES_JAVA_OPTS=-Xms512m -Xmx512m"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    ulimits:")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      memlock:")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        soft:"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -1")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        hard:"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -1")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    volumes:")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," data01:/usr/share/elasticsearch/data")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    ports:")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 9200:9200")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    networks:")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," elastic")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  es02:")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    image:"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," docker.elastic.co/elasticsearch/elasticsearch:7.12.1")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    container_name:"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," es02")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    environment:")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," node.name=es02")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," cluster.name=es-docker-cluster")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," discovery.seed_hosts=es01,es03")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," cluster.initial_master_nodes=es01,es02,es03")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," bootstrap.memory_lock="),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "ES_JAVA_OPTS=-Xms512m -Xmx512m"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    ulimits:")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      memlock:")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        soft:"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -1")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        hard:"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -1")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    volumes:")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," data02:/usr/share/elasticsearch/data")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    networks:")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," elastic")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  es03:")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    image:"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," docker.elastic.co/elasticsearch/elasticsearch:7.12.1")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    container_name:"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," es03")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    environment:")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," node.name=es03")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," cluster.name=es-docker-cluster")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," discovery.seed_hosts=es01,es02")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," cluster.initial_master_nodes=es01,es02,es03")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," bootstrap.memory_lock="),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "ES_JAVA_OPTS=-Xms512m -Xmx512m"')]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    ulimits:")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      memlock:")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        soft:"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -1")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        hard:"),t("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -1")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    volumes:")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," data03:/usr/share/elasticsearch/data")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    networks:")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," elastic")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"volumes:")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  data01:")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    driver:"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," local")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  data02:")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    driver:"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," local")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  data03:")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    driver:"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," local")]),E("\n"),t("span",{class:"line"}),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"networks:")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  elastic:")]),E("\n"),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    driver:"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," bridge")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[1081]||(l[1081]=t("p",null,[E("Run "),t("code",null,"docker-compose"),E(" to bring up the cluster:")],-1)),l[1082]||(l[1082]=t("div",{class:"language-sh max-h-300px"},[t("button",{title:"Copy code",class:"copy"}),t("span",{class:"lang"},"sh"),t("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[t("code",{"v-pre":""},[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker-compose"),t("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," up")])])]),t("button",{class:"code-block-unfold-btn"})],-1)),l[1083]||(l[1083]=t("h3",{id:"_13-2-集群脑裂问题",tabindex:"-1"},[E("13.2 集群脑裂问题 "),t("a",{class:"header-anchor",href:"#_13-2-集群脑裂问题","aria-label":'Permalink to "13.2 集群脑裂问题"'},"​")],-1)),l[1084]||(l[1084]=t("h4",{id:"_13-2-1-集群职责划分",tabindex:"-1"},[E("13.2.1 集群职责划分 "),t("a",{class:"header-anchor",href:"#_13-2-1-集群职责划分","aria-label":'Permalink to "13.2.1 集群职责划分"'},"​")],-1)),l[1085]||(l[1085]=t("p",null,"elasticsearch中集群节点有不同的职责划分：",-1)),l[1086]||(l[1086]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723223008967.png",alt:"image-20210723223008967",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[1087]||(l[1087]=t("p",null,"默认情况下，集群中的任何一个节点都同时具备上述四种角色。",-1)),l[1088]||(l[1088]=t("p",null,"但是真实的集群一定要将集群职责分离：",-1)),l[1089]||(l[1089]=t("ul",null,[t("li",null,"master节点：对CPU要求高，但是内存要求第"),t("li",null,"data节点：对CPU和内存要求都高"),t("li",null,"coordinating节点：对网络带宽、CPU要求高")],-1)),l[1090]||(l[1090]=t("p",null,"职责分离可以让我们根据不同节点的需求分配不同的硬件去部署。而且避免业务之间的互相干扰。",-1)),l[1091]||(l[1091]=t("p",null,"一个典型的es集群职责划分如图：",-1)),l[1092]||(l[1092]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723223629142.png",alt:"image-20210723223629142",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[1093]||(l[1093]=t("h4",{id:"_13-2-2-脑裂问题",tabindex:"-1"},[E("13.2.2 脑裂问题 "),t("a",{class:"header-anchor",href:"#_13-2-2-脑裂问题","aria-label":'Permalink to "13.2.2 脑裂问题"'},"​")],-1)),l[1094]||(l[1094]=t("p",null,"脑裂是因为集群中的节点失联导致的。",-1)),l[1095]||(l[1095]=t("p",null,"例如一个集群中，主节点与其它节点失联：",-1)),l[1096]||(l[1096]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723223804995.png",alt:"image-20210723223804995",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[1097]||(l[1097]=t("p",null,"此时，node2和node3认为node1宕机，就会重新选主：",-1)),l[1098]||(l[1098]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723223845754.png",alt:"image-20210723223845754",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[1099]||(l[1099]=t("p",null,"当node3当选后，集群继续对外提供服务，node2和node3自成集群，node1自成集群，两个集群数据不同步，出现数据差异。",-1)),l[1100]||(l[1100]=t("p",null,"当网络恢复后，因为集群中有两个master节点，集群状态的不一致，出现脑裂的情况：",-1)),l[1101]||(l[1101]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723224000555.png",alt:"image-20210723224000555",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[1102]||(l[1102]=t("p",null,"解决脑裂的方案是，要求选票超过 ( eligible节点数量 + 1 ）/ 2 才能当选为主，因此eligible节点数量最好是奇数。对应配置项是discovery.zen.minimum_master_nodes，在es7.0以后，已经成为默认配置，因此一般不会发生脑裂问题",-1)),l[1103]||(l[1103]=t("p",null,"例如：3个节点形成的集群，选票必须超过 （3 + 1） / 2 ，也就是2票。node3得到node2和node3的选票，当选为主。node1只有自己1票，没有当选。集群中依然只有1个主节点，没有出现脑裂。",-1)),l[1104]||(l[1104]=t("h4",{id:"_13-2-3-小结",tabindex:"-1"},[E("13.2.3 小结 "),t("a",{class:"header-anchor",href:"#_13-2-3-小结","aria-label":'Permalink to "13.2.3 小结"'},"​")],-1)),l[1105]||(l[1105]=t("blockquote",null,[t("ul",null,[t("li",null,[t("p",null,"master eligible节点的作用是什么？"),t("ul",null,[t("li",null,[t("p",null,"参与集群选主")]),t("li",null,[t("p",null,"主节点可以管理集群状态、管理分片信息、处理创建和删除索引库的请求")])])]),t("li",null,[t("p",null,"data节点的作用是什么？"),t("ul",null,[t("li",null,"数据的CRUD")])]),t("li",null,[t("p",null,"coordinator节点的作用是什么？"),t("ul",null,[t("li",null,[t("p",null,"路由请求到其它节点")]),t("li",null,[t("p",null,"合并查询到的结果，返回给用户")])])])])],-1)),l[1106]||(l[1106]=t("h3",{id:"_13-3-集群分布式存储",tabindex:"-1"},[E("13.3 集群分布式存储 "),t("a",{class:"header-anchor",href:"#_13-3-集群分布式存储","aria-label":'Permalink to "13.3 集群分布式存储"'},"​")],-1)),l[1107]||(l[1107]=t("p",null,"当新增文档时，应该保存到不同分片，保证数据均衡，那么coordinating node如何确定数据该存储到哪个分片呢？",-1)),l[1108]||(l[1108]=t("h4",{id:"_13-3-1-分片存储测试",tabindex:"-1"},[E("13.3.1 分片存储测试 "),t("a",{class:"header-anchor",href:"#_13-3-1-分片存储测试","aria-label":'Permalink to "13.3.1 分片存储测试"'},"​")],-1)),l[1109]||(l[1109]=t("p",null,"插入三条数据：",-1)),l[1110]||(l[1110]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723225006058.png",alt:"image-20210723225006058",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[1111]||(l[1111]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723225034637.png",alt:"image-20210723225034637",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[1112]||(l[1112]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723225112029.png",alt:"image-20210723225112029",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[1113]||(l[1113]=t("p",null,"测试可以看到，三条数据分别在不同分片：",-1)),l[1114]||(l[1114]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723225227928.png",alt:"image-20210723225227928",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[1115]||(l[1115]=t("p",null,"结果：",-1)),l[1116]||(l[1116]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723225342120.png",alt:"image-20210723225342120",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[1117]||(l[1117]=t("h4",{id:"_13-3-2-分片存储原理",tabindex:"-1"},[E("13.3.2 分片存储原理 "),t("a",{class:"header-anchor",href:"#_13-3-2-分片存储原理","aria-label":'Permalink to "13.3.2 分片存储原理"'},"​")],-1)),l[1118]||(l[1118]=t("p",null,"elasticsearch会通过hash算法来计算文档应该存储到哪个分片：",-1)),l[1119]||(l[1119]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723224354904.png",alt:"image-20210723224354904",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[1120]||(l[1120]=t("p",null,"说明：",-1)),l[1121]||(l[1121]=t("ul",null,[t("li",null,"_routing默认是文档的id"),t("li",null,"算法与分片数量有关，因此索引库一旦创建，分片数量不能修改！")],-1)),l[1122]||(l[1122]=t("p",null,"新增文档的流程如下：",-1)),l[1123]||(l[1123]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723225436084.png",alt:"image-20210723225436084",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[1124]||(l[1124]=t("p",null,"解读：",-1)),l[1125]||(l[1125]=t("ul",null,[t("li",null,"1）新增一个id=1的文档"),t("li",null,"2）对id做hash运算，假如得到的是2，则应该存储到shard-2"),t("li",null,"3）shard-2的主分片在node3节点，将数据路由到node3"),t("li",null,"4）保存文档"),t("li",null,"5）同步给shard-2的副本replica-2，在node2节点"),t("li",null,"6）返回结果给coordinating-node节点")],-1)),l[1126]||(l[1126]=t("h3",{id:"_13-4-集群分布式查询",tabindex:"-1"},[E("13.4 集群分布式查询 "),t("a",{class:"header-anchor",href:"#_13-4-集群分布式查询","aria-label":'Permalink to "13.4 集群分布式查询"'},"​")],-1)),l[1127]||(l[1127]=t("p",null,"elasticsearch的查询分成两个阶段：",-1)),l[1128]||(l[1128]=t("ul",null,[t("li",null,[t("p",null,"scatter phase：分散阶段，coordinating node会把请求分发到每一个分片")]),t("li",null,[t("p",null,"gather phase：聚集阶段，coordinating node汇总data node的搜索结果，并处理为最终结果集返回给用户")])],-1)),l[1129]||(l[1129]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723225809848.png",alt:"image-20210723225809848",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[1130]||(l[1130]=t("h3",{id:"_13-5-集群故障转移",tabindex:"-1"},[E("13.5 集群故障转移 "),t("a",{class:"header-anchor",href:"#_13-5-集群故障转移","aria-label":'Permalink to "13.5 集群故障转移"'},"​")],-1)),l[1131]||(l[1131]=t("p",null,"集群的master节点会监控集群中的节点状态，如果发现有节点宕机，会立即将宕机节点的分片数据迁移到其它节点，确保数据安全，这个叫做故障转移。",-1)),l[1132]||(l[1132]=t("p",null,"1）例如一个集群结构如图：",-1)),l[1133]||(l[1133]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723225945963.png",alt:"image-20210723225945963",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[1134]||(l[1134]=t("p",null,"现在，node1是主节点，其它两个节点是从节点。",-1)),l[1135]||(l[1135]=t("p",null,"2）突然，node1发生了故障：",-1)),l[1136]||(l[1136]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723230020574.png",alt:"image-20210723230020574",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[1137]||(l[1137]=t("p",null,"宕机后的第一件事，需要重新选主，例如选中了node2：",-1)),l[1138]||(l[1138]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723230055974.png",alt:"image-20210723230055974",loading:"lazy",decoding:"async",class:"lazy"})],-1)),l[1139]||(l[1139]=t("p",null,"node2成为主节点后，会检测集群监控状态，发现：shard-1、shard-0没有副本节点。因此需要将node1上的数据迁移到node2、node3：",-1)),l[1140]||(l[1140]=t("figure",null,[t("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723230216642.png",alt:"image-20210723230216642",loading:"lazy",decoding:"async",class:"lazy"})],-1))]),"main-header":k(()=>[n(s.$slots,"main-header")]),"main-header-after":k(()=>[n(s.$slots,"main-header-after")]),"main-nav":k(()=>[n(s.$slots,"main-nav")]),"main-content-before":k(()=>[n(s.$slots,"main-content-before")]),"main-content":k(()=>[n(s.$slots,"main-content")]),"main-content-after":k(()=>[n(s.$slots,"main-content-after")]),"main-nav-before":k(()=>[n(s.$slots,"main-nav-before")]),"main-nav-after":k(()=>[n(s.$slots,"main-nav-after")]),comment:k(()=>[n(s.$slots,"comment")]),footer:k(()=>[n(s.$slots,"footer")]),aside:k(()=>[n(s.$slots,"aside")]),"aside-custom":k(()=>[n(s.$slots,"aside-custom")]),default:k(()=>[n(s.$slots,"default")]),_:3},8,["frontmatter"])}}};export{F as default,c as usePageData};
