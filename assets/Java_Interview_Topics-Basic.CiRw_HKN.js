import{_ as o}from"./ValaxyMain.vue_vue_type_style_index_0_lang.C7NmjfkH.js";import{f as m,a as y,u as E}from"./chunks/vue-router.BlH_Pn6X.js";import{N as F,$ as a,Q as t,R as s,V as c,W as l,u as b,O as C,D as v}from"./framework.BU8aqy2L.js";import"./app.DTD3I1zI.js";import"./chunks/dayjs.WH26RRM8.js";import"./chunks/vue-i18n.BwO6G1QQ.js";import"./chunks/nprogress.t5q147rN.js";import"./chunks/pinia.Dovo_Y_t.js";import"./chunks/@vueuse/motion.C0KIn7Jt.js";import"./YunComment.vue_vue_type_style_index_0_lang.CgaBKLiW.js";import"./index.C5okkQwF.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang.CPLWUEU4.js";import"./post.CNanj6Cd.js";const A=m("/posts/Java_Interview_Topics-Basic",async h=>JSON.parse('{"title":"Java面试专题-基础篇","description":"","frontmatter":{"cover":"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/four_saber_page02.png","title":"Java面试专题-基础篇","date":"2023-4-18 14:52:05","categories":"Java","tags":["ArrayList","LinkedList","HashMap","Hashtable","Singleton"],"top":121,"outline":"deep","excerpt_type":"html","end":false},"headers":[{"level":2,"title":"1. ArrayList","slug":"_1-arraylist","link":"#_1-arraylist","children":[{"level":3,"title":"补充","slug":"补充","link":"#补充","children":[]}]},{"level":2,"title":"2. Iterator","slug":"_2-iterator","link":"#_2-iterator","children":[]},{"level":2,"title":"3. LinkedList VS ArrayList","slug":"_3-linkedlist-vs-arraylist","link":"#_3-linkedlist-vs-arraylist","children":[]},{"level":2,"title":"4. HashMap","slug":"_4-hashmap","link":"#_4-hashmap","children":[{"level":3,"title":"1）基本数据结构","slug":"_1-基本数据结构","link":"#_1-基本数据结构","children":[]},{"level":3,"title":"2）树化与退化","slug":"_2-树化与退化","link":"#_2-树化与退化","children":[]},{"level":3,"title":"3）索引计算","slug":"_3-索引计算","link":"#_3-索引计算","children":[]},{"level":3,"title":"4）put 与扩容","slug":"_4-put-与扩容","link":"#_4-put-与扩容","children":[]},{"level":3,"title":"5）并发问题","slug":"_5-并发问题","link":"#_5-并发问题","children":[]},{"level":3,"title":"6）key 的设计","slug":"_6-key-的设计","link":"#_6-key-的设计","children":[]}]},{"level":2,"title":"4.1. HashMap-快速查找","slug":"_4-1-hashmap-快速查找","link":"#_4-1-hashmap-快速查找","children":[]},{"level":2,"title":"4.2. HashMap-链表过长的解决方案","slug":"_4-2-hashmap-链表过长的解决方案","link":"#_4-2-hashmap-链表过长的解决方案","children":[{"level":3,"title":"4.2.1.扩容","slug":"_4-2-1-扩容","link":"#_4-2-1-扩容","children":[]},{"level":3,"title":"4.2.2. 树化","slug":"_4-2-2-树化","link":"#_4-2-2-树化","children":[]}]},{"level":2,"title":"5. 单例模式","slug":"_5-单例模式","link":"#_5-单例模式","children":[{"level":3,"title":"饿汉式","slug":"饿汉式","link":"#饿汉式","children":[]},{"level":3,"title":"枚举饿汉式","slug":"枚举饿汉式","link":"#枚举饿汉式","children":[]},{"level":3,"title":"懒汉式","slug":"懒汉式","link":"#懒汉式","children":[]},{"level":3,"title":"双检锁懒汉式","slug":"双检锁懒汉式","link":"#双检锁懒汉式","children":[]},{"level":3,"title":"内部类懒汉式","slug":"内部类懒汉式","link":"#内部类懒汉式","children":[]},{"level":3,"title":"JDK 中单例的体现","slug":"jdk-中单例的体现","link":"#jdk-中单例的体现","children":[]}]}],"relativePath":"pages/posts/Java_Interview_Topics-Basic.md","lastUpdated":null}'),{lazy:(h,g)=>h.name===g.name}),I={__name:"Java_Interview_Topics-Basic",setup(h,{expose:g}){var p;const{data:k}=A(),d=E(),r=y(),e=Object.assign(r.meta.frontmatter||{},((p=k.value)==null?void 0:p.frontmatter)||{});return r.meta.frontmatter=e,d.currentRoute.value.data=k.value,v("valaxy:frontmatter",e),globalThis.$frontmatter=e,g({frontmatter:{cover:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/four_saber_page02.png",title:"Java面试专题-基础篇",date:"2023-4-18 14:52:05",categories:"Java",tags:["ArrayList","LinkedList","HashMap","Hashtable","Singleton"],top:121,outline:"deep",excerpt_type:"html",end:!1}}),(n,i)=>{const u=o;return C(),F(u,{frontmatter:b(e)},{"main-content-md":a(()=>[i[0]||(i[0]=s("p",null,[l("参考视频："),s("a",{href:"https://www.bilibili.com/video/BV15b4y117RJ",target:"_blank",rel:"noreferrer"},"满神Java面试专题")],-1)),i[1]||(i[1]=s("p",null,"笔记的整体结构依据视频编写，并随着学习的深入补充了很多知识",-1)),c(" more "),i[2]||(i[2]=s("h2",{id:"_1-arraylist",tabindex:"-1"},[l("1. ArrayList "),s("a",{class:"header-anchor",href:"#_1-arraylist","aria-label":'Permalink to "1. ArrayList"'},"​")],-1)),i[3]||(i[3]=s("p",null,[s("strong",null,"要求")],-1)),i[4]||(i[4]=s("ul",null,[s("li",null,"掌握 ArrayList 扩容规则")],-1)),i[5]||(i[5]=s("p",null,[s("strong",null,"扩容规则")],-1)),i[6]||(i[6]=s("ol",null,[s("li",null,[s("strong",null,"ArrayList()"),l(" 会使用"),s("strong",null,"长度为零"),l("的数组")])],-1)),i[7]||(i[7]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418114304421.png",alt:"image-20230418114304421",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[8]||(i[8]=s("ol",{start:"2"},[s("li",null,[s("strong",null,"ArrayList(int initialCapacity)"),l(" 会使用"),s("strong",null,"指定容量"),l("的数组")])],-1)),i[9]||(i[9]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418114403174.png",alt:"image-20230418114403174",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[10]||(i[10]=s("ol",{start:"3"},[s("li",null,"public ArrayList(Collection<? extends E> c) 会使用 c 的大小作为数组容量")],-1)),i[11]||(i[11]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418114502997.png",alt:"image-20230418114502997",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[12]||(i[12]=s("ol",{start:"4"},[s("li",null,"add(Object o) 首次扩容为 10，再次扩容为上次容量的 1.5 倍")],-1)),i[13]||(i[13]=s("ul",null,[s("li",null,"第一次添加数组，数组为0，发生第一次扩容"),s("li",null,"第一个元素放入新数组索引0，新数组替换旧数组(首次为0)")],-1)),i[14]||(i[14]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418115017704.png",alt:"image-20230418115017704",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[15]||(i[15]=s("ul",null,[s("li",null,"再次扩容为上次容量的 1.5 倍，完成扩容并添加元素，新数组替换旧数组，旧数组没人引用就会被垃圾回收")],-1)),i[16]||(i[16]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418115545132.png",alt:"image-20230418115545132",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[17]||(i[17]=s("ul",null,[s("li",null,"以后扩容按上次容量+上次容量右移1位")],-1)),i[18]||(i[18]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418115811928.png",alt:"image-20230418115811928",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[19]||(i[19]=s("ul",null,[s("li",null,"此方式为调用的add方法得到的扩容结果")],-1)),i[20]||(i[20]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418120314176.png",alt:"image-20230418120314176",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[21]||(i[21]=s("ol",{start:"5"},[s("li",null,"addAll(Collection c) 没有元素时，扩容为 Math.max(10, 实际元素个数)，有元素时为 Math.max(原容量 1.5 倍, 实际元素个数)")],-1)),i[22]||(i[22]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418120611741.png",alt:"image-20230418120611741",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[23]||(i[23]=s("ul",null,[s("li",null,"第一次空数组扩容(元素个数<10)")],-1)),i[24]||(i[24]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418120727097.png",alt:"image-20230418120727097",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[25]||(i[25]=s("ul",null,[s("li",null,"第一次空数组扩容(10<元素个数<15，此时会拿当前元素个数与当前容量下次扩容的容量二者之间的较大值作为当前容量)")],-1)),i[26]||(i[26]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418121100137.png",alt:"image-20230418121100137",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[27]||(i[27]=s("ul",null,[s("li",null,"第一次非空数组扩容(规则一样)")],-1)),i[28]||(i[28]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418121501578.png",alt:"image-20230418121501578",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[29]||(i[29]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418121608015.png",alt:"image-20230418121608015",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[30]||(i[30]=s("p",null,"其中第 4 点必须知道，其它几点视个人情况而定",-1)),i[31]||(i[31]=s("p",null,[s("strong",null,"提示")],-1)),i[32]||(i[32]=s("ul",null,[s("li",null,[l("测试代码见 "),s("code",null,"day01.list.TestArrayList"),l(" ，这里不再列出")]),s("li",null,[l("要"),s("strong",null,"注意"),l("的是，示例中用反射方式来更直观地反映 ArrayList 的扩容特征，但从 JDK 9 由于模块化的影响，对反射做了较多限制，需要在运行测试代码时添加 VM 参数 "),s("code",null,"--add-opens java.base/java.util=ALL-UNNAMED"),l(" 方能运行通过，后面的例子都有相同问题")])],-1)),i[33]||(i[33]=s("blockquote",null,[s("p",null,[s("em",null,[s("strong",null,"代码说明")])]),s("ul",null,[s("li",null,"day01.list.TestArrayList#arrayListGrowRule 演示了 add(Object) 方法的扩容规则，输入参数 n 代表打印多少次扩容后的数组长度")])],-1)),i[34]||(i[34]=s("h3",{id:"补充",tabindex:"-1"},[l("补充 "),s("a",{class:"header-anchor",href:"#补充","aria-label":'Permalink to "补充"'},"​")],-1)),i[35]||(i[35]=s("blockquote",null,[s("p",null,[s("strong",null,"addAll扩容机制"),l("：添加元素后的元素个数与下一次扩容数作比较 0->10:3个->10,11->11;10->15:13->15,16->16")])],-1)),i[36]||(i[36]=s("h2",{id:"_2-iterator",tabindex:"-1"},[l("2. Iterator "),s("a",{class:"header-anchor",href:"#_2-iterator","aria-label":'Permalink to "2. Iterator"'},"​")],-1)),i[37]||(i[37]=s("p",null,[s("strong",null,"要求")],-1)),i[38]||(i[38]=s("ul",null,[s("li",null,"掌握什么是 Fail-Fast、什么是 Fail-Safe")],-1)),i[39]||(i[39]=s("p",null,"Fail-Fast 与 Fail-Safe",-1)),i[40]||(i[40]=s("ul",null,[s("li",null,"ArrayList 是 fail-fast 的典型代表，遍历的同时不能修改，尽快失败"),s("li",null,"fail-fast 一旦发现遍历的同时其它人来修改，则立刻抛异常")],-1)),i[41]||(i[41]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418133457466.png",alt:"image-20230418133457466",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[42]||(i[42]=s("ul",null,[s("li",null,"fail-fast实现原理")],-1)),i[43]||(i[43]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418135557765.png",alt:"image-20230418135557765",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[44]||(i[44]=s("ul",null,[s("li",null,"CopyOnWriteArrayList 是 fail-safe 的典型代表，遍历的同时可以修改，原理是读写分离"),s("li",null,"fail-safe 发现遍历的同时其它人来修改，应当能有应对策略，例如牺牲一致性来让整个遍历运行完成")],-1)),i[45]||(i[45]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418133702722.png",alt:"image-20230418133702722",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[46]||(i[46]=s("ul",null,[s("li",null,"fail-safe实现原理")],-1)),i[47]||(i[47]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418142258054.png",alt:"image-20230418142258054",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[48]||(i[48]=s("p",null,[s("strong",null,"提示")],-1)),i[49]||(i[49]=s("ul",null,[s("li",null,[s("p",null,[l("测试代码见 "),s("code",null,"day01.list.FailFastVsFailSafe"),l("，这里不再列出")])]),s("li",null,[s("p",null,"第一次笔记："),s("ul",null,[s("li",null,[s("p",null,[s("strong",null,"fail-fast:")]),s("ul",null,[s("li",null,[s("p",null,"​ 1.调用迭代器Iterator构造方法并初始化成员变量")]),s("li",null,[s("p",null,"​ 2.检查：expectedModCount(迭代一开始记录的修改次数)与modCount(外面list的修改次数)做对比，不等则抛异常")])])]),s("li",null,[s("p",null,[s("strong",null,"fail-safe:")]),s("ul",null,[s("li",null,"​ list.add中每次调用add方法时都会把旧的数组拷贝一份，并让长度加一，把新加的元素放到扩容数组(新数组)最后一个位置，即添加和遍历的数组不同，互不干扰")])])])]),s("li",null,[s("p",null,"第二次笔记："),s("ul",null,[s("li",null,[s("p",null,[s("strong",null,"failfast"),l("：")]),s("ul",null,[s("li",null,"增强for循环开始前的修改次数（crud）modCount"),s("li",null,"expectedModCount初始值=modCount"),s("li",null,"每次遍历元素前（迭代）都检查以上的值是否相等，在遍历期间并发修改了，等遍历下个元素时就会抛出异常")])]),s("li",null,[s("p",null,[s("strong",null,"failsafe"),l("：")]),s("ul",null,[s("li",null,"iterator遍历集合，list.add方法每次添加元素，都会拷贝一份原集合并让容量加一，在并发修改时迭代器是不知道，遍历的还是原集合，即添加是一个集合，遍历是另一个集合")])])])])],-1)),i[50]||(i[50]=s("h2",{id:"_3-linkedlist-vs-arraylist",tabindex:"-1"},[l("3. LinkedList VS "),s("strong",null,"ArrayList"),l(),s("a",{class:"header-anchor",href:"#_3-linkedlist-vs-arraylist","aria-label":'Permalink to "3. LinkedList VS **ArrayList**"'},"​")],-1)),i[51]||(i[51]=s("p",null,[s("strong",null,"要求")],-1)),i[52]||(i[52]=s("ul",null,[s("li",null,"能够说清楚 LinkedList 对比 ArrayList 的区别，并重视纠正部分错误的认知")],-1)),i[53]||(i[53]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418144031416.png",alt:"image-20230418144031416",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[54]||(i[54]=s("ul",null,[s("li",null,"两者查询元素内容的时间复杂度都是O(n)，都不太适合用来查询，查询可以选择更高效的数据结构，如HashMap、TreeMap等")],-1)),i[55]||(i[55]=s("p",null,[s("strong",null,"LinkedList")],-1)),i[56]||(i[56]=s("ol",null,[s("li",null,"基于双向链表，无需连续内存")],-1)),i[57]||(i[57]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418143629513.png",alt:"image-20230418143629513",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[58]||(i[58]=s("ol",{start:"2"},[s("li",null,"随机访问慢（要沿着链表遍历）")],-1)),i[59]||(i[59]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418143509162.png",alt:"image-20230418143509162",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[60]||(i[60]=s("ol",{start:"3"},[s("li",null,"头尾插入删除性能高"),s("li",null,"占用内存多")],-1)),i[61]||(i[61]=s("p",null,[s("strong",null,"ArrayList")],-1)),i[62]||(i[62]=s("ol",null,[s("li",null,"基于数组，需要连续内存")],-1)),i[63]||(i[63]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418143617488.png",alt:"image-20230418143617488",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[64]||(i[64]=s("ol",{start:"2"},[s("li",null,"随机访问快（指根据下标访问）")],-1)),i[65]||(i[65]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418143527810.png",alt:"image-20230418143527810",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[66]||(i[66]=s("ol",{start:"3"},[s("li",null,"尾部插入、删除性能可以，其它部分插入、删除都会移动数据，因此性能会低")],-1)),i[67]||(i[67]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418144640481.png",alt:"image-20230418144640481",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[68]||(i[68]=s("ol",{start:"4"},[s("li",null,"可以利用 cpu 缓存，局部性原理（将读取变量和其相邻的变量也一次读到CPU缓存中）")],-1)),i[69]||(i[69]=s("blockquote",null,[s("p",null,[s("em",null,[s("strong",null,"代码说明")])]),s("ul",null,[s("li",null,"day01.list.ArrayListVsLinkedList#randomAccess 对比随机访问性能")]),s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418143722912.png",alt:"image-20230418143722912",loading:"lazy",decoding:"async",class:"lazy"})]),s("ul",null,[s("li",null,"day01.list.ArrayListVsLinkedList#addMiddle 对比向中间插入性能"),s("li",null,"day01.list.ArrayListVsLinkedList#addFirst 对比头部插入性能"),s("li",null,"day01.list.ArrayListVsLinkedList#addLast 对比尾部插入性能")]),s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418145338167.png",alt:"image-20230418145338167",loading:"lazy",decoding:"async",class:"lazy"})]),s("ul",null,[s("li",null,"day01.list.ArrayListVsLinkedList#linkedListSize 打印一个 LinkedList 占用内存"),s("li",null,"day01.list.ArrayListVsLinkedList#arrayListSize 打印一个 ArrayList 占用内存")]),s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418153454935.png",alt:"image-20230418153454935",loading:"lazy",decoding:"async",class:"lazy"})]),s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418150308326.png",alt:"image-20230418150308326",loading:"lazy",decoding:"async",class:"lazy"})]),s("ul",null,[s("li",null,[s("p",null,"CPU进行计算的数据还是来自内存中的，比如进行加法运算，首先将内存中a的变量的读取到CPU的寄存器中，然后将b的值读到另一个寄存器中，数据都有了就进行接下来的加法运算，计算后的结果也会写到内存中的c变量，这样就完成了一次加法运算的计算过程，在这个计算过程里瓶颈在于内存变量的读和写上，因为内存的读写效率是非常低的，读一次、写一次大约需要花几百纳秒，对于CPU来讲这个时间是非常漫长的，CPU执行一次计算是少于纳秒级别的，也许花了不到1纳秒就完成了，但等待数据读进来写出去就要花费成百倍的时间，显然是不可接受的；")]),s("li",null,[s("p",null,"因此需要在CPU与内存之间加入CPU缓存，这个缓存的读写性能就比内存高很多了，CPU缓存又分为1级、2级、3级缓存，速度快的能达到10纳秒，速度慢的也能到达几十纳秒，对比内存的几百纳秒就快了很多")])]),s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418151824705.png",alt:"image-20230418151824705",loading:"lazy",decoding:"async",class:"lazy"})]),s("ul",null,[s("li",null,[l("局部性原理 "),s("ul",null,[s("li",null,"往缓存中读数据时的一种规则，一种优化措施"),s("li",null,"将某个数据以及它相邻的数据都读取到缓存中，它会出于这样一种假设，当读取某个变量时，它相邻的变量也会有很大几率被访问到，即拿到某个元素后，有很大几率会遍历数组，即可以直接在缓存中遍历了，无需再到内存中遍历")])])]),s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418152143557.png",alt:"image-20230418152143557",loading:"lazy",decoding:"async",class:"lazy"})]),s("ul",null,[s("li",null,"链表的局部性原理就不可行，因为第一个元素与第二个元素相邻的有点远")]),s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418152725657.png",alt:"image-20230418152725657",loading:"lazy",decoding:"async",class:"lazy"})]),s("ul",null,[s("li",null,"CPU缓存的空间也是有限的，如果将2和3也读到缓存，就会把之前的数据清空掉了，因此链表就不能很好的配合CPU缓存(局部性原理)来提升性能")]),s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418152845212.png",alt:"image-20230418152845212",loading:"lazy",decoding:"async",class:"lazy"})])],-1)),i[70]||(i[70]=s("h2",{id:"_4-hashmap",tabindex:"-1"},[l("4. HashMap "),s("a",{class:"header-anchor",href:"#_4-hashmap","aria-label":'Permalink to "4. HashMap"'},"​")],-1)),i[71]||(i[71]=s("p",null,[s("strong",null,"要求")],-1)),i[72]||(i[72]=s("ul",null,[s("li",null,"掌握 HashMap 的基本数据结构"),s("li",null,"掌握树化"),s("li",null,"理解索引计算方法、二次 hash 的意义、容量对索引计算的影响"),s("li",null,"掌握 put 流程、扩容、扩容因子"),s("li",null,"理解并发使用 HashMap 可能导致的问题"),s("li",null,"理解 key 的设计")],-1)),i[73]||(i[73]=s("h3",{id:"_1-基本数据结构",tabindex:"-1"},[l("1）基本数据结构 "),s("a",{class:"header-anchor",href:"#_1-基本数据结构","aria-label":'Permalink to "1）基本数据结构"'},"​")],-1)),i[74]||(i[74]=s("ul",null,[s("li",null,"1.7 数组 + 链表"),s("li",null,"1.8 数组 + （链表 | 红黑树）")],-1)),i[75]||(i[75]=s("blockquote",null,[s("p",null,"更形象的演示，见资料中的 hash-demo.jar，运行需要 jdk14 以上环境，进入 jar 包目录，执行下面命令"),s("div",{style:{"max-height":"300px"},class:"language- vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"}),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"java -jar --add-exports java.base/jdk.internal.misc=ALL-UNNAMED hash-demo.jar")])])]),s("button",{class:"collapse"})])],-1)),i[76]||(i[76]=s("h3",{id:"_2-树化与退化",tabindex:"-1"},[l("2）树化与退化 "),s("a",{class:"header-anchor",href:"#_2-树化与退化","aria-label":'Permalink to "2）树化与退化"'},"​")],-1)),i[77]||(i[77]=s("p",null,[s("strong",null,"树化意义")],-1)),i[78]||(i[78]=s("ul",null,[s("li",null,"红黑树用来避免 DoS 攻击，防止链表超长时性能下降，树化应当是偶然情况，是保底策略"),s("li",null,[l("hash 表的查找，更新的时间复杂度是 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"O"),s("mo",{stretchy:"false"},"("),s("mn",null,"1"),s("mo",{stretchy:"false"},")")]),s("annotation",{encoding:"application/x-tex"},"O(1)")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em"}},"O"),s("span",{class:"mopen"},"("),s("span",{class:"mord"},"1"),s("span",{class:"mclose"},")")])])]),l("，而红黑树的查找，更新的时间复杂度是 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"O"),s("mo",{stretchy:"false"},"("),s("mi",null,"l"),s("mi",null,"o"),s("msub",null,[s("mi",null,"g"),s("mn",null,"2")]),s("mi",null,"n"),s("mo",{stretchy:"false"},")")]),s("annotation",{encoding:"application/x-tex"},"O(log_2n)")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em"}},"O"),s("span",{class:"mopen"},"("),s("span",{class:"mord mathnormal",style:{"margin-right":"0.01968em"}},"l"),s("span",{class:"mord mathnormal"},"o"),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3011em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.0359em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},"2")])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mord mathnormal"},"n"),s("span",{class:"mclose"},")")])])]),l(" ，TreeNode 占用空间也比普通 Node 的大，如非必要，尽量还是使用链表")]),s("li",null,"hash 值如果足够随机，则在 hash 表内按泊松分布，在负载因子 0.75 的情况下，长度超过 8 的链表出现概率是 0.00000006，树化阈值选择 8 就是为了让树化几率足够小")],-1)),i[79]||(i[79]=s("p",null,[s("strong",null,"树化规则")],-1)),i[80]||(i[80]=s("ul",null,[s("li",null,"当链表长度超过树化阈值 8 时，先尝试扩容来减少链表长度，如果数组容量已经 >=64，才会进行树化")],-1)),i[81]||(i[81]=s("p",null,[s("strong",null,"退化规则")],-1)),i[82]||(i[82]=s("ul",null,[s("li",null,"情况1：在扩容时如果拆分树时，树元素个数 <= 6 则会退化链表"),s("li",null,"情况2：remove 树节点时，若 root、root.left、root.right、root.left.left 有一个为 null ，也会退化为链表")],-1)),i[83]||(i[83]=s("h3",{id:"_3-索引计算",tabindex:"-1"},[l("3）索引计算 "),s("a",{class:"header-anchor",href:"#_3-索引计算","aria-label":'Permalink to "3）索引计算"'},"​")],-1)),i[84]||(i[84]=s("ul",null,[s("li",null,[s("p",null,"前置知识"),s("ul",null,[s("li",null,"与运算（&）")]),s("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"java"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"参加运算的两个数据，按二进制位进行“与”运算。")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"运算规则："),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"&"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";   "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"&"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";    "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"&"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";     "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"&"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"即：两位同时为“"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"”，结果才为“"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"”，否则为0")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"例如："),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"3"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"&"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"5"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  即 "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0000"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0011"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," &"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0000"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0101"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0000"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0001"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"   因此，"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"3"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"&"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"5的值得1。")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"例如："),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"9"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"&"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"5"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  即 "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0000"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 1001"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (9的二进制补码)"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"&"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"00000101"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (5的二进制补码) "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"00000001"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (1的二进制补码)可见9"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"&"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"5"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"。")])])]),s("button",{class:"collapse"})]),s("ul",null,[s("li",null,[s("p",null,"或运算（|）"),s("div",{style:{"max-height":"300px"},class:"language- vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"}),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"参加运算的两个对象，按二进制位进行“或”运算。")]),l(`
`),s("span",{class:"line"},[s("span")]),l(`
`),s("span",{class:"line"},[s("span",null,"运算规则：0|0=0；   0|1=1；   1|0=1；    1|1=1；")]),l(`
`),s("span",{class:"line"},[s("span")]),l(`
`),s("span",{class:"line"},[s("span",null,"即 ：参加运算的两个对象只要有一个为1，其值为1。")]),l(`
`),s("span",{class:"line"},[s("span")]),l(`
`),s("span",{class:"line"},[s("span",null,"例如:3|5　即 0000 0011 | 0000 0101 = 0000 0111   因此，3|5的值得7。　")]),l(`
`),s("span",{class:"line"},[s("span")]),l(`
`),s("span",{class:"line"},[s("span",null,"例如：9|5可写算式如下： 00001001|00000101 =00001101 (十进制为13)可见9|5=13")])])]),s("button",{class:"collapse"})])]),s("li",null,[s("p",null,"异或运算（^）")])]),s("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"java"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"参加运算的两个数据，按二进制位进行“异或”运算。")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"运算规则："),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"^"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"；   "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"^"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"；   "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"^"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"；   "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"^"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"；")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"即：参加运算的两个对象，如果两个相应位为“异”（值不同），则该位结果为1，否则为0。")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"例如："),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"9"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"^"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"5可写成算式如下： "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"00001001"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"^"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"00000101"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"00001100"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (十进制为12)可见9"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"^"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"5"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"12")])])]),s("button",{class:"collapse"})]),s("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"java"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 01010"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"10"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 10000"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"16"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 11010"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"26"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"----------"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"10"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"&"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"16"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"----------"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"26"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"&"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"16"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 16"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"newHash "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 16"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"10")])])]),s("button",{class:"collapse"})])])],-1)),i[85]||(i[85]=s("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"java"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"8421码指的是四位二进制数，从0000"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"~"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1001"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"，分别代表十进制0"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"~"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"9"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"，其每位的权分别为$2"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"^"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"3$（"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"8"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"）、$2"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"^"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"2$（"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"4"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"）、$2"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"^"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"1$（"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"）、$2"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"^"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"0$（"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"）。除了8421码外，类似的还有5421码。")])])]),s("button",{class:"collapse"})],-1)),i[86]||(i[86]=s("ul",null,[s("li",null,"索引如何计算？hashCode都有了，为何还要提供hash()方法？数组容量为何是2的n次幂？")],-1)),i[87]||(i[87]=s("p",null,[s("strong",null,"索引计算方法"),l("（"),s("strong",null,"为了配合容量是 2 的 n 次幂的优化手段"),l(" ）")],-1)),i[88]||(i[88]=s("ul",null,[s("li",null,[s("p",null,"首先，计算对象的 hashCode()")]),s("li",null,[s("p",null,"再进行调用 HashMap 的 hash() 方法进行二次哈希"),s("ul",null,[s("li",null,[s("p",null,[l("二次 hash() 是为了综合高位数据，让哈希分布更为均匀；"),s("strong",null,"计算hashCode的值越随机，hashCode分布得越均匀，链表就越不会有过长的情况")]),s("ul",null,[s("li",null,"HashMap1.8二次hash")]),s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418201334955.png",alt:"image-20230418201334955",loading:"lazy",decoding:"async",class:"lazy"})]),s("ul",null,[s("li",null,"HashMap1.7二次hash")]),s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418201418625.png",alt:"image-20230418201418625",loading:"lazy",decoding:"async",class:"lazy"})])]),s("li",null,[s("p",null,"hashCode足够均匀")])]),s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418202517544.png",alt:"image-20230418202517544",loading:"lazy",decoding:"async",class:"lazy"})]),s("ul",null,[s("li",null,"hashCode选取不够好，不够随机")]),s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418202727603.png",alt:"image-20230418202727603",loading:"lazy",decoding:"async",class:"lazy"})]),s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418202829734.png",alt:"image-20230418202829734",loading:"lazy",decoding:"async",class:"lazy"})]),s("ul",null,[s("li",null,"进行二次hash扰动函数，使得hashCode分布更均匀，防止超长链表的产生")]),s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418203040744.png",alt:"image-20230418203040744",loading:"lazy",decoding:"async",class:"lazy"})]),s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418203513964.png",alt:"image-20230418203513964",loading:"lazy",decoding:"async",class:"lazy"})])]),s("li",null,[s("p",null,"最后 & (capacity – 1) 得到索引（容量capacity必须为2的n次幂）")])],-1)),i[89]||(i[89]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418195049973.png",alt:"image-20230418195049973",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[90]||(i[90]=s("p",null,[s("strong",null,"数组容量为何是 2 的 n 次幂")],-1)),i[91]||(i[91]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418195337120.png",alt:"image-20230418195337120",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[92]||(i[92]=s("ol",null,[s("li",null,"计算索引时效率更高：如果是 2 的 n 次幂可以使用位与运算代替取模"),s("li",null,"扩容时重新计算索引效率更高： hash & oldCap == 0 的元素留在原来位置 ，否则新位置 = 旧位置 + oldCap = 10 + 16")],-1)),i[93]||(i[93]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418204559461.png",alt:"image-20230418204559461",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[94]||(i[94]=s("p",null,[s("strong",null,"注意")],-1)),i[95]||(i[95]=s("ul",null,[s("li",null,[l("二次 hash 是为了配合 "),s("strong",null,"容量是 2 的 n 次幂"),l(" 这一设计前提，如果 hash 表的容量不是 2 的 n 次幂，则不必二次 hash，即想要更好的hash分布性，容量值就选择质数")])],-1)),i[96]||(i[96]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418210235261.png",alt:"image-20230418210235261",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[97]||(i[97]=s("ul",null,[s("li",null,[s("strong",null,"容量是 2 的 n 次幂"),l(" 这一设计计算索引效率更好（追求性能），但 hash 的分散性就不好，需要二次 hash 来作为补偿，没有采用这一设计的典型例子是 Hashtable，以下为 Hashtable 的扩容规律")])],-1)),i[98]||(i[98]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418210834027.png",alt:"image-20230418210834027",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[99]||(i[99]=s("h3",{id:"_4-put-与扩容",tabindex:"-1"},[l("4）put 与扩容 "),s("a",{class:"header-anchor",href:"#_4-put-与扩容","aria-label":'Permalink to "4）put 与扩容"'},"​")],-1)),i[100]||(i[100]=s("p",null,[s("strong",null,"put 流程")],-1)),i[101]||(i[101]=s("ul",null,[s("li",null,"1.8put流程")],-1)),i[102]||(i[102]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419110228837.png",alt:"image-20230419110228837",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[103]||(i[103]=s("ol",null,[s("li",null,"HashMap 是懒惰创建数组的，首次使用才创建数组"),s("li",null,"计算索引（桶下标）"),s("li",null,"如果桶下标还没人占用，创建 Node 占位返回"),s("li",null,[l("如果桶下标已经有人占用 "),s("ol",null,[s("li",null,"已经是 TreeNode 走红黑树的添加或更新逻辑"),s("li",null,"是普通 Node，走链表的添加或更新逻辑，如果链表长度超过树化阈值，走树化逻辑")])]),s("li",null,"返回前检查容量是否超过阈值，一旦超过进行扩容")],-1)),i[104]||(i[104]=s("p",null,[s("strong",null,"1.7 与 1.8 的区别")],-1)),i[105]||(i[105]=s("ol",null,[s("li",null,[s("p",null,"链表插入节点时"),s("ol",null,[s("li",null,"1.7 是头插法")]),s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419110745737.png",alt:"image-20230419110745737",loading:"lazy",decoding:"async",class:"lazy"})]),s("ol",{start:"2"},[s("li",null,"1.8 是尾插法")]),s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419110538952.png",alt:"image-20230419110538952",loading:"lazy",decoding:"async",class:"lazy"})])]),s("li",null,[s("p",null,"1.7 是大于等于阈值且没有空位时才扩容"),s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419112014919.png",alt:"image-20230419112014919",loading:"lazy",decoding:"async",class:"lazy"})])]),s("li",null,[s("p",null,"而 1.8 是大于阈值就扩容")]),s("li",null,[s("p",null,"1.8 在扩容计算 Node 索引时，会优化"),s("ul",null,[s("li",null,"hash & oldCap == 0 的元素留在原来位置 ，否则新位置 = 旧位置 + oldCap = 10 + 16")])])],-1)),i[106]||(i[106]=s("p",null,[s("strong",null,"扩容（加载）因子为何默认是 0.75f")],-1)),i[107]||(i[107]=s("ol",null,[s("li",null,[s("p",null,"在空间占用与查询时间之间取得较好的权衡")]),s("li",null,[s("p",null,"大于这个值，空间节省了，但链表就会比较长影响性能"),s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419112518996.png",alt:"image-20230419112518996",loading:"lazy",decoding:"async",class:"lazy"})])]),s("li",null,[s("p",null,"小于这个值，冲突减少了，但扩容就会更频繁，空间占用也更多")])],-1)),i[108]||(i[108]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419112817313.png",alt:"image-20230419112817313",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[109]||(i[109]=s("blockquote",null,[s("p",null,[l("计算桶下标：hash()→"),s("code",null,"(hashcode >>> 16 ^ hashcode )&(capacity-1)"),l(" capacity为2的n次幂，计算索引效率更高，但哈希分布不均匀；capacity为质数时哈希分布均匀（hashtable）。 hashmap1.8:超过容量扩容阈值（＞¾），先创建扩容新数组再将数据迁移到新数组；链表插入方式为尾插法 1.7:链表插入方式为头插法；")])],-1)),i[110]||(i[110]=s("h3",{id:"_5-并发问题",tabindex:"-1"},[l("5）并发问题 "),s("a",{class:"header-anchor",href:"#_5-并发问题","aria-label":'Permalink to "5）并发问题"'},"​")],-1)),i[111]||(i[111]=s("p",null,"1.7链表迁移过程(a和b迁移前后都是同一个对象，只是改变了它们的一些引用地址，并没有发生对象的创建)",-1)),i[112]||(i[112]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419121302636.png",alt:"image-20230419121302636",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[113]||(i[113]=s("p",null,[s("strong",null,"扩容死链（1.7 会存在）")],-1)),i[114]||(i[114]=s("p",null,"1.7 源码如下：",-1)),i[115]||(i[115]=s("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"java"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"void"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," transfer"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Entry"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[] newTable, "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"boolean"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," rehash) {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    int"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," newCapacity "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," newTable.length;")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    for"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (Entry<"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"K"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},","),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"V"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> e "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," table) {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        while"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"null"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," !="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," e) {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            Entry<"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"K"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},","),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"V"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> next "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," e.next;")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            if"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (rehash) {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                e.hash "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," =="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," e.key "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"?"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," :"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," hash"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(e.key);")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            }")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            int"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," i "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," indexFor"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(e.hash, newCapacity);")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            e.next "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," newTable[i];")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            newTable[i] "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," e;")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            e "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," next;")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),s("button",{class:"collapse"})],-1)),i[116]||(i[116]=s("ul",null,[s("li",null,"e 和 next 都是局部变量，用来指向当前节点和下一个节点"),s("li",null,"线程1（绿色）的临时变量 e 和 next 刚引用了这俩节点，还未来得及移动节点，发生了线程切换，由线程2（蓝色）完成扩容和迁移")],-1)),i[117]||(i[117]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210831084325075.png",alt:"image-20210831084325075",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[118]||(i[118]=s("ul",null,[s("li",null,"线程2 扩容完成，由于头插法，链表顺序颠倒。但线程1 的临时变量 e 和 next 还引用了这俩节点，还要再来一遍迁移")],-1)),i[119]||(i[119]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210831084723383.png",alt:"image-20210831084723383",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[120]||(i[120]=s("ul",null,[s("li",null,[s("p",null,"第一次循环"),s("ul",null,[s("li",null,"循环接着线程切换前运行，注意此时 e 指向的是节点 a，next 指向的是节点 b"),s("li",null,"e 头插 a 节点，注意图中画了两份 a 节点，但事实上只有一个（为了不让箭头特别乱画了两份）")]),s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210831084855348.png",alt:"image-20210831084855348",loading:"lazy",decoding:"async",class:"lazy"})]),s("ul",null,[s("li",null,"当循环结束是 e 会指向 next 也就是 b 节点")])])],-1)),i[121]||(i[121]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419121935915.png",alt:"image-20230419121935915",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[122]||(i[122]=s("ul",null,[s("li",null,[s("p",null,"第二次循环"),s("ul",null,[s("li",null,"第二轮开始，next 指向了节点 a"),s("li",null,"e 头插节点 b")]),s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210831085329449.png",alt:"image-20210831085329449",loading:"lazy",decoding:"async",class:"lazy"})]),s("ul",null,[s("li",null,"当循环结束时，e 指向 next 也就是节点 a")])])],-1)),i[123]||(i[123]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419122220312.png",alt:"image-20230419122220312",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[124]||(i[124]=s("ul",null,[s("li",null,[s("p",null,"第三次循环"),s("ul",null,[s("li",null,"next 指向了 null")]),s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419133332478.png",alt:"image-20230419133332478",loading:"lazy",decoding:"async",class:"lazy"})]),s("ul",null,[s("li",null,[l("e 头插节点 a，"),s("strong",null,"a 的 next 指向了 b"),l("（之前 a.next 一直是 null），b 的 next 指向 a，死链已成")])]),s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210831085543224.png",alt:"image-20210831085543224",loading:"lazy",decoding:"async",class:"lazy"})]),s("ul",null,[s("li",null,"当循环结束时，e 指向 next 也就是 null，因此第四次循环时会正常退出")])])],-1)),i[125]||(i[125]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419133643654.png",alt:"image-20230419133643654",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[126]||(i[126]=s("p",null,[s("strong",null,"数据错乱（1.7，1.8 都会存在）")],-1)),i[127]||(i[127]=s("ul",null,[s("li",null,[l("代码参考 "),s("code",null,"day01.map.HashMapMissData"),l("，具体调试步骤参考视频")])],-1)),i[128]||(i[128]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419115103985.png",alt:"image-20230419115103985",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[129]||(i[129]=s("blockquote",null,[s("p",null,[s("em",null,[s("strong",null,"补充代码说明")])]),s("ul",null,[s("li",null,"day01.map.HashMapDistribution 演示 map 中链表长度符合泊松分布"),s("li",null,[l("day01.map.DistributionAffectedByCapacity 演示容量及 hashCode 取值对分布的影响 "),s("ul",null,[s("li",null,"day01.map.DistributionAffectedByCapacity#hashtableGrowRule 演示了 Hashtable 的扩容规律"),s("li",null,"day01.sort.Utils#randomArray 如果 hashCode 足够随机，容量是否是 2 的 n 次幂影响不大"),s("li",null,"day01.sort.Utils#lowSameArray 如果 hashCode 低位一样的多，容量是 2 的 n 次幂会导致分布不均匀"),s("li",null,"day01.sort.Utils#evenArray 如果 hashCode 偶数的多，容量是 2 的 n 次幂会导致分布不均匀"),s("li",null,"由此得出对于容量是 2 的 n 次幂的设计来讲，二次 hash 非常重要")])]),s("li",null,"day01.map.HashMapVsHashtable 演示了对于同样数量的单词字符串放入 HashMap 和 Hashtable 分布上的区别")])],-1)),i[130]||(i[130]=s("h3",{id:"_6-key-的设计",tabindex:"-1"},[l("6）key 的设计 "),s("a",{class:"header-anchor",href:"#_6-key-的设计","aria-label":'Permalink to "6）key 的设计"'},"​")],-1)),i[131]||(i[131]=s("p",null,[s("strong",null,"key 的设计要求")],-1)),i[132]||(i[132]=s("ol",null,[s("li",null,[s("p",null,"HashMap 的 key 可以为 null，但 Map 的其他实现则不然")]),s("li",null,[s("p",null,[l("作为 key 的对象，必须实现 hashCode 和 equals，并且 "),s("strong",null,"key 的内容不能修改（不可变）")]),s("ul",null,[s("li",null,"重写hashCode方法是为了让我们的key在整个HashMap中有更好的分布性，提高查询性能"),s("li",null,"重写equals方法是为了将来如果计算两个对象的key的索引都一样，进一步需要用equals进行比较，看看是不是两个相同的对象"),s("li",null,"两个对象的hashCode相等，equals不一定相等；两个对象的equals相等，hashCode一定相等")])]),s("li",null,[s("p",null,"key 的 hashCode 应该有良好的散列性")])],-1)),i[133]||(i[133]=s("p",null,"如果 key 可变，例如修改了 age 会导致再次查询时查询不到，因此平时用整数、字符串等作为key，这些类的内容不可变",-1)),i[134]||(i[134]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419134838699.png",alt:"image-20230419134838699",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[135]||(i[135]=s("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"java"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HashMapMutableKey"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," main"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"String"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[] "),s("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"args"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        HashMap<"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Student"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Object"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> map "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," HashMap<>();")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        Student stu "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Student"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"张三"'),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"18"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        map."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"put"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(stu, "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"new"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Object"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        System.out."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(map."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"get"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(stu));")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        stu.age "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 19"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        System.out."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(map."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"get"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(stu));")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    static"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Student"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        String name;")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        int"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," age;")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        public"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Student"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(String "),s("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"name"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"int"),s("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," age"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"            this"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".name "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," name;")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"            this"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".age "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," age;")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        public"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String "),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getName"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            return"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," name;")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        public"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," setName"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(String "),s("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"name"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"            this"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".name "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," name;")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        public"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," int"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getAge"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            return"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," age;")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        public"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," setAge"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"int"),s("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," age"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"            this"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".age "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," age;")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        @"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Override")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        public"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," boolean"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," equals"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Object "),s("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"o"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            if"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ("),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"this"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," =="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," o) "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"return"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," true"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            if"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (o "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ||"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getClass"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," o."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getClass"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()) "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"return"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," false"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            Student student "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (Student) o;")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            return"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," age "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," student.age "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"&&"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Objects."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"equals"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(name, student.name);")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        @"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Override")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        public"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," int"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," hashCode"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            return"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Objects."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"hash"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(name, age);")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),s("button",{class:"collapse"})],-1)),i[136]||(i[136]=s("p",null,[s("strong",null,"String 对象的 hashCode() 设计")],-1)),i[137]||(i[137]=s("ul",null,[s("li",null,"目标是达到较为均匀的散列效果，每个字符串的 hashCode 足够独特"),s("li",null,[l("字符串中的每个字符都可以表现为一个数字，称为 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msub",null,[s("mi",null,"S"),s("mi",null,"i")])]),s("annotation",{encoding:"application/x-tex"},"S_i")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8333em","vertical-align":"-0.15em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3117em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.0576em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight"},"i")])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])])])])]),l("，其中 i 的范围是 0 ~ n - 1")]),s("li",null,[l("散列公式为："),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msub",null,[s("mi",null,"S"),s("mn",null,"0")]),s("mo",null,"∗"),s("msup",null,[s("mn",null,"31"),s("mrow",null,[s("mi",null,"n"),s("mo",null,"−"),s("mn",null,"1")])]),s("mo",null,"+"),s("msub",null,[s("mi",null,"S"),s("mn",null,"1")]),s("mo",null,"∗"),s("msup",null,[s("mn",null,"31"),s("mrow",null,[s("mi",null,"n"),s("mo",null,"−"),s("mn",null,"2")])]),s("mo",null,"+"),s("mo",null,"…"),s("msub",null,[s("mi",null,"S"),s("mi",null,"i")]),s("mo",null,"∗"),s("msup",null,[s("mn",null,"31"),s("mrow",null,[s("mi",null,"n"),s("mo",null,"−"),s("mn",null,"1"),s("mo",null,"−"),s("mi",null,"i")])]),s("mo",null,"+"),s("mo",null,"…"),s("msub",null,[s("mi",null,"S"),s("mrow",null,[s("mi",null,"n"),s("mo",null,"−"),s("mn",null,"1")])]),s("mo",null,"∗"),s("msup",null,[s("mn",null,"31"),s("mn",null,"0")])]),s("annotation",{encoding:"application/x-tex"},"S_0∗31^{n-1}+S_1∗31^{n-2}+… S_i∗31^{n-1-i}+…S_{n-1}∗31^0")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8333em","vertical-align":"-0.15em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3011em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.0576em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},"0")])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"∗"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8974em","vertical-align":"-0.0833em"}}),s("span",{class:"mord"},"3"),s("span",{class:"mord"},[s("span",{class:"mord"},"1"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8141em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight"},"n"),s("span",{class:"mbin mtight"},"−"),s("span",{class:"mord mtight"},"1")])])])])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"+"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8333em","vertical-align":"-0.15em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3011em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.0576em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},"1")])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"∗"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8974em","vertical-align":"-0.0833em"}}),s("span",{class:"mord"},"3"),s("span",{class:"mord"},[s("span",{class:"mord"},"1"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8141em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight"},"n"),s("span",{class:"mbin mtight"},"−"),s("span",{class:"mord mtight"},"2")])])])])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"+"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8333em","vertical-align":"-0.15em"}}),s("span",{class:"minner"},"…"),s("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3117em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.0576em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight"},"i")])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"∗"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.908em","vertical-align":"-0.0833em"}}),s("span",{class:"mord"},"3"),s("span",{class:"mord"},[s("span",{class:"mord"},"1"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8247em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight"},"n"),s("span",{class:"mbin mtight"},"−"),s("span",{class:"mord mtight"},"1"),s("span",{class:"mbin mtight"},"−"),s("span",{class:"mord mathnormal mtight"},"i")])])])])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"+"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8917em","vertical-align":"-0.2083em"}}),s("span",{class:"minner"},"…"),s("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3011em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.0576em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight"},"n"),s("span",{class:"mbin mtight"},"−"),s("span",{class:"mord mtight"},"1")])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.2083em"}},[s("span")])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"∗"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8141em"}}),s("span",{class:"mord"},"3"),s("span",{class:"mord"},[s("span",{class:"mord"},"1"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8141em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},"0")])])])])])])])])])])]),s("li",null,[l("31 代入公式有较好的散列特性，并且 31 * h 可以被优化为 "),s("ul",null,[s("li",null,[l("即 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mn",null,"32"),s("mo",null,"∗"),s("mi",null,"h"),s("mo",null,"−"),s("mi",null,"h")]),s("annotation",{encoding:"application/x-tex"},"32 ∗h -h")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6444em"}}),s("span",{class:"mord"},"32"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"∗"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.7778em","vertical-align":"-0.0833em"}}),s("span",{class:"mord mathnormal"},"h"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"−"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6944em"}}),s("span",{class:"mord mathnormal"},"h")])])])]),s("li",null,[l("即 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msup",null,[s("mn",null,"2"),s("mn",null,"5")]),s("mo",null,"∗"),s("mi",null,"h"),s("mo",null,"−"),s("mi",null,"h")]),s("annotation",{encoding:"application/x-tex"},"2^5 ∗h -h")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8141em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},"2"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8141em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},"5")])])])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"∗"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.7778em","vertical-align":"-0.0833em"}}),s("span",{class:"mord mathnormal"},"h"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"−"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6944em"}}),s("span",{class:"mord mathnormal"},"h")])])])]),s("li",null,[l("即 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"h"),s("mo",null,"≪"),s("mn",null,"5"),s("mo",null,"−"),s("mi",null,"h")]),s("annotation",{encoding:"application/x-tex"},"h≪5 -h")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.7335em","vertical-align":"-0.0391em"}}),s("span",{class:"mord mathnormal"},"h"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"≪"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.7278em","vertical-align":"-0.0833em"}}),s("span",{class:"mord"},"5"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"−"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6944em"}}),s("span",{class:"mord mathnormal"},"h")])])])])])])],-1)),i[138]||(i[138]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419135639704.png",alt:"image-20230419135639704",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[139]||(i[139]=s("h2",{id:"_4-1-hashmap-快速查找",tabindex:"-1"},[l("4.1. HashMap-快速查找 "),s("a",{class:"header-anchor",href:"#_4-1-hashmap-快速查找","aria-label":'Permalink to "4.1. HashMap-快速查找"'},"​")],-1)),i[140]||(i[140]=s("ul",null,[s("li",null,"ArrayList查找效率较低")],-1)),i[141]||(i[141]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418161635803.png",alt:"image-20230418161635803",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[142]||(i[142]=s("ul",null,[s("li",null,"HashMap通过索引计算直接找到元素(hash运算)，无链表情况查找时间复杂度为O(1)，有链表情况就看链表长度了，时间复杂度为O(n)")],-1)),i[143]||(i[143]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418161857746.png",alt:"image-20230418161857746",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[144]||(i[144]=s("h2",{id:"_4-2-hashmap-链表过长的解决方案",tabindex:"-1"},[l("4.2. HashMap-链表过长的解决方案 "),s("a",{class:"header-anchor",href:"#_4-2-hashmap-链表过长的解决方案","aria-label":'Permalink to "4.2. HashMap-链表过长的解决方案"'},"​")],-1)),i[145]||(i[145]=s("ul",null,[s("li",null,"形成链表：keys相同的固定hash；keys的hash%容量相同")],-1)),i[146]||(i[146]=s("h3",{id:"_4-2-1-扩容",tabindex:"-1"},[l("4.2.1.扩容 "),s("a",{class:"header-anchor",href:"#_4-2-1-扩容","aria-label":'Permalink to "4.2.1.扩容"'},"​")],-1)),i[147]||(i[147]=s("ul",null,[s("li",null,"正常情况")],-1)),i[148]||(i[148]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418162855531.png",alt:"image-20230418162855531",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[149]||(i[149]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418162904156.png",alt:"image-20230418162904156",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[150]||(i[150]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418162909932.png",alt:"image-20230418162909932",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[151]||(i[151]=s("ul",null,[s("li",null,"极端情况，只能树化为红黑树了")],-1)),i[152]||(i[152]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418162935840.png",alt:"image-20230418162935840",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[153]||(i[153]=s("h3",{id:"_4-2-2-树化",tabindex:"-1"},[l("4.2.2. 树化 "),s("a",{class:"header-anchor",href:"#_4-2-2-树化","aria-label":'Permalink to "4.2.2. 树化"'},"​")],-1)),i[154]||(i[154]=s("ul",null,[s("li",null,"链表->红黑树：当容量为16，在某个桶下标形成链表的8个元素添加元素，仅进行扩容为32，再添加扩容到64才会树化")],-1)),i[155]||(i[155]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418164530243.png",alt:"image-20230418164530243",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[156]||(i[156]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418165555721.png",alt:"image-20230418165555721",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[157]||(i[157]=s("ul",null,[s("li",null,"满足树化条件(容量>=64且链表长度>8)，红黑树父节点左侧都是比它小的元素，右侧都是比它大的元素，子节点同理，hash码相同时才比较，按照key的字符串值比较，查找的时间复杂度为O(log2(n))")],-1)),i[158]||(i[158]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418165707584.png",alt:"image-20230418165707584",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[159]||(i[159]=s("ul",null,[s("li",null,"链表长度是可能出现超过8的情况")],-1)),i[160]||(i[160]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418170758857.png",alt:"image-20230418170758857",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[161]||(i[161]=s("h4",{id:"红黑树的意义-树化阈值",tabindex:"-1"},[l("红黑树的意义-树化阈值 "),s("a",{class:"header-anchor",href:"#红黑树的意义-树化阈值","aria-label":'Permalink to "红黑树的意义-树化阈值"'},"​")],-1)),i[162]||(i[162]=s("ul",null,[s("li",null,[s("p",null,"为何要用红黑树，为何一上来不树化，树化阈值为何是8，何时会树化，何时会退化为链表？"),s("ul",null,[s("li",null,[s("p",null,"因为链表较长时会影响整个HashMap的性能，1.8之后引入红黑树，即使链表较长也不会对性能有太大的影响")]),s("li",null,[s("p",null,"链表->红黑树：当容量为16，在某个桶下标形成链表的8个元素添加元素，仅进行扩容为32，再添加扩容到64才会树化")]),s("li",null,[s("p",null,"链表短的时候，链表性能大于红黑树，链表长时性能才远远不如红黑树，且红黑树占用内存比链表大得多，非必要不树化")]),s("li",null,[s("p",null,"红黑树是一种非正常情况，下图为23W多个正常单词的hash分布情况，若没有刻意构造hash码，在负载因子0.75的情况下，链表出现8的概率非常低，为0.00000006")])]),s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418181214309.png",alt:"image-20230418181214309",loading:"lazy",decoding:"async",class:"lazy"})]),s("ul",null,[s("li",null,"红黑树用来避免 DoS 攻击，防止链表超长时性能下降，树化应当是偶然情况，是保底策略")])])],-1)),i[163]||(i[163]=s("h4",{id:"树退化链表-情况1",tabindex:"-1"},[l("树退化链表-情况1 "),s("a",{class:"header-anchor",href:"#树退化链表-情况1","aria-label":'Permalink to "树退化链表-情况1"'},"​")],-1)),i[164]||(i[164]=s("ul",null,[s("li",null,"在扩容时如果拆分树时，树元素个数 <= 6 则会退化链表")],-1)),i[165]||(i[165]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418183806555.png",alt:"image-20230418183806555",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[166]||(i[166]=s("ul",null,[s("li",null,"在扩容时如果拆分树时，树元素个数 > 6 则不会退化链表")],-1)),i[167]||(i[167]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418184454141.png",alt:"image-20230418184454141",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[168]||(i[168]=s("h4",{id:"树退化链表-情况2",tabindex:"-1"},[l("树退化链表-情况2 "),s("a",{class:"header-anchor",href:"#树退化链表-情况2","aria-label":'Permalink to "树退化链表-情况2"'},"​")],-1)),i[169]||(i[169]=s("ul",null,[s("li",null,"remove 树节点时，若 root(爷)、root.left(左孩子)、root.right(右孩子)、root.left.left(左孙子) 有一个为 null ，也会退化为链表")],-1)),i[170]||(i[170]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418192832140.png",alt:"image-20230418192832140",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[171]||(i[171]=s("ul",null,[s("li",null,"例子2")],-1)),i[172]||(i[172]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230418193518600.png",alt:"image-20230418193518600",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[173]||(i[173]=s("h2",{id:"_5-单例模式",tabindex:"-1"},[l("5. 单例模式 "),s("a",{class:"header-anchor",href:"#_5-单例模式","aria-label":'Permalink to "5. 单例模式"'},"​")],-1)),i[174]||(i[174]=s("p",null,[s("strong",null,"要求")],-1)),i[175]||(i[175]=s("ul",null,[s("li",null,"掌握五种单例模式的实现方式"),s("li",null,"理解为何 DCL 实现时要使用 volatile 修饰静态变量"),s("li",null,"了解 jdk 中用到单例的场景")],-1)),i[176]||(i[176]=s("h3",{id:"饿汉式",tabindex:"-1"},[s("strong",null,"饿汉式"),l(),s("a",{class:"header-anchor",href:"#饿汉式","aria-label":'Permalink to "**饿汉式**"'},"​")],-1)),i[177]||(i[177]=s("ul",null,[s("li",null,"提前创建单例对象")],-1)),i[178]||(i[178]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419141144975.png",alt:"image-20230419141144975",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[179]||(i[179]=s("ul",null,[s("li",null,"实现Serializable接口利用反射破坏单例")],-1)),i[180]||(i[180]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419141539054.png",alt:"image-20230419141539054",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[181]||(i[181]=s("ul",null,[s("li",null,"反序列化破坏单例")],-1)),i[182]||(i[182]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419142100218.png",alt:"image-20230419142100218",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[183]||(i[183]=s("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"java"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Singleton1"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," implements"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Serializable"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Singleton1"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        if"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (INSTANCE "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            throw"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," RuntimeException"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"单例对象不能重复创建"'),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        System.out."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"private Singleton1()"'),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," final"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Singleton1 INSTANCE "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Singleton1"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Singleton1 "),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getInstance"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," INSTANCE;")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," otherMethod"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        System.out."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"otherMethod()"'),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Object "),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"readResolve"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," INSTANCE;")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),s("button",{class:"collapse"})],-1)),i[184]||(i[184]=s("ul",null,[s("li",null,"构造方法抛出异常是防止反射破坏单例")],-1)),i[185]||(i[185]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419141740516.png",alt:"image-20230419141740516",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[186]||(i[186]=s("ul",null,[s("li",null,[s("code",null,"readResolve()"),l(" 是防止反序列化破坏单例")])],-1)),i[187]||(i[187]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419142253512.png",alt:"image-20230419142253512",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[188]||(i[188]=s("ul",null,[s("li",null,"unsafe破坏单例")],-1)),i[189]||(i[189]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419142613493.png",alt:"image-20230419142613493",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[190]||(i[190]=s("h3",{id:"枚举饿汉式",tabindex:"-1"},[s("strong",null,"枚举饿汉式"),l(),s("a",{class:"header-anchor",href:"#枚举饿汉式","aria-label":'Permalink to "**枚举饿汉式**"'},"​")],-1)),i[191]||(i[191]=s("ul",null,[s("li",null,"枚举类一加载并初始化，就会把枚举对象创建出来")],-1)),i[192]||(i[192]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419143438750.png",alt:"image-20230419143438750",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[193]||(i[193]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419143148474.png",alt:"image-20230419143148474",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[194]||(i[194]=s("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"java"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," enum"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Singleton2"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    INSTANCE"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Singleton2"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        System.out."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"private Singleton2()"'),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Override")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String "),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"toString"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getClass"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getName"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "@"'),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"toHexString"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"hashCode"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Singleton2 "),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getInstance"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," INSTANCE;")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," otherMethod"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        System.out."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"otherMethod()"'),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),s("button",{class:"collapse"})],-1)),i[195]||(i[195]=s("ul",null,[s("li",null,"枚举饿汉式能天然防止反射、反序列化破坏单例")],-1)),i[196]||(i[196]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419144121454.png",alt:"image-20230419144121454",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[197]||(i[197]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419143856798.png",alt:"image-20230419143856798",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[198]||(i[198]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419143639529.png",alt:"image-20230419143639529",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[199]||(i[199]=s("ul",null,[s("li",null,"unsafe依旧可以破坏枚举单例")],-1)),i[200]||(i[200]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419144327173.png",alt:"image-20230419144327173",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[201]||(i[201]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419144146527.png",alt:"image-20230419144146527",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[202]||(i[202]=s("h3",{id:"懒汉式",tabindex:"-1"},[s("strong",null,"懒汉式"),l(),s("a",{class:"header-anchor",href:"#懒汉式","aria-label":'Permalink to "**懒汉式**"'},"​")],-1)),i[203]||(i[203]=s("ul",null,[s("li",null,"第一次调用getInstance方法时才创建单例对象(非线程安全)")],-1)),i[204]||(i[204]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419144620623.png",alt:"image-20230419144620623",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[205]||(i[205]=s("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"java"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Singleton3"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," implements"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Serializable"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Singleton3"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        System.out."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"private Singleton3()"'),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Singleton3 INSTANCE "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // Singleton3.class  synchronized加在方法上，性能不是特别好，因为单例对象创建好以后，其他线程来访问该同步方法时无需再加锁了，后续的操作不用再进行同步和互斥保护了，不然就影响性能了，只有首次创建单例是才进行线程安全的保护")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," synchronized"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Singleton3 "),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getInstance"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        if"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (INSTANCE "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            INSTANCE "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Singleton3"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," INSTANCE;")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," otherMethod"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        System.out."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"otherMethod()"'),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),s("button",{class:"collapse"})],-1)),i[206]||(i[206]=s("ul",null,[s("li",null,"其实只有首次创建单例对象时才需要同步，但该代码实际上每次调用都会同步"),s("li",null,"因此有了下面的双检锁改进")],-1)),i[207]||(i[207]=s("h3",{id:"双检锁懒汉式",tabindex:"-1"},[s("strong",null,"双检锁懒汉式"),l(),s("a",{class:"header-anchor",href:"#双检锁懒汉式","aria-label":'Permalink to "**双检锁懒汉式**"'},"​")],-1)),i[208]||(i[208]=s("ul",null,[s("li",null,"少了内层判断还是会重复创建对象")],-1)),i[209]||(i[209]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419145814990.png",alt:"image-20230419145814990",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[210]||(i[210]=s("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"java"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Singleton4"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," implements"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Serializable"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Singleton4"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        System.out."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"private Singleton4()"'),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," volatile"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Singleton4 INSTANCE "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"; "),s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 可见性，有序性")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Singleton4 "),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getInstance"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        if"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (INSTANCE "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            synchronized"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (Singleton4.class) {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"                if"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (INSTANCE "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    INSTANCE "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Singleton4"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                }")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            }")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," INSTANCE;")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," otherMethod"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        System.out."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"otherMethod()"'),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),s("button",{class:"collapse"})],-1)),i[211]||(i[211]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419145942353.png",alt:"image-20230419145942353",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[212]||(i[212]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419151419398.png",alt:"image-20230419151419398",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[213]||(i[213]=s("p",null,"为何必须加 volatile：",-1)),i[214]||(i[214]=s("ul",null,[s("li",null,[s("code",null,"INSTANCE = new Singleton4()"),l(" 不是原子的，分成 3 步：创建对象、调用构造、给静态变量赋值，其中后两步可能被指令重排序优化，变成先赋值、再调用构造")]),s("li",null,[l("如果线程1 先执行了赋值，线程2 执行到第一个 "),s("code",null,"INSTANCE == null"),l(" 时发现 INSTANCE 已经不为 null，此时就会返回一个未完全构造的对象")])],-1)),i[215]||(i[215]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419153459527.png",alt:"image-20230419153459527",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[216]||(i[216]=s("h3",{id:"内部类懒汉式",tabindex:"-1"},[s("strong",null,"内部类懒汉式"),l(),s("a",{class:"header-anchor",href:"#内部类懒汉式","aria-label":'Permalink to "**内部类懒汉式**"'},"​")],-1)),i[217]||(i[217]=s("div",{style:{"max-height":"300px"},class:"language-java vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"java"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Singleton5"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," implements"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Serializable"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Singleton5"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        System.out."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"private Singleton5()"'),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Holder"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        static"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Singleton5 INSTANCE "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Singleton5"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Singleton5 "),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getInstance"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Holder.INSTANCE;")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," otherMethod"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        System.out."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"otherMethod()"'),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),s("button",{class:"collapse"})],-1)),i[218]||(i[218]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419154215932.png",alt:"image-20230419154215932",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[219]||(i[219]=s("ul",null,[s("li",null,"避免了双检锁的缺点")],-1)),i[220]||(i[220]=s("blockquote",null,[s("p",null,"volatile修饰共享变量可以解决指令重排序(懒汉单例-DCL(双检索)) 给静态变量赋值肯定会放到静态代码块里执行，静态代码块里的代码由JVM来保证，则饿汉式不用考虑线程安全问题，枚举饿汉式同理")],-1)),i[221]||(i[221]=s("h3",{id:"jdk-中单例的体现",tabindex:"-1"},[s("strong",null,"JDK 中单例的体现"),l(),s("a",{class:"header-anchor",href:"#jdk-中单例的体现","aria-label":'Permalink to "**JDK 中单例的体现**"'},"​")],-1)),i[222]||(i[222]=s("ul",null,[s("li",null,"Runtime 体现了饿汉式单例")],-1)),i[223]||(i[223]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419154748392.png",alt:"image-20230419154748392",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[224]||(i[224]=s("ul",null,[s("li",null,"Console 体现了双检锁懒汉式单例")],-1)),i[225]||(i[225]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419154859774.png",alt:"image-20230419154859774",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[226]||(i[226]=s("ul",null,[s("li",null,"Collections 中的 EmptyNavigableSet 内部类懒汉式单例")],-1)),i[227]||(i[227]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419155254327.png",alt:"image-20230419155254327",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[228]||(i[228]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419155346324.png",alt:"image-20230419155346324",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[229]||(i[229]=s("ul",null,[s("li",null,"其他内部类懒汉式例子")],-1)),i[230]||(i[230]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419155525101.png",alt:"image-20230419155525101",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[231]||(i[231]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419155558145.png",alt:"image-20230419155558145",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[232]||(i[232]=s("ul",null,[s("li",null,"ReverseComparator.REVERSE_ORDER 内部类懒汉式单例")],-1)),i[233]||(i[233]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419155823830.png",alt:"image-20230419155823830",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[234]||(i[234]=s("ul",null,[s("li",null,"Comparators.NaturalOrderComparator.INSTANCE 枚举饿汉式单例")],-1)),i[235]||(i[235]=s("figure",null,[s("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20230419160119770.png",alt:"image-20230419160119770",loading:"lazy",decoding:"async",class:"lazy"})],-1))]),"main-header":a(()=>[t(n.$slots,"main-header")]),"main-header-after":a(()=>[t(n.$slots,"main-header-after")]),"main-nav":a(()=>[t(n.$slots,"main-nav")]),"main-content-before":a(()=>[t(n.$slots,"main-content-before")]),"main-content":a(()=>[t(n.$slots,"main-content")]),"main-content-after":a(()=>[t(n.$slots,"main-content-after")]),"main-nav-before":a(()=>[t(n.$slots,"main-nav-before")]),"main-nav-after":a(()=>[t(n.$slots,"main-nav-after")]),comment:a(()=>[t(n.$slots,"comment")]),footer:a(()=>[t(n.$slots,"footer")]),aside:a(()=>[t(n.$slots,"aside")]),"aside-custom":a(()=>[t(n.$slots,"aside-custom")]),default:a(()=>[t(n.$slots,"default")]),_:3},8,["frontmatter"])}}};export{I as default,A as usePageData};
