import{_ as l}from"./ValaxyMain.vue_vue_type_style_index_0_lang.NDzr_upu.js";import"./chunks/@vueuse/motion.BrTBiDBP.js";import{d as i,a as s,u as a}from"./chunks/vue-router.Cmq8qKBB.js";import{a1 as e,a3 as n,a4 as t,a5 as h,a6 as k,a7 as r,F as c,a2 as o,Z as p}from"./framework.CSpzLJwA.js";import"./app.B9pDRBUK.js";import"./chunks/dayjs.Dto65haK.js";import"./chunks/vue-i18n.C5QQbedb.js";import"./chunks/pinia.CKttsWmm.js";import"./chunks/nprogress.BEPa78Un.js";/* empty css                    */import"./YunComment.vue_vue_type_style_index_0_lang.B26MP4Hy.js";import"./index.TQnGKZgq.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang.DIveis5r.js";import"./post.DD7hVHl0.js";const d=i("/posts/Docker",async l=>JSON.parse('{"title":"Docker 从入门到实战","description":"","frontmatter":{"title":"Docker 从入门到实战","author":"imklaus","top":98,"tags":["Docker"],"categories":["部署"],"date":"2025/12/7 17:34:00","outline":"deep","postTitleClass":"text-#62afe9","excerpt_type":"html","end":false},"headers":[],"relativePath":"pages/posts/Docker.md","lastUpdated":null}'),{lazy:(l,i)=>l.name===i.name}),g={__name:"Docker",setup(i,{expose:g}){const{data:u}=d(),y=a(),m=s(),F=Object.assign(m.meta.frontmatter||{},u.value?.frontmatter||{});y.currentRoute.value.data=u.value,p("valaxy:frontmatter",F),globalThis.$frontmatter=F;return g({frontmatter:{title:"Docker 从入门到实战",author:"imklaus",top:98,tags:["Docker"],categories:["部署"],date:"2025/12/7 17:34:00",outline:"deep",postTitleClass:"text-#62afe9",excerpt_type:"html",end:!1}}),(i,s)=>{const a=l;return o(),e(a,{frontmatter:c(F)},{"main-content-md":n(()=>[s[0]||(s[0]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/self-hosting-overpass-api-us-only-on-docker-a-journey-with-bumps.png",alt:"",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[1]||(s[1]=h("p",null,[r("参考视频："),h("a",{href:"https://www.bilibili.com/video/BV1LQ4y127n4",target:"_blank",rel:"noreferrer"},"黑马SpringCloud微服务技术栈Docker篇")],-1)),s[2]||(s[2]=h("p",null,"笔记的整体结构依据视频编写，并随着学习的深入补充了很多知识",-1)),s[3]||(s[3]=h("p",null,[h("strong",null,"目录指引"),r("：")],-1)),s[4]||(s[4]=h("nav",{class:"table-of-contents"},[h("ul",null,[h("li",null,[h("a",{href:"#_1-初识docker"},"1. 初识Docker"),h("ul",null,[h("li",null,[h("a",{href:"#_1-1-什么是docker"},"1.1 什么是Docker")]),h("li",null,[h("a",{href:"#_1-2-docker和虚拟机的区别"},"1.2 Docker和虚拟机的区别")]),h("li",null,[h("a",{href:"#_1-3-docker架构"},"1.3 Docker架构")]),h("li",null,[h("a",{href:"#_1-4-安装docker"},"1.4 安装Docker")])])]),h("li",null,[h("a",{href:"#_2-docker的基本操作"},"2.Docker的基本操作"),h("ul",null,[h("li",null,[h("a",{href:"#_2-1-镜像操作"},"2.1.镜像操作")]),h("li",null,[h("a",{href:"#_2-2-容器操作"},"2.2 容器操作")]),h("li",null,[h("a",{href:"#_2-3-数据卷-容器数据管理"},"2.3 数据卷（容器数据管理）")])])]),h("li",null,[h("a",{href:"#_3-dockerfile自定义镜像"},"3. Dockerfile自定义镜像"),h("ul",null,[h("li",null,[h("a",{href:"#_3-1-镜像结构"},"3.1 镜像结构")]),h("li",null,[h("a",{href:"#_3-2-dockerfile语法"},"3.2 Dockerfile语法")]),h("li",null,[h("a",{href:"#_3-3-构建java项目"},"3.3 构建Java项目")]),h("li",null,[h("a",{href:"#_3-4-小结"},"3.4 小结")])])]),h("li",null,[h("a",{href:"#_4-docker-compose"},"4. Docker-Compose"),h("ul",null,[h("li",null,[h("a",{href:"#_4-1-初识dockercompose"},"4.1 初识DockerCompose")]),h("li",null,[h("a",{href:"#_4-2-安装dockercompose"},"4.2 安装DockerCompose")]),h("li",null,[h("a",{href:"#_4-3-部署微服务集群"},"4.3 部署微服务集群")])])]),h("li",null,[h("a",{href:"#_5-docker镜像仓库"},"5. Docker镜像仓库"),h("ul",null,[h("li",null,[h("a",{href:"#_5-1-搭建私有镜像仓库"},"5.1 搭建私有镜像仓库")]),h("li",null,[h("a",{href:"#_5-2-推送、拉取镜像"},"5.2 推送、拉取镜像")])])])])],-1)),s[5]||(s[5]=h("h2",{id:"_1-初识docker",tabindex:"-1"},[r("1. 初识Docker "),h("a",{class:"header-anchor",href:"#_1-初识docker","aria-label":'Permalink to "1. 初识Docker"'},"​")],-1)),s[6]||(s[6]=h("hr",null,null,-1)),s[7]||(s[7]=h("h3",{id:"_1-1-什么是docker",tabindex:"-1"},[r("1.1 什么是Docker "),h("a",{class:"header-anchor",href:"#_1-1-什么是docker","aria-label":'Permalink to "1.1 什么是Docker"'},"​")],-1)),s[8]||(s[8]=h("p",null,"微服务虽然具备各种各样的优势，但服务的拆分通用给部署带来了很大的麻烦。",-1)),s[9]||(s[9]=h("ul",null,[h("li",null,"分布式系统中，依赖的组件非常多，不同组件之间部署时往往会产生一些冲突。"),h("li",null,"在数百上千台服务中重复部署，环境不一定一致，会遇到各种问题")],-1)),s[10]||(s[10]=h("h4",{id:"_1-1-1-应用部署的环境问题",tabindex:"-1"},[r("1.1.1 应用部署的环境问题 "),h("a",{class:"header-anchor",href:"#_1-1-1-应用部署的环境问题","aria-label":'Permalink to "1.1.1 应用部署的环境问题"'},"​")],-1)),s[11]||(s[11]=h("p",null,"大型项目组件较多，运行环境也较为复杂，部署时会碰到一些问题：",-1)),s[12]||(s[12]=h("ul",null,[h("li",null,[h("p",null,"依赖关系复杂，容易出现兼容性问题")]),h("li",null,[h("p",null,"开发、测试、生产环境有差异")])],-1)),k(" more "),s[13]||(s[13]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731141907366.png",alt:"image-20210731141907366",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[14]||(s[14]=h("p",null,"例如一个项目中，部署时需要依赖于node.js、Redis、RabbitMQ、MySQL等，这些服务部署时所需要的函数库、依赖项各不相同，甚至会有冲突。给部署带来了极大的困难。",-1)),s[15]||(s[15]=h("h4",{id:"_1-1-2-docker解决依赖兼容问题",tabindex:"-1"},[r("1.1.2 Docker解决依赖兼容问题 "),h("a",{class:"header-anchor",href:"#_1-1-2-docker解决依赖兼容问题","aria-label":'Permalink to "1.1.2 Docker解决依赖兼容问题"'},"​")],-1)),s[16]||(s[16]=h("p",null,"而Docker确巧妙的解决了这些问题，Docker是如何实现的呢？",-1)),s[17]||(s[17]=h("p",null,"Docker为了解决依赖的兼容问题的，采用了两个手段：",-1)),s[18]||(s[18]=h("ul",null,[h("li",null,[h("p",null,"将应用的Libs（函数库）、Deps（依赖）、配置与应用一起打包")]),h("li",null,[h("p",null,[r("将每个应用放到一个隔离"),h("strong",null,"容器"),r("去运行，避免互相干扰")])])],-1)),s[19]||(s[19]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731142219735.png",alt:"image-20210731142219735",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[20]||(s[20]=h("p",null,"这样打包好的应用包中，既包含应用本身，也保护应用所需要的Libs、Deps，无需再操作系统上安装这些，自然就不存在不同应用之间的兼容问题了。",-1)),s[21]||(s[21]=h("p",null,"虽然解决了不同应用的兼容问题，但是开发、测试等环境会存在差异，操作系统版本也会有差异，怎么解决这些问题呢？",-1)),s[22]||(s[22]=h("h4",{id:"_1-1-3-docker解决操作系统环境差异",tabindex:"-1"},[r("1.1.3 Docker解决操作系统环境差异 "),h("a",{class:"header-anchor",href:"#_1-1-3-docker解决操作系统环境差异","aria-label":'Permalink to "1.1.3 Docker解决操作系统环境差异"'},"​")],-1)),s[23]||(s[23]=h("p",null,"要解决不同操作系统环境差异问题，必须先了解操作系统结构。以一个Ubuntu操作系统为例，结构如下：",-1)),s[24]||(s[24]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731143401460.png",alt:"image-20210731143401460",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[25]||(s[25]=h("p",null,"结构包括：",-1)),s[26]||(s[26]=h("ul",null,[h("li",null,"计算机硬件：例如CPU、内存、磁盘等"),h("li",null,[r("系统内核：所有Linux发行版的内核都是Linux，例如CentOS、Ubuntu、Fedora等。内核可以与计算机硬件交互，对外提供"),h("strong",null,"内核指令"),r("，用于操作计算机硬件。")]),h("li",null,"系统应用：操作系统本身提供的应用、函数库。这些函数库是对内核指令的封装，使用更加方便。")],-1)),s[27]||(s[27]=h("p",null,"应用于计算机交互的流程如下：",-1)),s[28]||(s[28]=h("p",null,"1）应用调用操作系统应用（函数库），实现各种功能",-1)),s[29]||(s[29]=h("p",null,"2）系统函数库是对内核指令集的封装，会调用内核指令",-1)),s[30]||(s[30]=h("p",null,"3）内核指令操作计算机硬件",-1)),s[31]||(s[31]=h("p",null,"Ubuntu和CentOS都是基于Linux内核，无非是系统应用不同，提供的函数库有差异：",-1)),s[32]||(s[32]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731144304990.png",alt:"image-20210731144304990",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[33]||(s[33]=h("p",null,"此时，如果将一个Ubuntu版本的MySQL应用安装到CentOS系统，MySQL在调用Ubuntu函数库时，会发现找不到或者不匹配，就会报错了：",-1)),s[34]||(s[34]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731144458680.png",alt:"image-20210731144458680",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[35]||(s[35]=h("p",null,"Docker如何解决不同系统环境的问题？",-1)),s[36]||(s[36]=h("ul",null,[h("li",null,"Docker将用户程序与所需要调用的系统(比如Ubuntu)函数库一起打包"),h("li",null,"Docker运行到不同操作系统时，直接基于打包的函数库，借助于操作系统的Linux内核来运行")],-1)),s[37]||(s[37]=h("p",null,"如图：",-1)),s[38]||(s[38]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731144820638.png",alt:"image-20210731144820638",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[39]||(s[39]=h("h4",{id:"_1-1-4-小结",tabindex:"-1"},[r("1.1.4 小结 "),h("a",{class:"header-anchor",href:"#_1-1-4-小结","aria-label":'Permalink to "1.1.4 小结"'},"​")],-1)),s[40]||(s[40]=h("p",null,"Docker如何解决大型项目依赖关系复杂，不同组件依赖的兼容性问题？",-1)),s[41]||(s[41]=h("ul",null,[h("li",null,[r("Docker允许开发中将应用、依赖、函数库、配置一起"),h("strong",null,"打包"),r("，形成可移植镜像")]),h("li",null,[r("Docker应用运行在容器中，使用沙箱机制，相互"),h("strong",null,"隔离")])],-1)),s[42]||(s[42]=h("p",null,"Docker如何解决开发、测试、生产环境有差异的问题？",-1)),s[43]||(s[43]=h("ul",null,[h("li",null,"Docker镜像中包含完整运行环境，包括系统函数库，仅依赖系统的Linux内核，因此可以在任意Linux操作系统上运行")],-1)),s[44]||(s[44]=h("p",null,"Docker是一个快速交付应用、运行应用的技术，具备下列优势：",-1)),s[45]||(s[45]=h("ul",null,[h("li",null,"可以将程序及其依赖、运行环境一起打包为一个镜像，可以迁移到任意Linux操作系统"),h("li",null,"运行时利用沙箱机制形成隔离容器，各个应用互不干扰"),h("li",null,"启动、移除都可以通过一行命令完成，方便快捷")],-1)),s[46]||(s[46]=h("h3",{id:"_1-2-docker和虚拟机的区别",tabindex:"-1"},[r("1.2 Docker和虚拟机的区别 "),h("a",{class:"header-anchor",href:"#_1-2-docker和虚拟机的区别","aria-label":'Permalink to "1.2 Docker和虚拟机的区别"'},"​")],-1)),s[47]||(s[47]=h("p",null,"Docker可以让一个应用在任何操作系统中非常方便的运行。而以前我们接触的虚拟机，也能在一个操作系统中，运行另外一个操作系统，保护系统中的任何应用。",-1)),s[48]||(s[48]=h("p",null,"两者有什么差异呢？",-1)),s[49]||(s[49]=h("p",null,[h("strong",null,"虚拟机"),r("（virtual machine）是在操作系统中"),h("strong",null,"模拟"),r("硬件设备，然后运行另一个操作系统，比如在 Windows 系统里面运行 Ubuntu 系统，这样就可以运行任意的Ubuntu应用了。")],-1)),s[50]||(s[50]=h("p",null,[h("strong",null,"Docker"),r("仅仅是封装函数库，并没有模拟完整的操作系统，如图：")],-1)),s[51]||(s[51]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731145914960.png",alt:"image-20210731145914960",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[52]||(s[52]=h("p",null,"对比来看：",-1)),s[53]||(s[53]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731152243765.png",alt:"image-20210731152243765",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[54]||(s[54]=h("p",null,"小结：",-1)),s[55]||(s[55]=h("p",null,"Docker和虚拟机的差异：",-1)),s[56]||(s[56]=h("ul",null,[h("li",null,[h("p",null,"docker是一个系统进程；虚拟机是在操作系统中的操作系统")]),h("li",null,[h("p",null,"docker体积小、启动速度快、性能好；虚拟机体积大、启动速度慢、性能一般")])],-1)),s[57]||(s[57]=h("h3",{id:"_1-3-docker架构",tabindex:"-1"},[r("1.3 Docker架构 "),h("a",{class:"header-anchor",href:"#_1-3-docker架构","aria-label":'Permalink to "1.3 Docker架构"'},"​")],-1)),s[58]||(s[58]=h("h4",{id:"_1-3-1-镜像和容器",tabindex:"-1"},[r("1.3.1 镜像和容器 "),h("a",{class:"header-anchor",href:"#_1-3-1-镜像和容器","aria-label":'Permalink to "1.3.1 镜像和容器"'},"​")],-1)),s[59]||(s[59]=h("p",null,"Docker中有几个重要的概念：",-1)),s[60]||(s[60]=h("p",null,[h("strong",null,"镜像（Image）"),r("：Docker将应用程序及其所需的依赖、函数库、环境、配置等文件打包在一起，称为镜像。")],-1)),s[61]||(s[61]=h("p",null,[h("strong",null,"容器（Container）"),r("：镜像中的应用程序运行后形成的进程就是"),h("strong",null,"容器"),r("，只是Docker会给容器进程做隔离，对外不可见。")],-1)),s[62]||(s[62]=h("p",null,[r("一切应用最终都是代码组成，都是硬盘中的一个个的字节形成的"),h("strong",null,"文件"),r("。只有运行时，才会加载到内存，形成进程。")],-1)),s[63]||(s[63]=h("p",null,[r("而"),h("strong",null,"镜像"),r("，就是把一个应用在硬盘上的文件、及其运行环境、部分系统函数库文件一起打包形成的文件包。这个文件包是只读的。")],-1)),s[64]||(s[64]=h("p",null,[h("strong",null,"容器"),r("呢，就是将这些文件中编写的程序、函数加载到内存中允许，形成进程，只不过要隔离起来。因此一个镜像可以启动多次，形成多个容器进程。")],-1)),s[65]||(s[65]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731153059464.png",alt:"image-20210731153059464",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[66]||(s[66]=h("p",null,[r("例如你下载了一个QQ，如果我们将QQ在磁盘上的运行"),h("strong",null,"文件"),r("及其运行的操作系统依赖打包，形成QQ镜像。然后你可以启动多次，双开、甚至三开QQ，跟多个妹子聊天。")],-1)),s[67]||(s[67]=h("h4",{id:"_1-3-2-dockerhub",tabindex:"-1"},[r("1.3.2 DockerHub "),h("a",{class:"header-anchor",href:"#_1-3-2-dockerhub","aria-label":'Permalink to "1.3.2 DockerHub"'},"​")],-1)),s[68]||(s[68]=h("p",null,"开源应用程序非常多，打包这些应用往往是重复的劳动。为了避免这些重复劳动，人们就会将自己打包的应用镜像，例如Redis、MySQL镜像放到网络上，共享使用，就像GitHub的代码共享一样。",-1)),s[69]||(s[69]=h("ul",null,[h("li",null,[h("p",null,"DockerHub：DockerHub是一个官方的Docker镜像的托管平台。这样的平台称为Docker Registry。")]),h("li",null,[h("p",null,[r("国内也有类似于DockerHub 的公开服务，比如 "),h("a",{href:"https://c.163yun.com/hub",target:"_blank",rel:"noreferrer"},"网易云镜像服务"),r("、"),h("a",{href:"https://cr.console.aliyun.com/",target:"_blank",rel:"noreferrer"},"阿里云镜像库"),r("等。")])])],-1)),s[70]||(s[70]=h("p",null,"我们一方面可以将自己的镜像共享到DockerHub，另一方面也可以从DockerHub拉取镜像：",-1)),s[71]||(s[71]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731153743354.png",alt:"image-20210731153743354",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[72]||(s[72]=h("h4",{id:"_1-3-3-docker架构",tabindex:"-1"},[r("1.3.3 Docker架构 "),h("a",{class:"header-anchor",href:"#_1-3-3-docker架构","aria-label":'Permalink to "1.3.3 Docker架构"'},"​")],-1)),s[73]||(s[73]=h("p",null,"我们要使用Docker来操作镜像、容器，就必须要安装Docker。",-1)),s[74]||(s[74]=h("p",null,"Docker是一个CS架构的程序，由两部分组成：",-1)),s[75]||(s[75]=h("ul",null,[h("li",null,[h("p",null,"服务端(server)：Docker守护进程，负责处理Docker指令，管理镜像、容器等")]),h("li",null,[h("p",null,"客户端(client)：通过命令或RestAPI向Docker服务端发送指令。可以在本地或远程向服务端发送指令。")])],-1)),s[76]||(s[76]=h("p",null,"如图：",-1)),s[77]||(s[77]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731154257653.png",alt:"image-20210731154257653",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[78]||(s[78]=h("h4",{id:"_1-3-4-小结",tabindex:"-1"},[r("1.3.4 小结 "),h("a",{class:"header-anchor",href:"#_1-3-4-小结","aria-label":'Permalink to "1.3.4 小结"'},"​")],-1)),s[79]||(s[79]=h("blockquote",null,[h("ul",null,[h("li",null,[h("p",null,"镜像："),h("ul",null,[h("li",null,"将应用程序及其依赖、环境、配置打包在一起")])]),h("li",null,[h("p",null,"容器："),h("ul",null,[h("li",null,"镜像运行起来就是容器，一个镜像可以运行多个容器")])]),h("li",null,[h("p",null,"Docker结构："),h("ul",null,[h("li",null,[h("p",null,"服务端：接收命令或远程请求，操作镜像或容器"),h("p",null,"客户端：发送命令或者请求到Docker服务端")])])]),h("li",null,[h("p",null,"DockerHub："),h("ul",null,[h("li",null,"一个镜像托管的服务器，类似的还有阿里云镜像服务，统称为DockerRegistry")])])])],-1)),s[80]||(s[80]=h("h3",{id:"_1-4-安装docker",tabindex:"-1"},[r("1.4 安装Docker "),h("a",{class:"header-anchor",href:"#_1-4-安装docker","aria-label":'Permalink to "1.4 安装Docker"'},"​")],-1)),s[81]||(s[81]=h("p",null,"企业部署一般都是采用Linux操作系统，而其中又数CentOS发行版占比最多，因此我们在CentOS下安装Docker。",-1)),s[82]||(s[82]=h("p",null,"Docker 分为 CE 和 EE 两大版本。CE 即社区版（免费，支持周期 7 个月），EE 即企业版，强调安全，付费使用，支持周期 24 个月。",-1)),s[83]||(s[83]=h("p",null,[r("Docker CE 分为 "),h("code",null,"stable"),r(),h("code",null,"test"),r(" 和 "),h("code",null,"nightly"),r(" 三个更新频道。")],-1)),s[84]||(s[84]=h("p",null,[r("官方网站上有各种环境下的 "),h("a",{href:"https://docs.docker.com/install/",target:"_blank",rel:"noreferrer"},"安装指南"),r("，这里主要介绍 Docker CE 在 CentOS上的安装。")],-1)),s[85]||(s[85]=h("h4",{id:"centos安装docker",tabindex:"-1"},[r("CentOS安装Docker "),h("a",{class:"header-anchor",href:"#centos安装docker","aria-label":'Permalink to "CentOS安装Docker"'},"​")],-1)),s[86]||(s[86]=h("p",null,"Docker CE 支持 64 位版本 CentOS 7，并且要求内核版本不低于 3.10， CentOS 7 满足最低内核的要求，所以我们在CentOS 7安装Docker。",-1)),s[87]||(s[87]=h("h5",{id:"_1-卸载-可选",tabindex:"-1"},[r("1. 卸载（可选） "),h("a",{class:"header-anchor",href:"#_1-卸载-可选","aria-label":'Permalink to "1. 卸载（可选）"'},"​")],-1)),s[88]||(s[88]=h("p",null,"如果之前安装过旧版本的Docker，可以使用下面命令卸载：",-1)),s[89]||(s[89]=h("div",{class:"language-sh max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"sh"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"yum"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," remove"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," docker"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"                  docker-client"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"                  docker-client-latest"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"                  docker-common"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"                  docker-latest"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"                  docker-latest-logrotate"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"                  docker-logrotate"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"                  docker-selinux"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"                  docker-engine-selinux"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"                  docker-engine"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"                  docker-ce")])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[90]||(s[90]=h("h5",{id:"_2-安装docker",tabindex:"-1"},[r("2. 安装docker "),h("a",{class:"header-anchor",href:"#_2-安装docker","aria-label":'Permalink to "2. 安装docker"'},"​")],-1)),s[91]||(s[91]=h("p",null,"首先需要大家虚拟机联网，安装yum工具",-1)),s[92]||(s[92]=h("div",{class:"language-sh max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"sh"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"yum"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," install"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -y"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," yum-utils"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"           device-mapper-persistent-data"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"           lvm2"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --skip-broken")])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[93]||(s[93]=h("p",null,"然后更新本地镜像源：",-1)),s[94]||(s[94]=h("div",{class:"language-shell max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"shell"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 设置docker镜像源")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"yum-config-manager"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    --add-repo"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"    https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    ")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"sed"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -i"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 's/download.docker.com/mirrors.aliyun.com\\/docker-ce/g'"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /etc/yum.repos.d/docker-ce.repo")]),r("\n"),h("span",{class:"line"}),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"yum"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," makecache"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," fast")])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[95]||(s[95]=h("p",null,"然后输入命令：",-1)),s[96]||(s[96]=h("div",{class:"language-shell max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"shell"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"yum"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," install"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -y"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," docker-ce")])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[97]||(s[97]=h("p",null,"docker-ce为社区免费版本。稍等片刻，docker即可安装成功。",-1)),s[98]||(s[98]=h("h5",{id:"_3-启动docker",tabindex:"-1"},[r("3. 启动docker "),h("a",{class:"header-anchor",href:"#_3-启动docker","aria-label":'Permalink to "3. 启动docker"'},"​")],-1)),s[99]||(s[99]=h("p",null,"Docker应用需要用到各种端口，逐一去修改防火墙设置。非常麻烦，因此建议大家直接关闭防火墙！",-1)),s[100]||(s[100]=h("p",null,"启动docker前，一定要关闭防火墙后！！",-1)),s[101]||(s[101]=h("p",null,"启动docker前，一定要关闭防火墙后！！",-1)),s[102]||(s[102]=h("p",null,"启动docker前，一定要关闭防火墙后！！",-1)),s[103]||(s[103]=h("div",{class:"language-sh max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"sh"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 关闭")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"systemctl"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," stop"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," firewalld")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 禁止开机启动防火墙")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"systemctl"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," disable"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," firewalld")])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[104]||(s[104]=h("p",null,"通过命令启动docker：",-1)),s[105]||(s[105]=h("div",{class:"language-sh max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"sh"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"systemctl"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," start"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," docker"),h("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  # 启动docker服务")]),r("\n"),h("span",{class:"line"}),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"systemctl"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," stop"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," docker"),h("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  # 停止docker服务")]),r("\n"),h("span",{class:"line"}),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"systemctl"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," restart"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," docker"),h("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  # 重启docker服务")]),r("\n"),h("span",{class:"line"}),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"systemctl"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," enable"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," docker"),h("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," # 开机自启")])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[106]||(s[106]=h("p",null,"然后输入命令，可以查看docker版本：",-1)),s[107]||(s[107]=h("div",{class:"language-sh max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"sh"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -v")])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[108]||(s[108]=h("p",null,"如图：",-1)),s[109]||(s[109]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210418154704436.png",alt:"image-20210418154704436",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[110]||(s[110]=h("h5",{id:"_4-配置镜像加速",tabindex:"-1"},[r("4. 配置镜像加速 "),h("a",{class:"header-anchor",href:"#_4-配置镜像加速","aria-label":'Permalink to "4. 配置镜像加速"'},"​")],-1)),s[111]||(s[111]=h("p",null,"docker官方镜像仓库网速较差，我们需要设置国内镜像服务：",-1)),s[112]||(s[112]=h("p",null,[r("参考阿里云的镜像加速文档："),h("a",{href:"https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors",target:"_blank",rel:"noreferrer"},"https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors")],-1)),s[113]||(s[113]=h("hr",null,null,-1)),s[114]||(s[114]=h("h2",{id:"_2-docker的基本操作",tabindex:"-1"},[r("2.Docker的基本操作 "),h("a",{class:"header-anchor",href:"#_2-docker的基本操作","aria-label":'Permalink to "2.Docker的基本操作"'},"​")],-1)),s[115]||(s[115]=h("h3",{id:"_2-1-镜像操作",tabindex:"-1"},[r("2.1.镜像操作 "),h("a",{class:"header-anchor",href:"#_2-1-镜像操作","aria-label":'Permalink to "2.1.镜像操作"'},"​")],-1)),s[116]||(s[116]=h("h4",{id:"_2-1-1-镜像名称",tabindex:"-1"},[r("2.1.1 镜像名称 "),h("a",{class:"header-anchor",href:"#_2-1-1-镜像名称","aria-label":'Permalink to "2.1.1 镜像名称"'},"​")],-1)),s[117]||(s[117]=h("p",null,"首先来看下镜像的名称组成：",-1)),s[118]||(s[118]=h("ul",null,[h("li",null,"镜名称一般分两部分组成：[repository]:[tag]。"),h("li",null,"在没有指定tag时，默认是latest，代表最新版本的镜像")],-1)),s[119]||(s[119]=h("p",null,"如图：",-1)),s[120]||(s[120]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731155141362.png",alt:"image-20210731155141362",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[121]||(s[121]=h("p",null,"这里的mysql就是repository，5.7就是tag，合一起就是镜像名称，代表5.7版本的MySQL镜像。",-1)),s[122]||(s[122]=h("h4",{id:"_2-1-2-镜像命令",tabindex:"-1"},[r("2.1.2 镜像命令 "),h("a",{class:"header-anchor",href:"#_2-1-2-镜像命令","aria-label":'Permalink to "2.1.2 镜像命令"'},"​")],-1)),s[123]||(s[123]=h("p",null,"常见的镜像操作命令如图：",-1)),s[124]||(s[124]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731155649535.png",alt:"image-20210731155649535",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[125]||(s[125]=h("h4",{id:"_2-1-3-案例1-拉取、查看镜像",tabindex:"-1"},[r("2.1.3 案例1-拉取、查看镜像 "),h("a",{class:"header-anchor",href:"#_2-1-3-案例1-拉取、查看镜像","aria-label":'Permalink to "2.1.3 案例1-拉取、查看镜像"'},"​")],-1)),s[126]||(s[126]=h("p",null,"需求：从DockerHub中拉取一个nginx镜像并查看",-1)),s[127]||(s[127]=h("p",null,[r("1）首先去镜像仓库搜索nginx镜像，比如"),h("a",{href:"https://hub.docker.com/",target:"_blank",rel:"noreferrer"},"DockerHub"),r(":")],-1)),s[128]||(s[128]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731155844368.png",alt:"image-20210731155844368",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[129]||(s[129]=h("p",null,"2）根据查看到的镜像名称，拉取自己需要的镜像，通过命令：docker pull nginx",-1)),s[130]||(s[130]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731155856199.png",alt:"image-20210731155856199",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[131]||(s[131]=h("p",null,"3）通过命令：docker images 查看拉取到的镜像",-1)),s[132]||(s[132]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731155903037.png",alt:"image-20210731155903037",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[133]||(s[133]=h("h4",{id:"_2-1-4-案例2-保存、导入镜像",tabindex:"-1"},[r("2.1.4 案例2-保存、导入镜像 "),h("a",{class:"header-anchor",href:"#_2-1-4-案例2-保存、导入镜像","aria-label":'Permalink to "2.1.4 案例2-保存、导入镜像"'},"​")],-1)),s[134]||(s[134]=h("p",null,"需求：利用docker save将nginx镜像导出磁盘，然后再通过load加载回来",-1)),s[135]||(s[135]=h("p",null,"1）利用docker xx --help命令查看docker save和docker load的语法",-1)),s[136]||(s[136]=h("p",null,"例如，查看save命令用法，可以输入命令：",-1)),s[137]||(s[137]=h("div",{class:"language-sh max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"sh"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," save"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --help")])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[138]||(s[138]=h("p",null,"结果：",-1)),s[139]||(s[139]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731161104732.png",alt:"image-20210731161104732",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[140]||(s[140]=h("p",null,"命令格式：",-1)),s[141]||(s[141]=h("div",{class:"language-shell max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"shell"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," save"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -o"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," [保存的目标文件名称] [镜像名称]")])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[142]||(s[142]=h("p",null,"2）使用docker save导出镜像到磁盘",-1)),s[143]||(s[143]=h("p",null,"运行命令：",-1)),s[144]||(s[144]=h("div",{class:"language-sh max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"sh"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," save"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -o"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," nginx.tar"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," nginx:latest")])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[145]||(s[145]=h("p",null,"结果如图：",-1)),s[146]||(s[146]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731161354344.png",alt:"image-20210731161354344",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[147]||(s[147]=h("p",null,"3）使用docker load加载镜像",-1)),s[148]||(s[148]=h("p",null,"先删除本地的nginx镜像：",-1)),s[149]||(s[149]=h("div",{class:"language-sh max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"sh"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," rmi"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," nginx:latest")])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[150]||(s[150]=h("p",null,"然后运行命令，加载本地文件：",-1)),s[151]||(s[151]=h("div",{class:"language-sh max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"sh"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," load"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -i"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," nginx.tar")])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[152]||(s[152]=h("p",null,"结果：",-1)),s[153]||(s[153]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731161746245.png",alt:"image-20210731161746245",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[154]||(s[154]=h("h4",{id:"_2-1-5-练习",tabindex:"-1"},[r("2.1.5 练习 "),h("a",{class:"header-anchor",href:"#_2-1-5-练习","aria-label":'Permalink to "2.1.5 练习"'},"​")],-1)),s[155]||(s[155]=h("p",null,"需求：去DockerHub搜索并拉取一个Redis镜像",-1)),s[156]||(s[156]=h("p",null,"目标：",-1)),s[157]||(s[157]=h("p",null,"1）去DockerHub搜索Redis镜像",-1)),s[158]||(s[158]=h("p",null,"2）查看Redis镜像的名称和版本",-1)),s[159]||(s[159]=h("p",null,"3）利用docker pull命令拉取镜像",-1)),s[160]||(s[160]=h("p",null,"4）利用docker save命令将 redis:latest打包为一个redis.tar包",-1)),s[161]||(s[161]=h("p",null,"5）利用docker rmi 删除本地的redis:latest",-1)),s[162]||(s[162]=h("p",null,"6）利用docker load 重新加载 redis.tar文件",-1)),s[163]||(s[163]=h("h3",{id:"_2-2-容器操作",tabindex:"-1"},[r("2.2 容器操作 "),h("a",{class:"header-anchor",href:"#_2-2-容器操作","aria-label":'Permalink to "2.2 容器操作"'},"​")],-1)),s[164]||(s[164]=h("h4",{id:"_2-2-1-容器相关命令",tabindex:"-1"},[r("2.2.1 容器相关命令 "),h("a",{class:"header-anchor",href:"#_2-2-1-容器相关命令","aria-label":'Permalink to "2.2.1 容器相关命令"'},"​")],-1)),s[165]||(s[165]=h("p",null,"容器操作的命令如图：",-1)),s[166]||(s[166]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731161950495.png",alt:"image-20210731161950495",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[167]||(s[167]=h("p",null,"容器保护三个状态：",-1)),s[168]||(s[168]=h("ul",null,[h("li",null,"运行：进程正常运行"),h("li",null,"暂停：进程暂停，CPU不再运行，并不释放内存"),h("li",null,"停止：进程终止，回收进程占用的内存、CPU等资源")],-1)),s[169]||(s[169]=h("p",null,"其中：",-1)),s[170]||(s[170]=h("ul",null,[h("li",null,[h("p",null,"docker run：创建并运行一个容器，处于运行状态")]),h("li",null,[h("p",null,"docker pause：让一个运行的容器暂停")]),h("li",null,[h("p",null,"docker unpause：让一个容器从暂停状态恢复运行")]),h("li",null,[h("p",null,"docker stop：停止一个运行的容器")]),h("li",null,[h("p",null,"docker start：让一个停止的容器再次运行")]),h("li",null,[h("p",null,"docker rm：删除一个容器")])],-1)),s[171]||(s[171]=h("h4",{id:"_2-2-2-案例-创建并运行一个容器",tabindex:"-1"},[r("2.2.2 案例-创建并运行一个容器 "),h("a",{class:"header-anchor",href:"#_2-2-2-案例-创建并运行一个容器","aria-label":'Permalink to "2.2.2 案例-创建并运行一个容器"'},"​")],-1)),s[172]||(s[172]=h("p",null,"创建并运行nginx容器的命令：",-1)),s[173]||(s[173]=h("div",{class:"language-sh max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"sh"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," run"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --name"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," containerName"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -p"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 80:80"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -d"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," nginx")])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[174]||(s[174]=h("p",null,"命令解读：",-1)),s[175]||(s[175]=h("ul",null,[h("li",null,"docker run ：创建并运行一个容器"),h("li",null,"–name : 给容器起一个名字，比如叫做mn"),h("li",null,"-p ：将宿主机端口与容器端口映射，冒号左侧是宿主机端口，右侧是容器端口"),h("li",null,"-d：后台运行容器"),h("li",null,"nginx：镜像名称，例如nginx")],-1)),s[176]||(s[176]=h("p",null,[r("这里的"),h("code",null,"-p"),r("参数，是将容器端口映射到宿主机端口。")],-1)),s[177]||(s[177]=h("p",null,"默认情况下，容器是隔离环境，我们直接访问宿主机的80端口，肯定访问不到容器中的nginx。",-1)),s[178]||(s[178]=h("p",null,"现在，将容器的80与宿主机的80关联起来，当我们访问宿主机的80端口时，就会被映射到容器的80，这样就能访问到nginx了：",-1)),s[179]||(s[179]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731163255863.png",alt:"image-20210731163255863",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[180]||(s[180]=h("h4",{id:"_2-2-3-案例-进入容器-修改文件",tabindex:"-1"},[r("2.2.3 案例-进入容器，修改文件 "),h("a",{class:"header-anchor",href:"#_2-2-3-案例-进入容器-修改文件","aria-label":'Permalink to "2.2.3 案例-进入容器，修改文件"'},"​")],-1)),s[181]||(s[181]=h("p",null,[h("strong",null,"需求"),r("：进入Nginx容器，修改HTML文件内容，添加“传智教育欢迎您”")],-1)),s[182]||(s[182]=h("p",null,[h("strong",null,"提示"),r("：进入容器要用到docker exec命令。")],-1)),s[183]||(s[183]=h("p",null,[h("strong",null,"步骤"),r("：")],-1)),s[184]||(s[184]=h("p",null,"1）进入容器。进入我们刚刚创建的nginx容器的命令为：",-1)),s[185]||(s[185]=h("div",{class:"language-sh max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"sh"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," exec"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -it"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," mn"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," bash")])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[186]||(s[186]=h("p",null,"命令解读：",-1)),s[187]||(s[187]=h("ul",null,[h("li",null,[h("p",null,"docker exec ：进入容器内部，执行一个命令")]),h("li",null,[h("p",null,"-it : 给当前进入的容器创建一个标准输入、输出终端，允许我们与容器交互")]),h("li",null,[h("p",null,"mn ：要进入的容器的名称")]),h("li",null,[h("p",null,"bash：进入容器后执行的命令，bash是一个linux终端交互命令")])],-1)),s[188]||(s[188]=h("p",null,"2）进入nginx的HTML所在目录 /usr/share/nginx/html",-1)),s[189]||(s[189]=h("p",null,"容器内部会模拟一个独立的Linux文件系统，看起来如同一个linux服务器一样：",-1)),s[190]||(s[190]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731164159811.png",alt:"image-20210731164159811",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[191]||(s[191]=h("p",null,"nginx的环境、配置、运行文件全部都在这个文件系统中，包括我们要修改的html文件。",-1)),s[192]||(s[192]=h("p",null,[r("查看DockerHub网站中的nginx页面，可以知道nginx的html目录位置在"),h("code",null,"/usr/share/nginx/html")],-1)),s[193]||(s[193]=h("p",null,"我们执行命令，进入该目录：",-1)),s[194]||(s[194]=h("div",{class:"language-sh max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"sh"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"cd"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /usr/share/nginx/html")])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[195]||(s[195]=h("p",null,"查看目录下文件：",-1)),s[196]||(s[196]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731164455818.png",alt:"image-20210731164455818",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[197]||(s[197]=h("p",null,"3）修改index.html的内容",-1)),s[198]||(s[198]=h("p",null,"容器内没有vi命令，无法直接修改，我们用下面的命令来修改：",-1)),s[199]||(s[199]=h("div",{class:"language-sh max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"sh"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"sed"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -i"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -e"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 's#Welcome to nginx#传智教育欢迎您#g'"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -e"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 's#<head>#<head><meta charset=\"utf-8\">#g'"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," index.html")])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[200]||(s[200]=h("p",null,[r("在浏览器访问自己的虚拟机地址，例如我的是："),h("a",{href:"http://192.168.150.101",target:"_blank",rel:"noreferrer"},"http://192.168.150.101"),r("，即可看到结果：")],-1)),s[201]||(s[201]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731164717604.png",alt:"image-20210731164717604",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[202]||(s[202]=h("h4",{id:"_2-2-4-小结",tabindex:"-1"},[r("2.2.4 小结 "),h("a",{class:"header-anchor",href:"#_2-2-4-小结","aria-label":'Permalink to "2.2.4 小结"'},"​")],-1)),s[203]||(s[203]=h("p",null,"docker run命令的常见参数有哪些？",-1)),s[204]||(s[204]=h("ul",null,[h("li",null,"–name：指定容器名称"),h("li",null,"-p：指定端口映射"),h("li",null,"-d：让容器后台运行")],-1)),s[205]||(s[205]=h("p",null,"查看容器日志的命令：",-1)),s[206]||(s[206]=h("ul",null,[h("li",null,"docker logs"),h("li",null,"添加 -f 参数可以持续查看日志")],-1)),s[207]||(s[207]=h("p",null,"查看容器状态：",-1)),s[208]||(s[208]=h("ul",null,[h("li",null,"docker ps"),h("li",null,"docker ps -a 查看所有容器，包括已经停止的")],-1)),s[209]||(s[209]=h("h3",{id:"_2-3-数据卷-容器数据管理",tabindex:"-1"},[r("2.3 数据卷（容器数据管理） "),h("a",{class:"header-anchor",href:"#_2-3-数据卷-容器数据管理","aria-label":'Permalink to "2.3 数据卷（容器数据管理）"'},"​")],-1)),s[210]||(s[210]=h("p",null,"在之前的nginx案例中，修改nginx的html页面时，需要进入nginx内部。并且因为没有编辑器，修改文件也很麻烦。",-1)),s[211]||(s[211]=h("p",null,"这就是因为容器与数据（容器内文件）耦合带来的后果。",-1)),s[212]||(s[212]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731172440275.png",alt:"image-20210731172440275",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[213]||(s[213]=h("p",null,"要解决这个问题，必须将数据与容器解耦，这就要用到数据卷了。",-1)),s[214]||(s[214]=h("h4",{id:"_2-3-1-什么是数据卷",tabindex:"-1"},[r("2.3.1 什么是数据卷 "),h("a",{class:"header-anchor",href:"#_2-3-1-什么是数据卷","aria-label":'Permalink to "2.3.1 什么是数据卷"'},"​")],-1)),s[215]||(s[215]=h("p",null,"**数据卷（volume）**是一个虚拟目录，指向宿主机文件系统中的某个目录。",-1)),s[216]||(s[216]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731173541846.png",alt:"image-20210731173541846",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[217]||(s[217]=h("p",null,"一旦完成数据卷挂载，对容器的一切操作都会作用在数据卷对应的宿主机目录了。",-1)),s[218]||(s[218]=h("p",null,"这样，我们操作宿主机的/var/lib/docker/volumes/html目录，就等于操作容器内的/usr/share/nginx/html目录了",-1)),s[219]||(s[219]=h("h4",{id:"_2-3-2-数据集操作命令",tabindex:"-1"},[r("2.3.2 数据集操作命令 "),h("a",{class:"header-anchor",href:"#_2-3-2-数据集操作命令","aria-label":'Permalink to "2.3.2 数据集操作命令"'},"​")],-1)),s[220]||(s[220]=h("p",null,"数据卷操作的基本语法如下：",-1)),s[221]||(s[221]=h("div",{class:"language-sh max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"sh"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," volume"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," [COMMAND]")])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[222]||(s[222]=h("p",null,"docker volume命令是数据卷操作，根据命令后跟随的command来确定下一步的操作：",-1)),s[223]||(s[223]=h("ul",null,[h("li",null,"create 创建一个volume"),h("li",null,"inspect 显示一个或多个volume的信息"),h("li",null,"ls 列出所有的volume"),h("li",null,"prune 删除未使用的volume"),h("li",null,"rm 删除一个或多个指定的volume")],-1)),s[224]||(s[224]=h("h4",{id:"_2-3-3-创建和查看数据卷",tabindex:"-1"},[r("2.3.3 创建和查看数据卷 "),h("a",{class:"header-anchor",href:"#_2-3-3-创建和查看数据卷","aria-label":'Permalink to "2.3.3 创建和查看数据卷"'},"​")],-1)),s[225]||(s[225]=h("p",null,[h("strong",null,"需求"),r("：创建一个数据卷，并查看数据卷在宿主机的目录位置")],-1)),s[226]||(s[226]=h("p",null,"① 创建数据卷",-1)),s[227]||(s[227]=h("div",{class:"language-sh max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"sh"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," volume"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," create"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," html")])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[228]||(s[228]=h("p",null,"② 查看所有数据",-1)),s[229]||(s[229]=h("div",{class:"language-sh max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"sh"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," volume"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ls")])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[230]||(s[230]=h("p",null,"结果：",-1)),s[231]||(s[231]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731173746910.png",alt:"image-20210731173746910",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[232]||(s[232]=h("p",null,"③ 查看数据卷详细信息卷",-1)),s[233]||(s[233]=h("div",{class:"language-sh max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"sh"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," volume"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," inspect"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," html")])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[234]||(s[234]=h("p",null,"结果：",-1)),s[235]||(s[235]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731173809877.png",alt:"image-20210731173809877",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[236]||(s[236]=h("p",null,[r("可以看到，我们创建的html这个数据卷关联的宿主机目录为"),h("code",null,"/var/lib/docker/volumes/html/_data"),r("目录。")],-1)),s[237]||(s[237]=h("p",null,[h("strong",null,"小结"),r("：")],-1)),s[238]||(s[238]=h("p",null,"数据卷的作用：",-1)),s[239]||(s[239]=h("ul",null,[h("li",null,"将容器与数据分离，解耦合，方便操作容器内数据，保证数据安全")],-1)),s[240]||(s[240]=h("p",null,"数据卷操作：",-1)),s[241]||(s[241]=h("ul",null,[h("li",null,"docker volume create：创建数据卷"),h("li",null,"docker volume ls：查看所有数据卷"),h("li",null,"docker volume inspect：查看数据卷详细信息，包括关联的宿主机目录位置"),h("li",null,"docker volume rm：删除指定数据卷"),h("li",null,"docker volume prune：删除所有未使用的数据卷")],-1)),s[242]||(s[242]=h("h4",{id:"_2-3-4-挂载数据卷",tabindex:"-1"},[r("2.3.4 挂载数据卷 "),h("a",{class:"header-anchor",href:"#_2-3-4-挂载数据卷","aria-label":'Permalink to "2.3.4 挂载数据卷"'},"​")],-1)),s[243]||(s[243]=h("p",null,"我们在创建容器时，可以通过 -v 参数来挂载一个数据卷到某个容器内目录，命令格式如下：",-1)),s[244]||(s[244]=h("div",{class:"language-sh max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"sh"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," run"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"  --name"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," mn"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"  -v"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," html:/root/html"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"  -p"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 8080:80")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  nginx"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[245]||(s[245]=h("p",null,"这里的-v就是挂载数据卷的命令：",-1)),s[246]||(s[246]=h("ul",null,[h("li",null,[h("code",null,"-v html:/root/htm"),r(" ：把html数据卷挂载到容器内的/root/html这个目录中")])],-1)),s[247]||(s[247]=h("h4",{id:"_2-3-5-案例-给nginx挂载数据卷",tabindex:"-1"},[r("2.3.5 案例-给nginx挂载数据卷 "),h("a",{class:"header-anchor",href:"#_2-3-5-案例-给nginx挂载数据卷","aria-label":'Permalink to "2.3.5 案例-给nginx挂载数据卷"'},"​")],-1)),s[248]||(s[248]=h("p",null,[h("strong",null,"需求"),r("：创建一个nginx容器，修改容器内的html目录内的index.html内容")],-1)),s[249]||(s[249]=h("p",null,[h("strong",null,"分析"),r("：上个案例中，我们进入nginx容器内部，已经知道nginx的html目录所在位置/usr/share/nginx/html ，我们需要把这个目录挂载到html这个数据卷上，方便操作其中的内容。")],-1)),s[250]||(s[250]=h("p",null,[h("strong",null,"提示"),r("：运行容器时使用 -v 参数挂载数据卷")],-1)),s[251]||(s[251]=h("p",null,"步骤：",-1)),s[252]||(s[252]=h("p",null,"① 创建容器并挂载数据卷到容器内的HTML目录",-1)),s[253]||(s[253]=h("div",{class:"language-sh max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"sh"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," run"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --name"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," mn"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -v"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," html:/usr/share/nginx/html"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -p"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 80:80"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -d"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," nginx")])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[254]||(s[254]=h("p",null,"② 进入html数据卷所在位置，并修改HTML内容",-1)),s[255]||(s[255]=h("div",{class:"language-sh max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"sh"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 查看html数据卷的位置")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," volume"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," inspect"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," html")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 进入该目录")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"cd"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /var/lib/docker/volumes/html/_data")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 修改文件")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"vi"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," index.html")])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[256]||(s[256]=h("h4",{id:"_2-3-6-案例-给mysql挂载本地目录",tabindex:"-1"},[r("2.3.6 案例-给MySQL挂载本地目录 "),h("a",{class:"header-anchor",href:"#_2-3-6-案例-给mysql挂载本地目录","aria-label":'Permalink to "2.3.6 案例-给MySQL挂载本地目录"'},"​")],-1)),s[257]||(s[257]=h("p",null,"容器不仅仅可以挂载数据卷，也可以直接挂载到宿主机目录上。关联关系如下：",-1)),s[258]||(s[258]=h("ul",null,[h("li",null,"带数据卷模式：宿主机目录 --\x3e 数据卷 —> 容器内目录"),h("li",null,"直接挂载模式：宿主机目录 —> 容器内目录")],-1)),s[259]||(s[259]=h("p",null,"如图：",-1)),s[260]||(s[260]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731175155453.png",alt:"image-20210731175155453",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[261]||(s[261]=h("p",null,[h("strong",null,"语法"),r("：")],-1)),s[262]||(s[262]=h("p",null,"目录挂载与数据卷挂载的语法是类似的：",-1)),s[263]||(s[263]=h("ul",null,[h("li",null,"-v [宿主机目录]:[容器内目录]"),h("li",null,"-v [宿主机文件]:[容器内文件]")],-1)),s[264]||(s[264]=h("p",null,[h("strong",null,"需求"),r("：创建并运行一个MySQL容器，将宿主机目录直接挂载到容器")],-1)),s[265]||(s[265]=h("p",null,"实现思路如下：",-1)),s[266]||(s[266]=h("p",null,"1）在将课前资料中的mysql.tar文件上传到虚拟机，通过load命令加载为镜像",-1)),s[267]||(s[267]=h("p",null,"2）创建目录/tmp/mysql/data",-1)),s[268]||(s[268]=h("p",null,"3）创建目录/tmp/mysql/conf，将课前资料提供的hmy.cnf文件上传到/tmp/mysql/conf",-1)),s[269]||(s[269]=h("p",null,"4）去DockerHub查阅资料，创建并运行MySQL容器，要求：",-1)),s[270]||(s[270]=h("p",null,"① 挂载/tmp/mysql/data到mysql容器内数据存储目录",-1)),s[271]||(s[271]=h("p",null,"② 挂载/tmp/mysql/conf/hmy.cnf到mysql容器的配置文件",-1)),s[272]||(s[272]=h("p",null,"③ 设置MySQL密码",-1)),s[273]||(s[273]=h("h4",{id:"_2-3-7-小结",tabindex:"-1"},[r("2.3.7 小结 "),h("a",{class:"header-anchor",href:"#_2-3-7-小结","aria-label":'Permalink to "2.3.7 小结"'},"​")],-1)),s[274]||(s[274]=h("p",null,"docker run的命令中通过 -v 参数挂载文件或目录到容器中：",-1)),s[275]||(s[275]=h("ul",null,[h("li",null,"-v volume名称:容器内目录"),h("li",null,"-v 宿主机文件:容器内文"),h("li",null,"-v 宿主机目录:容器内目录")],-1)),s[276]||(s[276]=h("p",null,"数据卷挂载与目录直接挂载的",-1)),s[277]||(s[277]=h("ul",null,[h("li",null,"数据卷挂载耦合度低，由docker来管理目录，但是目录较深，不好找"),h("li",null,"目录挂载耦合度高，需要我们自己管理目录，不过目录容易寻找查看")],-1)),s[278]||(s[278]=h("hr",null,null,-1)),s[279]||(s[279]=h("h2",{id:"_3-dockerfile自定义镜像",tabindex:"-1"},[r("3. Dockerfile自定义镜像 "),h("a",{class:"header-anchor",href:"#_3-dockerfile自定义镜像","aria-label":'Permalink to "3. Dockerfile自定义镜像"'},"​")],-1)),s[280]||(s[280]=h("p",null,"常见的镜像在DockerHub就能找到，但是我们自己写的项目就必须自己构建镜像了。",-1)),s[281]||(s[281]=h("p",null,"而要自定义镜像，就必须先了解镜像的结构才行。",-1)),s[282]||(s[282]=h("h3",{id:"_3-1-镜像结构",tabindex:"-1"},[r("3.1 镜像结构 "),h("a",{class:"header-anchor",href:"#_3-1-镜像结构","aria-label":'Permalink to "3.1 镜像结构"'},"​")],-1)),s[283]||(s[283]=h("p",null,"镜像是将应用程序及其需要的系统函数库、环境、配置、依赖打包而成。",-1)),s[284]||(s[284]=h("p",null,"我们以MySQL为例，来看看镜像的组成结构：",-1)),s[285]||(s[285]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731175806273.png",alt:"image-20210731175806273",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[286]||(s[286]=h("p",null,"简单来说，镜像就是在系统函数库、运行环境基础上，添加应用程序文件、配置文件、依赖文件等组合，然后编写好启动脚本打包在一起形成的文件。",-1)),s[287]||(s[287]=h("p",null,"我们要构建镜像，其实就是实现上述打包的过程。",-1)),s[288]||(s[288]=h("h3",{id:"_3-2-dockerfile语法",tabindex:"-1"},[r("3.2 Dockerfile语法 "),h("a",{class:"header-anchor",href:"#_3-2-dockerfile语法","aria-label":'Permalink to "3.2 Dockerfile语法"'},"​")],-1)),s[289]||(s[289]=h("p",null,"构建自定义的镜像时，并不需要一个个文件去拷贝，打包。",-1)),s[290]||(s[290]=h("p",null,"我们只需要告诉Docker，我们的镜像的组成，需要哪些BaseImage、需要拷贝什么文件、需要安装什么依赖、启动脚本是什么，将来Docker会帮助我们构建镜像。",-1)),s[291]||(s[291]=h("p",null,"而描述上述信息的文件就是Dockerfile文件。",-1)),s[292]||(s[292]=h("p",null,[h("strong",null,"Dockerfile"),r("就是一个文本文件，其中包含一个个的"),h("strong",null,"指令(Instruction)"),r("，用指令来说明要执行什么操作来构建镜像。每一个指令都会形成一层Layer。")],-1)),s[293]||(s[293]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731180321133.png",alt:"image-20210731180321133",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[294]||(s[294]=h("p",null,[r("更新详细语法说明，请参考官网文档： "),h("a",{href:"https://docs.docker.com/engine/reference/builder",target:"_blank",rel:"noreferrer"},"https://docs.docker.com/engine/reference/builder")],-1)),s[295]||(s[295]=h("h3",{id:"_3-3-构建java项目",tabindex:"-1"},[r("3.3 构建Java项目 "),h("a",{class:"header-anchor",href:"#_3-3-构建java项目","aria-label":'Permalink to "3.3 构建Java项目"'},"​")],-1)),s[296]||(s[296]=h("h4",{id:"_3-3-1-基于ubuntu构建java项目",tabindex:"-1"},[r("3.3.1 基于Ubuntu构建Java项目 "),h("a",{class:"header-anchor",href:"#_3-3-1-基于ubuntu构建java项目","aria-label":'Permalink to "3.3.1 基于Ubuntu构建Java项目"'},"​")],-1)),s[297]||(s[297]=h("p",null,"需求：基于Ubuntu镜像构建一个新镜像，运行一个java项目",-1)),s[298]||(s[298]=h("ul",null,[h("li",null,[h("p",null,"步骤1：新建一个空文件夹docker-demo"),h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210801101207444.png",alt:"image-20210801101207444",loading:"lazy",decoding:"async",class:"lazy"})])]),h("li",null,[h("p",null,"步骤2：拷贝课前资料中的docker-demo.jar文件到docker-demo这个目录"),h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210801101314816.png",alt:"image-20210801101314816",loading:"lazy",decoding:"async",class:"lazy"})])]),h("li",null,[h("p",null,"步骤3：拷贝课前资料中的jdk8.tar.gz文件到docker-demo这个目录"),h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210801101410200.png",alt:"image-20210801101410200",loading:"lazy",decoding:"async",class:"lazy"})])]),h("li",null,[h("p",null,"步骤4：拷贝课前资料提供的Dockerfile到docker-demo这个目录"),h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210801101455590.png",alt:"image-20210801101455590",loading:"lazy",decoding:"async",class:"lazy"})]),h("p",null,"其中的内容如下："),h("div",{class:"language-dockerfile max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"dockerfile"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 指定基础镜像")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"FROM"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ubuntu:16.04")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 配置环境变量，JDK的安装目录")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ENV"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," JAVA_DIR=/usr/local")]),r("\n"),h("span",{class:"line"}),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 拷贝jdk和java项目的包")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"COPY"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ./jdk8.tar.gz $JAVA_DIR/")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"COPY"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ./docker-demo.jar /tmp/app.jar")]),r("\n"),h("span",{class:"line"}),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 安装JDK")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RUN"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," cd $JAVA_DIR \\")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," && tar -xf ./jdk8.tar.gz \\")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," && mv ./jdk1.8.0_144 ./java8")]),r("\n"),h("span",{class:"line"}),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 配置环境变量")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ENV"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," JAVA_HOME=$JAVA_DIR/java8")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ENV"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," PATH=$PATH:$JAVA_HOME/bin")]),r("\n"),h("span",{class:"line"}),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 暴露端口")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"EXPOSE"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," 8090")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 入口，java项目的启动命令")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ENTRYPOINT"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," java -jar /tmp/app.jar")])])]),h("button",{class:"code-block-unfold-btn"})])]),h("li",null,[h("p",null,"步骤5：进入docker-demo"),h("p",null,"将准备好的docker-demo上传到虚拟机任意目录，然后进入docker-demo目录下")]),h("li",null,[h("p",null,"步骤6：运行命令："),h("div",{class:"language-sh max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"sh"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," build"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -t"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," javaweb:1.0"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," .")])])]),h("button",{class:"code-block-unfold-btn"})])])],-1)),s[299]||(s[299]=h("p",null,[r("最后访问 "),h("a",{href:"http://192.168.150.101:8090/hello/count%EF%BC%8C%E5%85%B6%E4%B8%AD%E7%9A%84ip%E6%94%B9%E6%88%90%E4%BD%A0%E7%9A%84%E8%99%9A%E6%8B%9F%E6%9C%BAip",target:"_blank",rel:"noreferrer"},"http://192.168.150.101:8090/hello/count，其中的ip改成你的虚拟机ip")],-1)),s[300]||(s[300]=h("h4",{id:"_3-3-2-基于java8构建java项目",tabindex:"-1"},[r("3.3.2 基于java8构建Java项目 "),h("a",{class:"header-anchor",href:"#_3-3-2-基于java8构建java项目","aria-label":'Permalink to "3.3.2 基于java8构建Java项目"'},"​")],-1)),s[301]||(s[301]=h("p",null,"虽然我们可以基于Ubuntu基础镜像，添加任意自己需要的安装包，构建镜像，但是却比较麻烦。所以大多数情况下，我们都可以在一些安装了部分软件的基础镜像上做改造。",-1)),s[302]||(s[302]=h("p",null,"例如，构建java项目的镜像，可以在已经准备了JDK的基础镜像基础上构建。",-1)),s[303]||(s[303]=h("p",null,"需求：基于java:8-alpine镜像，将一个Java项目构建为镜像",-1)),s[304]||(s[304]=h("p",null,"实现思路如下：",-1)),s[305]||(s[305]=h("ul",null,[h("li",null,[h("p",null,"① 新建一个空的目录，然后在目录中新建一个文件，命名为Dockerfile")]),h("li",null,[h("p",null,"② 拷贝课前资料提供的docker-demo.jar到这个目录中")]),h("li",null,[h("p",null,"③ 编写Dockerfile文件："),h("ul",null,[h("li",null,[h("p",null,"a ）基于java:8-alpine作为基础镜像")]),h("li",null,[h("p",null,"b ）将app.jar拷贝到镜像中")]),h("li",null,[h("p",null,"c ）暴露端口")]),h("li",null,[h("p",null,"d ）编写入口ENTRYPOINT"),h("p",null,"内容如下："),h("div",{class:"language-dockerfile max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"dockerfile"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"FROM"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," java:8-alpine")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"COPY"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ./app.jar /tmp/app.jar")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"EXPOSE"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," 8090")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ENTRYPOINT"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," java -jar /tmp/app.jar")])])]),h("button",{class:"code-block-unfold-btn"})])])])]),h("li",null,[h("p",null,"④ 使用docker build命令构建镜像")]),h("li",null,[h("p",null,"⑤ 使用docker run创建容器并运行")])],-1)),s[306]||(s[306]=h("h3",{id:"_3-4-小结",tabindex:"-1"},[r("3.4 小结 "),h("a",{class:"header-anchor",href:"#_3-4-小结","aria-label":'Permalink to "3.4 小结"'},"​")],-1)),s[307]||(s[307]=h("blockquote",null,[h("ol",null,[h("li",null,[h("p",null,"Dockerfile的本质是一个文件，通过指令描述镜像的构建过程")]),h("li",null,[h("p",null,"Dockerfile的第一行必须是FROM，从一个基础镜像来构建")]),h("li",null,[h("p",null,"基础镜像可以是基本操作系统，如Ubuntu。也可以是其他人制作好的镜像，例如：java:8-alpine")])])],-1)),s[308]||(s[308]=h("hr",null,null,-1)),s[309]||(s[309]=h("h2",{id:"_4-docker-compose",tabindex:"-1"},[r("4. Docker-Compose "),h("a",{class:"header-anchor",href:"#_4-docker-compose","aria-label":'Permalink to "4. Docker-Compose"'},"​")],-1)),s[310]||(s[310]=h("p",null,"Docker Compose可以基于Compose文件帮我们快速的部署分布式应用，而无需手动一个个创建和运行容器！",-1)),s[311]||(s[311]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731180921742.png",alt:"image-20210731180921742",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[312]||(s[312]=h("h3",{id:"_4-1-初识dockercompose",tabindex:"-1"},[r("4.1 初识DockerCompose "),h("a",{class:"header-anchor",href:"#_4-1-初识dockercompose","aria-label":'Permalink to "4.1 初识DockerCompose"'},"​")],-1)),s[313]||(s[313]=h("p",null,"Compose文件是一个文本文件，通过指令定义集群中的每个容器如何运行。格式如下：",-1)),s[314]||(s[314]=h("div",{class:"language-json max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"json"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"version: "),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"3.8"')]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," services:")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  mysql:")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    image: mysql:"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"5.7"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"25")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    environment:")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"     MYSQL_ROOT_PASSWORD: "),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"123"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    volumes:")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"     - "),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/tmp/mysql/data:/var/lib/mysql"')]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"     - "),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/tmp/mysql/conf/hmy.cnf:/etc/mysql/conf.d/hmy.cnf"')]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  web:")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    build: .")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    ports:")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"     - "),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"8090:8090"')])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[315]||(s[315]=h("p",null,"上面的Compose文件就描述一个项目，其中包含两个容器：",-1)),s[316]||(s[316]=h("ul",null,[h("li",null,[r("mysql：一个基于"),h("code",null,"mysql:5.7.25"),r("镜像构建的容器，并且挂载了两个目录")]),h("li",null,[r("web：一个基于"),h("code",null,"docker build"),r("临时构建的镜像容器，映射端口时8090")])],-1)),s[317]||(s[317]=h("p",null,[r("DockerCompose的详细语法参考官网："),h("a",{href:"https://docs.docker.com/compose/compose-file/",target:"_blank",rel:"noreferrer"},"https://docs.docker.com/compose/compose-file/")],-1)),s[318]||(s[318]=h("p",null,"其实DockerCompose文件可以看做是将多个docker run命令写到一个文件，只是语法稍有差异。",-1)),s[319]||(s[319]=h("h3",{id:"_4-2-安装dockercompose",tabindex:"-1"},[r("4.2 安装DockerCompose "),h("a",{class:"header-anchor",href:"#_4-2-安装dockercompose","aria-label":'Permalink to "4.2 安装DockerCompose"'},"​")],-1)),s[320]||(s[320]=h("h4",{id:"centos7安装dockercompose",tabindex:"-1"},[r("CentOS7安装DockerCompose "),h("a",{class:"header-anchor",href:"#centos7安装dockercompose","aria-label":'Permalink to "CentOS7安装DockerCompose"'},"​")],-1)),s[321]||(s[321]=h("h5",{id:"_1-下载",tabindex:"-1"},[r("1. 下载 "),h("a",{class:"header-anchor",href:"#_1-下载","aria-label":'Permalink to "1. 下载"'},"​")],-1)),s[322]||(s[322]=h("p",null,"Linux下需要通过命令下载：",-1)),s[323]||(s[323]=h("div",{class:"language-sh max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"sh"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 安装")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"curl"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -L"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," https://github.com/docker/compose/releases/download/1.23.1/docker-compose-`"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"uname"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -s"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"`"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"-"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"`"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"uname"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -m"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"`"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," >"),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," /usr/local/bin/docker-compose")])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[324]||(s[324]=h("p",null,"如果下载速度较慢，或者下载失败，可以使用课前资料提供的docker-compose文件：",-1)),s[325]||(s[325]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210417133020614.png",alt:"image-20210417133020614",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[326]||(s[326]=h("p",null,[r("上传到"),h("code",null,"/usr/local/bin/"),r("目录也可以。")],-1)),s[327]||(s[327]=h("h5",{id:"_2-修改文件权限",tabindex:"-1"},[r("2. 修改文件权限 "),h("a",{class:"header-anchor",href:"#_2-修改文件权限","aria-label":'Permalink to "2. 修改文件权限"'},"​")],-1)),s[328]||(s[328]=h("p",null,"修改文件权限：",-1)),s[329]||(s[329]=h("div",{class:"language-sh max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"sh"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 修改权限")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"chmod"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," +x"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /usr/local/bin/docker-compose")])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[330]||(s[330]=h("h5",{id:"_3-base自动补全命令",tabindex:"-1"},[r("3. Base自动补全命令： "),h("a",{class:"header-anchor",href:"#_3-base自动补全命令","aria-label":'Permalink to "3. Base自动补全命令："'},"​")],-1)),s[331]||(s[331]=h("div",{class:"language-sh max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"sh"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 补全命令")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"curl"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -L"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," https://raw.githubusercontent.com/docker/compose/1.29.1/contrib/completion/bash/docker-compose"),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," >"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /etc/bash_completion.d/docker-compose")])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[332]||(s[332]=h("p",null,"如果这里出现错误，需要修改自己的hosts文件：",-1)),s[333]||(s[333]=h("div",{class:"language-sh max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"sh"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"echo"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "199.232.68.133 raw.githubusercontent.com"'),h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," >>"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /etc/hosts")])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[334]||(s[334]=h("h3",{id:"_4-3-部署微服务集群",tabindex:"-1"},[r("4.3 部署微服务集群 "),h("a",{class:"header-anchor",href:"#_4-3-部署微服务集群","aria-label":'Permalink to "4.3 部署微服务集群"'},"​")],-1)),s[335]||(s[335]=h("p",null,[h("strong",null,"需求"),r("：将之前学习的cloud-demo微服务集群利用DockerCompose部署")],-1)),s[336]||(s[336]=h("p",null,[h("strong",null,"实现思路"),r("：")],-1)),s[337]||(s[337]=h("p",null,"① 查看课前资料提供的cloud-demo文件夹，里面已经编写好了docker-compose文件",-1)),s[338]||(s[338]=h("p",null,"② 修改自己的cloud-demo项目，将数据库、nacos地址都命名为docker-compose中的服务名",-1)),s[339]||(s[339]=h("p",null,"③ 使用maven打包工具，将项目中的每个微服务都打包为app.jar",-1)),s[340]||(s[340]=h("p",null,"④ 将打包好的app.jar拷贝到cloud-demo中的每一个对应的子目录中",-1)),s[341]||(s[341]=h("p",null,[r("⑤ 将cloud-demo上传至虚拟机，利用 "),h("code",null,"docker-compose up -d"),r(" 来部署")],-1)),s[342]||(s[342]=h("h4",{id:"_4-3-1-compose文件",tabindex:"-1"},[r("4.3.1 compose文件 "),h("a",{class:"header-anchor",href:"#_4-3-1-compose文件","aria-label":'Permalink to "4.3.1 compose文件"'},"​")],-1)),s[343]||(s[343]=h("p",null,"查看课前资料提供的cloud-demo文件夹，里面已经编写好了docker-compose文件，而且每个微服务都准备了一个独立的目录：",-1)),s[344]||(s[344]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731181341330.png",alt:"image-20210731181341330",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[345]||(s[345]=h("p",null,"内容如下：",-1)),s[346]||(s[346]=h("div",{class:"language-yaml max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"yaml"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"version"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"3.2"')]),r("\n"),h("span",{class:"line"}),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"services"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  nacos"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    image"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"nacos/nacos-server")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    environment"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"      MODE"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"standalone")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    ports"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"8848:8848"')]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  mysql"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    image"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"mysql:5.7.25")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    environment"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"      MYSQL_ROOT_PASSWORD"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"123")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    volumes"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"$PWD/mysql/data:/var/lib/mysql"')]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"$PWD/mysql/conf:/etc/mysql/conf.d/"')]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  userservice"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    build"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"./user-service")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  orderservice"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    build"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"./order-service")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  gateway"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    build"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"./gateway")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    ports"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"10010:10010"')])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[347]||(s[347]=h("p",null,"可以看到，其中包含5个service服务：",-1)),s[348]||(s[348]=h("ul",null,[h("li",null,[h("code",null,"nacos"),r("：作为注册中心和配置中心 "),h("ul",null,[h("li",null,[h("code",null,"image: nacos/nacos-server"),r("： 基于nacos/nacos-server镜像构建")]),h("li",null,[h("code",null,"environment"),r("：环境变量 "),h("ul",null,[h("li",null,[h("code",null,"MODE: standalone"),r("：单点模式启动")])])]),h("li",null,[h("code",null,"ports"),r("：端口映射，这里暴露了8848端口")])])]),h("li",null,[h("code",null,"mysql"),r("：数据库 "),h("ul",null,[h("li",null,[h("code",null,"image: mysql:5.7.25"),r("：镜像版本是mysql:5.7.25")]),h("li",null,[h("code",null,"environment"),r("：环境变量 "),h("ul",null,[h("li",null,[h("code",null,"MYSQL_ROOT_PASSWORD: 123"),r("：设置数据库root账户的密码为123")])])]),h("li",null,[h("code",null,"volumes"),r("：数据卷挂载，这里挂载了mysql的data、conf目录，其中有我提前准备好的数据")])])]),h("li",null,[h("code",null,"userservice"),r("、"),h("code",null,"orderservice"),r("、"),h("code",null,"gateway"),r("：都是基于Dockerfile临时构建的")])],-1)),s[349]||(s[349]=h("p",null,"查看mysql目录，可以看到其中已经准备好了cloud_order、cloud_user表：",-1)),s[350]||(s[350]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210801095205034.png",alt:"image-20210801095205034",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[351]||(s[351]=h("p",null,"查看微服务目录，可以看到都包含Dockerfile文件：",-1)),s[352]||(s[352]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210801095320586.png",alt:"image-20210801095320586",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[353]||(s[353]=h("p",null,"内容如下：",-1)),s[354]||(s[354]=h("div",{class:"language-dockerfile max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"dockerfile"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"FROM"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," java:8-alpine")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"COPY"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ./app.jar /tmp/app.jar")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ENTRYPOINT"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," java -jar /tmp/app.jar")])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[355]||(s[355]=h("h4",{id:"_4-3-2-修改微服务配置",tabindex:"-1"},[r("4.3.2 修改微服务配置 "),h("a",{class:"header-anchor",href:"#_4-3-2-修改微服务配置","aria-label":'Permalink to "4.3.2 修改微服务配置"'},"​")],-1)),s[356]||(s[356]=h("p",null,"因为微服务将来要部署为docker容器，而容器之间互联不是通过IP地址，而是通过容器名。这里我们将order-service、user-service、gateway服务的mysql、nacos地址都修改为基于容器名的访问。",-1)),s[357]||(s[357]=h("p",null,"如下所示：",-1)),s[358]||(s[358]=h("div",{class:"language-yaml max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"yaml"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"spring"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  datasource"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    url"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"jdbc:mysql://mysql:3306/cloud_order?useSSL=false")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    username"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"root")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    password"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"123")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    driver-class-name"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"com.mysql.jdbc.Driver")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  application"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    name"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"orderservice")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  cloud"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    nacos"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"      server-addr"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"nacos:8848"),h("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," # nacos服务地址")])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[359]||(s[359]=h("h4",{id:"_4-3-3-打包",tabindex:"-1"},[r("4.3.3 打包 "),h("a",{class:"header-anchor",href:"#_4-3-3-打包","aria-label":'Permalink to "4.3.3 打包"'},"​")],-1)),s[360]||(s[360]=h("p",null,"接下来需要将我们的每个微服务都打包。因为之前查看到Dockerfile中的jar包名称都是app.jar，因此我们的每个微服务都需要用这个名称。",-1)),s[361]||(s[361]=h("p",null,"可以通过修改pom.xml中的打包名称来实现，每个微服务都需要修改：",-1)),s[362]||(s[362]=h("div",{class:"language-xml max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"xml"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"build"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  \x3c!-- 服务打包的最终名称 --\x3e")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  <"),h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"finalName"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">app</"),h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"finalName"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  <"),h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"plugins"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    <"),h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"plugin"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      <"),h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"groupId"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">org.springframework.boot</"),h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"groupId"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      <"),h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"artifactId"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">spring-boot-maven-plugin</"),h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"artifactId"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    </"),h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"plugin"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  </"),h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"plugins"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"</"),h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"build"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[363]||(s[363]=h("p",null,"打包后：",-1)),s[364]||(s[364]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210801095951030.png",alt:"image-20210801095951030",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[365]||(s[365]=h("h4",{id:"_4-3-4-拷贝jar包到部署目录",tabindex:"-1"},[r("4.3.4 拷贝jar包到部署目录 "),h("a",{class:"header-anchor",href:"#_4-3-4-拷贝jar包到部署目录","aria-label":'Permalink to "4.3.4 拷贝jar包到部署目录"'},"​")],-1)),s[366]||(s[366]=h("p",null,"编译打包好的app.jar文件，需要放到Dockerfile的同级目录中。注意：每个微服务的app.jar放到与服务名称对应的目录，别搞错了。",-1)),s[367]||(s[367]=h("p",null,"user-service：",-1)),s[368]||(s[368]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210801100201253.png",alt:"image-20210801100201253",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[369]||(s[369]=h("p",null,"order-service：",-1)),s[370]||(s[370]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210801100231495.png",alt:"image-20210801100231495",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[371]||(s[371]=h("p",null,"gateway：",-1)),s[372]||(s[372]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210801100308102.png",alt:"image-20210801100308102",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[373]||(s[373]=h("h4",{id:"_4-3-5-部署",tabindex:"-1"},[r("4.3.5 部署 "),h("a",{class:"header-anchor",href:"#_4-3-5-部署","aria-label":'Permalink to "4.3.5 部署"'},"​")],-1)),s[374]||(s[374]=h("p",null,"最后，我们需要将文件整个cloud-demo文件夹上传到虚拟机中，理由DockerCompose部署。",-1)),s[375]||(s[375]=h("p",null,"上传到任意目录：",-1)),s[376]||(s[376]=h("figure",null,[h("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210801100955653.png",alt:"image-20210801100955653",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[377]||(s[377]=h("p",null,"部署：",-1)),s[378]||(s[378]=h("p",null,"进入cloud-demo目录，然后运行下面的命令：",-1)),s[379]||(s[379]=h("div",{class:"language-sh max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"sh"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker-compose"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," up"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -d")])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[380]||(s[380]=h("hr",null,null,-1)),s[381]||(s[381]=h("h2",{id:"_5-docker镜像仓库",tabindex:"-1"},[r("5. Docker镜像仓库 "),h("a",{class:"header-anchor",href:"#_5-docker镜像仓库","aria-label":'Permalink to "5. Docker镜像仓库"'},"​")],-1)),s[382]||(s[382]=h("h3",{id:"_5-1-搭建私有镜像仓库",tabindex:"-1"},[r("5.1 搭建私有镜像仓库 "),h("a",{class:"header-anchor",href:"#_5-1-搭建私有镜像仓库","aria-label":'Permalink to "5.1 搭建私有镜像仓库"'},"​")],-1)),s[383]||(s[383]=h("h4",{id:"docker镜像仓库",tabindex:"-1"},[r("Docker镜像仓库 "),h("a",{class:"header-anchor",href:"#docker镜像仓库","aria-label":'Permalink to "Docker镜像仓库"'},"​")],-1)),s[384]||(s[384]=h("p",null,"搭建镜像仓库可以基于Docker官方提供的DockerRegistry来实现。",-1)),s[385]||(s[385]=h("p",null,[r("官网地址："),h("a",{href:"https://hub.docker.com/_/registry",target:"_blank",rel:"noreferrer"},"https://hub.docker.com/_/registry")],-1)),s[386]||(s[386]=h("h5",{id:"_1-简化版镜像仓库",tabindex:"-1"},[r("1. 简化版镜像仓库 "),h("a",{class:"header-anchor",href:"#_1-简化版镜像仓库","aria-label":'Permalink to "1. 简化版镜像仓库"'},"​")],-1)),s[387]||(s[387]=h("p",null,"Docker官方的Docker Registry是一个基础版本的Docker镜像仓库，具备仓库管理的完整功能，但是没有图形化界面。",-1)),s[388]||(s[388]=h("p",null,"搭建方式比较简单，命令如下：",-1)),s[389]||(s[389]=h("div",{class:"language-sh max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"sh"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," run"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -d"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    --restart=always"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    --name"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," registry"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\t\\")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    -p"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 5000:5000"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    -v"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," registry-data:/var/lib/registry"),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"    registry")])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[390]||(s[390]=h("p",null,"命令中挂载了一个数据卷registry-data到容器内的/var/lib/registry 目录，这是私有镜像库存放数据的目录。",-1)),s[391]||(s[391]=h("p",null,[r("访问"),h("a",{href:"http://YourIp:5000/v2/_catalog",target:"_blank",rel:"noreferrer"},"http://YourIp:5000/v2/_catalog"),r(" 可以查看当前私有镜像服务中包含的镜像")],-1)),s[392]||(s[392]=h("h5",{id:"_2-带有图形化界面版本",tabindex:"-1"},[r("2. 带有图形化界面版本 "),h("a",{class:"header-anchor",href:"#_2-带有图形化界面版本","aria-label":'Permalink to "2. 带有图形化界面版本"'},"​")],-1)),s[393]||(s[393]=h("p",null,"使用DockerCompose部署带有图象界面的DockerRegistry，命令如下：",-1)),s[394]||(s[394]=h("div",{class:"language-yaml max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"yaml"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"version"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'3.0'")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"services"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  registry"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    image"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"registry")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    volumes"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"./registry-data:/var/lib/registry")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  ui"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    image"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"joxit/docker-registry-ui:static")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    ports"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"8080:80")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    environment"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"REGISTRY_TITLE=传智教育私有仓库")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"REGISTRY_URL=http://registry:5000")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    depends_on"),h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"registry")])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[395]||(s[395]=h("h5",{id:"_3-配置docker信任地址",tabindex:"-1"},[r("3. 配置Docker信任地址 "),h("a",{class:"header-anchor",href:"#_3-配置docker信任地址","aria-label":'Permalink to "3. 配置Docker信任地址"'},"​")],-1)),s[396]||(s[396]=h("p",null,"我们的私服采用的是http协议，默认不被Docker信任，所以需要做一个配置：",-1)),s[397]||(s[397]=h("div",{class:"language-sh max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"sh"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 打开要修改的文件")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"vi"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /etc/docker/daemon.json")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 添加内容：")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},'"insecure-registries"'),h("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},":"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"["),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},'"http://192.168.150.101:8080"'),h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"]")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 重加载")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"systemctl"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," daemon-reload")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 重启docker")]),r("\n"),h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"systemctl"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," restart"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," docker")])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[398]||(s[398]=h("h3",{id:"_5-2-推送、拉取镜像",tabindex:"-1"},[r("5.2 推送、拉取镜像 "),h("a",{class:"header-anchor",href:"#_5-2-推送、拉取镜像","aria-label":'Permalink to "5.2 推送、拉取镜像"'},"​")],-1)),s[399]||(s[399]=h("p",null,"推送镜像到私有镜像服务必须先tag，步骤如下：",-1)),s[400]||(s[400]=h("p",null,[r("① 重新tag本地镜像，名称前缀为私有仓库的地址："),h("code",null,"192.168.150.101:8080/")],-1)),s[401]||(s[401]=h("div",{class:"language-sh max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"sh"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," tag"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," nginx:latest"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 192.168.150.101:8080/nginx:1.0")])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[402]||(s[402]=h("p",null,"② 推送镜像",-1)),s[403]||(s[403]=h("div",{class:"language-sh max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"sh"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," push"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 192.168.150.101:8080/nginx:1.0")])])]),h("button",{class:"code-block-unfold-btn"})],-1)),s[404]||(s[404]=h("p",null,"③ 拉取镜像",-1)),s[405]||(s[405]=h("div",{class:"language-sh max-h-300px"},[h("button",{title:"Copy code",class:"copy"}),h("span",{class:"lang"},"sh"),h("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[h("code",{"v-pre":""},[h("span",{class:"line"},[h("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," pull"),h("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 192.168.150.101:8080/nginx:1.0")])])]),h("button",{class:"code-block-unfold-btn"})],-1))]),"main-header":n(()=>[t(i.$slots,"main-header")]),"main-header-after":n(()=>[t(i.$slots,"main-header-after")]),"main-nav":n(()=>[t(i.$slots,"main-nav")]),"main-content-before":n(()=>[t(i.$slots,"main-content-before")]),"main-content":n(()=>[t(i.$slots,"main-content")]),"main-content-after":n(()=>[t(i.$slots,"main-content-after")]),"main-nav-before":n(()=>[t(i.$slots,"main-nav-before")]),"main-nav-after":n(()=>[t(i.$slots,"main-nav-after")]),comment:n(()=>[t(i.$slots,"comment")]),footer:n(()=>[t(i.$slots,"footer")]),aside:n(()=>[t(i.$slots,"aside")]),"aside-custom":n(()=>[t(i.$slots,"aside-custom")]),default:n(()=>[t(i.$slots,"default")]),_:3},8,["frontmatter"])}}};export{g as default,d as usePageData};
