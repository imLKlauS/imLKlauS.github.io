var F=(e,E,h)=>new Promise((g,p)=>{var r=a=>{try{t(h.next(a))}catch(s){p(s)}},d=a=>{try{t(h.throw(a))}catch(s){p(s)}},t=a=>a.done?g(a.value):Promise.resolve(a.value).then(r,d);t((h=h.apply(e,E)).next())});import{_ as C}from"./ValaxyMain.vue_vue_type_style_index_0_lang.CDNsmhz3.js";import"./chunks/@vueuse/motion.C0680yyY.js";import{d as B,a as m,u as b}from"./chunks/vue-router.BrUfGvTC.js";import{a1 as c,a3 as n,a4 as k,a5 as i,a6 as D,a7 as l,W as o,a0 as A,F as f,a2 as v,Z as x}from"./framework.CyQERZzy.js";import"./app.BPzKOdEP.js";import"./chunks/dayjs.BSMtxqtT.js";import"./chunks/vue-i18n.CvwbWgfE.js";import"./chunks/pinia.CyvRWuDa.js";import"./chunks/nprogress.c3ZdlDjC.js";/* empty css                    */import"./YunComment.vue_vue_type_style_index_0_lang.BIbThCyp.js";import"./index.C5okkQwF.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang.Du2MZPyS.js";import"./post.BkCOJq1d.js";const S=B("/posts/Elasticsearch",e=>F(null,null,function*(){return JSON.parse('{"title":"Elasticsearch 从入门到实战","description":"","frontmatter":{"title":"Elasticsearch 从入门到实战","author":"imklaus","tags":["Elasticsearch"],"categories":["中间件"],"date":"2025/12/7 22:51:00","outline":"deep","postTitleClass":"text-#fcd522","excerpt_type":"html","end":false},"headers":[],"relativePath":"pages/posts/Elasticsearch.md","lastUpdated":null}')}),{lazy:(e,E)=>e.name===E.name}),U={__name:"Elasticsearch",setup(e,{expose:E}){var t;const{data:h}=S(),g=b(),p=m(),r=Object.assign(p.meta.frontmatter||{},((t=h.value)==null?void 0:t.frontmatter)||{});return g.currentRoute.value.data=h.value,x("valaxy:frontmatter",r),globalThis.$frontmatter=r,E({frontmatter:{title:"Elasticsearch 从入门到实战",author:"imklaus",tags:["Elasticsearch"],categories:["中间件"],date:"2025/12/7 22:51:00",outline:"deep",postTitleClass:"text-#fcd522",excerpt_type:"html",end:!1}}),(a,s)=>{const y=A("font"),u=C;return v(),c(u,{frontmatter:f(r)},{"main-content-md":n(()=>[s[10]||(s[10]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/v2-37905c52c75915f998824731a75e8d38_720w.jpg",alt:"",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[11]||(s[11]=i("p",null,[l("参考视频："),i("a",{href:"https://www.bilibili.com/video/BV1LQ4y127n4",target:"_blank",rel:"noreferrer"},"黑马SpringCloud微服务技术栈Elasticsearch篇")],-1)),s[12]||(s[12]=i("p",null,"笔记的整体结构依据视频编写，并随着学习的深入补充了很多知识",-1)),s[13]||(s[13]=i("p",null,[i("strong",null,"目录指引"),l("：")],-1)),s[14]||(s[14]=i("nav",{class:"table-of-contents"},[i("ul",null,[i("li",null,[i("a",{href:"#_1-初识elasticsearch"},"1. 初识elasticsearch"),i("ul",null,[i("li",null,[i("a",{href:"#_1-1-了解es"},"1.1 了解ES"),i("ul",null,[i("li",null,[i("a",{href:"#_1-1-1-elasticsearch的作用"},"1.1.1 elasticsearch的作用")]),i("li",null,[i("a",{href:"#_1-1-2-elk技术栈"},"1.1.2 ELK技术栈")]),i("li",null,[i("a",{href:"#_1-1-3-elasticsearch和lucene"},"1.1.3 elasticsearch和lucene")]),i("li",null,[i("a",{href:"#_1-1-4-为什么不是其他搜索技术"},"1.1.4 为什么不是其他搜索技术？")]),i("li",null,[i("a",{href:"#_1-1-5-总结"},"1.1.5 总结")])])]),i("li",null,[i("a",{href:"#_1-2-倒排索引"},"1.2 倒排索引"),i("ul",null,[i("li",null,[i("a",{href:"#_1-2-1-正向索引"},"1.2.1 正向索引")]),i("li",null,[i("a",{href:"#_1-2-2-倒排索引"},"1.2.2 倒排索引")]),i("li",null,[i("a",{href:"#_1-2-3-正向和倒排"},"1.2.3 正向和倒排")])])]),i("li",null,[i("a",{href:"#_1-3-es的一些概念"},"1.3 es的一些概念"),i("ul",null,[i("li",null,[i("a",{href:"#_1-3-1-文档和字段"},"1.3.1 文档和字段")]),i("li",null,[i("a",{href:"#_1-3-2-索引和映射"},"1.3.2 索引和映射")]),i("li",null,[i("a",{href:"#_1-3-3-mysql与elasticsearch"},"1.3.3 mysql与elasticsearch")])])]),i("li",null,[i("a",{href:"#_1-4-安装es、kibana"},"1.4 安装es、kibana"),i("ul",null,[i("li",null,[i("a",{href:"#部署elasticsearch-单节点"},"部署elasticsearch（单节点）")]),i("li",null,[i("a",{href:"#部署kibana"},"部署kibana")]),i("li",null,[i("a",{href:"#安装ik分词器"},"安装IK分词器")]),i("li",null,[i("a",{href:"#总结"},"总结")])])])])]),i("li",null,[i("a",{href:"#_2-索引库操作"},"2. 索引库操作"),i("ul",null,[i("li",null,[i("a",{href:"#_2-1-mapping映射属性"},"2.1 mapping映射属性")]),i("li",null,[i("a",{href:"#_2-2-索引库的crud"},"2.2 索引库的CRUD"),i("ul",null,[i("li",null,[i("a",{href:"#_2-2-1-创建索引库和映射"},"2.2.1 创建索引库和映射")]),i("li",null,[i("a",{href:"#基本语法"},"基本语法：")]),i("li",null,[i("a",{href:"#示例"},"示例：")]),i("li",null,[i("a",{href:"#_2-2-2-查询索引库"},"2.2.2 查询索引库")]),i("li",null,[i("a",{href:"#_2-2-3-修改索引库"},"2.2.3 修改索引库")]),i("li",null,[i("a",{href:"#_2-2-4-删除索引库"},"2.2.4 删除索引库")]),i("li",null,[i("a",{href:"#_2-2-5-总结"},"2.2.5 总结")])])])])]),i("li",null,[i("a",{href:"#_3-文档操作"},"3. 文档操作"),i("ul",null,[i("li",null,[i("a",{href:"#_3-1-新增文档"},"3.1 新增文档")]),i("li",null,[i("a",{href:"#_3-2-查询文档"},"3.2 查询文档")]),i("li",null,[i("a",{href:"#_3-3-删除文档"},"3.3 删除文档")]),i("li",null,[i("a",{href:"#_3-4-修改文档"},"3.4 修改文档"),i("ul",null,[i("li",null,[i("a",{href:"#_3-4-1-全量修改"},"3.4.1 全量修改")]),i("li",null,[i("a",{href:"#_3-4-2-增量修改"},"3.4.2 增量修改")])])]),i("li",null,[i("a",{href:"#_3-5-总结"},"3.5 总结")])])]),i("li",null,[i("a",{href:"#_4-restapi"},"4. RestAPI"),i("ul",null,[i("li",null,[i("a",{href:"#_4-0-导入demo工程"},"4.0 导入Demo工程"),i("ul",null,[i("li",null,[i("a",{href:"#_4-0-1-导入数据"},"4.0.1 导入数据")]),i("li",null,[i("a",{href:"#_4-0-2-导入项目"},"4.0.2 导入项目")]),i("li",null,[i("a",{href:"#_4-0-3-mapping映射分析"},"4.0.3 mapping映射分析")]),i("li",null,[i("a",{href:"#_4-0-4-初始化restclient"},"4.0.4 初始化RestClient")])])]),i("li",null,[i("a",{href:"#_4-1-创建索引库"},"4.1 创建索引库"),i("ul",null,[i("li",null,[i("a",{href:"#_4-1-1-代码解读"},"4.1.1 代码解读")]),i("li",null,[i("a",{href:"#_4-1-2-完整示例"},"4.1.2 完整示例")])])]),i("li",null,[i("a",{href:"#_4-2-删除索引库"},"4.2 删除索引库")]),i("li",null,[i("a",{href:"#_4-3-判断索引库是否存在"},"4.3 判断索引库是否存在")]),i("li",null,[i("a",{href:"#_4-4-总结"},"4.4 总结")])])]),i("li",null,[i("a",{href:"#_5-restclient操作文档"},"5. RestClient操作文档"),i("ul",null,[i("li",null,[i("a",{href:"#_5-1-新增文档"},"5.1 新增文档"),i("ul",null,[i("li",null,[i("a",{href:"#_5-1-1-索引库实体类"},"5.1.1 索引库实体类")]),i("li",null,[i("a",{href:"#_5-1-2-语法说明"},"5.1.2 语法说明")]),i("li",null,[i("a",{href:"#_5-1-3-完整代码"},"5.1.3 完整代码")])])]),i("li",null,[i("a",{href:"#_5-2-查询文档"},"5.2 查询文档"),i("ul",null,[i("li",null,[i("a",{href:"#_5-2-1-语法说明"},"5.2.1 语法说明")]),i("li",null,[i("a",{href:"#_5-2-2-完整代码"},"5.2.2 完整代码")])])]),i("li",null,[i("a",{href:"#_5-3-删除文档"},"5.3 删除文档")]),i("li",null,[i("a",{href:"#_5-4-修改文档"},"5.4 修改文档"),i("ul",null,[i("li",null,[i("a",{href:"#_5-4-1-语法说明"},"5.4.1 语法说明")]),i("li",null,[i("a",{href:"#_5-4-2-完整代码"},"5.4.2 完整代码")])])]),i("li",null,[i("a",{href:"#_5-5-批量导入文档"},"5.5 批量导入文档"),i("ul",null,[i("li",null,[i("a",{href:"#_5-5-1-语法说明"},"5.5.1 语法说明")]),i("li",null,[i("a",{href:"#_5-5-2-完整代码"},"5.5.2 完整代码")])])]),i("li",null,[i("a",{href:"#_5-6-小结"},"5.6 小结")])])]),i("li",null,[i("a",{href:"#_6-dsl查询文档"},"6. DSL查询文档"),i("ul",null,[i("li",null,[i("a",{href:"#_6-1-dsl查询分类"},"6.1 DSL查询分类")]),i("li",null,[i("a",{href:"#_6-2-全文检索查询"},"6.2 全文检索查询"),i("ul",null,[i("li",null,[i("a",{href:"#_6-2-1-使用场景"},"6.2.1 使用场景")]),i("li",null,[i("a",{href:"#_6-2-2-基本语法"},"6.2.2 基本语法")]),i("li",null,[i("a",{href:"#_6-2-3-示例"},"6.2.3 示例")]),i("li",null,[i("a",{href:"#_6-2-4-总结"},"6.2.4 总结")])])]),i("li",null,[i("a",{href:"#_6-3-精准查询"},"6.3 精准查询"),i("ul",null,[i("li",null,[i("a",{href:"#_6-3-1-term查询"},"6.3.1 term查询")]),i("li",null,[i("a",{href:"#_6-3-2-range查询"},"6.3.2 range查询")]),i("li",null,[i("a",{href:"#_6-3-3-总结"},"6.3.3 总结")])])]),i("li",null,[i("a",{href:"#_6-4-地理坐标查询"},"6.4 地理坐标查询"),i("ul",null,[i("li",null,[i("a",{href:"#_6-4-1-矩形范围查询"},"6.4.1 矩形范围查询")]),i("li",null,[i("a",{href:"#_6-4-2-附近查询"},"6.4.2 附近查询")])])]),i("li",null,[i("a",{href:"#_6-5-复合查询"},"6.5 复合查询"),i("ul",null,[i("li",null,[i("a",{href:"#_6-5-1-相关性算分"},"6.5.1 相关性算分")]),i("li",null,[i("a",{href:"#_6-5-2-算分函数查询"},"6.5.2 算分函数查询")]),i("li",null,[i("a",{href:"#_6-5-3-布尔查询"},"6.5.3 布尔查询")])])])])]),i("li",null,[i("a",{href:"#_7-搜索结果处理"},"7. 搜索结果处理"),i("ul",null,[i("li",null,[i("a",{href:"#_7-1-排序"},"7.1 排序"),i("ul",null,[i("li",null,[i("a",{href:"#_7-1-1-普通字段排序"},"7.1.1 普通字段排序")]),i("li",null,[i("a",{href:"#_7-1-2-地理坐标排序"},"7.1.2 地理坐标排序")])])]),i("li",null,[i("a",{href:"#_7-2-分页"},"7.2 分页"),i("ul",null,[i("li",null,[i("a",{href:"#_7-2-1-基本的分页"},"7.2.1 基本的分页")]),i("li",null,[i("a",{href:"#_7-2-2-深度分页问题"},"7.2.2 深度分页问题")]),i("li",null,[i("a",{href:"#_7-2-3-小结"},"7.2.3 小结")])])]),i("li",null,[i("a",{href:"#_7-3-高亮"},"7.3 高亮"),i("ul",null,[i("li",null,[i("a",{href:"#_7-3-1-高亮原理"},"7.3.1 高亮原理")]),i("li",null,[i("a",{href:"#_7-3-2-实现高亮"},"7.3.2 实现高亮")])])]),i("li",null,[i("a",{href:"#_7-4-总结"},"7.4 总结")])])]),i("li",null,[i("a",{href:"#_8-restclient查询文档"},"8. RestClient查询文档"),i("ul",null,[i("li",null,[i("a",{href:"#_8-1-快速入门"},"8.1 快速入门"),i("ul",null,[i("li",null,[i("a",{href:"#_8-1-1-发起查询请求"},"8.1.1 发起查询请求")]),i("li",null,[i("a",{href:"#_8-1-2-解析响应"},"8.1.2 解析响应")]),i("li",null,[i("a",{href:"#_8-1-3-完整代码"},"8.1.3 完整代码")]),i("li",null,[i("a",{href:"#_8-1-4-小结"},"8.1.4 小结")])])]),i("li",null,[i("a",{href:"#_8-2-match查询"},"8.2 match查询")]),i("li",null,[i("a",{href:"#_8-3-精确查询"},"8.3 精确查询")]),i("li",null,[i("a",{href:"#_8-4-布尔查询"},"8.4 布尔查询")]),i("li",null,[i("a",{href:"#_8-5-排序、分页"},"8.5 排序、分页")]),i("li",null,[i("a",{href:"#_8-6-高亮"},"8.6 高亮"),i("ul",null,[i("li",null,[i("a",{href:"#_8-6-1-高亮请求构建"},"8.6.1 高亮请求构建")]),i("li",null,[i("a",{href:"#_8-6-2-高亮结果解析"},"8.6.2 高亮结果解析")])])])])]),i("li",null,[i("a",{href:"#_9-黑马旅游案例"},"9. 黑马旅游案例"),i("ul",null,[i("li",null,[i("a",{href:"#_9-1-酒店搜索和分页"},"9.1 酒店搜索和分页"),i("ul",null,[i("li",null,[i("a",{href:"#_9-1-1-需求分析"},"9.1.1 需求分析")]),i("li",null,[i("a",{href:"#_9-1-2-定义实体类"},"9.1.2 定义实体类")]),i("li",null,[i("a",{href:"#_9-1-3-定义controller"},"9.1.3 定义controller")]),i("li",null,[i("a",{href:"#_9-1-4-实现搜索业务"},"9.1.4 实现搜索业务")])])]),i("li",null,[i("a",{href:"#_9-2-酒店结果过滤"},"9.2 酒店结果过滤"),i("ul",null,[i("li",null,[i("a",{href:"#_9-2-1-需求分析"},"9.2.1 需求分析")]),i("li",null,[i("a",{href:"#_9-2-2-修改实体类"},"9.2.2 修改实体类")]),i("li",null,[i("a",{href:"#_9-2-3-修改搜索业务"},"9.2.3 修改搜索业务")])])]),i("li",null,[i("a",{href:"#_9-3-我周边的酒店"},"9.3 我周边的酒店"),i("ul",null,[i("li",null,[i("a",{href:"#_9-3-1-需求分析"},"9.3.1 需求分析")]),i("li",null,[i("a",{href:"#_9-3-2-修改实体类"},"9.3.2 修改实体类")]),i("li",null,[i("a",{href:"#_9-3-3-距离排序api"},"9.3.3 距离排序API")]),i("li",null,[i("a",{href:"#_9-3-4-添加距离排序"},"9.3.4 添加距离排序")]),i("li",null,[i("a",{href:"#_9-3-5-排序距离显示"},"9.3.5 排序距离显示")])])]),i("li",null,[i("a",{href:"#_9-4-酒店竞价排名"},"9.4 酒店竞价排名"),i("ul",null,[i("li",null,[i("a",{href:"#_9-4-1-需求分析"},"9.4.1 需求分析")]),i("li",null,[i("a",{href:"#_9-4-2-修改hoteldoc实体"},"9.4.2 修改HotelDoc实体")]),i("li",null,[i("a",{href:"#_9-4-3-添加广告标记"},"9.4.3 添加广告标记")]),i("li",null,[i("a",{href:"#_9-4-4-添加算分函数查询"},"9.4.4 添加算分函数查询")])])])])]),i("li",null,[i("a",{href:"#_10-数据聚合"},"10. 数据聚合"),i("ul",null,[i("li",null,[i("a",{href:"#_10-1-聚合的种类"},"10.1 聚合的种类")]),i("li",null,[i("a",{href:"#_10-2-dsl实现聚合"},"10.2 DSL实现聚合"),i("ul",null,[i("li",null,[i("a",{href:"#_10-2-1-bucket聚合语法"},"10.2.1 Bucket聚合语法")]),i("li",null,[i("a",{href:"#_10-2-2-聚合结果排序"},"10.2.2 聚合结果排序")]),i("li",null,[i("a",{href:"#_10-2-3-限定聚合范围"},"10.2.3 限定聚合范围")]),i("li",null,[i("a",{href:"#_10-2-4-metric聚合语法"},"10.2.4 Metric聚合语法")]),i("li",null,[i("a",{href:"#_10-2-5-小结"},"10.2.5 小结")])])]),i("li",null,[i("a",{href:"#_10-3-restapi实现聚合"},"10.3 RestAPI实现聚合"),i("ul",null,[i("li",null,[i("a",{href:"#_10-3-1-api语法"},"10.3.1 API语法")]),i("li",null,[i("a",{href:"#_10-3-2-业务需求"},"10.3.2 业务需求")]),i("li",null,[i("a",{href:"#_10-3-3-业务实现"},"10.3.3 业务实现")])])])])]),i("li",null,[i("a",{href:"#_11-自动补全"},"11. 自动补全"),i("ul",null,[i("li",null,[i("a",{href:"#_11-1-拼音分词器"},"11.1.拼音分词器")]),i("li",null,[i("a",{href:"#_11-2-自定义分词器"},"11.2 自定义分词器")]),i("li",null,[i("a",{href:"#_11-3-自动补全查询"},"11.3 自动补全查询")]),i("li",null,[i("a",{href:"#_11-4-实现酒店搜索框自动补全"},"11.4 实现酒店搜索框自动补全"),i("ul",null,[i("li",null,[i("a",{href:"#_11-4-1-修改酒店映射结构"},"11.4.1 修改酒店映射结构")]),i("li",null,[i("a",{href:"#_11-4-2-修改hoteldoc实体"},"11.4.2 修改HotelDoc实体")]),i("li",null,[i("a",{href:"#_11-4-3-重新导入"},"11.4.3 重新导入")]),i("li",null,[i("a",{href:"#_11-4-4-自动补全查询的javaapi"},"11.4.4 自动补全查询的JavaAPI")]),i("li",null,[i("a",{href:"#_11-4-5-实现搜索框自动补全"},"11.4.5 实现搜索框自动补全")])])])])]),i("li",null,[i("a",{href:"#_12-数据同步"},"12. 数据同步"),i("ul",null,[i("li",null,[i("a",{href:"#_12-1-思路分析"},"12.1 思路分析"),i("ul",null,[i("li",null,[i("a",{href:"#_12-1-1-同步调用"},"12.1.1 同步调用")]),i("li",null,[i("a",{href:"#_12-1-2-异步通知"},"12.1.2 异步通知")]),i("li",null,[i("a",{href:"#_12-1-3-监听binlog"},"12.1.3 监听binlog")]),i("li",null,[i("a",{href:"#_12-1-4-选择"},"12.1.4 选择")])])]),i("li",null,[i("a",{href:"#_12-2-实现数据同步"},"12.2 实现数据同步"),i("ul",null,[i("li",null,[i("a",{href:"#_12-2-1-思路"},"12.2.1 思路")]),i("li",null,[i("a",{href:"#_12-2-2-导入demo"},"12.2.2 导入demo")]),i("li",null,[i("a",{href:"#_12-2-3-声明交换机、队列"},"12.2.3 声明交换机、队列")]),i("li",null,[i("a",{href:"#_12-2-4-发送mq消息"},"12.2.4 发送MQ消息")]),i("li",null,[i("a",{href:"#_12-2-5-接收mq消息"},"12.2.5 接收MQ消息")])])])])]),i("li",null,[i("a",{href:"#_13-集群"},"13. 集群"),i("ul",null,[i("li",null,[i("a",{href:"#_13-1-搭建es集群"},"13.1 搭建ES集群"),i("ul",null,[i("li",null,[i("a",{href:"#部署es集群"},"部署es集群")])])]),i("li",null,[i("a",{href:"#_13-2-集群脑裂问题"},"13.2 集群脑裂问题"),i("ul",null,[i("li",null,[i("a",{href:"#_13-2-1-集群职责划分"},"13.2.1 集群职责划分")]),i("li",null,[i("a",{href:"#_13-2-2-脑裂问题"},"13.2.2 脑裂问题")]),i("li",null,[i("a",{href:"#_13-2-3-小结"},"13.2.3 小结")])])]),i("li",null,[i("a",{href:"#_13-3-集群分布式存储"},"13.3 集群分布式存储"),i("ul",null,[i("li",null,[i("a",{href:"#_13-3-1-分片存储测试"},"13.3.1 分片存储测试")]),i("li",null,[i("a",{href:"#_13-3-2-分片存储原理"},"13.3.2 分片存储原理")])])]),i("li",null,[i("a",{href:"#_13-4-集群分布式查询"},"13.4 集群分布式查询")]),i("li",null,[i("a",{href:"#_13-5-集群故障转移"},"13.5 集群故障转移")])])])])],-1)),s[15]||(s[15]=i("h2",{id:"_1-初识elasticsearch",tabindex:"-1"},[l("1. 初识elasticsearch "),i("a",{class:"header-anchor",href:"#_1-初识elasticsearch","aria-label":'Permalink to "1. 初识elasticsearch"'},"​")],-1)),s[16]||(s[16]=i("h3",{id:"_1-1-了解es",tabindex:"-1"},[l("1.1 了解ES "),i("a",{class:"header-anchor",href:"#_1-1-了解es","aria-label":'Permalink to "1.1 了解ES"'},"​")],-1)),s[17]||(s[17]=i("h4",{id:"_1-1-1-elasticsearch的作用",tabindex:"-1"},[l("1.1.1 elasticsearch的作用 "),i("a",{class:"header-anchor",href:"#_1-1-1-elasticsearch的作用","aria-label":'Permalink to "1.1.1 elasticsearch的作用"'},"​")],-1)),s[18]||(s[18]=i("p",null,"elasticsearch是一款非常强大的开源搜索引擎，具备非常多强大功能，可以帮助我们从海量数据中快速找到需要的内容",-1)),s[19]||(s[19]=i("p",null,"例如：",-1)),s[20]||(s[20]=i("ul",null,[i("li",null,[i("p",null,"在GitHub搜索代码"),i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720193623245.png",alt:"image-20210720193623245",loading:"lazy",decoding:"async",class:"lazy"})])])],-1)),D(" more "),s[21]||(s[21]=i("ul",null,[i("li",null,[i("p",null,"在电商网站搜索商品"),i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720193633483.png",alt:"image-20210720193633483",loading:"lazy",decoding:"async",class:"lazy"})])]),i("li",null,[i("p",null,"在百度搜索答案"),i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720193641907.png",alt:"image-20210720193641907",loading:"lazy",decoding:"async",class:"lazy"})])]),i("li",null,[i("p",null,"在打车软件搜索附近的车"),i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720193648044.png",alt:"image-20210720193648044",loading:"lazy",decoding:"async",class:"lazy"})])])],-1)),s[22]||(s[22]=i("h4",{id:"_1-1-2-elk技术栈",tabindex:"-1"},[l("1.1.2 ELK技术栈 "),i("a",{class:"header-anchor",href:"#_1-1-2-elk技术栈","aria-label":'Permalink to "1.1.2 ELK技术栈"'},"​")],-1)),s[23]||(s[23]=i("p",null,"elasticsearch结合kibana、Logstash、Beats，也就是elastic stack（ELK）。被广泛应用在日志数据分析、实时监控等领域：",-1)),s[24]||(s[24]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720194008781.png",alt:"image-20210720194008781",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[25]||(s[25]=i("p",null,"而elasticsearch是elastic stack的核心，负责存储、搜索、分析数据。",-1)),s[26]||(s[26]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720194230265.png",alt:"image-20210720194230265",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[27]||(s[27]=i("h4",{id:"_1-1-3-elasticsearch和lucene",tabindex:"-1"},[l("1.1.3 elasticsearch和lucene "),i("a",{class:"header-anchor",href:"#_1-1-3-elasticsearch和lucene","aria-label":'Permalink to "1.1.3 elasticsearch和lucene"'},"​")],-1)),s[28]||(s[28]=i("p",null,[l("elasticsearch底层是基于"),i("strong",null,"lucene"),l("来实现的。")],-1)),s[29]||(s[29]=i("p",null,[i("strong",null,"Lucene"),l("是一个Java语言的搜索引擎类库，是Apache公司的顶级项目，由DougCutting于1999年研发。官网地址："),i("a",{href:"https://lucene.apache.org/",target:"_blank",rel:"noreferrer"},"https://lucene.apache.org/"),l(" 。")],-1)),s[30]||(s[30]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720194547780.png",alt:"image-20210720194547780",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[31]||(s[31]=i("p",null,[i("strong",null,"elasticsearch"),l("的发展历史：")],-1)),s[32]||(s[32]=i("ul",null,[i("li",null,"2004年Shay Banon基于Lucene开发了Compass"),i("li",null,"2010年Shay Banon 重写了Compass，取名为Elasticsearch。")],-1)),s[33]||(s[33]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720195001221.png",alt:"image-20210720195001221",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[34]||(s[34]=i("h4",{id:"_1-1-4-为什么不是其他搜索技术",tabindex:"-1"},[l("1.1.4 为什么不是其他搜索技术？ "),i("a",{class:"header-anchor",href:"#_1-1-4-为什么不是其他搜索技术","aria-label":'Permalink to "1.1.4 为什么不是其他搜索技术？"'},"​")],-1)),s[35]||(s[35]=i("p",null,"目前比较知名的搜索引擎技术排名：",-1)),s[36]||(s[36]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720195142535.png",alt:"image-20210720195142535",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[37]||(s[37]=i("p",null,"虽然在早期，Apache Solr是最主要的搜索引擎技术，但随着发展elasticsearch已经渐渐超越了Solr，独占鳌头：",-1)),s[38]||(s[38]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720195306484.png",alt:"image-20210720195306484",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[39]||(s[39]=i("h4",{id:"_1-1-5-总结",tabindex:"-1"},[l("1.1.5 总结 "),i("a",{class:"header-anchor",href:"#_1-1-5-总结","aria-label":'Permalink to "1.1.5 总结"'},"​")],-1)),s[40]||(s[40]=i("blockquote",null,[i("ul",null,[i("li",null,[i("p",null,"什么是elasticsearch？"),i("ul",null,[i("li",null,"一个开源的分布式搜索引擎，可以用来实现搜索、日志统计、分析、系统监控等功能")])]),i("li",null,[i("p",null,"什么是elastic stack（ELK）？"),i("ul",null,[i("li",null,"是以elasticsearch为核心的技术栈，包括beats、Logstash、kibana、elasticsearch")])]),i("li",null,[i("p",null,"什么是Lucene？"),i("ul",null,[i("li",null,"是Apache的开源搜索引擎类库，提供了搜索引擎的核心API")])])])],-1)),s[41]||(s[41]=i("h3",{id:"_1-2-倒排索引",tabindex:"-1"},[l("1.2 倒排索引 "),i("a",{class:"header-anchor",href:"#_1-2-倒排索引","aria-label":'Permalink to "1.2 倒排索引"'},"​")],-1)),s[42]||(s[42]=i("p",null,"倒排索引的概念是基于MySQL这样的正向索引而言的。",-1)),s[43]||(s[43]=i("h4",{id:"_1-2-1-正向索引",tabindex:"-1"},[l("1.2.1 正向索引 "),i("a",{class:"header-anchor",href:"#_1-2-1-正向索引","aria-label":'Permalink to "1.2.1 正向索引"'},"​")],-1)),s[44]||(s[44]=i("p",null,"那么什么是正向索引呢？例如给下表（tb_goods）中的id创建索引：",-1)),s[45]||(s[45]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720195531539.png",alt:"image-20210720195531539",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[46]||(s[46]=i("p",null,"如果是根据id查询，那么直接走索引，查询速度非常快。",-1)),s[47]||(s[47]=i("p",null,"但如果是基于title做模糊查询，只能是逐行扫描数据，流程如下：",-1)),s[48]||(s[48]=i("p",null,[l("1）用户搜索数据，条件是title符合"),i("code",null,'"%手机%"')],-1)),s[49]||(s[49]=i("p",null,"2）逐行获取数据，比如id为1的数据",-1)),s[50]||(s[50]=i("p",null,"3）判断数据中的title是否符合用户搜索条件",-1)),s[51]||(s[51]=i("p",null,"4）如果符合则放入结果集，不符合则丢弃。回到步骤1",-1)),s[52]||(s[52]=i("p",null,"逐行扫描，也就是全表扫描，随着数据量增加，其查询效率也会越来越低。当数据量达到数百万时，就是一场灾难。",-1)),s[53]||(s[53]=i("h4",{id:"_1-2-2-倒排索引",tabindex:"-1"},[l("1.2.2 倒排索引 "),i("a",{class:"header-anchor",href:"#_1-2-2-倒排索引","aria-label":'Permalink to "1.2.2 倒排索引"'},"​")],-1)),s[54]||(s[54]=i("p",null,"倒排索引中有两个非常重要的概念：",-1)),s[55]||(s[55]=i("ul",null,[i("li",null,[l("文档（"),i("code",null,"Document"),l("）：用来搜索的数据，其中的每一条数据就是一个文档。例如一个网页、一个商品信息")]),i("li",null,[l("词条（"),i("code",null,"Term"),l("）：对文档数据或用户搜索数据，利用某种算法分词，得到的具备含义的词语就是词条。例如：我是中国人，就可以分为：我、是、中国人、中国、国人这样的几个词条")])],-1)),s[56]||(s[56]=i("p",null,[i("strong",null,"创建倒排索引"),l("是对正向索引的一种特殊处理，流程如下：")],-1)),s[57]||(s[57]=i("ul",null,[i("li",null,"将每一个文档的数据利用算法分词，得到一个个词条"),i("li",null,"创建表，每行数据包括词条、词条所在文档id、位置等信息"),i("li",null,"因为词条唯一性，可以给词条创建索引，例如hash表结构索引")],-1)),s[58]||(s[58]=i("p",null,"如图：",-1)),s[59]||(s[59]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720200457207.png",alt:"image-20210720200457207",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[60]||(s[60]=i("p",null,[l("倒排索引的"),i("strong",null,"搜索流程"),l('如下（以搜索"华为手机"为例）：')],-1)),s[61]||(s[61]=i("p",null,[l("1）用户输入条件"),i("code",null,'"华为手机"'),l("进行搜索。")],-1)),s[62]||(s[62]=i("p",null,[l("2）对用户输入内容"),i("strong",null,"分词"),l("，得到词条："),i("code",null,"华为"),l("、"),i("code",null,"手机"),l("。")],-1)),s[63]||(s[63]=i("p",null,"3）拿着词条在倒排索引中查找，可以得到包含词条的文档id：1、2、3。",-1)),s[64]||(s[64]=i("p",null,"4）拿着文档id到正向索引中查找具体文档。",-1)),s[65]||(s[65]=i("p",null,"如图：",-1)),s[66]||(s[66]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720201115192.png",alt:"image-20210720201115192",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[67]||(s[67]=i("p",null,"虽然要先查询倒排索引，再查询倒排索引，但是无论是词条、还是文档id都建立了索引，查询速度非常快！无需全表扫描。",-1)),s[68]||(s[68]=i("h4",{id:"_1-2-3-正向和倒排",tabindex:"-1"},[l("1.2.3 正向和倒排 "),i("a",{class:"header-anchor",href:"#_1-2-3-正向和倒排","aria-label":'Permalink to "1.2.3 正向和倒排"'},"​")],-1)),s[69]||(s[69]=i("p",null,"那么为什么一个叫做正向索引，一个叫做倒排索引呢？",-1)),s[70]||(s[70]=i("ul",null,[i("li",null,[i("p",null,[i("strong",null,"正向索引"),l("是最传统的，根据id索引的方式。但根据词条查询时，必须先逐条获取每个文档，然后判断文档中是否包含所需要的词条，是"),i("strong",null,"根据文档找词条的过程"),l("。")])]),i("li",null,[i("p",null,[l("而"),i("strong",null,"倒排索引"),l("则相反，是先找到用户要搜索的词条，根据词条得到保护词条的文档的id，然后根据id获取文档。是"),i("strong",null,"根据词条找文档的过程"),l("。")])])],-1)),s[71]||(s[71]=i("p",null,"是不是恰好反过来了？",-1)),s[72]||(s[72]=i("p",null,"那么两者方式的优缺点是什么呢？",-1)),s[73]||(s[73]=i("p",null,[i("strong",null,"正向索引"),l("：")],-1)),s[74]||(s[74]=i("ul",null,[i("li",null,[l("优点： "),i("ul",null,[i("li",null,"可以给多个字段创建索引"),i("li",null,"根据索引字段搜索、排序速度非常快")])]),i("li",null,[l("缺点： "),i("ul",null,[i("li",null,"根据非索引字段，或者索引字段中的部分词条查找时，只能全表扫描。")])])],-1)),s[75]||(s[75]=i("p",null,[i("strong",null,"倒排索引"),l("：")],-1)),s[76]||(s[76]=i("ul",null,[i("li",null,[l("优点： "),i("ul",null,[i("li",null,"根据词条搜索、模糊搜索时，速度非常快")])]),i("li",null,[l("缺点： "),i("ul",null,[i("li",null,"只能给词条创建索引，而不是字段"),i("li",null,"无法根据字段做排序")])])],-1)),s[77]||(s[77]=i("h3",{id:"_1-3-es的一些概念",tabindex:"-1"},[l("1.3 es的一些概念 "),i("a",{class:"header-anchor",href:"#_1-3-es的一些概念","aria-label":'Permalink to "1.3 es的一些概念"'},"​")],-1)),s[78]||(s[78]=i("p",null,"elasticsearch中有很多独有的概念，与mysql中略有差别，但也有相似之处。",-1)),s[79]||(s[79]=i("h4",{id:"_1-3-1-文档和字段",tabindex:"-1"},[l("1.3.1 文档和字段 "),i("a",{class:"header-anchor",href:"#_1-3-1-文档和字段","aria-label":'Permalink to "1.3.1 文档和字段"'},"​")],-1)),s[80]||(s[80]=i("p",null,"elasticsearch是面向**文档（Document）**存储的，可以是数据库中的一条商品数据，一个订单信息。文档数据会被序列化为json格式后存储在elasticsearch中：",-1)),s[81]||(s[81]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720202707797.png",alt:"image-20210720202707797",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[82]||(s[82]=i("p",null,[l("而Json文档中往往包含很多的"),i("strong",null,"字段（Field）"),l("，类似于数据库中的列。")],-1)),s[83]||(s[83]=i("h4",{id:"_1-3-2-索引和映射",tabindex:"-1"},[l("1.3.2 索引和映射 "),i("a",{class:"header-anchor",href:"#_1-3-2-索引和映射","aria-label":'Permalink to "1.3.2 索引和映射"'},"​")],-1)),s[84]||(s[84]=i("p",null,[i("strong",null,"索引（Index）"),l("，就是相同类型的文档的集合。")],-1)),s[85]||(s[85]=i("p",null,"例如：",-1)),s[86]||(s[86]=i("ul",null,[i("li",null,"所有用户文档，就可以组织在一起，称为用户的索引；"),i("li",null,"所有商品的文档，可以组织在一起，称为商品的索引；"),i("li",null,"所有订单的文档，可以组织在一起，称为订单的索引；")],-1)),s[87]||(s[87]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720203022172.png",alt:"image-20210720203022172",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[88]||(s[88]=i("p",null,"因此，我们可以把索引当做是数据库中的表。",-1)),s[89]||(s[89]=i("p",null,[l("数据库的表会有约束信息，用来定义表的结构、字段的名称、类型等信息。因此，索引库中就有"),i("strong",null,"映射（mapping）"),l("，是索引中文档的字段约束信息，类似表的结构约束。")],-1)),s[90]||(s[90]=i("h4",{id:"_1-3-3-mysql与elasticsearch",tabindex:"-1"},[l("1.3.3 mysql与elasticsearch "),i("a",{class:"header-anchor",href:"#_1-3-3-mysql与elasticsearch","aria-label":'Permalink to "1.3.3 mysql与elasticsearch"'},"​")],-1)),s[91]||(s[91]=i("p",null,"我们统一的把mysql与elasticsearch的概念做一下对比：",-1)),s[92]||(s[92]=i("table",null,[i("thead",null,[i("tr",null,[i("th",null,[i("strong",null,"MySQL")]),i("th",null,[i("strong",null,"Elasticsearch")]),i("th",null,[i("strong",null,"说明")])])]),i("tbody",null,[i("tr",null,[i("td",null,"Table"),i("td",null,"Index"),i("td",null,"索引(index)，就是文档的集合，类似数据库的表(table)")]),i("tr",null,[i("td",null,"Row"),i("td",null,"Document"),i("td",null,"文档（Document），就是一条条的数据，类似数据库中的行（Row），文档都是JSON格式")]),i("tr",null,[i("td",null,"Column"),i("td",null,"Field"),i("td",null,"字段（Field），就是JSON文档中的字段，类似数据库中的列（Column）")]),i("tr",null,[i("td",null,"Schema"),i("td",null,"Mapping"),i("td",null,"Mapping（映射）是索引中文档的约束，例如字段类型约束。类似数据库的表结构（Schema）")]),i("tr",null,[i("td",null,"SQL"),i("td",null,"DSL"),i("td",null,"DSL是elasticsearch提供的JSON风格的请求语句，用来操作elasticsearch，实现CRUD")])])],-1)),s[93]||(s[93]=i("p",null,"是不是说，我们学习了elasticsearch就不再需要mysql了呢？",-1)),s[94]||(s[94]=i("p",null,"并不是如此，两者各自有自己的擅长支出：",-1)),s[95]||(s[95]=i("ul",null,[i("li",null,[i("p",null,"Mysql：擅长事务类型操作，可以确保数据的安全和一致性")]),i("li",null,[i("p",null,"Elasticsearch：擅长海量数据的搜索、分析、计算")])],-1)),s[96]||(s[96]=i("p",null,"因此在企业中，往往是两者结合使用：",-1)),s[97]||(s[97]=i("ul",null,[i("li",null,"对安全性要求较高的写操作，使用mysql实现"),i("li",null,"对查询性能要求较高的搜索需求，使用elasticsearch实现"),i("li",null,"两者再基于某种方式，实现数据的同步，保证一致性")],-1)),s[98]||(s[98]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720203534945.png",alt:"image-20210720203534945",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[99]||(s[99]=i("h3",{id:"_1-4-安装es、kibana",tabindex:"-1"},[l("1.4 安装es、kibana "),i("a",{class:"header-anchor",href:"#_1-4-安装es、kibana","aria-label":'Permalink to "1.4 安装es、kibana"'},"​")],-1)),s[100]||(s[100]=i("h4",{id:"部署elasticsearch-单节点",tabindex:"-1"},[l("部署elasticsearch（单节点） "),i("a",{class:"header-anchor",href:"#部署elasticsearch-单节点","aria-label":'Permalink to "部署elasticsearch（单节点）"'},"​")],-1)),s[101]||(s[101]=i("h5",{id:"_1-创建网络",tabindex:"-1"},[l("1. 创建网络 "),i("a",{class:"header-anchor",href:"#_1-创建网络","aria-label":'Permalink to "1. 创建网络"'},"​")],-1)),s[102]||(s[102]=i("p",null,"因为我们还需要部署kibana容器，因此需要让es和kibana容器互联。这里先创建一个网络：",-1)),s[103]||(s[103]=i("div",{class:"language-sh max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"sh"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," network"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," create"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," es-net")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[104]||(s[104]=i("h5",{id:"_2-加载镜像",tabindex:"-1"},[l("2. 加载镜像 "),i("a",{class:"header-anchor",href:"#_2-加载镜像","aria-label":'Permalink to "2. 加载镜像"'},"​")],-1)),s[105]||(s[105]=i("p",null,"这里我们采用elasticsearch的7.12.1版本的镜像，这个镜像体积非常大，接近1G。不建议大家自己pull。",-1)),s[106]||(s[106]=i("p",null,"课前资料提供了镜像的tar包：",-1)),s[107]||(s[107]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210510165308064.png",alt:"image-20210510165308064",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[108]||(s[108]=i("p",null,"大家将其上传到虚拟机中，然后运行命令加载即可：",-1)),s[109]||(s[109]=i("div",{class:"language-sh max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"sh"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 导入数据")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," load"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -i"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," es.tar")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[110]||(s[110]=i("p",null,[l("同理还有"),i("code",null,"kibana"),l("的tar包也需要这样做。")],-1)),s[111]||(s[111]=i("h5",{id:"_3-运行",tabindex:"-1"},[l("3. 运行 "),i("a",{class:"header-anchor",href:"#_3-运行","aria-label":'Permalink to "3. 运行"'},"​")],-1)),s[112]||(s[112]=i("p",null,"运行docker命令，部署单点es：",-1)),s[113]||(s[113]=i("div",{class:"language-sh max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"sh"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," run"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -d"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"	--name"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," es"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    -e"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "ES_JAVA_OPTS=-Xms512m -Xmx512m"'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    -e"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "discovery.type=single-node"'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    -v"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," es-data:/usr/share/elasticsearch/data"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    -v"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," es-plugins:/usr/share/elasticsearch/plugins"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    --privileged"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    --network"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," es-net"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    -p"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 9200:9200"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    -p"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 9300:9300"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"elasticsearch:7.12.1")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[114]||(s[114]=i("p",null,"命令解释：",-1)),s[115]||(s[115]=i("ul",null,[i("li",null,[i("code",null,'-e "cluster.name=es-docker-cluster"'),l("：设置集群名称")]),i("li",null,[i("code",null,'-e "http.host=0.0.0.0"'),l("：监听的地址，可以外网访问")]),i("li",null,[i("code",null,'-e "ES_JAVA_OPTS=-Xms512m -Xmx512m"'),l("：内存大小")]),i("li",null,[i("code",null,'-e "discovery.type=single-node"'),l("：非集群模式")]),i("li",null,[i("code",null,"-v es-data:/usr/share/elasticsearch/data"),l("：挂载逻辑卷，绑定es的数据目录")]),i("li",null,[i("code",null,"-v es-logs:/usr/share/elasticsearch/logs"),l("：挂载逻辑卷，绑定es的日志目录")]),i("li",null,[i("code",null,"-v es-plugins:/usr/share/elasticsearch/plugins"),l("：挂载逻辑卷，绑定es的插件目录")]),i("li",null,[i("code",null,"--privileged"),l("：授予逻辑卷访问权")]),i("li",null,[i("code",null,"--network es-net"),l(" ：加入一个名为es-net的网络中")]),i("li",null,[i("code",null,"-p 9200:9200"),l("：端口映射配置")])],-1)),s[116]||(s[116]=i("p",null,[l("在浏览器中输入："),i("code",null,"http://192.168.150.101:9200"),l(" 即可看到elasticsearch的响应结果：")],-1)),s[117]||(s[117]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210506101053676.png",alt:"image-20210506101053676",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[118]||(s[118]=i("h4",{id:"部署kibana",tabindex:"-1"},[l("部署kibana "),i("a",{class:"header-anchor",href:"#部署kibana","aria-label":'Permalink to "部署kibana"'},"​")],-1)),s[119]||(s[119]=i("p",null,"kibana可以给我们提供一个elasticsearch的可视化界面，便于我们学习。",-1)),s[120]||(s[120]=i("h5",{id:"_1-运行",tabindex:"-1"},[l("1. 运行 "),i("a",{class:"header-anchor",href:"#_1-运行","aria-label":'Permalink to "1. 运行"'},"​")],-1)),s[121]||(s[121]=i("p",null,"运行docker命令，部署kibana",-1)),s[122]||(s[122]=i("div",{class:"language-sh max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"sh"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," run"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -d"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"--name "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"kibana"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"-e "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"ELASTICSEARCH_HOSTS=http://es:9200"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"--network=es-net "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"-p "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"5601:5601"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"  \\")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"kibana:7.12.1")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[123]||(s[123]=i("ul",null,[i("li",null,[i("code",null,"--network es-net"),l(" ：加入一个名为es-net的网络中，与elasticsearch在同一个网络中")]),i("li",null,[i("code",null,'-e ELASTICSEARCH_HOSTS=http://es:9200"'),l("：设置elasticsearch的地址，因为kibana已经与elasticsearch在一个网络，因此可以用容器名直接访问elasticsearch")]),i("li",null,[i("code",null,"-p 5601:5601"),l("：端口映射配置")])],-1)),s[124]||(s[124]=i("p",null,"kibana启动一般比较慢，需要多等待一会，可以通过命令：",-1)),s[125]||(s[125]=i("div",{class:"language-sh max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"sh"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," logs"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -f"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," kibana")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[126]||(s[126]=i("p",null,"查看运行日志，当查看到下面的日志，说明成功：",-1)),s[127]||(s[127]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210109105135812.png",alt:"image-20210109105135812",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[128]||(s[128]=i("p",null,[l("此时，在浏览器输入地址访问："),i("a",{href:"http://192.168.150.101:5601",target:"_blank",rel:"noreferrer"},"http://192.168.150.101:5601"),l("，即可看到结果")],-1)),s[129]||(s[129]=i("h5",{id:"_2-devtools",tabindex:"-1"},[l("2. DevTools "),i("a",{class:"header-anchor",href:"#_2-devtools","aria-label":'Permalink to "2. DevTools"'},"​")],-1)),s[130]||(s[130]=i("p",null,"kibana中提供了一个DevTools界面：",-1)),s[131]||(s[131]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210506102630393.png",alt:"image-20210506102630393",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[132]||(s[132]=i("p",null,"这个界面中可以编写DSL来操作elasticsearch。并且对DSL语句有自动补全功能。",-1)),s[133]||(s[133]=i("h4",{id:"安装ik分词器",tabindex:"-1"},[l("安装IK分词器 "),i("a",{class:"header-anchor",href:"#安装ik分词器","aria-label":'Permalink to "安装IK分词器"'},"​")],-1)),s[134]||(s[134]=i("h5",{id:"_1-在线安装ik插件-较慢",tabindex:"-1"},[l("1. 在线安装ik插件（较慢） "),i("a",{class:"header-anchor",href:"#_1-在线安装ik插件-较慢","aria-label":'Permalink to "1. 在线安装ik插件（较慢）"'},"​")],-1)),s[135]||(s[135]=i("div",{class:"language-shell max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"shell"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 进入容器内部")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," exec"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -it"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," elasticsearch"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /bin/bash")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 在线下载并安装")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"./bin/elasticsearch-plugin"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  install"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v7.12.1/elasticsearch-analysis-ik-7.12.1.zip")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"#退出")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"exit")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"#重启容器")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," restart"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," elasticsearch")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[136]||(s[136]=i("h5",{id:"_2-离线安装ik插件-推荐",tabindex:"-1"},[l("2. 离线安装ik插件（推荐） "),i("a",{class:"header-anchor",href:"#_2-离线安装ik插件-推荐","aria-label":'Permalink to "2. 离线安装ik插件（推荐）"'},"​")],-1)),s[137]||(s[137]=i("h6",{id:"_1-查看数据卷目录",tabindex:"-1"},[l("1）查看数据卷目录 "),i("a",{class:"header-anchor",href:"#_1-查看数据卷目录","aria-label":'Permalink to "1）查看数据卷目录"'},"​")],-1)),s[138]||(s[138]=i("p",null,"安装插件需要知道elasticsearch的plugins目录位置，而我们用了数据卷挂载，因此需要查看elasticsearch的数据卷目录，通过下面命令查看:",-1)),s[139]||(s[139]=i("div",{class:"language-sh max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"sh"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," volume"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," inspect"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," es-plugins")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[140]||(s[140]=i("p",null,"显示结果：",-1)),s[141]||(s[141]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "CreatedAt"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"2022-05-06T10:06:34+08:00"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "Driver"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"local"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "Labels"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"null"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "Mountpoint"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/var/lib/docker/volumes/es-plugins/_data"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "Name"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"es-plugins"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "Options"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"null"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "Scope"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"local"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[142]||(s[142]=i("p",null,[l("说明plugins目录被挂载到了："),i("code",null,"/var/lib/docker/volumes/es-plugins/_data "),l("这个目录中。")],-1)),s[143]||(s[143]=i("h6",{id:"_2-解压缩分词器安装包",tabindex:"-1"},[l("2）解压缩分词器安装包 "),i("a",{class:"header-anchor",href:"#_2-解压缩分词器安装包","aria-label":'Permalink to "2）解压缩分词器安装包"'},"​")],-1)),s[144]||(s[144]=i("p",null,"下面我们需要把课前资料中的ik分词器解压缩，重命名为ik",-1)),s[145]||(s[145]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210506110249144.png",alt:"image-20210506110249144",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[146]||(s[146]=i("h6",{id:"_3-上传到es容器的插件数据卷中",tabindex:"-1"},[l("3）上传到es容器的插件数据卷中 "),i("a",{class:"header-anchor",href:"#_3-上传到es容器的插件数据卷中","aria-label":'Permalink to "3）上传到es容器的插件数据卷中"'},"​")],-1)),s[147]||(s[147]=i("p",null,[l("也就是"),i("code",null,"/var/lib/docker/volumes/es-plugins/_data "),l("：")],-1)),s[148]||(s[148]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210506110704293.png",alt:"image-20210506110704293",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[149]||(s[149]=i("h6",{id:"_4-重启容器",tabindex:"-1"},[l("4）重启容器 "),i("a",{class:"header-anchor",href:"#_4-重启容器","aria-label":'Permalink to "4）重启容器"'},"​")],-1)),s[150]||(s[150]=i("div",{class:"language-shell max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"shell"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 4、重启容器")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," restart"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," es")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[151]||(s[151]=i("div",{class:"language-sh max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"sh"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 查看es日志")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," logs"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -f"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," es")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[152]||(s[152]=i("h6",{id:"_5-测试",tabindex:"-1"},[l("5）测试 "),i("a",{class:"header-anchor",href:"#_5-测试","aria-label":'Permalink to "5）测试"'},"​")],-1)),s[153]||(s[153]=i("p",null,"IK分词器包含两种模式：",-1)),s[154]||(s[154]=i("ul",null,[i("li",null,[i("p",null,[i("code",null,"ik_smart"),l("：最少切分")])]),i("li",null,[i("p",null,[i("code",null,"ik_max_word"),l("：最细切分")])])],-1)),s[155]||(s[155]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /_analyze")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "analyzer"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"ik_max_word"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "text"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"黑马程序员学习java太棒了"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[156]||(s[156]=i("p",null,"结果：",-1)),s[157]||(s[157]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "tokens"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : [")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "token"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"黑马"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "start_offset"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "end_offset"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"CN_WORD"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "position"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "token"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"程序员"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "start_offset"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "end_offset"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"5"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"CN_WORD"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "position"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "token"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"程序"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "start_offset"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "end_offset"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"4"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"CN_WORD"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "position"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "token"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"员"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "start_offset"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"4"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "end_offset"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"5"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"CN_CHAR"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "position"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"3")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "token"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"学习"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "start_offset"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"5"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "end_offset"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"7"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"CN_WORD"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "position"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"4")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "token"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"java"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "start_offset"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"7"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "end_offset"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"11"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"ENGLISH"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "position"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"5")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "token"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"太棒了"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "start_offset"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"11"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "end_offset"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"14"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"CN_WORD"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "position"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"6")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "token"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"太棒"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "start_offset"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"11"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "end_offset"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"13"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"CN_WORD"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "position"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"7")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "token"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"了"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "start_offset"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"13"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "end_offset"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"14"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"CN_CHAR"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "position"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"8")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  ]")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[158]||(s[158]=i("h5",{id:"_3-扩展词词典",tabindex:"-1"},[l("3. 扩展词词典 "),i("a",{class:"header-anchor",href:"#_3-扩展词词典","aria-label":'Permalink to "3. 扩展词词典"'},"​")],-1)),s[159]||(s[159]=i("p",null,"随着互联网的发展，“造词运动”也越发的频繁。出现了很多新的词语，在原有的词汇列表中并不存在。比如：“奥力给”，“传智播客” 等。",-1)),s[160]||(s[160]=i("p",null,"所以我们的词汇也需要不断的更新，IK分词器提供了扩展词汇的功能。",-1)),s[161]||(s[161]=i("p",null,"1）打开IK分词器config目录：",-1)),s[162]||(s[162]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210506112225508.png",alt:"image-20210506112225508",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[163]||(s[163]=i("p",null,"2）在IKAnalyzer.cfg.xml配置文件内容添加：",-1)),s[164]||(s[164]=i("div",{class:"language-xml max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"xml"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<?"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"xml"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," version"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"1.0"'),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," encoding"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"UTF-8"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"?>")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<!"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"DOCTYPE"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," properties"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},' SYSTEM "http://java.sun.com/dtd/properties.dtd">')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"properties"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        <"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"comment"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">IK Analyzer 扩展配置</"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"comment"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        <!--用户可以在这里配置自己的扩展字典 *** 添加扩展词典-->")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        <"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"entry"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," key"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"ext_dict"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">ext.dic</"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"entry"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"</"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"properties"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[165]||(s[165]=i("p",null,"3）新建一个 ext.dic，可以参考config目录下复制一个配置文件进行修改",-1)),s[166]||(s[166]=i("div",{class:"language-properties max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"properties"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"传智播客")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"奥力给")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[167]||(s[167]=i("p",null,"4）重启elasticsearch",-1)),s[168]||(s[168]=i("div",{class:"language-sh max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"sh"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," restart"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," es")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 查看 日志")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," logs"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -f"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," elasticsearch")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[169]||(s[169]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20201115230900504.png",alt:"image-20201115230900504",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[170]||(s[170]=i("p",null,"日志中已经成功加载ext.dic配置文件",-1)),s[171]||(s[171]=i("p",null,"5）测试效果：",-1)),s[172]||(s[172]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /_analyze")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "analyzer"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"ik_max_word"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "text"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"传智播客Java就业超过90%,奥力给！"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[173]||(s[173]=i("blockquote",null,[i("p",null,"注意当前文件的编码必须是 UTF-8 格式，严禁使用Windows记事本编辑")],-1)),s[174]||(s[174]=i("h5",{id:"_4-停用词词典",tabindex:"-1"},[l("4. 停用词词典 "),i("a",{class:"header-anchor",href:"#_4-停用词词典","aria-label":'Permalink to "4. 停用词词典"'},"​")],-1)),s[175]||(s[175]=i("p",null,"在互联网项目中，在网络间传输的速度很快，所以很多语言是不允许在网络上传递的，如：关于宗教、政治等敏感词语，那么我们在搜索时也应该忽略当前词汇。",-1)),s[176]||(s[176]=i("p",null,"IK分词器也提供了强大的停用词功能，让我们在索引时就直接忽略当前的停用词汇表中的内容。",-1)),s[177]||(s[177]=i("p",null,"1）IKAnalyzer.cfg.xml配置文件内容添加：",-1)),s[178]||(s[178]=i("div",{class:"language-xml max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"xml"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<?"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"xml"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," version"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"1.0"'),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," encoding"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"UTF-8"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"?>")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<!"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"DOCTYPE"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," properties"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},' SYSTEM "http://java.sun.com/dtd/properties.dtd">')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"properties"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        <"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"comment"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">IK Analyzer 扩展配置</"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"comment"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        <!--用户可以在这里配置自己的扩展字典-->")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        <"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"entry"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," key"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"ext_dict"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">ext.dic</"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"entry"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"         <!--用户可以在这里配置自己的扩展停止词字典  *** 添加停用词词典-->")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        <"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"entry"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," key"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"ext_stopwords"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">stopword.dic</"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"entry"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"</"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"properties"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[179]||(s[179]=i("p",null,"3）在 stopword.dic 添加停用词",-1)),s[180]||(s[180]=i("div",{class:"language-properties max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"properties"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"习大大")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[181]||(s[181]=i("p",null,"4）重启elasticsearch",-1)),s[182]||(s[182]=i("div",{class:"language-sh max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"sh"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 重启服务")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," restart"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," elasticsearch")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," restart"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," kibana")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 查看 日志")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," logs"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -f"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," elasticsearch")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[183]||(s[183]=i("p",null,"日志中已经成功加载stopword.dic配置文件",-1)),s[184]||(s[184]=i("p",null,"5）测试效果：",-1)),s[185]||(s[185]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /_analyze")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "analyzer"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"ik_max_word"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "text"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"传智播客Java就业率超过95%,习大大都点赞,奥力给！"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[186]||(s[186]=i("blockquote",null,[i("p",null,"注意当前文件的编码必须是 UTF-8 格式，严禁使用Windows记事本编辑")],-1)),s[187]||(s[187]=i("h4",{id:"总结",tabindex:"-1"},[l("总结 "),i("a",{class:"header-anchor",href:"#总结","aria-label":'Permalink to "总结"'},"​")],-1)),s[188]||(s[188]=i("blockquote",null,[i("ul",null,[i("li",null,[i("p",null,"分词器的作用是什么？"),i("ul",null,[i("li",null,[i("p",null,"创建倒排索引时对文档分词")]),i("li",null,[i("p",null,"用户搜索时，对输入的内容分词")])])]),i("li",null,[i("p",null,"IK分词器有几种模式？"),i("ul",null,[i("li",null,[i("p",null,"ik_smart：智能切分，粗粒度")]),i("li",null,[i("p",null,"ik_max_word：最细切分，细粒度")])])]),i("li",null,[i("p",null,"IK分词器如何拓展词条？如何停用词条？"),i("ul",null,[i("li",null,[i("p",null,"利用config目录的IkAnalyzer.cfg.xml文件添加拓展词典和停用词典")]),i("li",null,[i("p",null,"在词典中添加拓展词条或者停用词条")])])])])],-1)),s[189]||(s[189]=i("hr",null,null,-1)),s[190]||(s[190]=i("h2",{id:"_2-索引库操作",tabindex:"-1"},[l("2. 索引库操作 "),i("a",{class:"header-anchor",href:"#_2-索引库操作","aria-label":'Permalink to "2. 索引库操作"'},"​")],-1)),s[191]||(s[191]=i("p",null,"索引库就类似数据库表，mapping映射就类似表的结构。",-1)),s[192]||(s[192]=i("p",null,"我们要向es中存储数据，必须先创建“库”和“表”。",-1)),s[193]||(s[193]=i("h3",{id:"_2-1-mapping映射属性",tabindex:"-1"},[l("2.1 mapping映射属性 "),i("a",{class:"header-anchor",href:"#_2-1-mapping映射属性","aria-label":'Permalink to "2.1 mapping映射属性"'},"​")],-1)),s[194]||(s[194]=i("p",null,"mapping是对索引库中文档的约束，常见的mapping属性包括：",-1)),s[195]||(s[195]=i("ul",null,[i("li",null,[l("type：字段数据类型，常见的简单类型有： "),i("ul",null,[i("li",null,"字符串：text（可分词的文本）、keyword（精确值，例如：品牌、国家、ip地址）"),i("li",null,"数值：long、integer、short、byte、double、float、"),i("li",null,"布尔：boolean"),i("li",null,"日期：date"),i("li",null,"对象：object")])]),i("li",null,"index：是否创建索引，默认为true"),i("li",null,"analyzer：使用哪种分词器"),i("li",null,"properties：该字段的子字段")],-1)),s[196]||(s[196]=i("p",null,"例如下面的json文档：",-1)),s[197]||(s[197]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "age"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"21"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "weight"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"52.1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "isMarried"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"false"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "info"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"黑马程序员Java讲师"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "email"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"zy@itcast.cn"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "score"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": ["),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"99.1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"99.5"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"98.9"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"],")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "name"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "firstName"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"云"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "lastName"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"赵"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[198]||(s[198]=i("p",null,"对应的每个字段映射（mapping）：",-1)),s[199]||(s[199]=i("ul",null,[i("li",null,"age：类型为 integer；参与搜索，因此需要index为true；无需分词器"),i("li",null,"weight：类型为float；参与搜索，因此需要index为true；无需分词器"),i("li",null,"isMarried：类型为boolean；参与搜索，因此需要index为true；无需分词器"),i("li",null,"info：类型为字符串，需要分词，因此是text；参与搜索，因此需要index为true；分词器可以用ik_smart"),i("li",null,"email：类型为字符串，但是不需要分词，因此是keyword；不参与搜索，因此需要index为false；无需分词器"),i("li",null,"score：虽然是数组，但是我们只看元素的类型，类型为float；参与搜索，因此需要index为true；无需分词器"),i("li",null,[l("name：类型为object，需要定义多个子属性 "),i("ul",null,[i("li",null,"name.firstName；类型为字符串，但是不需要分词，因此是keyword；参与搜索，因此需要index为true；无需分词器"),i("li",null,"name.lastName；类型为字符串，但是不需要分词，因此是keyword；参与搜索，因此需要index为true；无需分词器")])])],-1)),s[200]||(s[200]=i("h3",{id:"_2-2-索引库的crud",tabindex:"-1"},[l("2.2 索引库的CRUD "),i("a",{class:"header-anchor",href:"#_2-2-索引库的crud","aria-label":'Permalink to "2.2 索引库的CRUD"'},"​")],-1)),s[201]||(s[201]=i("p",null,"这里我们统一使用Kibana编写DSL的方式来演示。",-1)),s[202]||(s[202]=i("h4",{id:"_2-2-1-创建索引库和映射",tabindex:"-1"},[l("2.2.1 创建索引库和映射 "),i("a",{class:"header-anchor",href:"#_2-2-1-创建索引库和映射","aria-label":'Permalink to "2.2.1 创建索引库和映射"'},"​")],-1)),s[203]||(s[203]=i("h4",{id:"基本语法",tabindex:"-1"},[l("基本语法： "),i("a",{class:"header-anchor",href:"#基本语法","aria-label":'Permalink to "基本语法："'},"​")],-1)),s[204]||(s[204]=i("ul",null,[i("li",null,"请求方式：PUT"),i("li",null,"请求路径：/索引库名，可以自定义"),i("li",null,"请求参数：mapping映射")],-1)),s[205]||(s[205]=i("p",null,"格式：",-1)),s[206]||(s[206]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"PUT /索引库名称")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "mappings"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "properties"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "字段名"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"text"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "analyzer"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"ik_smart"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "字段名2"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"keyword"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "index"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"false"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "字段名3"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "properties"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "子字段"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'            "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"keyword"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"          }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"      // ...略")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[207]||(s[207]=i("h4",{id:"示例",tabindex:"-1"},[l("示例： "),i("a",{class:"header-anchor",href:"#示例","aria-label":'Permalink to "示例："'},"​")],-1)),s[208]||(s[208]=i("div",{class:"language-sh max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"sh"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"PUT /heima")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},'  "mappings"'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},":"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},'    "properties"'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},":"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},'      "info"'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},":"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},'        "type"'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},":"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},' "text"'),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},'        "analyzer"'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},":"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},' "ik_smart"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},'      "email"'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},":"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},'        "type"'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},":"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},' "keyword"'),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},'        "index"'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},":"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},' "falsae"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},'      "name"'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},":"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},'        "properties"'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},":"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},'          "firstName"'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},":"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},'            "type"'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},":"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},' "keyword"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"          }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      //"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ..."),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 略")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[209]||(s[209]=i("h4",{id:"_2-2-2-查询索引库",tabindex:"-1"},[l("2.2.2 查询索引库 "),i("a",{class:"header-anchor",href:"#_2-2-2-查询索引库","aria-label":'Permalink to "2.2.2 查询索引库"'},"​")],-1)),s[210]||(s[210]=i("p",null,[i("strong",null,"基本语法"),l("：")],-1)),s[211]||(s[211]=i("ul",null,[i("li",null,[i("p",null,"请求方式：GET")]),i("li",null,[i("p",null,"请求路径：/索引库名")]),i("li",null,[i("p",null,"请求参数：无")])],-1)),s[212]||(s[212]=i("p",null,[i("strong",null,"格式"),l("：")],-1)),s[213]||(s[213]=i("div",{class:"language- max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"}),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",null,"GET /索引库名")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[214]||(s[214]=i("p",null,[i("strong",null,"示例"),l("：")],-1)),s[215]||(s[215]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720211019329.png",alt:"image-20210720211019329",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[216]||(s[216]=i("h4",{id:"_2-2-3-修改索引库",tabindex:"-1"},[l("2.2.3 修改索引库 "),i("a",{class:"header-anchor",href:"#_2-2-3-修改索引库","aria-label":'Permalink to "2.2.3 修改索引库"'},"​")],-1)),s[217]||(s[217]=i("p",null,[l("倒排索引结构虽然不复杂，但是一旦数据结构改变（比如改变了分词器），就需要重新创建倒排索引，这简直是灾难。因此索引库"),i("strong",null,"一旦创建，无法修改mapping"),l("。")],-1)),s[218]||(s[218]=i("p",null,"虽然无法修改mapping中已有的字段，但是却允许添加新的字段到mapping中，因为不会对倒排索引产生影响。",-1)),s[219]||(s[219]=i("p",null,[i("strong",null,"语法说明"),l("：")],-1)),s[220]||(s[220]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"PUT /索引库名/_mapping")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "properties"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "新字段名"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"integer"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[221]||(s[221]=i("p",null,[i("strong",null,"示例"),l("：")],-1)),s[222]||(s[222]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720212357390.png",alt:"image-20210720212357390",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[223]||(s[223]=i("h4",{id:"_2-2-4-删除索引库",tabindex:"-1"},[l("2.2.4 删除索引库 "),i("a",{class:"header-anchor",href:"#_2-2-4-删除索引库","aria-label":'Permalink to "2.2.4 删除索引库"'},"​")],-1)),s[224]||(s[224]=i("p",null,[i("strong",null,"语法：")],-1)),s[225]||(s[225]=i("ul",null,[i("li",null,[i("p",null,"请求方式：DELETE")]),i("li",null,[i("p",null,"请求路径：/索引库名")]),i("li",null,[i("p",null,"请求参数：无")])],-1)),s[226]||(s[226]=i("p",null,[i("strong",null,"格式：")],-1)),s[227]||(s[227]=i("div",{class:"language- max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"}),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",null,"DELETE /索引库名")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[228]||(s[228]=i("p",null,"在kibana中测试：",-1)),s[229]||(s[229]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720212123420.png",alt:"image-20210720212123420",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[230]||(s[230]=i("h4",{id:"_2-2-5-总结",tabindex:"-1"},[l("2.2.5 总结 "),i("a",{class:"header-anchor",href:"#_2-2-5-总结","aria-label":'Permalink to "2.2.5 总结"'},"​")],-1)),s[231]||(s[231]=i("p",null,"索引库操作有哪些？",-1)),s[232]||(s[232]=i("ul",null,[i("li",null,"创建索引库：PUT /索引库名"),i("li",null,"查询索引库：GET /索引库名"),i("li",null,"删除索引库：DELETE /索引库名"),i("li",null,"添加字段：PUT /索引库名/_mapping")],-1)),s[233]||(s[233]=i("hr",null,null,-1)),s[234]||(s[234]=i("h2",{id:"_3-文档操作",tabindex:"-1"},[l("3. 文档操作 "),i("a",{class:"header-anchor",href:"#_3-文档操作","aria-label":'Permalink to "3. 文档操作"'},"​")],-1)),s[235]||(s[235]=i("h3",{id:"_3-1-新增文档",tabindex:"-1"},[l("3.1 新增文档 "),i("a",{class:"header-anchor",href:"#_3-1-新增文档","aria-label":'Permalink to "3.1 新增文档"'},"​")],-1)),s[236]||(s[236]=i("p",null,[i("strong",null,"语法：")],-1)),s[237]||(s[237]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"POST /索引库名/_doc/文档id")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "字段1"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"值1"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "字段2"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"值2"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "字段3"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "子属性1"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"值3"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "子属性2"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"值4"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // ...")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[238]||(s[238]=i("p",null,[i("strong",null,"示例：")],-1)),s[239]||(s[239]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"POST /heima/_doc/"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "info"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"黑马程序员Java讲师"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "email"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"zy@itcast.cn"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "name"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "firstName"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"云"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "lastName"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"赵"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[240]||(s[240]=i("p",null,[i("strong",null,"响应：")],-1)),s[241]||(s[241]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720212933362.png",alt:"image-20210720212933362",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[242]||(s[242]=i("h3",{id:"_3-2-查询文档",tabindex:"-1"},[l("3.2 查询文档 "),i("a",{class:"header-anchor",href:"#_3-2-查询文档","aria-label":'Permalink to "3.2 查询文档"'},"​")],-1)),s[243]||(s[243]=i("p",null,"根据rest风格，新增是post，查询应该是get，不过查询一般都需要条件，这里我们把文档id带上。",-1)),s[244]||(s[244]=i("p",null,[i("strong",null,"语法：")],-1)),s[245]||(s[245]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /{"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"索引库名称"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}/_doc/{"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"id"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[246]||(s[246]=i("p",null,[i("strong",null,"通过kibana查看数据：")],-1)),s[247]||(s[247]=i("div",{class:"language-js max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"js"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"GET"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," /"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"heima"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"_doc"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[248]||(s[248]=i("p",null,[i("strong",null,"查看结果：")],-1)),s[249]||(s[249]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720213345003.png",alt:"image-20210720213345003",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[250]||(s[250]=i("h3",{id:"_3-3-删除文档",tabindex:"-1"},[l("3.3 删除文档 "),i("a",{class:"header-anchor",href:"#_3-3-删除文档","aria-label":'Permalink to "3.3 删除文档"'},"​")],-1)),s[251]||(s[251]=i("p",null,"删除使用DELETE请求，同样，需要根据id进行删除：",-1)),s[252]||(s[252]=i("p",null,[i("strong",null,"语法：")],-1)),s[253]||(s[253]=i("div",{class:"language-js max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"js"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"DELETE"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," /"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{索引库名}"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"_doc"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"id值")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[254]||(s[254]=i("p",null,[i("strong",null,"示例：")],-1)),s[255]||(s[255]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"# 根据id删除数据")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"DELETE /heima/_doc/"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[256]||(s[256]=i("p",null,[i("strong",null,"结果：")],-1)),s[257]||(s[257]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720213634918.png",alt:"image-20210720213634918",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[258]||(s[258]=i("h3",{id:"_3-4-修改文档",tabindex:"-1"},[l("3.4 修改文档 "),i("a",{class:"header-anchor",href:"#_3-4-修改文档","aria-label":'Permalink to "3.4 修改文档"'},"​")],-1)),s[259]||(s[259]=i("p",null,"修改有两种方式：",-1)),s[260]||(s[260]=i("ul",null,[i("li",null,"全量修改：直接覆盖原来的文档"),i("li",null,"增量修改：修改文档中的部分字段")],-1)),s[261]||(s[261]=i("h4",{id:"_3-4-1-全量修改",tabindex:"-1"},[l("3.4.1 全量修改 "),i("a",{class:"header-anchor",href:"#_3-4-1-全量修改","aria-label":'Permalink to "3.4.1 全量修改"'},"​")],-1)),s[262]||(s[262]=i("p",null,"全量修改是覆盖原来的文档，其本质是：",-1)),s[263]||(s[263]=i("ul",null,[i("li",null,"根据指定的id删除文档"),i("li",null,"新增一个相同id的文档")],-1)),s[264]||(s[264]=i("p",null,[i("strong",null,"注意"),l("：如果根据id删除时，id不存在，第二步的新增也会执行，也就从修改变成了新增操作了。")],-1)),s[265]||(s[265]=i("p",null,[i("strong",null,"语法：")],-1)),s[266]||(s[266]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"PUT /{"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"索引库名"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}/_doc/文档id")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "字段1"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"值1"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "字段2"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"值2"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // ... 略")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[267]||(s[267]=i("p",null,[i("strong",null,"示例：")],-1)),s[268]||(s[268]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"PUT /heima/_doc/"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "info"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"黑马程序员高级Java讲师"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "email"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"zy@itcast.cn"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "name"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "firstName"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"云"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "lastName"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"赵"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[269]||(s[269]=i("h4",{id:"_3-4-2-增量修改",tabindex:"-1"},[l("3.4.2 增量修改 "),i("a",{class:"header-anchor",href:"#_3-4-2-增量修改","aria-label":'Permalink to "3.4.2 增量修改"'},"​")],-1)),s[270]||(s[270]=i("p",null,"增量修改是只修改指定id匹配的文档中的部分字段。",-1)),s[271]||(s[271]=i("p",null,[i("strong",null,"语法：")],-1)),s[272]||(s[272]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"POST /{"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"索引库名"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}/_update/文档id")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "doc"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'         "字段名"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"新的值"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[273]||(s[273]=i("p",null,[i("strong",null,"示例：")],-1)),s[274]||(s[274]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"POST /heima/_update/"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "doc"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "email"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"ZhaoYun@itcast.cn"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[275]||(s[275]=i("h3",{id:"_3-5-总结",tabindex:"-1"},[l("3.5 总结 "),i("a",{class:"header-anchor",href:"#_3-5-总结","aria-label":'Permalink to "3.5 总结"'},"​")],-1)),s[276]||(s[276]=i("blockquote",null,[i("ul",null,[i("li",null,[i("p",null,"文档操作有哪些？"),i("ul",null,[i("li",{json文档:""},[i("p",null,"创建文档：POST /{索引库名}/_doc/文档id ")]),i("li",null,[i("p",null,"查询文档：GET /{索引库名}/_doc/文档id")]),i("li",null,[i("p",null,"删除文档：DELETE /{索引库名}/_doc/文档id")]),i("li",null,[i("p",null,"修改文档："),i("ul",null,[i("li",{json文档:""},[l("全量修改：PUT /{索引库名}/_doc/文档id "),i("ul",null,[i("li",null,'增量修改：POST /{索引库名}/_update/文档id { "doc": {字段}}')])])])])])])])],-1)),s[277]||(s[277]=i("hr",null,null,-1)),s[278]||(s[278]=i("h2",{id:"_4-restapi",tabindex:"-1"},[l("4. RestAPI "),i("a",{class:"header-anchor",href:"#_4-restapi","aria-label":'Permalink to "4. RestAPI"'},"​")],-1)),s[279]||(s[279]=i("p",null,[l("ES官方提供了各种不同语言的客户端，用来操作ES。这些客户端的本质就是组装DSL语句，通过http请求发送给ES。官方文档地址："),i("a",{href:"https://www.elastic.co/guide/en/elasticsearch/client/index.html",target:"_blank",rel:"noreferrer"},"https://www.elastic.co/guide/en/elasticsearch/client/index.html")],-1)),s[280]||(s[280]=i("p",null,"其中的Java Rest Client又包括两种：",-1)),s[281]||(s[281]=i("ul",null,[i("li",null,"Java Low Level Rest Client"),i("li",null,"Java High Level Rest Client")],-1)),s[282]||(s[282]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720214555863.png",alt:"image-20210720214555863",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[283]||(s[283]=i("p",null,"我们学习的是Java HighLevel Rest Client客户端API",-1)),s[284]||(s[284]=i("h3",{id:"_4-0-导入demo工程",tabindex:"-1"},[l("4.0 导入Demo工程 "),i("a",{class:"header-anchor",href:"#_4-0-导入demo工程","aria-label":'Permalink to "4.0 导入Demo工程"'},"​")],-1)),s[285]||(s[285]=i("h4",{id:"_4-0-1-导入数据",tabindex:"-1"},[l("4.0.1 导入数据 "),i("a",{class:"header-anchor",href:"#_4-0-1-导入数据","aria-label":'Permalink to "4.0.1 导入数据"'},"​")],-1)),s[286]||(s[286]=i("p",null,"首先导入课前资料提供的数据库数据：",-1)),s[287]||(s[287]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720220400297.png",alt:"image-20210720220400297",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[288]||(s[288]=i("p",null,"数据结构如下：",-1)),s[289]||(s[289]=i("div",{class:"language-sql max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"sql"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"CREATE"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," TABLE"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," `"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"tb_hotel"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"` (")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  `id`"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," bigint"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"20"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"NOT NULL"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," COMMENT "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'酒店id'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  `name`"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," varchar"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"255"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"NOT NULL"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," COMMENT "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'酒店名称；例：7天酒店'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  `address`"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," varchar"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"255"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"NOT NULL"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," COMMENT "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'酒店地址；例：航头路'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  `price`"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," int"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"10"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"NOT NULL"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," COMMENT "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'酒店价格；例：329'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  `score`"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," int"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"NOT NULL"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," COMMENT "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'酒店评分；例：45，就是4.5分'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  `brand`"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," varchar"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"32"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"NOT NULL"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," COMMENT "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'酒店品牌；例：如家'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  `city`"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," varchar"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"32"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"NOT NULL"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," COMMENT "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'所在城市；例：上海'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  `star_name`"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," varchar"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"16"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"DEFAULT"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," NULL"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," COMMENT "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'酒店星级，从低到高分别是：1星到5星，1钻到5钻'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  `business`"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," varchar"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"255"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"DEFAULT"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," NULL"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," COMMENT "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'商圈；例：虹桥'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  `latitude`"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," varchar"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"32"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"NOT NULL"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," COMMENT "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'纬度；例：31.2497'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  `longitude`"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," varchar"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"32"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"NOT NULL"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," COMMENT "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'经度；例：120.3925'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  `pic`"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," varchar"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"255"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"DEFAULT"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," NULL"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," COMMENT "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'酒店图片；例:/img/1.jpg'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"  PRIMARY KEY"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"`id`"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") ENGINE"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"InnoDB "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"DEFAULT"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," CHARSET"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"utf8mb4;")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[290]||(s[290]=i("h4",{id:"_4-0-2-导入项目",tabindex:"-1"},[l("4.0.2 导入项目 "),i("a",{class:"header-anchor",href:"#_4-0-2-导入项目","aria-label":'Permalink to "4.0.2 导入项目"'},"​")],-1)),s[291]||(s[291]=i("p",null,"然后导入课前资料提供的项目:",-1)),s[292]||(s[292]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720220503411.png",alt:"image-20210720220503411",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[293]||(s[293]=i("p",null,"项目结构如图：",-1)),s[294]||(s[294]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720220647541.png",alt:"image-20210720220647541",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[295]||(s[295]=i("h4",{id:"_4-0-3-mapping映射分析",tabindex:"-1"},[l("4.0.3 mapping映射分析 "),i("a",{class:"header-anchor",href:"#_4-0-3-mapping映射分析","aria-label":'Permalink to "4.0.3 mapping映射分析"'},"​")],-1)),s[296]||(s[296]=i("p",null,"创建索引库，最关键的是mapping映射，而mapping映射要考虑的信息包括：",-1)),s[297]||(s[297]=i("ul",null,[i("li",null,"字段名"),i("li",null,"字段数据类型"),i("li",null,"是否参与搜索"),i("li",null,"是否需要分词"),i("li",null,"如果分词，分词器是什么？")],-1)),s[298]||(s[298]=i("p",null,"其中：",-1)),s[299]||(s[299]=i("ul",null,[i("li",null,"字段名、字段数据类型，可以参考数据表结构的名称和类型"),i("li",null,"是否参与搜索要分析业务来判断，例如图片地址，就无需参与搜索"),i("li",null,"是否分词呢要看内容，内容如果是一个整体就无需分词，反之则要分词"),i("li",null,"分词器，我们可以统一使用ik_max_word")],-1)),s[300]||(s[300]=i("p",null,"来看下酒店数据的索引库结构:",-1)),s[301]||(s[301]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"PUT /hotel")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "mappings"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "properties"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "id"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"keyword"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "name"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"text"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "analyzer"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"ik_max_word"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "copy_to"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"all"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "address"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"keyword"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "index"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"false")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "price"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"integer"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "score"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"integer"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "brand"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"keyword"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "copy_to"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"all"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "city"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"keyword"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "copy_to"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"all"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "starName"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"keyword"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "business"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"keyword"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "location"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"geo_point"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "pic"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"keyword"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "index"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"false")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "all"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"text"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "analyzer"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"ik_max_word"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[302]||(s[302]=i("p",null,"几个特殊字段说明：",-1)),s[303]||(s[303]=i("ul",null,[i("li",null,"location：地理坐标，里面包含精度、纬度"),i("li",null,"all：一个组合字段，其目的是将多字段的值 利用copy_to合并，提供给用户搜索")],-1)),s[304]||(s[304]=i("p",null,"地理坐标说明：",-1)),s[305]||(s[305]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720222110126.png",alt:"image-20210720222110126",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[306]||(s[306]=i("p",null,"copy_to说明：",-1)),s[307]||(s[307]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720222221516.png",alt:"image-20210720222221516",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[308]||(s[308]=i("h4",{id:"_4-0-4-初始化restclient",tabindex:"-1"},[l("4.0.4 初始化RestClient "),i("a",{class:"header-anchor",href:"#_4-0-4-初始化restclient","aria-label":'Permalink to "4.0.4 初始化RestClient"'},"​")],-1)),s[309]||(s[309]=i("p",null,"在elasticsearch提供的API中，与elasticsearch一切交互都封装在一个名为RestHighLevelClient的类中，必须先完成这个对象的初始化，建立与elasticsearch的连接。",-1)),s[310]||(s[310]=i("p",null,"分为三步：",-1)),s[311]||(s[311]=i("p",null,"1）引入es的RestHighLevelClient依赖：",-1)),s[312]||(s[312]=i("div",{class:"language-xml max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"xml"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"dependency"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    <"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"groupId"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">org.elasticsearch.client</"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"groupId"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    <"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"artifactId"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">elasticsearch-rest-high-level-client</"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"artifactId"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"</"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"dependency"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[313]||(s[313]=i("p",null,"2）因为SpringBoot默认的ES版本是7.6.2，所以我们需要覆盖默认的ES版本：",-1)),s[314]||(s[314]=i("div",{class:"language-xml max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"xml"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"properties"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    <"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"java.version"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">1.8</"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"java.version"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    <"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"elasticsearch.version"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">7.12.1</"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"elasticsearch.version"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"</"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"properties"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[315]||(s[315]=i("p",null,"3）初始化RestHighLevelClient：",-1)),s[316]||(s[316]=i("p",null,"初始化的代码如下：",-1)),s[317]||(s[317]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"RestHighLevelClient client "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," RestHighLevelClient"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(RestClient."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"builder"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        HttpHost."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"create"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"http://192.168.150.101:9200"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"));")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[318]||(s[318]=i("p",null,"这里为了单元测试方便，我们创建一个测试类HotelIndexTest，然后将初始化的代码编写在@BeforeEach方法中：",-1)),s[319]||(s[319]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"package"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," cn.itcast.hotel;")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.apache.http.HttpHost;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.elasticsearch.client.RestHighLevelClient;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.junit.jupiter.api.AfterEach;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.junit.jupiter.api.BeforeEach;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.junit.jupiter.api.Test;")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," java.io.IOException;")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HotelIndexTest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RestHighLevelClient client;")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"BeforeEach")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    void"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," setUp"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".client "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," RestHighLevelClient"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(RestClient."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"builder"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                HttpHost."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"create"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"http://192.168.150.101:9200"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        ));")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"AfterEach")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    void"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," tearDown"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"throws"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," IOException {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"close"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[320]||(s[320]=i("h3",{id:"_4-1-创建索引库",tabindex:"-1"},[l("4.1 创建索引库 "),i("a",{class:"header-anchor",href:"#_4-1-创建索引库","aria-label":'Permalink to "4.1 创建索引库"'},"​")],-1)),s[321]||(s[321]=i("h4",{id:"_4-1-1-代码解读",tabindex:"-1"},[l("4.1.1 代码解读 "),i("a",{class:"header-anchor",href:"#_4-1-1-代码解读","aria-label":'Permalink to "4.1.1 代码解读"'},"​")],-1)),s[322]||(s[322]=i("p",null,"创建索引库的API如下：",-1)),s[323]||(s[323]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720223049408.png",alt:"image-20210720223049408",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[324]||(s[324]=i("p",null,"代码分为三步：",-1)),s[325]||(s[325]=i("ul",null,[i("li",null,"1）创建Request对象。因为是创建索引库的操作，因此Request是CreateIndexRequest。"),i("li",null,"2）添加请求参数，其实就是DSL的JSON参数部分。因为json字符串很长，这里是定义了静态字符串常量MAPPING_TEMPLATE，让代码看起来更加优雅。"),i("li",null,"3）发送请求，client.indices()方法的返回值是IndicesClient类型，封装了所有与索引库操作有关的方法。")],-1)),s[326]||(s[326]=i("h4",{id:"_4-1-2-完整示例",tabindex:"-1"},[l("4.1.2 完整示例 "),i("a",{class:"header-anchor",href:"#_4-1-2-完整示例","aria-label":'Permalink to "4.1.2 完整示例"'},"​")],-1)),s[327]||(s[327]=i("p",null,"在hotel-demo的cn.itcast.hotel.constants包下，创建一个类，定义mapping映射的JSON字符串常量：",-1)),s[328]||(s[328]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"package"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," cn.itcast.hotel.constants;")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HotelConstants"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," final"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String MAPPING_TEMPLATE "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "{'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "  '),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"mappings"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": {"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "    '),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"properties"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": {"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      '),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"id"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": {"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"type"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"keyword"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"\\n'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      },'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      '),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"name"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},":{"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"type"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"text"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},","),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"analyzer"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"ik_max_word"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},","),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"copy_to"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"all"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"\\n'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      },'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      '),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"address"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},":{"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"type"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"keyword"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},","),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"index"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": false"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      },'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      '),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"price"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},":{"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"type"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"integer"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"\\n'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      },'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      '),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"score"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},":{"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"type"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"integer"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"\\n'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      },'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      '),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"brand"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},":{"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"type"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"keyword"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},","),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"copy_to"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"all"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"\\n'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      },'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      '),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"city"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},":{"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"type"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"keyword"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},","),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"copy_to"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"all"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"\\n'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      },'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      '),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"starName"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},":{"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"type"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"keyword"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"\\n'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      },'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      '),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"business"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},":{"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"type"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"keyword"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"\\n'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      },'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      '),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"location"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},":{"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"type"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"geo_point"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"\\n'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      },'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      '),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"pic"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},":{"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"type"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"keyword"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},","),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"index"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": false"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      },'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      '),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"all"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},":{"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"type"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"text"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},","),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "        '),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"analyzer"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"ik_max_word"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'\\"\\n'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "      }'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "    }'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "  }'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "}"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[329]||(s[329]=i("p",null,"在hotel-demo中的HotelIndexTest测试类中，编写单元测试，实现创建索引：",-1)),s[330]||(s[330]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Test")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"void"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," createHotelIndex"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() throws IOException {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 1.创建Request对象")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    CreateIndexRequest request "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," CreateIndexRequest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.准备请求的参数：DSL语句")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    request."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(MAPPING_TEMPLATE, XContentType.JSON);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 3.发送请求")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"indices"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"create"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[331]||(s[331]=i("h3",{id:"_4-2-删除索引库",tabindex:"-1"},[l("4.2 删除索引库 "),i("a",{class:"header-anchor",href:"#_4-2-删除索引库","aria-label":'Permalink to "4.2 删除索引库"'},"​")],-1)),s[332]||(s[332]=i("p",null,"删除索引库的DSL语句非常简单：",-1)),s[333]||(s[333]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"DELETE /hotel")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[334]||(s[334]=i("p",null,"与创建索引库相比：",-1)),s[335]||(s[335]=i("ul",null,[i("li",null,"请求方式从PUT变为DELTE"),i("li",null,"请求路径不变"),i("li",null,"无请求参数")],-1)),s[336]||(s[336]=i("p",null,"所以代码的差异，注意体现在Request对象上。依然是三步走：",-1)),s[337]||(s[337]=i("ul",null,[i("li",null,"1）创建Request对象。这次是DeleteIndexRequest对象"),i("li",null,"2）准备参数。这里是无参"),i("li",null,"3）发送请求。改用delete方法")],-1)),s[338]||(s[338]=i("p",null,"在hotel-demo中的HotelIndexTest测试类中，编写单元测试，实现删除索引：",-1)),s[339]||(s[339]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Test")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"void"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testDeleteHotelIndex"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() throws IOException {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 1.创建Request对象")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    DeleteIndexRequest request "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," DeleteIndexRequest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.发送请求")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"indices"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"delete"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[340]||(s[340]=i("h3",{id:"_4-3-判断索引库是否存在",tabindex:"-1"},[l("4.3 判断索引库是否存在 "),i("a",{class:"header-anchor",href:"#_4-3-判断索引库是否存在","aria-label":'Permalink to "4.3 判断索引库是否存在"'},"​")],-1)),s[341]||(s[341]=i("p",null,"判断索引库是否存在，本质就是查询，对应的DSL是：",-1)),s[342]||(s[342]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /hotel")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[343]||(s[343]=i("p",null,"因此与删除的Java代码流程是类似的。依然是三步走：",-1)),s[344]||(s[344]=i("ul",null,[i("li",null,"1）创建Request对象。这次是GetIndexRequest对象"),i("li",null,"2）准备参数。这里是无参"),i("li",null,"3）发送请求。改用exists方法")],-1)),s[345]||(s[345]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Test")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"void"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testExistsHotelIndex"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() throws IOException {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 1.创建Request对象")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    GetIndexRequest request "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," GetIndexRequest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.发送请求")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    boolean"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," exists "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"indices"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"exists"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 3.输出")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    System.err."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(exists "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"?"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "索引库已经存在！"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," :"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "索引库不存在！"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[346]||(s[346]=i("h3",{id:"_4-4-总结",tabindex:"-1"},[l("4.4 总结 "),i("a",{class:"header-anchor",href:"#_4-4-总结","aria-label":'Permalink to "4.4 总结"'},"​")],-1)),s[347]||(s[347]=i("p",null,"JavaRestClient操作elasticsearch的流程基本类似。核心是client.indices()方法来获取索引库的操作对象。",-1)),s[348]||(s[348]=i("p",null,"索引库操作的基本步骤：",-1)),s[349]||(s[349]=i("ul",null,[i("li",null,"初始化RestHighLevelClient"),i("li",null,"创建XxxIndexRequest。XXX是Create、Get、Delete"),i("li",null,"准备DSL（ Create时需要，其它是无参）"),i("li",null,"发送请求。调用RestHighLevelClient#indices().xxx()方法，xxx是create、exists、delete")],-1)),s[350]||(s[350]=i("hr",null,null,-1)),s[351]||(s[351]=i("h2",{id:"_5-restclient操作文档",tabindex:"-1"},[l("5. RestClient操作文档 "),i("a",{class:"header-anchor",href:"#_5-restclient操作文档","aria-label":'Permalink to "5. RestClient操作文档"'},"​")],-1)),s[352]||(s[352]=i("p",null,"为了与索引库操作分离，我们再次参加一个测试类，做两件事情：",-1)),s[353]||(s[353]=i("ul",null,[i("li",null,"初始化RestHighLevelClient"),i("li",null,"我们的酒店数据在数据库，需要利用IHotelService去查询，所以注入这个接口")],-1)),s[354]||(s[354]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"package"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," cn.itcast.hotel;")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," cn.itcast.hotel.pojo.Hotel;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," cn.itcast.hotel.service.IHotelService;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.junit.jupiter.api.AfterEach;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.junit.jupiter.api.BeforeEach;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.junit.jupiter.api.Test;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.springframework.beans.factory.annotation.Autowired;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.springframework.boot.test.context.SpringBootTest;")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," java.io.IOException;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," java.util.List;")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"SpringBootTest")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HotelDocumentTest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Autowired")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," IHotelService hotelService;")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RestHighLevelClient client;")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"BeforeEach")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    void"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," setUp"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".client "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," RestHighLevelClient"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(RestClient."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"builder"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                HttpHost."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"create"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"http://192.168.150.101:9200"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        ));")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"AfterEach")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    void"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," tearDown"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"throws"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," IOException {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"close"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[355]||(s[355]=i("h3",{id:"_5-1-新增文档",tabindex:"-1"},[l("5.1 新增文档 "),i("a",{class:"header-anchor",href:"#_5-1-新增文档","aria-label":'Permalink to "5.1 新增文档"'},"​")],-1)),s[356]||(s[356]=i("p",null,"我们要将数据库的酒店数据查询出来，写入elasticsearch中。",-1)),s[357]||(s[357]=i("h4",{id:"_5-1-1-索引库实体类",tabindex:"-1"},[l("5.1.1 索引库实体类 "),i("a",{class:"header-anchor",href:"#_5-1-1-索引库实体类","aria-label":'Permalink to "5.1.1 索引库实体类"'},"​")],-1)),s[358]||(s[358]=i("p",null,"数据库查询后的结果是一个Hotel类型的对象。结构如下：",-1)),s[359]||(s[359]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Data")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"TableName"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"tb_hotel"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Hotel"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"TableId"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"type"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," IdType.INPUT)")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Long id;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String name;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String address;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer price;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer score;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String brand;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String city;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String starName;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String business;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String longitude;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String latitude;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String pic;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[360]||(s[360]=i("p",null,"与我们的索引库结构存在差异：",-1)),s[361]||(s[361]=i("ul",null,[i("li",null,"longitude和latitude需要合并为location")],-1)),s[362]||(s[362]=i("p",null,"因此，我们需要定义一个新的类型，与索引库结构吻合：",-1)),s[363]||(s[363]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"package"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," cn.itcast.hotel.pojo;")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," lombok.Data;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," lombok.NoArgsConstructor;")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Data")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"NoArgsConstructor")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HotelDoc"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Long id;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String name;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String address;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer price;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer score;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String brand;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String city;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String starName;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String business;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String location;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String pic;")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HotelDoc"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Hotel "),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"hotel"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".id "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getId"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".name "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getName"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".address "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getAddress"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".price "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getPrice"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".score "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getScore"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".brand "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getBrand"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".city "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getCity"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".starName "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getStarName"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".business "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getBusiness"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".location "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getLatitude"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' ", "'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getLongitude"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".pic "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getPic"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[364]||(s[364]=i("h4",{id:"_5-1-2-语法说明",tabindex:"-1"},[l("5.1.2 语法说明 "),i("a",{class:"header-anchor",href:"#_5-1-2-语法说明","aria-label":'Permalink to "5.1.2 语法说明"'},"​")],-1)),s[365]||(s[365]=i("p",null,"新增文档的DSL语句如下：",-1)),s[366]||(s[366]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"POST /{"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"索引库名"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}/_doc/"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "name"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Jack"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "age"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"21")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[367]||(s[367]=i("p",null,"对应的java代码如图：",-1)),s[368]||(s[368]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720230027240.png",alt:"image-20210720230027240",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[369]||(s[369]=i("p",null,"可以看到与创建索引库类似，同样是三步走：",-1)),s[370]||(s[370]=i("ul",null,[i("li",null,"1）创建Request对象"),i("li",null,"2）准备请求参数，也就是DSL中的JSON文档"),i("li",null,"3）发送请求")],-1)),s[371]||(s[371]=i("p",null,"变化的地方在于，这里直接使用client.xxx()的API，不再需要client.indices()了。",-1)),s[372]||(s[372]=i("h4",{id:"_5-1-3-完整代码",tabindex:"-1"},[l("5.1.3 完整代码 "),i("a",{class:"header-anchor",href:"#_5-1-3-完整代码","aria-label":'Permalink to "5.1.3 完整代码"'},"​")],-1)),s[373]||(s[373]=i("p",null,"我们导入酒店数据，基本流程一致，但是需要考虑几点变化：",-1)),s[374]||(s[374]=i("ul",null,[i("li",null,"酒店数据来自于数据库，我们需要先查询出来，得到hotel对象"),i("li",null,"hotel对象需要转为HotelDoc对象"),i("li",null,"HotelDoc需要序列化为json格式")],-1)),s[375]||(s[375]=i("p",null,"因此，代码整体步骤如下：",-1)),s[376]||(s[376]=i("ul",null,[i("li",null,"1）根据id查询酒店数据Hotel"),i("li",null,"2）将Hotel封装为HotelDoc"),i("li",null,"3）将HotelDoc序列化为JSON"),i("li",null,"4）创建IndexRequest，指定索引库名和id"),i("li",null,"5）准备请求参数，也就是JSON文档"),i("li",null,"6）发送请求")],-1)),s[377]||(s[377]=i("p",null,"在hotel-demo的HotelDocumentTest测试类中，编写单元测试：",-1)),s[378]||(s[378]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Test")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"void"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testAddDocument"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() throws IOException {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 1.根据id查询酒店数据")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    Hotel hotel "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotelService."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getById"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"61083L"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.转换为文档类型")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    HotelDoc hotelDoc "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HotelDoc"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(hotel);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 3.将HotelDoc转json")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String json "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," JSON."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"toJSONString"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(hotelDoc);")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 1.准备Request对象")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    IndexRequest request "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," IndexRequest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"id"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(hotelDoc."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getId"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"toString"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.准备Json文档")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    request."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(json, XContentType.JSON);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 3.发送请求")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"index"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[379]||(s[379]=i("h3",{id:"_5-2-查询文档",tabindex:"-1"},[l("5.2 查询文档 "),i("a",{class:"header-anchor",href:"#_5-2-查询文档","aria-label":'Permalink to "5.2 查询文档"'},"​")],-1)),s[380]||(s[380]=i("h4",{id:"_5-2-1-语法说明",tabindex:"-1"},[l("5.2.1 语法说明 "),i("a",{class:"header-anchor",href:"#_5-2-1-语法说明","aria-label":'Permalink to "5.2.1 语法说明"'},"​")],-1)),s[381]||(s[381]=i("p",null,"查询的DSL语句如下：",-1)),s[382]||(s[382]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /hotel/_doc/{"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"id"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[383]||(s[383]=i("p",null,"非常简单，因此代码大概分两步：",-1)),s[384]||(s[384]=i("ul",null,[i("li",null,"准备Request对象"),i("li",null,"发送请求")],-1)),s[385]||(s[385]=i("p",null,"不过查询的目的是得到结果，解析为HotelDoc，因此难点是结果的解析。完整代码如下：",-1)),s[386]||(s[386]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720230811674.png",alt:"image-20210720230811674",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[387]||(s[387]=i("p",null,[l("可以看到，结果是一个JSON，其中文档放在一个"),i("code",null,"_source"),l("属性中，因此解析就是拿到"),i("code",null,"_source"),l("，反序列化为Java对象即可。")],-1)),s[388]||(s[388]=i("p",null,"与之前类似，也是三步走：",-1)),s[389]||(s[389]=i("ul",null,[i("li",null,"1）准备Request对象。这次是查询，所以是GetRequest"),i("li",null,"2）发送请求，得到结果。因为是查询，这里调用client.get()方法"),i("li",null,"3）解析结果，就是对JSON做反序列化")],-1)),s[390]||(s[390]=i("h4",{id:"_5-2-2-完整代码",tabindex:"-1"},[l("5.2.2 完整代码 "),i("a",{class:"header-anchor",href:"#_5-2-2-完整代码","aria-label":'Permalink to "5.2.2 完整代码"'},"​")],-1)),s[391]||(s[391]=i("p",null,"在hotel-demo的HotelDocumentTest测试类中，编写单元测试：",-1)),s[392]||(s[392]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Test")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"void"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testGetDocumentById"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() throws IOException {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 1.准备Request")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    GetRequest request "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," GetRequest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"61082"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.发送请求，得到响应")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    GetResponse response "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"get"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 3.解析响应结果")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String json "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," response."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getSourceAsString"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    HotelDoc hotelDoc "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," JSON."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"parseObject"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(json, HotelDoc.class);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    System.out."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(hotelDoc);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[393]||(s[393]=i("h3",{id:"_5-3-删除文档",tabindex:"-1"},[l("5.3 删除文档 "),i("a",{class:"header-anchor",href:"#_5-3-删除文档","aria-label":'Permalink to "5.3 删除文档"'},"​")],-1)),s[394]||(s[394]=i("p",null,"删除的DSL为是这样的：",-1)),s[395]||(s[395]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"DELETE /hotel/_doc/{"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"id"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[396]||(s[396]=i("p",null,"与查询相比，仅仅是请求方式从DELETE变成GET，可以想象Java代码应该依然是三步走：",-1)),s[397]||(s[397]=i("ul",null,[i("li",null,"1）准备Request对象，因为是删除，这次是DeleteRequest对象。要指定索引库名和id"),i("li",null,"2）准备参数，无参"),i("li",null,"3）发送请求。因为是删除，所以是client.delete()方法")],-1)),s[398]||(s[398]=i("p",null,"在hotel-demo的HotelDocumentTest测试类中，编写单元测试：",-1)),s[399]||(s[399]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Test")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"void"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testDeleteDocument"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() throws IOException {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 1.准备Request")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    DeleteRequest request "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," DeleteRequest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"61083"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.发送请求")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"delete"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[400]||(s[400]=i("h3",{id:"_5-4-修改文档",tabindex:"-1"},[l("5.4 修改文档 "),i("a",{class:"header-anchor",href:"#_5-4-修改文档","aria-label":'Permalink to "5.4 修改文档"'},"​")],-1)),s[401]||(s[401]=i("h4",{id:"_5-4-1-语法说明",tabindex:"-1"},[l("5.4.1 语法说明 "),i("a",{class:"header-anchor",href:"#_5-4-1-语法说明","aria-label":'Permalink to "5.4.1 语法说明"'},"​")],-1)),s[402]||(s[402]=i("p",null,"修改我们讲过两种方式：",-1)),s[403]||(s[403]=i("ul",null,[i("li",null,"全量修改：本质是先根据id删除，再新增"),i("li",null,"增量修改：修改文档中的指定字段值")],-1)),s[404]||(s[404]=i("p",null,"在RestClient的API中，全量修改与新增的API完全一致，判断依据是ID：",-1)),s[405]||(s[405]=i("ul",null,[i("li",null,"如果新增时，ID已经存在，则修改"),i("li",null,"如果新增时，ID不存在，则新增")],-1)),s[406]||(s[406]=i("p",null,"这里不再赘述，我们主要关注增量修改。",-1)),s[407]||(s[407]=i("p",null,"代码示例如图：",-1)),s[408]||(s[408]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720231040875.png",alt:"image-20210720231040875",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[409]||(s[409]=i("p",null,"与之前类似，也是三步走：",-1)),s[410]||(s[410]=i("ul",null,[i("li",null,"1）准备Request对象。这次是修改，所以是UpdateRequest"),i("li",null,"2）准备参数。也就是JSON文档，里面包含要修改的字段"),i("li",null,"3）更新文档。这里调用client.update()方法")],-1)),s[411]||(s[411]=i("h4",{id:"_5-4-2-完整代码",tabindex:"-1"},[l("5.4.2 完整代码 "),i("a",{class:"header-anchor",href:"#_5-4-2-完整代码","aria-label":'Permalink to "5.4.2 完整代码"'},"​")],-1)),s[412]||(s[412]=i("p",null,"在hotel-demo的HotelDocumentTest测试类中，编写单元测试：",-1)),s[413]||(s[413]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Test")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"void"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testUpdateDocument"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() throws IOException {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 1.准备Request")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    UpdateRequest request "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," UpdateRequest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"61083"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.准备请求参数")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    request."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"doc"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'        "price"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"952"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'        "starName"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"四钻"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    );")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 3.发送请求")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"update"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[414]||(s[414]=i("h3",{id:"_5-5-批量导入文档",tabindex:"-1"},[l("5.5 批量导入文档 "),i("a",{class:"header-anchor",href:"#_5-5-批量导入文档","aria-label":'Permalink to "5.5 批量导入文档"'},"​")],-1)),s[415]||(s[415]=i("p",null,"案例需求：利用BulkRequest批量将数据库数据导入到索引库中。",-1)),s[416]||(s[416]=i("p",null,"步骤如下：",-1)),s[417]||(s[417]=i("ul",null,[i("li",null,[i("p",null,"利用mybatis-plus查询酒店数据")]),i("li",null,[i("p",null,"将查询到的酒店数据（Hotel）转换为文档类型数据（HotelDoc）")]),i("li",null,[i("p",null,"利用JavaRestClient中的BulkRequest批处理，实现批量新增文档")])],-1)),s[418]||(s[418]=i("h4",{id:"_5-5-1-语法说明",tabindex:"-1"},[l("5.5.1 语法说明 "),i("a",{class:"header-anchor",href:"#_5-5-1-语法说明","aria-label":'Permalink to "5.5.1 语法说明"'},"​")],-1)),s[419]||(s[419]=i("p",null,"批量处理BulkRequest，其本质就是将多个普通的CRUD请求组合在一起发送。",-1)),s[420]||(s[420]=i("p",null,"其中提供了一个add方法，用来添加其他请求：",-1)),s[421]||(s[421]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720232105943.png",alt:"image-20210720232105943",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[422]||(s[422]=i("p",null,"可以看到，能添加的请求包括：",-1)),s[423]||(s[423]=i("ul",null,[i("li",null,"IndexRequest，也就是新增"),i("li",null,"UpdateRequest，也就是修改"),i("li",null,"DeleteRequest，也就是删除")],-1)),s[424]||(s[424]=i("p",null,"因此Bulk中添加了多个IndexRequest，就是批量新增功能了。示例：",-1)),s[425]||(s[425]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210720232431383.png",alt:"image-20210720232431383",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[426]||(s[426]=i("p",null,"其实还是三步走：",-1)),s[427]||(s[427]=i("ul",null,[i("li",null,"1）创建Request对象。这里是BulkRequest"),i("li",null,"2）准备参数。批处理的参数，就是其它Request对象，这里就是多个IndexRequest"),i("li",null,"3）发起请求。这里是批处理，调用的方法为client.bulk()方法")],-1)),s[428]||(s[428]=i("p",null,"我们在导入酒店数据时，将上述代码改造成for循环处理即可。",-1)),s[429]||(s[429]=i("h4",{id:"_5-5-2-完整代码",tabindex:"-1"},[l("5.5.2 完整代码 "),i("a",{class:"header-anchor",href:"#_5-5-2-完整代码","aria-label":'Permalink to "5.5.2 完整代码"'},"​")],-1)),s[430]||(s[430]=i("p",null,"在hotel-demo的HotelDocumentTest测试类中，编写单元测试：",-1)),s[431]||(s[431]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Test")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"void"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testBulkRequest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() throws IOException {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 批量查询酒店数据")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    List<"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Hotel"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> hotels "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotelService."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"list"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 1.创建Request")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    BulkRequest request "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," BulkRequest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.准备参数，添加多个新增的Request")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    for"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (Hotel hotel "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotels) {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 2.1.转换为文档类型HotelDoc")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        HotelDoc hotelDoc "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HotelDoc"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(hotel);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 2.2.创建新增文档的Request对象")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        request."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"add"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," IndexRequest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    ."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"id"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(hotelDoc."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getId"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"toString"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    ."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(JSON."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"toJSONString"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(hotelDoc), XContentType.JSON));")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 3.发送请求")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bulk"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[432]||(s[432]=i("h3",{id:"_5-6-小结",tabindex:"-1"},[l("5.6 小结 "),i("a",{class:"header-anchor",href:"#_5-6-小结","aria-label":'Permalink to "5.6 小结"'},"​")],-1)),s[433]||(s[433]=i("blockquote",null,[i("ul",null,[i("li",null,[i("p",null,"文档操作的基本步骤："),i("ul",null,[i("li",null,[i("p",null,"初始化RestHighLevelClient")]),i("li",null,[i("p",null,"创建XxxRequest。XXX是Index、Get、Update、Delete、Bulk")]),i("li",null,[i("p",null,"准备参数（Index、Update、Bulk时需要）")]),i("li",null,[i("p",null,"发送请求。调用RestHighLevelClient#.xxx()方法，xxx是index、get、update、delete、bulk")]),i("li",null,[i("p",null,"解析结果（Get时需要）")])])])])],-1)),s[434]||(s[434]=i("hr",null,null,-1)),s[435]||(s[435]=i("h2",{id:"_6-dsl查询文档",tabindex:"-1"},[l("6. DSL查询文档 "),i("a",{class:"header-anchor",href:"#_6-dsl查询文档","aria-label":'Permalink to "6. DSL查询文档"'},"​")],-1)),s[436]||(s[436]=i("p",null,"elasticsearch的查询依然是基于JSON风格的DSL来实现的。",-1)),s[437]||(s[437]=i("h3",{id:"_6-1-dsl查询分类",tabindex:"-1"},[l("6.1 DSL查询分类 "),i("a",{class:"header-anchor",href:"#_6-1-dsl查询分类","aria-label":'Permalink to "6.1 DSL查询分类"'},"​")],-1)),s[438]||(s[438]=i("p",null,[l("Elasticsearch提供了基于JSON的DSL（"),i("a",{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl.html",target:"_blank",rel:"noreferrer"},"Domain Specific Language"),l("）来定义查询。常见的查询类型包括：")],-1)),s[439]||(s[439]=i("ul",null,[i("li",null,[i("p",null,[i("strong",null,"查询所有"),l("：查询出所有数据，一般测试用。例如：match_all")])]),i("li",null,[i("p",null,[i("strong",null,"全文检索（full text）查询"),l("：利用分词器对用户输入内容分词，然后去倒排索引库中匹配。例如：")]),i("ul",null,[i("li",null,"match_query"),i("li",null,"multi_match_query")])]),i("li",null,[i("p",null,[i("strong",null,"精确查询"),l("：根据精确词条值查找数据，一般是查找keyword、数值、日期、boolean等类型字段。例如：")]),i("ul",null,[i("li",null,"ids"),i("li",null,"range"),i("li",null,"term")])]),i("li",null,[i("p",null,[i("strong",null,"地理（geo）查询"),l("：根据经纬度查询。例如：")]),i("ul",null,[i("li",null,"geo_distance"),i("li",null,"geo_bounding_box")])]),i("li",null,[i("p",null,[i("strong",null,"复合（compound）查询"),l("：复合查询可以将上述各种查询条件组合起来，合并查询条件。例如：")]),i("ul",null,[i("li",null,"bool"),i("li",null,"function_score")])])],-1)),s[440]||(s[440]=i("p",null,"查询的语法基本一致：",-1)),s[441]||(s[441]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /indexName/_search")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "query"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "查询类型"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "查询条件"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"条件值"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[442]||(s[442]=i("p",null,"我们以查询所有为例，其中：",-1)),s[443]||(s[443]=i("ul",null,[i("li",null,"查询类型为match_all"),i("li",null,"没有查询条件")],-1)),s[444]||(s[444]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 查询所有")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /indexName/_search")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "query"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "match_all"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[445]||(s[445]=i("p",null,[l("其它查询无非就是"),i("strong",null,"查询类型"),l("、"),i("strong",null,"查询条件"),l("的变化。")],-1)),s[446]||(s[446]=i("h3",{id:"_6-2-全文检索查询",tabindex:"-1"},[l("6.2 全文检索查询 "),i("a",{class:"header-anchor",href:"#_6-2-全文检索查询","aria-label":'Permalink to "6.2 全文检索查询"'},"​")],-1)),s[447]||(s[447]=i("h4",{id:"_6-2-1-使用场景",tabindex:"-1"},[l("6.2.1 使用场景 "),i("a",{class:"header-anchor",href:"#_6-2-1-使用场景","aria-label":'Permalink to "6.2.1 使用场景"'},"​")],-1)),s[448]||(s[448]=i("p",null,"全文检索查询的基本流程如下：",-1)),s[449]||(s[449]=i("ul",null,[i("li",null,"对用户搜索的内容做分词，得到词条"),i("li",null,"根据词条去倒排索引库中匹配，得到文档id"),i("li",null,"根据文档id找到文档，返回给用户")],-1)),s[450]||(s[450]=i("p",null,"比较常用的场景包括：",-1)),s[451]||(s[451]=i("ul",null,[i("li",null,"商城的输入框搜索"),i("li",null,"百度输入框搜索")],-1)),s[452]||(s[452]=i("p",null,"例如京东：",-1)),s[453]||(s[453]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721165326938.png",alt:"image-20210721165326938",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[454]||(s[454]=i("p",null,"因为是拿着词条去匹配，因此参与搜索的字段也必须是可分词的text类型的字段。",-1)),s[455]||(s[455]=i("h4",{id:"_6-2-2-基本语法",tabindex:"-1"},[l("6.2.2 基本语法 "),i("a",{class:"header-anchor",href:"#_6-2-2-基本语法","aria-label":'Permalink to "6.2.2 基本语法"'},"​")],-1)),s[456]||(s[456]=i("p",null,"常见的全文检索查询包括：",-1)),s[457]||(s[457]=i("ul",null,[i("li",null,"match查询：单字段查询"),i("li",null,"multi_match查询：多字段查询，任意一个字段符合条件就算符合查询条件")],-1)),s[458]||(s[458]=i("p",null,"match查询语法如下：",-1)),s[459]||(s[459]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /indexName/_search")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "query"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "match"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "FIELD"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"TEXT"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[460]||(s[460]=i("p",null,"mulit_match语法如下：",-1)),s[461]||(s[461]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /indexName/_search")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "query"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "multi_match"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "query"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"TEXT"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "fields"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": ["),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"FIELD1"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'" FIELD12"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[462]||(s[462]=i("h4",{id:"_6-2-3-示例",tabindex:"-1"},[l("6.2.3 示例 "),i("a",{class:"header-anchor",href:"#_6-2-3-示例","aria-label":'Permalink to "6.2.3 示例"'},"​")],-1)),s[463]||(s[463]=i("p",null,"match查询示例：",-1)),s[464]||(s[464]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721170455419.png",alt:"image-20210721170455419",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[465]||(s[465]=i("p",null,"multi_match查询示例：",-1)),s[466]||(s[466]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721170720691.png",alt:"image-20210721170720691",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[467]||(s[467]=i("p",null,"可以看到，两种查询结果是一样的，为什么？",-1)),s[468]||(s[468]=i("p",null,"因为我们将brand、name、business值都利用copy_to复制到了all字段中。因此你根据三个字段搜索，和根据all字段搜索效果当然一样了。",-1)),s[469]||(s[469]=i("p",null,"但是，搜索字段越多，对查询性能影响越大，因此建议采用copy_to，然后单字段查询的方式。",-1)),s[470]||(s[470]=i("h4",{id:"_6-2-4-总结",tabindex:"-1"},[l("6.2.4 总结 "),i("a",{class:"header-anchor",href:"#_6-2-4-总结","aria-label":'Permalink to "6.2.4 总结"'},"​")],-1)),s[471]||(s[471]=i("blockquote",null,[i("ul",null,[i("li",null,[i("p",null,"match和multi_match的区别是什么？"),i("ul",null,[i("li",null,[i("p",null,"match：根据一个字段查询")]),i("li",null,[i("p",null,"multi_match：根据多个字段查询，参与查询字段越多，查询性能越差")])])])])],-1)),s[472]||(s[472]=i("h3",{id:"_6-3-精准查询",tabindex:"-1"},[l("6.3 精准查询 "),i("a",{class:"header-anchor",href:"#_6-3-精准查询","aria-label":'Permalink to "6.3 精准查询"'},"​")],-1)),s[473]||(s[473]=i("p",null,[l("精确查询一般是查找keyword、数值、日期、boolean等类型字段。所以"),i("strong",null,"不会"),l("对搜索条件分词。常见的有：")],-1)),s[474]||(s[474]=i("ul",null,[i("li",null,"term：根据词条精确值查询"),i("li",null,"range：根据值的范围查询")],-1)),s[475]||(s[475]=i("h4",{id:"_6-3-1-term查询",tabindex:"-1"},[l("6.3.1 term查询 "),i("a",{class:"header-anchor",href:"#_6-3-1-term查询","aria-label":'Permalink to "6.3.1 term查询"'},"​")],-1)),s[476]||(s[476]=i("p",null,[l("因为精确查询的字段搜是不分词的字段，因此查询的条件也必须是"),i("strong",null,"不分词"),l("的词条。查询时，用户输入的内容跟自动值完全匹配时才认为符合条件。如果用户输入的内容过多，反而搜索不到数据。")],-1)),s[477]||(s[477]=i("p",null,"语法说明：",-1)),s[478]||(s[478]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// term查询")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /indexName/_search")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "query"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "term"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "FIELD"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "value"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"VALUE"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[479]||(s[479]=i("p",null,"示例：",-1)),s[480]||(s[480]=i("p",null,"当我搜索的是精确词条时，能正确查询出结果：",-1)),s[481]||(s[481]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721171655308.png",alt:"image-20210721171655308",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[482]||(s[482]=i("p",null,"但是，当我搜索的内容不是词条，而是多个词语形成的短语时，反而搜索不到：",-1)),s[483]||(s[483]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721171838378.png",alt:"image-20210721171838378",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[484]||(s[484]=i("h4",{id:"_6-3-2-range查询",tabindex:"-1"},[l("6.3.2 range查询 "),i("a",{class:"header-anchor",href:"#_6-3-2-range查询","aria-label":'Permalink to "6.3.2 range查询"'},"​")],-1)),s[485]||(s[485]=i("p",null,"范围查询，一般应用在对数值类型做范围过滤的时候。比如做价格范围过滤。",-1)),s[486]||(s[486]=i("p",null,"基本语法：",-1)),s[487]||(s[487]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// range查询")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /indexName/_search")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "query"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "range"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "FIELD"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "gte"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"10"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 这里的gte代表大于等于，gt则代表大于")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "lte"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"20"),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," // lte代表小于等于，lt则代表小于")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[488]||(s[488]=i("p",null,"示例：",-1)),s[489]||(s[489]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721172307172.png",alt:"image-20210721172307172",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[490]||(s[490]=i("h4",{id:"_6-3-3-总结",tabindex:"-1"},[l("6.3.3 总结 "),i("a",{class:"header-anchor",href:"#_6-3-3-总结","aria-label":'Permalink to "6.3.3 总结"'},"​")],-1)),s[491]||(s[491]=i("blockquote",null,[i("ul",null,[i("li",null,[i("p",null,"精确查询常见的有哪些？"),i("ul",null,[i("li",null,[i("p",null,"term查询：根据词条精确匹配，一般搜索keyword类型、数值类型、布尔类型、日期类型字段")]),i("li",null,[i("p",null,"range查询：根据数值范围查询，可以是数值、日期的范围")])])])])],-1)),s[492]||(s[492]=i("h3",{id:"_6-4-地理坐标查询",tabindex:"-1"},[l("6.4 地理坐标查询 "),i("a",{class:"header-anchor",href:"#_6-4-地理坐标查询","aria-label":'Permalink to "6.4 地理坐标查询"'},"​")],-1)),s[493]||(s[493]=i("p",null,[l("所谓的地理坐标查询，其实就是根据经纬度查询，官方文档："),i("a",{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/geo-queries.html",target:"_blank",rel:"noreferrer"},"https://www.elastic.co/guide/en/elasticsearch/reference/current/geo-queries.html")],-1)),s[494]||(s[494]=i("p",null,"常见的使用场景包括：",-1)),s[495]||(s[495]=i("ul",null,[i("li",null,"携程：搜索我附近的酒店"),i("li",null,"滴滴：搜索我附近的出租车"),i("li",null,"微信：搜索我附近的人")],-1)),s[496]||(s[496]=i("p",null,"附近的酒店：",-1)),s[497]||(s[497]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721172645103.png",alt:"image-20210721172645103",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[498]||(s[498]=i("p",null,"附近的车：",-1)),s[499]||(s[499]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721172654880.png",alt:"image-20210721172654880",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[500]||(s[500]=i("h4",{id:"_6-4-1-矩形范围查询",tabindex:"-1"},[l("6.4.1 矩形范围查询 "),i("a",{class:"header-anchor",href:"#_6-4-1-矩形范围查询","aria-label":'Permalink to "6.4.1 矩形范围查询"'},"​")],-1)),s[501]||(s[501]=i("p",null,"矩形范围查询，也就是geo_bounding_box查询，查询坐标落在某个矩形范围的所有文档：",-1)),s[502]||(s[502]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/DKV9HZbVS6.gif",alt:"DKV9HZbVS6",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[503]||(s[503]=i("p",null,[l("查询时，需要指定矩形的"),i("strong",null,"左上"),l("、"),i("strong",null,"右下"),l("两个点的坐标，然后画出一个矩形，落在该矩形内的都是符合条件的点。")],-1)),s[504]||(s[504]=i("p",null,"语法如下：",-1)),s[505]||(s[505]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// geo_bounding_box查询")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /indexName/_search")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "query"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "geo_bounding_box"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "FIELD"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "top_left"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": { "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 左上点")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "lat"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"31.1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "lon"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"121.5")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "bottom_right"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": { "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 右下点")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "lat"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"30.9"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "lon"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"121.7")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[506]||(s[506]=i("p",null,"这种并不符合“附近的人”这样的需求，所以我们就不做了。",-1)),s[507]||(s[507]=i("h4",{id:"_6-4-2-附近查询",tabindex:"-1"},[l("6.4.2 附近查询 "),i("a",{class:"header-anchor",href:"#_6-4-2-附近查询","aria-label":'Permalink to "6.4.2 附近查询"'},"​")],-1)),s[508]||(s[508]=i("p",null,"附近查询，也叫做距离查询（geo_distance）：查询到指定中心点小于某个距离值的所有文档。",-1)),s[509]||(s[509]=i("p",null,"换句话来说，在地图上找一个点作为圆心，以指定距离为半径，画一个圆，落在圆内的坐标都算符合条件：",-1)),s[510]||(s[510]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/vZrdKAh19C.gif",alt:"vZrdKAh19C",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[511]||(s[511]=i("p",null,"语法说明：",-1)),s[512]||(s[512]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// geo_distance 查询")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /indexName/_search")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "query"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "geo_distance"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "distance"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"15km"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 半径")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "FIELD"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"31.21,121.5"'),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," // 圆心")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[513]||(s[513]=i("p",null,"示例：",-1)),s[514]||(s[514]=i("p",null,"我们先搜索陆家嘴附近15km的酒店：",-1)),s[515]||(s[515]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721175443234.png",alt:"image-20210721175443234",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[516]||(s[516]=i("p",null,"发现共有47家酒店。",-1)),s[517]||(s[517]=i("p",null,"然后把半径缩短到3公里：",-1)),s[518]||(s[518]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721182031475.png",alt:"image-20210721182031475",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[519]||(s[519]=i("p",null,"可以发现，搜索到的酒店数量减少到了5家。",-1)),s[520]||(s[520]=i("h3",{id:"_6-5-复合查询",tabindex:"-1"},[l("6.5 复合查询 "),i("a",{class:"header-anchor",href:"#_6-5-复合查询","aria-label":'Permalink to "6.5 复合查询"'},"​")],-1)),s[521]||(s[521]=i("p",null,"复合（compound）查询：复合查询可以将其它简单查询组合起来，实现更复杂的搜索逻辑。常见的有两种：",-1)),s[522]||(s[522]=i("ul",null,[i("li",null,"fuction score：算分函数查询，可以控制文档相关性算分，控制文档排名"),i("li",null,"bool query：布尔查询，利用逻辑关系组合多个其它的查询，实现复杂搜索")],-1)),s[523]||(s[523]=i("h4",{id:"_6-5-1-相关性算分",tabindex:"-1"},[l("6.5.1 相关性算分 "),i("a",{class:"header-anchor",href:"#_6-5-1-相关性算分","aria-label":'Permalink to "6.5.1 相关性算分"'},"​")],-1)),s[524]||(s[524]=i("p",null,"当我们利用match查询时，文档结果会根据与搜索词条的关联度打分（_score），返回结果时按照分值降序排列。",-1)),s[525]||(s[525]=i("p",null,'例如，我们搜索 "虹桥如家"，结果如下：',-1)),s[526]||(s[526]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "_score"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"17.850193"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "_source"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "name"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"虹桥如家酒店真不错"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "_score"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"12.259849"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "_source"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "name"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"外滩如家酒店真不错"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "_score"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"11.91091"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "_source"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "name"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"迪士尼如家酒店真不错"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[527]||(s[527]=i("p",null,"在elasticsearch中，早期使用的打分算法是TF-IDF算法，公式如下：",-1)),s[528]||(s[528]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721190152134.png",alt:"image-20210721190152134",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[529]||(s[529]=i("p",null,"在后来的5.1版本升级中，elasticsearch将算法改进为BM25算法，公式如下：",-1)),s[530]||(s[530]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721190416214.png",alt:"image-20210721190416214",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[531]||(s[531]=i("p",null,"TF-IDF算法有一各缺陷，就是词条频率越高，文档得分也会越高，单个词条对文档影响较大。而BM25则会让单个词条的算分有一个上限，曲线更加平滑：",-1)),s[532]||(s[532]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721190907320.png",alt:"image-20210721190907320",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[533]||(s[533]=i("p",null,"小结：elasticsearch会根据词条和文档的相关度做打分，算法由两种：",-1)),s[534]||(s[534]=i("ul",null,[i("li",null,"TF-IDF算法"),i("li",null,"BM25算法，elasticsearch5.1版本后采用的算法")],-1)),s[535]||(s[535]=i("h4",{id:"_6-5-2-算分函数查询",tabindex:"-1"},[l("6.5.2 算分函数查询 "),i("a",{class:"header-anchor",href:"#_6-5-2-算分函数查询","aria-label":'Permalink to "6.5.2 算分函数查询"'},"​")],-1)),s[536]||(s[536]=i("p",null,[l("根据相关度打分是比较合理的需求，但"),i("strong",null,"合理的不一定是产品经理需要"),l("的。")],-1)),s[537]||(s[537]=i("p",null,"以百度为例，你搜索的结果中，并不是相关度越高排名越靠前，而是谁掏的钱多排名就越靠前。如图：",-1)),s[538]||(s[538]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721191144560.png",alt:"image-20210721191144560",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[539]||(s[539]=i("p",null,"要想认为控制相关性算分，就需要利用elasticsearch中的function score 查询了。",-1)),s[540]||(s[540]=i("h5",{id:"_1-语法说明",tabindex:"-1"},[l("1）语法说明 "),i("a",{class:"header-anchor",href:"#_1-语法说明","aria-label":'Permalink to "1）语法说明"'},"​")],-1)),s[541]||(s[541]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721191544750.png",alt:"image-20210721191544750",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[542]||(s[542]=i("p",null,"function score 查询中包含四部分内容：",-1)),s[543]||(s[543]=i("ul",null,[i("li",null,[i("strong",null,"原始查询"),l("条件：query部分，基于这个条件搜索文档，并且基于BM25算法给文档打分，"),i("strong",null,"原始算分"),l("（query score)")]),i("li",null,[i("strong",null,"过滤条件"),l("：filter部分，符合该条件的文档才会重新算分")]),i("li",null,[i("strong",null,"算分函数"),l("：符合filter条件的文档要根据这个函数做运算，得到的"),i("strong",null,"函数算分"),l("（function score），有四种函数 "),i("ul",null,[i("li",null,"weight：函数结果是常量"),i("li",null,"field_value_factor：以文档中的某个字段值作为函数结果"),i("li",null,"random_score：以随机数作为函数结果"),i("li",null,"script_score：自定义算分函数算法")])]),i("li",null,[i("strong",null,"运算模式"),l("：算分函数的结果、原始查询的相关性算分，两者之间的运算方式，包括： "),i("ul",null,[i("li",null,"multiply：相乘"),i("li",null,"replace：用function score替换query score"),i("li",null,"其它，例如：sum、avg、max、min")])])],-1)),s[544]||(s[544]=i("p",null,"function score的运行流程如下：",-1)),s[545]||(s[545]=i("ul",null,[i("li",null,[l("1）根据"),i("strong",null,"原始条件"),l("查询搜索文档，并且计算相关性算分，称为"),i("strong",null,"原始算分"),l("（query score）")]),i("li",null,[l("2）根据"),i("strong",null,"过滤条件"),l("，过滤文档")]),i("li",null,[l("3）符合"),i("strong",null,"过滤条件"),l("的文档，基于"),i("strong",null,"算分函数"),l("运算，得到"),i("strong",null,"函数算分"),l("（function score）")]),i("li",null,[l("4）将"),i("strong",null,"原始算分"),l("（query score）和"),i("strong",null,"函数算分"),l("（function score）基于"),i("strong",null,"运算模式"),l("做运算，得到最终结果，作为相关性算分。")])],-1)),s[546]||(s[546]=i("p",null,"因此，其中的关键点是：",-1)),s[547]||(s[547]=i("ul",null,[i("li",null,"过滤条件：决定哪些文档的算分被修改"),i("li",null,"算分函数：决定函数算分的算法"),i("li",null,"运算模式：决定最终算分结果")],-1)),s[548]||(s[548]=i("h5",{id:"_2-示例",tabindex:"-1"},[l("2）示例 "),i("a",{class:"header-anchor",href:"#_2-示例","aria-label":'Permalink to "2）示例"'},"​")],-1)),s[549]||(s[549]=i("p",null,"需求：给“如家”这个品牌的酒店排名靠前一些",-1)),s[550]||(s[550]=i("p",null,"翻译一下这个需求，转换为之前说的四个要点：",-1)),s[551]||(s[551]=i("ul",null,[i("li",null,"原始条件：不确定，可以任意变化"),i("li",null,'过滤条件：brand = "如家"'),i("li",null,"算分函数：可以简单粗暴，直接给固定的算分结果，weight"),i("li",null,"运算模式：比如求和")],-1)),s[552]||(s[552]=i("p",null,"因此最终的DSL语句如下：",-1)),s[553]||(s[553]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /hotel/_search")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "query"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "function_score"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "query"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {  "),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"...."),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," }, "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 原始查询，可以是任意条件")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "functions"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": [ "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 算分函数")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "filter"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": { "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 满足的条件，品牌必须是如家")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'            "term"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'              "brand"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"如家"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"          },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "weight"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2"),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," // 算分权重为2")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      ],")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "boost_mode"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"sum"'),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," // 加权模式，求和")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[554]||(s[554]=i("p",null,"测试，在未添加算分函数时，如家得分如下：",-1)),s[555]||(s[555]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721193152520.png",alt:"image-20210721193152520",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[556]||(s[556]=i("p",null,"添加了算分函数后，如家得分就提升了：",-1)),s[557]||(s[557]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721193458182.png",alt:"image-20210721193458182",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[558]||(s[558]=i("h5",{id:"_3-小结",tabindex:"-1"},[l("3）小结 "),i("a",{class:"header-anchor",href:"#_3-小结","aria-label":'Permalink to "3）小结"'},"​")],-1)),s[559]||(s[559]=i("blockquote",null,[i("ul",null,[i("li",null,[i("p",null,"function score query定义的三要素是什么？"),i("ul",null,[i("li",null,[i("p",null,"过滤条件：哪些文档要加分")]),i("li",null,[i("p",null,"算分函数：如何计算function score")]),i("li",null,[i("p",null,"加权方式：function score 与 query score如何运算")])])])])],-1)),s[560]||(s[560]=i("h4",{id:"_6-5-3-布尔查询",tabindex:"-1"},[l("6.5.3 布尔查询 "),i("a",{class:"header-anchor",href:"#_6-5-3-布尔查询","aria-label":'Permalink to "6.5.3 布尔查询"'},"​")],-1)),s[561]||(s[561]=i("p",null,[l("布尔查询是一个或多个查询子句的组合，每一个子句就是一个"),i("strong",null,"子查询"),l("。子查询的组合方式有：")],-1)),s[562]||(s[562]=i("ul",null,[i("li",null,"must：必须匹配每个子查询，类似“与”"),i("li",null,"should：选择性匹配子查询，类似“或”"),i("li",null,[l("must_not：必须不匹配，"),i("strong",null,"不参与算分"),l("，类似“非”")]),i("li",null,[l("filter：必须匹配，"),i("strong",null,"不参与算分")])],-1)),s[563]||(s[563]=i("p",null,"比如在搜索酒店时，除了关键字搜索外，我们还可能根据品牌、价格、城市等字段做过滤：",-1)),s[564]||(s[564]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721193822848.png",alt:"image-20210721193822848",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[565]||(s[565]=i("p",null,"每一个不同的字段，其查询的条件、方式都不一样，必须是多个不同的查询，而要组合这些查询，就必须用bool查询了。",-1)),s[566]||(s[566]=i("p",null,[l("需要注意的是，搜索时，参与"),i("strong",null,"打分的字段越多，查询的性能也越差"),l("。因此这种多条件查询时，建议这样做：")],-1)),s[567]||(s[567]=i("ul",null,[i("li",null,"搜索框的关键字搜索，是全文检索查询，使用must查询，参与算分"),i("li",null,"其它过滤条件，采用filter查询。不参与算分")],-1)),s[568]||(s[568]=i("h5",{id:"_1-语法示例",tabindex:"-1"},[l("1）语法示例： "),i("a",{class:"header-anchor",href:"#_1-语法示例","aria-label":'Permalink to "1）语法示例："'},"​")],-1)),s[569]||(s[569]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /hotel/_search")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "query"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "bool"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "must"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": [")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        {"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'"term"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'"city"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"上海"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," }}")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      ],")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "should"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": [")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        {"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'"term"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'"brand"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"皇冠假日"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," }},")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        {"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'"term"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'"brand"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"华美达"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," }}")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      ],")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "must_not"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": [")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        { "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'"range"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": { "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'"price"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": { "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'"lte"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"500"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," } }}")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      ],")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "filter"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": [")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        { "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'"range"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'"score"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": { "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'"gte"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"45"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," } }}")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      ]")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[570]||(s[570]=i("h5",{id:"_2-示例-1",tabindex:"-1"},[l("2）示例 "),i("a",{class:"header-anchor",href:"#_2-示例-1","aria-label":'Permalink to "2）示例"'},"​")],-1)),s[571]||(s[571]=i("p",null,"需求：搜索名字包含“如家”，价格不高于400，在坐标31.21,121.5周围10km范围内的酒店。",-1)),s[572]||(s[572]=i("p",null,"分析：",-1)),s[573]||(s[573]=i("ul",null,[i("li",null,"名称搜索，属于全文检索查询，应该参与算分。放到must中"),i("li",null,"价格不高于400，用range查询，属于过滤条件，不参与算分。放到must_not中"),i("li",null,"周围10km范围内，用geo_distance查询，属于过滤条件，不参与算分。放到filter中")],-1)),s[574]||(s[574]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721194744183.png",alt:"image-20210721194744183",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[575]||(s[575]=i("h5",{id:"_3-小结-1",tabindex:"-1"},[l("3）小结 "),i("a",{class:"header-anchor",href:"#_3-小结-1","aria-label":'Permalink to "3）小结"'},"​")],-1)),s[576]||(s[576]=i("p",null,"bool查询有几种逻辑关系？",-1)),s[577]||(s[577]=i("ul",null,[i("li",null,"must：必须匹配的条件，可以理解为“与”"),i("li",null,"should：选择性匹配的条件，可以理解为“或”"),i("li",null,"must_not：必须不匹配的条件，不参与打分"),i("li",null,"filter：必须匹配的条件，不参与打分")],-1)),s[578]||(s[578]=i("hr",null,null,-1)),s[579]||(s[579]=i("h2",{id:"_7-搜索结果处理",tabindex:"-1"},[l("7. 搜索结果处理 "),i("a",{class:"header-anchor",href:"#_7-搜索结果处理","aria-label":'Permalink to "7. 搜索结果处理"'},"​")],-1)),s[580]||(s[580]=i("p",null,"搜索的结果可以按照用户指定的方式去处理或展示。",-1)),s[581]||(s[581]=i("h3",{id:"_7-1-排序",tabindex:"-1"},[l("7.1 排序 "),i("a",{class:"header-anchor",href:"#_7-1-排序","aria-label":'Permalink to "7.1 排序"'},"​")],-1)),s[582]||(s[582]=i("p",null,[l("elasticsearch默认是根据相关度算分（_score）来排序，但是也支持自定义方式对搜索"),i("a",{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/sort-search-results.html",target:"_blank",rel:"noreferrer"},"结果排序"),l("。可以排序字段类型有：keyword类型、数值类型、地理坐标类型、日期类型等。")],-1)),s[583]||(s[583]=i("h4",{id:"_7-1-1-普通字段排序",tabindex:"-1"},[l("7.1.1 普通字段排序 "),i("a",{class:"header-anchor",href:"#_7-1-1-普通字段排序","aria-label":'Permalink to "7.1.1 普通字段排序"'},"​")],-1)),s[584]||(s[584]=i("p",null,"keyword、数值、日期类型排序的语法基本一致。",-1)),s[585]||(s[585]=i("p",null,[i("strong",null,"语法"),l("：")],-1)),s[586]||(s[586]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /indexName/_search")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "query"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "match_all"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {}")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "sort"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": [")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "FIELD"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"desc"'),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  // 排序字段、排序方式ASC、DESC")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  ]")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[587]||(s[587]=i("p",null,"排序条件是一个数组，也就是可以写多个排序条件。按照声明的顺序，当第一个条件相等时，再按照第二个条件排序，以此类推",-1)),s[588]||(s[588]=i("p",null,[i("strong",null,"示例"),l("：")],-1)),s[589]||(s[589]=i("p",null,"需求描述：酒店数据按照用户评价（score)降序排序，评价相同的按照价格(price)升序排序",-1)),s[590]||(s[590]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721195728306.png",alt:"image-20210721195728306",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[591]||(s[591]=i("h4",{id:"_7-1-2-地理坐标排序",tabindex:"-1"},[l("7.1.2 地理坐标排序 "),i("a",{class:"header-anchor",href:"#_7-1-2-地理坐标排序","aria-label":'Permalink to "7.1.2 地理坐标排序"'},"​")],-1)),s[592]||(s[592]=i("p",null,"地理坐标排序略有不同。",-1)),s[593]||(s[593]=i("p",null,[i("strong",null,"语法说明"),l("：")],-1)),s[594]||(s[594]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /indexName/_search")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "query"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "match_all"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {}")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "sort"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": [")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "_geo_distance"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "FIELD"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"纬度，经度"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 文档中geo_point类型的字段名、目标坐标点")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "order"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"asc"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 排序方式")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "unit"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"km"'),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," // 排序的距离单位")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  ]")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[595]||(s[595]=i("p",null,"这个查询的含义是：",-1)),s[596]||(s[596]=i("ul",null,[i("li",null,"指定一个坐标，作为目标点"),i("li",null,"计算每一个文档中，指定字段（必须是geo_point类型）的坐标 到目标点的距离是多少"),i("li",null,"根据距离排序")],-1)),s[597]||(s[597]=i("p",null,[i("strong",null,"示例：")],-1)),s[598]||(s[598]=i("p",null,"需求描述：实现对酒店数据按照到你的位置坐标的距离升序排序",-1)),s[599]||(s[599]=i("p",null,[l("提示：获取你的位置的经纬度的方式："),i("a",{href:"https://lbs.amap.com/demo/jsapi-v2/example/map/click-to-get-lnglat/",target:"_blank",rel:"noreferrer"},"https://lbs.amap.com/demo/jsapi-v2/example/map/click-to-get-lnglat/")],-1)),s[600]||(s[600]=i("p",null,"假设我的位置是：31.034661，121.612282，寻找我周围距离最近的酒店。",-1)),s[601]||(s[601]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721200214690.png",alt:"image-20210721200214690",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[602]||(s[602]=i("h3",{id:"_7-2-分页",tabindex:"-1"},[l("7.2 分页 "),i("a",{class:"header-anchor",href:"#_7-2-分页","aria-label":'Permalink to "7.2 分页"'},"​")],-1)),s[603]||(s[603]=i("p",null,"elasticsearch 默认情况下只返回top10的数据。而如果要查询更多数据就需要修改分页参数了。elasticsearch中通过修改from、size参数来控制要返回的分页结果：",-1)),s[604]||(s[604]=i("ul",null,[i("li",null,"from：从第几个文档开始"),i("li",null,"size：总共查询几个文档")],-1)),s[605]||(s[605]=i("p",null,[l("类似于mysql中的"),i("code",null,"limit ?, ?")],-1)),s[606]||(s[606]=i("h4",{id:"_7-2-1-基本的分页",tabindex:"-1"},[l("7.2.1 基本的分页 "),i("a",{class:"header-anchor",href:"#_7-2-1-基本的分页","aria-label":'Permalink to "7.2.1 基本的分页"'},"​")],-1)),s[607]||(s[607]=i("p",null,"分页的基本语法如下：",-1)),s[608]||(s[608]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /hotel/_search")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "query"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "match_all"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {}")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "from"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 分页开始的位置，默认为0")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "size"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"10"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 期望获取的文档总数")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "sort"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": [")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'"price"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"asc"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  ]")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[609]||(s[609]=i("h4",{id:"_7-2-2-深度分页问题",tabindex:"-1"},[l("7.2.2 深度分页问题 "),i("a",{class:"header-anchor",href:"#_7-2-2-深度分页问题","aria-label":'Permalink to "7.2.2 深度分页问题"'},"​")],-1)),s[610]||(s[610]=i("p",null,"现在，我要查询990~1000的数据，查询逻辑要这么写：",-1)),s[611]||(s[611]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /hotel/_search")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "query"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "match_all"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {}")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "from"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"990"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 分页开始的位置，默认为0")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "size"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"10"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 期望获取的文档总数")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "sort"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": [")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'"price"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"asc"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  ]")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[612]||(s[612]=i("p",null,"这里是查询990开始的数据，也就是 第990~第1000条 数据。",-1)),s[613]||(s[613]=i("p",null,"不过，elasticsearch内部分页时，必须先查询 0~1000条，然后截取其中的990 ~ 1000的这10条：",-1)),s[614]||(s[614]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721200643029.png",alt:"image-20210721200643029",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[615]||(s[615]=i("p",null,"查询TOP1000，如果es是单点模式，这并无太大影响。",-1)),s[616]||(s[616]=i("p",null,"但是elasticsearch将来一定是集群，例如我集群有5个节点，我要查询TOP1000的数据，并不是每个节点查询200条就可以了。",-1)),s[617]||(s[617]=i("p",null,"因为节点A的TOP200，在另一个节点可能排到10000名以外了。",-1)),s[618]||(s[618]=i("p",null,"因此要想获取整个集群的TOP1000，必须先查询出每个节点的TOP1000，汇总结果后，重新排名，重新截取TOP1000。",-1)),s[619]||(s[619]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721201003229.png",alt:"image-20210721201003229",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[620]||(s[620]=i("p",null,"那如果我要查询9900~10000的数据呢？是不是要先查询TOP10000呢？那每个节点都要查询10000条？汇总到内存中？",-1)),s[621]||(s[621]=i("p",null,"当查询分页深度较大时，汇总数据过多，对内存和CPU会产生非常大的压力，因此elasticsearch会禁止from+ size 超过10000的请求。",-1)),s[622]||(s[622]=i("p",null,[l("针对深度分页，ES提供了两种解决方案，"),i("a",{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/paginate-search-results.html",target:"_blank",rel:"noreferrer"},"官方文档"),l("：")],-1)),s[623]||(s[623]=i("ul",null,[i("li",null,"search after：分页时需要排序，原理是从上一次的排序值开始，查询下一页数据。官方推荐使用的方式。"),i("li",null,"scroll：原理将排序后的文档id形成快照，保存在内存。官方已经不推荐使用。")],-1)),s[624]||(s[624]=i("h4",{id:"_7-2-3-小结",tabindex:"-1"},[l("7.2.3 小结 "),i("a",{class:"header-anchor",href:"#_7-2-3-小结","aria-label":'Permalink to "7.2.3 小结"'},"​")],-1)),s[625]||(s[625]=i("blockquote",null,[i("ul",null,[i("li",null,[i("p",null,"分页查询的常见实现方案以及优缺点："),i("ul",null,[i("li",null,[i("p",null,[i("code",null,"from + size"),l("：")]),i("ul",null,[i("li",null,[i("p",null,"优点：支持随机翻页")]),i("li",null,[i("p",null,"缺点：深度分页问题，默认查询上限（from + size）是10000")]),i("li",null,[i("p",null,"场景：百度、京东、谷歌、淘宝这样的随机翻页搜索")]),i("li",null,[i("p",null,[i("code",null,"after search"),l("：")]),i("ul",null,[i("li",null,"优点：没有查询上限（单次查询的size不超过10000）"),i("li",null,"缺点：只能向后逐页查询，不支持随机翻页"),i("li",null,"场景：没有随机翻页需求的搜索，例如手机向下滚动翻页")])])])]),i("li",null,[i("p",null,[i("code",null,"scroll"),l("：")]),i("ul",null,[i("li",null,[l("优点：没有查询上限（单次查询的size不超过10000） "),i("ul",null,[i("li",null,"缺点：会有额外内存消耗，并且搜索结果是非实时的"),i("li",null,"场景：海量数据的获取和迁移。从ES7.1开始不推荐，建议用 after search方案。")])])])])])])])],-1)),s[626]||(s[626]=i("h3",{id:"_7-3-高亮",tabindex:"-1"},[l("7.3 高亮 "),i("a",{class:"header-anchor",href:"#_7-3-高亮","aria-label":'Permalink to "7.3 高亮"'},"​")],-1)),s[627]||(s[627]=i("h4",{id:"_7-3-1-高亮原理",tabindex:"-1"},[l("7.3.1 高亮原理 "),i("a",{class:"header-anchor",href:"#_7-3-1-高亮原理","aria-label":'Permalink to "7.3.1 高亮原理"'},"​")],-1)),s[628]||(s[628]=i("p",null,"什么是高亮显示呢？",-1)),s[629]||(s[629]=i("p",null,"我们在百度，京东搜索时，关键字会变成红色，比较醒目，这叫高亮显示：",-1)),s[630]||(s[630]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721202705030.png",alt:"image-20210721202705030",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[631]||(s[631]=i("p",null,"高亮显示的实现分为两步：",-1)),s[632]||(s[632]=i("ul",null,[i("li",null,[l("1）给文档中的所有关键字都添加一个标签，例如"),i("code",null,"<em>"),l("标签")]),i("li",null,[l("2）页面给"),i("code",null,"<em>"),l("标签编写CSS样式")])],-1)),s[633]||(s[633]=i("h4",{id:"_7-3-2-实现高亮",tabindex:"-1"},[l("7.3.2 实现高亮 "),i("a",{class:"header-anchor",href:"#_7-3-2-实现高亮","aria-label":'Permalink to "7.3.2 实现高亮"'},"​")],-1)),s[634]||(s[634]=i("p",null,[i("strong",null,"高亮的语法"),l("：")],-1)),s[635]||(s[635]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /hotel/_search")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "query"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "match"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "FIELD"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"TEXT"'),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," // 查询条件，高亮一定要使用全文检索查询")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "highlight"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "fields"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": { "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 指定要高亮的字段")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "FIELD"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "pre_tags"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"<em>"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",  "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 用来标记高亮字段的前置标签")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "post_tags"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"</em>"'),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," // 用来标记高亮字段的后置标签")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[636]||(s[636]=i("p",null,[i("strong",null,"注意：")],-1)),s[637]||(s[637]=i("ul",null,[i("li",null,[l("高亮是对关键字高亮，因此"),i("strong",null,"搜索条件必须带有关键字"),l("，而不能是范围这样的查询。")]),i("li",null,[l("默认情况下，"),i("strong",null,"高亮的字段，必须与搜索指定的字段一致"),l("，否则无法高亮")]),i("li",null,"如果要对非搜索字段高亮，则需要添加一个属性：required_field_match=false")],-1)),s[638]||(s[638]=i("p",null,[i("strong",null,"示例"),l("：")],-1)),s[639]||(s[639]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721203349633.png",alt:"image-20210721203349633",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[640]||(s[640]=i("h3",{id:"_7-4-总结",tabindex:"-1"},[l("7.4 总结 "),i("a",{class:"header-anchor",href:"#_7-4-总结","aria-label":'Permalink to "7.4 总结"'},"​")],-1)),s[641]||(s[641]=i("blockquote",null,[i("ul",null,[i("li",null,[i("p",null,"查询的DSL是一个大的JSON对象，包含下列属性："),i("ul",null,[i("li",null,[i("p",null,"query：查询条件")]),i("li",null,[i("p",null,"from和size：分页条件")]),i("li",null,[i("p",null,"sort：排序条件")]),i("li",null,[i("p",null,"highlight：高亮条件")])])])]),i("p",null,"示例："),i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721203657850.png",alt:"image-20210721203657850",loading:"lazy",decoding:"async",class:"lazy"})])],-1)),s[642]||(s[642]=i("hr",null,null,-1)),s[643]||(s[643]=i("h2",{id:"_8-restclient查询文档",tabindex:"-1"},[l("8. RestClient查询文档 "),i("a",{class:"header-anchor",href:"#_8-restclient查询文档","aria-label":'Permalink to "8. RestClient查询文档"'},"​")],-1)),s[644]||(s[644]=i("p",null,"文档的查询同样适用昨天学习的 RestHighLevelClient对象，基本步骤包括：",-1)),s[645]||(s[645]=i("ol",null,[i("li",null,"准备Request对象"),i("li",null,"准备请求参数"),i("li",null,"发起请求"),i("li",null,"解析响应")],-1)),s[646]||(s[646]=i("h3",{id:"_8-1-快速入门",tabindex:"-1"},[l("8.1 快速入门 "),i("a",{class:"header-anchor",href:"#_8-1-快速入门","aria-label":'Permalink to "8.1 快速入门"'},"​")],-1)),s[647]||(s[647]=i("p",null,"我们以match_all查询为例",-1)),s[648]||(s[648]=i("h4",{id:"_8-1-1-发起查询请求",tabindex:"-1"},[l("8.1.1 发起查询请求 "),i("a",{class:"header-anchor",href:"#_8-1-1-发起查询请求","aria-label":'Permalink to "8.1.1 发起查询请求"'},"​")],-1)),s[649]||(s[649]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721203950559.png",alt:"image-20210721203950559",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[650]||(s[650]=i("p",null,"代码解读：",-1)),s[651]||(s[651]=i("ul",null,[i("li",null,[i("p",null,[l("第一步，创建"),i("code",null,"SearchRequest"),l("对象，指定索引库名")])]),i("li",null,[i("p",null,[l("第二步，利用"),i("code",null,"request.source()"),l("构建DSL，DSL中可以包含查询、分页、排序、高亮等")]),i("ul",null,[i("li",null,[i("code",null,"query()"),l("：代表查询条件，利用"),i("code",null,"QueryBuilders.matchAllQuery()"),l("构建一个match_all查询的DSL")])])]),i("li",null,[i("p",null,"第三步，利用client.search()发送请求，得到响应")])],-1)),s[652]||(s[652]=i("p",null,[l("这里关键的API有两个，一个是"),i("code",null,"request.source()"),l("，其中包含了查询、排序、分页、高亮等所有功能：")],-1)),s[653]||(s[653]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721215640790.png",alt:"image-20210721215640790",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[654]||(s[654]=i("p",null,[l("另一个是"),i("code",null,"QueryBuilders"),l("，其中包含match、term、function_score、bool等各种查询：")],-1)),s[655]||(s[655]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721215729236.png",alt:"image-20210721215729236",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[656]||(s[656]=i("h4",{id:"_8-1-2-解析响应",tabindex:"-1"},[l("8.1.2 解析响应 "),i("a",{class:"header-anchor",href:"#_8-1-2-解析响应","aria-label":'Permalink to "8.1.2 解析响应"'},"​")],-1)),s[657]||(s[657]=i("p",null,"响应结果的解析：",-1)),s[658]||(s[658]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721214221057.png",alt:"image-20210721214221057",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[659]||(s[659]=i("p",null,"elasticsearch返回的结果是一个JSON字符串，结构包含：",-1)),s[660]||(s[660]=i("ul",null,[i("li",null,[i("code",null,"hits"),l("：命中的结果 "),i("ul",null,[i("li",null,[i("code",null,"total"),l("：总条数，其中的value是具体的总条数值")]),i("li",null,[i("code",null,"max_score"),l("：所有结果中得分最高的文档的相关性算分")]),i("li",null,[i("code",null,"hits"),l("：搜索结果的文档数组，其中的每个文档都是一个json对象 "),i("ul",null,[i("li",null,[i("code",null,"_source"),l("：文档中的原始数据，也是json对象")])])])])])],-1)),s[661]||(s[661]=i("p",null,"因此，我们解析响应结果，就是逐层解析JSON字符串，流程如下：",-1)),s[662]||(s[662]=i("ul",null,[i("li",null,[i("code",null,"SearchHits"),l("：通过response.getHits()获取，就是JSON中的最外层的hits，代表命中的结果 "),i("ul",null,[i("li",null,[i("code",null,"SearchHits#getTotalHits().value"),l("：获取总条数信息")]),i("li",null,[i("code",null,"SearchHits#getHits()"),l("：获取SearchHit数组，也就是文档数组 "),i("ul",null,[i("li",null,[i("code",null,"SearchHit#getSourceAsString()"),l("：获取文档结果中的_source，也就是原始的json文档数据")])])])])])],-1)),s[663]||(s[663]=i("h4",{id:"_8-1-3-完整代码",tabindex:"-1"},[l("8.1.3 完整代码 "),i("a",{class:"header-anchor",href:"#_8-1-3-完整代码","aria-label":'Permalink to "8.1.3 完整代码"'},"​")],-1)),s[664]||(s[664]=i("p",null,"完整代码如下：",-1)),s[665]||(s[665]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Test")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"void"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testMatchAll"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() throws IOException {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 1.准备Request")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    SearchRequest request "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," SearchRequest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.准备DSL")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    request."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        ."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"query"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"matchAllQuery"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 3.发送请求")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    SearchResponse response "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"search"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.解析响应")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    handleResponse"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(response);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"private"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," handleResponse"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(SearchResponse response) {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.解析响应")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    SearchHits searchHits "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," response."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getHits"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.1.获取总条数")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    long"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," total "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," searchHits."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getTotalHits"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"().value;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    System.out."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"共搜索到"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," total "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "条数据"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.2.文档数组")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    SearchHit"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[] hits "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," searchHits."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getHits"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.3.遍历")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    for"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (SearchHit hit "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hits) {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 获取文档source")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        String json "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hit."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getSourceAsString"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 反序列化")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        HotelDoc hotelDoc "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," JSON."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"parseObject"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(json, HotelDoc.class);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        System.out."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotelDoc = "'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotelDoc);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[666]||(s[666]=i("h4",{id:"_8-1-4-小结",tabindex:"-1"},[l("8.1.4 小结 "),i("a",{class:"header-anchor",href:"#_8-1-4-小结","aria-label":'Permalink to "8.1.4 小结"'},"​")],-1)),s[667]||(s[667]=i("blockquote",null,[i("p",null,"查询的基本步骤是："),i("ol",null,[i("li",null,[i("p",null,"创建SearchRequest对象")]),i("li",null,[i("p",null,"准备Request.source()，也就是DSL。"),i("p",null,"① QueryBuilders来构建查询条件"),i("p",null,"② 传入Request.source() 的 query() 方法")]),i("li",null,[i("p",null,"发送请求，得到结果")]),i("li",null,[i("p",null,"解析结果（参考JSON结果，从外到内，逐层解析）")])])],-1)),s[668]||(s[668]=i("h3",{id:"_8-2-match查询",tabindex:"-1"},[l("8.2 match查询 "),i("a",{class:"header-anchor",href:"#_8-2-match查询","aria-label":'Permalink to "8.2 match查询"'},"​")],-1)),s[669]||(s[669]=i("p",null,"全文检索的match和multi_match查询与match_all的API基本一致。差别是查询条件，也就是query的部分。",-1)),s[670]||(s[670]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721215923060.png",alt:"image-20210721215923060",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[671]||(s[671]=i("p",null,"因此，Java代码上的差异主要是request.source().query()中的参数了。同样是利用QueryBuilders提供的方法：",-1)),s[672]||(s[672]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721215843099.png",alt:"image-20210721215843099",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[673]||(s[673]=i("p",null,"而结果解析代码则完全一致，可以抽取并共享。",-1)),s[674]||(s[674]=i("p",null,"完整代码如下：",-1)),s[675]||(s[675]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Test")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"void"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testMatch"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() throws IOException {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 1.准备Request")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    SearchRequest request "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," SearchRequest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.准备DSL")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    request."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        ."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"query"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"matchQuery"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"all"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"如家"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"));")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 3.发送请求")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    SearchResponse response "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"search"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.解析响应")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    handleResponse"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(response);")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[676]||(s[676]=i("h3",{id:"_8-3-精确查询",tabindex:"-1"},[l("8.3 精确查询 "),i("a",{class:"header-anchor",href:"#_8-3-精确查询","aria-label":'Permalink to "8.3 精确查询"'},"​")],-1)),s[677]||(s[677]=i("p",null,"精确查询主要是两者：",-1)),s[678]||(s[678]=i("ul",null,[i("li",null,"term：词条精确匹配"),i("li",null,"range：范围查询")],-1)),s[679]||(s[679]=i("p",null,"与之前的查询相比，差异同样在查询条件，其它都一样。",-1)),s[680]||(s[680]=i("p",null,"查询条件构造的API如下：",-1)),s[681]||(s[681]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721220305140.png",alt:"image-20210721220305140",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[682]||(s[682]=i("h3",{id:"_8-4-布尔查询",tabindex:"-1"},[l("8.4 布尔查询 "),i("a",{class:"header-anchor",href:"#_8-4-布尔查询","aria-label":'Permalink to "8.4 布尔查询"'},"​")],-1)),s[683]||(s[683]=i("p",null,"布尔查询是用must、must_not、filter等方式组合其它查询，代码示例如下：",-1)),s[684]||(s[684]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721220927286.png",alt:"image-20210721220927286",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[685]||(s[685]=i("p",null,"可以看到，API与其它查询的差别同样是在查询条件的构建，QueryBuilders，结果解析等其他代码完全不变。",-1)),s[686]||(s[686]=i("p",null,"完整代码如下：",-1)),s[687]||(s[687]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Test")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"void"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testBool"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() throws IOException {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 1.准备Request")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    SearchRequest request "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," SearchRequest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.准备DSL")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.1.准备BooleanQuery")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    BoolQueryBuilder boolQuery "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," QueryBuilders."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"boolQuery"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.2.添加term")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    boolQuery."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"must"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"termQuery"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"city"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"杭州"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"));")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.3.添加range")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    boolQuery."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"filter"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"rangeQuery"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"price"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"lte"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"250"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"));")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    request."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"query"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(boolQuery);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 3.发送请求")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    SearchResponse response "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"search"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.解析响应")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    handleResponse"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(response);")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[688]||(s[688]=i("h3",{id:"_8-5-排序、分页",tabindex:"-1"},[l("8.5 排序、分页 "),i("a",{class:"header-anchor",href:"#_8-5-排序、分页","aria-label":'Permalink to "8.5 排序、分页"'},"​")],-1)),s[689]||(s[689]=i("p",null,"搜索结果的排序和分页是与query同级的参数，因此同样是使用request.source()来设置。",-1)),s[690]||(s[690]=i("p",null,"对应的API如下：",-1)),s[691]||(s[691]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721221121266.png",alt:"image-20210721221121266",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[692]||(s[692]=i("p",null,"完整代码示例：",-1)),s[693]||(s[693]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Test")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"void"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testPageAndSort"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() throws IOException {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 页码，每页大小")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    int"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," page "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", size "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 5"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 1.准备Request")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    SearchRequest request "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," SearchRequest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.准备DSL")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.1.query")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    request."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"query"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"matchAllQuery"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.2.排序 sort")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    request."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"sort"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"price"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", SortOrder.ASC);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.3.分页 from、size")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    request."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"from"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"((page "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"*"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," size)."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"size"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"5"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 3.发送请求")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    SearchResponse response "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"search"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.解析响应")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    handleResponse"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(response);")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[694]||(s[694]=i("h3",{id:"_8-6-高亮",tabindex:"-1"},[l("8.6 高亮 "),i("a",{class:"header-anchor",href:"#_8-6-高亮","aria-label":'Permalink to "8.6 高亮"'},"​")],-1)),s[695]||(s[695]=i("p",null,"高亮的代码与之前代码差异较大，有两点：",-1)),s[696]||(s[696]=i("ul",null,[i("li",null,"查询的DSL：其中除了查询条件，还需要添加高亮条件，同样是与query同级。"),i("li",null,"结果解析：结果除了要解析_source文档数据，还要解析高亮结果")],-1)),s[697]||(s[697]=i("h4",{id:"_8-6-1-高亮请求构建",tabindex:"-1"},[l("8.6.1 高亮请求构建 "),i("a",{class:"header-anchor",href:"#_8-6-1-高亮请求构建","aria-label":'Permalink to "8.6.1 高亮请求构建"'},"​")],-1)),s[698]||(s[698]=i("p",null,"高亮请求的构建API如下：",-1)),s[699]||(s[699]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721221744883.png",alt:"image-20210721221744883",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[700]||(s[700]=i("p",null,"上述代码省略了查询条件部分，但是大家不要忘了：高亮查询必须使用全文检索查询，并且要有搜索关键字，将来才可以对关键字高亮。",-1)),s[701]||(s[701]=i("p",null,"完整代码如下：",-1)),s[702]||(s[702]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Test")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"void"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," testHighlight"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() throws IOException {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 1.准备Request")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    SearchRequest request "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," SearchRequest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.准备DSL")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.1.query")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    request."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"query"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"matchQuery"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"all"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"如家"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"));")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.2.高亮")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    request."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"highlighter"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HighlightBuilder"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"field"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"name"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"requireFieldMatch"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"false"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"));")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 3.发送请求")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    SearchResponse response "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"search"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.解析响应")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    handleResponse"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(response);")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[703]||(s[703]=i("h4",{id:"_8-6-2-高亮结果解析",tabindex:"-1"},[l("8.6.2 高亮结果解析 "),i("a",{class:"header-anchor",href:"#_8-6-2-高亮结果解析","aria-label":'Permalink to "8.6.2 高亮结果解析"'},"​")],-1)),s[704]||(s[704]=i("p",null,"高亮的结果与查询的文档结果默认是分离的，并不在一起。",-1)),s[705]||(s[705]=i("p",null,"因此解析高亮的代码需要额外处理：",-1)),s[706]||(s[706]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721222057212.png",alt:"image-20210721222057212",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[707]||(s[707]=i("p",null,"代码解读：",-1)),s[708]||(s[708]=i("ul",null,[i("li",null,"第一步：从结果中获取source。hit.getSourceAsString()，这部分是非高亮结果，json字符串。还需要反序列为HotelDoc对象"),i("li",null,"第二步：获取高亮结果。hit.getHighlightFields()，返回值是一个Map，key是高亮字段名称，值是HighlightField对象，代表高亮值"),i("li",null,"第三步：从map中根据高亮字段名称，获取高亮字段值对象HighlightField"),i("li",null,"第四步：从HighlightField中获取Fragments，并且转为字符串。这部分就是真正的高亮字符串了"),i("li",null,"第五步：用高亮的结果替换HotelDoc中的非高亮结果")],-1)),s[709]||(s[709]=i("p",null,"完整代码如下：",-1)),s[710]||(s[710]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"private"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," handleResponse"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(SearchResponse response) {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.解析响应")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    SearchHits searchHits "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," response."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getHits"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.1.获取总条数")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    long"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," total "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," searchHits."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getTotalHits"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"().value;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    System.out."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"共搜索到"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," total "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "条数据"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.2.文档数组")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    SearchHit"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[] hits "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," searchHits."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getHits"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.3.遍历")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    for"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (SearchHit hit "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hits) {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 获取文档source")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        String json "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hit."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getSourceAsString"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 反序列化")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        HotelDoc hotelDoc "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," JSON."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"parseObject"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(json, HotelDoc.class);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 获取高亮结果")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        Map<"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"String"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"HighlightField"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> highlightFields "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hit."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getHighlightFields"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"CollectionUtils."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"isEmpty"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(highlightFields)) {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            // 根据字段名获取高亮结果")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            HighlightField highlightField "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," highlightFields."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"get"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"name"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (highlightField "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"                // 获取高亮值")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                String name "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," highlightField."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getFragments"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()["),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"string"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"                // 覆盖非高亮结果")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                hotelDoc."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setName"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(name);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        System.out."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotelDoc = "'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotelDoc);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[711]||(s[711]=i("hr",null,null,-1)),s[712]||(s[712]=i("h2",{id:"_9-黑马旅游案例",tabindex:"-1"},[l("9. 黑马旅游案例 "),i("a",{class:"header-anchor",href:"#_9-黑马旅游案例","aria-label":'Permalink to "9. 黑马旅游案例"'},"​")],-1)),s[713]||(s[713]=i("p",null,"下面，我们通过黑马旅游的案例来实战演练下之前学习的知识。",-1)),s[714]||(s[714]=i("p",null,"我们实现四部分功能：",-1)),s[715]||(s[715]=i("ul",null,[i("li",null,"酒店搜索和分页"),i("li",null,"酒店结果过滤"),i("li",null,"我周边的酒店"),i("li",null,"酒店竞价排名")],-1)),s[716]||(s[716]=i("p",null,[l("启动我们提供的hotel-demo项目，其默认端口是8089，访问"),i("code",null,"http://localhost:8090"),l("，就能看到项目页面了：")],-1)),s[717]||(s[717]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721223159598.png",alt:"image-20210721223159598",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[718]||(s[718]=i("h3",{id:"_9-1-酒店搜索和分页",tabindex:"-1"},[l("9.1 酒店搜索和分页 "),i("a",{class:"header-anchor",href:"#_9-1-酒店搜索和分页","aria-label":'Permalink to "9.1 酒店搜索和分页"'},"​")],-1)),s[719]||(s[719]=i("p",null,"案例需求：实现黑马旅游的酒店搜索功能，完成关键字搜索和分页",-1)),s[720]||(s[720]=i("h4",{id:"_9-1-1-需求分析",tabindex:"-1"},[l("9.1.1 需求分析 "),i("a",{class:"header-anchor",href:"#_9-1-1-需求分析","aria-label":'Permalink to "9.1.1 需求分析"'},"​")],-1)),s[721]||(s[721]=i("p",null,"在项目的首页，有一个大大的搜索框，还有分页按钮：",-1)),s[722]||(s[722]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721223859419.png",alt:"image-20210721223859419",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[723]||(s[723]=i("p",null,"点击搜索按钮，可以看到浏览器控制台发出了请求：",-1)),s[724]||(s[724]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721224033789.png",alt:"image-20210721224033789",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[725]||(s[725]=i("p",null,"请求参数如下：",-1)),s[726]||(s[726]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721224112708.png",alt:"image-20210721224112708",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[727]||(s[727]=i("p",null,"由此可以知道，我们这个请求的信息如下：",-1)),s[728]||(s[728]=i("ul",null,[i("li",null,"请求方式：POST"),i("li",null,"请求路径：/hotel/list"),i("li",null,[l("请求参数：JSON对象，包含4个字段： "),i("ul",null,[i("li",null,"key：搜索关键字"),i("li",null,"page：页码"),i("li",null,"size：每页大小"),i("li",null,"sortBy：排序，目前暂不实现")])]),i("li",null,[l("返回值：分页查询，需要返回分页结果PageResult，包含两个属性： "),i("ul",null,[i("li",null,[i("code",null,"total"),l("：总条数")]),i("li",null,[i("code",null,"List<HotelDoc>"),l("：当前页的数据")])])])],-1)),s[729]||(s[729]=i("p",null,"因此，我们实现业务的流程如下：",-1)),s[730]||(s[730]=i("ul",null,[i("li",null,"步骤一：定义实体类，接收请求参数的JSON对象"),i("li",null,"步骤二：编写controller，接收页面的请求"),i("li",null,"步骤三：编写业务实现，利用RestHighLevelClient实现搜索、分页")],-1)),s[731]||(s[731]=i("h4",{id:"_9-1-2-定义实体类",tabindex:"-1"},[l("9.1.2 定义实体类 "),i("a",{class:"header-anchor",href:"#_9-1-2-定义实体类","aria-label":'Permalink to "9.1.2 定义实体类"'},"​")],-1)),s[732]||(s[732]=i("p",null,"实体类有两个，一个是前端的请求参数实体，一个是服务端应该返回的响应结果实体。",-1)),s[733]||(s[733]=i("p",null,"1）请求参数",-1)),s[734]||(s[734]=i("p",null,"前端请求的json结构如下：",-1)),s[735]||(s[735]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "key"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"搜索关键字"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "page"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "size"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"3"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "sortBy"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"default"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[736]||(s[736]=i("p",null,[l("因此，我们在"),i("code",null,"cn.itcast.hotel.pojo"),l("包下定义一个实体类：")],-1)),s[737]||(s[737]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"package"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," cn.itcast.hotel.pojo;")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," lombok.Data;")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Data")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," RequestParams"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String key;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer page;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer size;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String sortBy;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[738]||(s[738]=i("p",null,"2）返回值",-1)),s[739]||(s[739]=i("p",null,"分页查询，需要返回分页结果PageResult，包含两个属性：",-1)),s[740]||(s[740]=i("ul",null,[i("li",null,[i("code",null,"total"),l("：总条数")]),i("li",null,[i("code",null,"List<HotelDoc>"),l("：当前页的数据")])],-1)),s[741]||(s[741]=i("p",null,[l("因此，我们在"),i("code",null,"cn.itcast.hotel.pojo"),l("中定义返回结果：")],-1)),s[742]||(s[742]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"package"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," cn.itcast.hotel.pojo;")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," lombok.Data;")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," java.util.List;")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Data")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," PageResult"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Long total;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," List<"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"HotelDoc"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> hotels;")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," PageResult"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," PageResult"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Long "),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"total"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", List<"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"HotelDoc"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> "),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"hotels"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".total "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," total;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".hotels "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotels;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[743]||(s[743]=i("h4",{id:"_9-1-3-定义controller",tabindex:"-1"},[l("9.1.3 定义controller "),i("a",{class:"header-anchor",href:"#_9-1-3-定义controller","aria-label":'Permalink to "9.1.3 定义controller"'},"​")],-1)),s[744]||(s[744]=i("p",null,"定义一个HotelController，声明查询接口，满足下列要求：",-1)),s[745]||(s[745]=i("ul",null,[i("li",null,"请求方式：Post"),i("li",null,"请求路径：/hotel/list"),i("li",null,"请求参数：对象，类型为RequestParam"),i("li",null,[l("返回值：PageResult，包含两个属性 "),i("ul",null,[i("li",null,[i("code",null,"Long total"),l("：总条数")]),i("li",null,[i("code",null,"List<HotelDoc> hotels"),l("：酒店数据")])])])],-1)),s[746]||(s[746]=i("p",null,[l("因此，我们在"),i("code",null,"cn.itcast.hotel.web"),l("中定义HotelController：")],-1)),s[747]||(s[747]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RestController")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestMapping"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/hotel"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HotelController"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Autowired")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," IHotelService hotelService;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"	// 搜索酒店数据")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"PostMapping"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/list"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," PageResult "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"search"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestBody"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RequestParams "),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"params"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"){")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotelService."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"search"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(params);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[748]||(s[748]=i("h4",{id:"_9-1-4-实现搜索业务",tabindex:"-1"},[l("9.1.4 实现搜索业务 "),i("a",{class:"header-anchor",href:"#_9-1-4-实现搜索业务","aria-label":'Permalink to "9.1.4 实现搜索业务"'},"​")],-1)),s[749]||(s[749]=i("p",null,"我们在controller调用了IHotelService，并没有实现该方法，因此下面我们就在IHotelService中定义方法，并且去实现业务逻辑。",-1)),s[750]||(s[750]=i("p",null,[l("1）在"),i("code",null,"cn.itcast.hotel.service"),l("中的"),i("code",null,"IHotelService"),l("接口中定义一个方法：")],-1)),s[751]||(s[751]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"/**")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * 根据关键字搜索酒店信息")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," params"),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," 请求参数对象，包含用户输入的关键字 ")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@return"),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," 酒店文档列表")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," */")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"PageResult "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"search"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(RequestParams params);")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[752]||(s[752]=i("p",null,[l("2）实现搜索业务，肯定离不开RestHighLevelClient，我们需要把它注册到Spring中作为一个Bean。在"),i("code",null,"cn.itcast.hotel"),l("中的"),i("code",null,"HotelDemoApplication"),l("中声明这个Bean：")],-1)),s[753]||(s[753]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Bean")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RestHighLevelClient "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"client"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(){")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    return"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"  new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," RestHighLevelClient"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(RestClient."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"builder"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        HttpHost."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"create"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"http://192.168.150.101:9200"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    ));")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[754]||(s[754]=i("p",null,[l("3）在"),i("code",null,"cn.itcast.hotel.service.impl"),l("中的"),i("code",null,"HotelService"),l("中实现search方法：")],-1)),s[755]||(s[755]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Override")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," PageResult "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"search"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(RequestParams params) {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    try"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 1.准备Request")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        SearchRequest request "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," SearchRequest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 2.准备DSL")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 2.1.query")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        String key "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," params."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getKey"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (key "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ||"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' ""'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"equals"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(key)) {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            boolQuery."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"must"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"matchAllQuery"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        } "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"else"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            boolQuery."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"must"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"matchQuery"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"all"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", key));")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 2.2.分页")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        int"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," page "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," params."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getPage"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        int"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," size "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," params."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getSize"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        request."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"from"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"((page "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"*"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," size)."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"size"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(size);")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 3.发送请求")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        SearchResponse response "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"search"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 4.解析响应")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," handleResponse"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(response);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    } "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"catch"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (IOException "),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"e"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        throw"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," RuntimeException"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(e);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 结果解析")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," PageResult "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"handleResponse"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(SearchResponse response) {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.解析响应")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    SearchHits searchHits "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," response."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getHits"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.1.获取总条数")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    long"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," total "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," searchHits."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getTotalHits"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"().value;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.2.文档数组")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    SearchHit"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[] hits "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," searchHits."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getHits"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.3.遍历")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    List<"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"HotelDoc"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> hotels "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ArrayList<>();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    for"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (SearchHit hit "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hits) {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 获取文档source")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        String json "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hit."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getSourceAsString"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 反序列化")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        HotelDoc hotelDoc "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," JSON."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"parseObject"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(json, HotelDoc.class);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"		// 放入集合")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        hotels."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"add"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(hotelDoc);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.4.封装返回")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    return"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," PageResult"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(total, hotels);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[756]||(s[756]=i("h3",{id:"_9-2-酒店结果过滤",tabindex:"-1"},[l("9.2 酒店结果过滤 "),i("a",{class:"header-anchor",href:"#_9-2-酒店结果过滤","aria-label":'Permalink to "9.2 酒店结果过滤"'},"​")],-1)),s[757]||(s[757]=i("p",null,"需求：添加品牌、城市、星级、价格等过滤功能",-1)),s[758]||(s[758]=i("h4",{id:"_9-2-1-需求分析",tabindex:"-1"},[l("9.2.1 需求分析 "),i("a",{class:"header-anchor",href:"#_9-2-1-需求分析","aria-label":'Permalink to "9.2.1 需求分析"'},"​")],-1)),s[759]||(s[759]=i("p",null,"在页面搜索框下面，会有一些过滤项：",-1)),s[760]||(s[760]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210722091940726.png",alt:"image-20210722091940726",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[761]||(s[761]=i("p",null,"传递的参数如图：",-1)),s[762]||(s[762]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210722092051994.png",alt:"image-20210722092051994",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[763]||(s[763]=i("p",null,"包含的过滤条件有：",-1)),s[764]||(s[764]=i("ul",null,[i("li",null,"brand：品牌值"),i("li",null,"city：城市"),i("li",null,"minPrice~maxPrice：价格范围"),i("li",null,"starName：星级")],-1)),s[765]||(s[765]=i("p",null,"我们需要做两件事情：",-1)),s[766]||(s[766]=i("ul",null,[i("li",null,"修改请求参数的对象RequestParams，接收上述参数"),i("li",null,"修改业务逻辑，在搜索条件之外，添加一些过滤条件")],-1)),s[767]||(s[767]=i("h4",{id:"_9-2-2-修改实体类",tabindex:"-1"},[l("9.2.2 修改实体类 "),i("a",{class:"header-anchor",href:"#_9-2-2-修改实体类","aria-label":'Permalink to "9.2.2 修改实体类"'},"​")],-1)),s[768]||(s[768]=i("p",null,[l("修改在"),i("code",null,"cn.itcast.hotel.pojo"),l("包下的实体类RequestParams：")],-1)),s[769]||(s[769]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Data")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," RequestParams"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String key;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer page;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer size;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String sortBy;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 下面是新增的过滤条件参数")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String city;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String brand;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String starName;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer minPrice;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer maxPrice;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[770]||(s[770]=i("h4",{id:"_9-2-3-修改搜索业务",tabindex:"-1"},[l("9.2.3 修改搜索业务 "),i("a",{class:"header-anchor",href:"#_9-2-3-修改搜索业务","aria-label":'Permalink to "9.2.3 修改搜索业务"'},"​")],-1)),s[771]||(s[771]=i("p",null,"在HotelService的search方法中，只有一个地方需要修改：requet.source().query( … )其中的查询条件。",-1)),s[772]||(s[772]=i("p",null,"在之前的业务中，只有match查询，根据关键字搜索，现在要添加条件过滤，包括：",-1)),s[773]||(s[773]=i("ul",null,[i("li",null,"品牌过滤：是keyword类型，用term查询"),i("li",null,"星级过滤：是keyword类型，用term查询"),i("li",null,"价格过滤：是数值类型，用range查询"),i("li",null,"城市过滤：是keyword类型，用term查询")],-1)),s[774]||(s[774]=i("p",null,"多个查询条件组合，肯定是boolean查询来组合：",-1)),s[775]||(s[775]=i("ul",null,[i("li",null,"关键字搜索放到must中，参与算分"),i("li",null,"其它过滤条件放到filter中，不参与算分")],-1)),s[776]||(s[776]=i("p",null,"因为条件构建的逻辑比较复杂，这里先封装为一个函数：",-1)),s[777]||(s[777]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210722092935453.png",alt:"image-20210722092935453",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[778]||(s[778]=i("p",null,"buildBasicQuery的代码如下：",-1)),s[779]||(s[779]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"private"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," buildBasicQuery"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(RequestParams params, SearchRequest request) {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 1.构建BooleanQuery")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    BoolQueryBuilder boolQuery "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," QueryBuilders."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"boolQuery"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.关键字搜索")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String key "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," params."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getKey"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (key "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ||"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' ""'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"equals"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(key)) {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        boolQuery."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"must"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"matchAllQuery"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    } "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"else"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        boolQuery."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"must"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"matchQuery"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"all"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", key));")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 3.城市条件")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (params."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getCity"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," &&"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," !"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"params."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getCity"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"equals"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'""'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")) {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        boolQuery."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"filter"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"termQuery"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"city"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", params."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getCity"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()));")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.品牌条件")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (params."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getBrand"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," &&"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," !"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"params."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getBrand"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"equals"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'""'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")) {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        boolQuery."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"filter"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"termQuery"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"brand"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", params."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getBrand"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()));")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 5.星级条件")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (params."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getStarName"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," &&"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," !"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"params."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getStarName"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"equals"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'""'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")) {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        boolQuery."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"filter"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"termQuery"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"starName"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", params."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getStarName"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()));")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"	// 6.价格")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (params."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getMinPrice"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," &&"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," params."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getMaxPrice"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        boolQuery."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"filter"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                         ."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"rangeQuery"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"price"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                         ."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"gte"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(params."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getMinPrice"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                         ."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"lte"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(params."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getMaxPrice"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                        );")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"	// 7.放入source")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    request."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"query"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(boolQuery);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[780]||(s[780]=i("h3",{id:"_9-3-我周边的酒店",tabindex:"-1"},[l("9.3 我周边的酒店 "),i("a",{class:"header-anchor",href:"#_9-3-我周边的酒店","aria-label":'Permalink to "9.3 我周边的酒店"'},"​")],-1)),s[781]||(s[781]=i("p",null,"需求：我附近的酒店",-1)),s[782]||(s[782]=i("h4",{id:"_9-3-1-需求分析",tabindex:"-1"},[l("9.3.1 需求分析 "),i("a",{class:"header-anchor",href:"#_9-3-1-需求分析","aria-label":'Permalink to "9.3.1 需求分析"'},"​")],-1)),s[783]||(s[783]=i("p",null,"在酒店列表页的右侧，有一个小地图，点击地图的定位按钮，地图会找到你所在的位置：",-1)),s[784]||(s[784]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210722093414542.png",alt:"image-20210722093414542",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[785]||(s[785]=i("p",null,"并且，在前端会发起查询请求，将你的坐标发送到服务端：",-1)),s[786]||(s[786]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210722093642382.png",alt:"image-20210722093642382",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[787]||(s[787]=i("p",null,"我们要做的事情就是基于这个location坐标，然后按照距离对周围酒店排序。实现思路如下：",-1)),s[788]||(s[788]=i("ul",null,[i("li",null,"修改RequestParams参数，接收location字段"),i("li",null,"修改search方法业务逻辑，如果location有值，添加根据geo_distance排序的功能")],-1)),s[789]||(s[789]=i("h4",{id:"_9-3-2-修改实体类",tabindex:"-1"},[l("9.3.2 修改实体类 "),i("a",{class:"header-anchor",href:"#_9-3-2-修改实体类","aria-label":'Permalink to "9.3.2 修改实体类"'},"​")],-1)),s[790]||(s[790]=i("p",null,[l("修改在"),i("code",null,"cn.itcast.hotel.pojo"),l("包下的实体类RequestParams：")],-1)),s[791]||(s[791]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"package"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," cn.itcast.hotel.pojo;")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," lombok.Data;")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Data")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," RequestParams"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String key;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer page;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer size;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String sortBy;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String city;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String brand;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String starName;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer minPrice;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer maxPrice;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 我当前的地理坐标")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String location;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[792]||(s[792]=i("h4",{id:"_9-3-3-距离排序api",tabindex:"-1"},[l("9.3.3 距离排序API "),i("a",{class:"header-anchor",href:"#_9-3-3-距离排序api","aria-label":'Permalink to "9.3.3 距离排序API"'},"​")],-1)),s[793]||(s[793]=i("p",null,"我们以前学习过排序功能，包括两种：",-1)),s[794]||(s[794]=i("ul",null,[i("li",null,"普通字段排序"),i("li",null,"地理坐标排序")],-1)),s[795]||(s[795]=i("p",null,"我们只讲了普通字段排序对应的java写法。地理坐标排序只学过DSL语法，如下：",-1)),s[796]||(s[796]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /indexName/_search")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "query"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "match_all"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {}")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "sort"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": [")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "price"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"asc"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  ")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "_geo_distance"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "FIELD"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"纬度，经度"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "order"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"asc"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "unit"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," : "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"km"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  ]")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[797]||(s[797]=i("p",null,"对应的java代码示例：",-1)),s[798]||(s[798]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210722095227059.png",alt:"image-20210722095227059",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[799]||(s[799]=i("h4",{id:"_9-3-4-添加距离排序",tabindex:"-1"},[l("9.3.4 添加距离排序 "),i("a",{class:"header-anchor",href:"#_9-3-4-添加距离排序","aria-label":'Permalink to "9.3.4 添加距离排序"'},"​")],-1)),s[800]||(s[800]=i("p",null,[l("在"),i("code",null,"cn.itcast.hotel.service.impl"),l("的"),i("code",null,"HotelService"),l("的"),i("code",null,"search"),l("方法中，添加一个排序功能：")],-1)),s[801]||(s[801]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210722095902314.png",alt:"image-20210722095902314",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[802]||(s[802]=i("p",null,"完整代码：",-1)),s[803]||(s[803]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Override")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," PageResult "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"search"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(RequestParams params) {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    try"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 1.准备Request")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        SearchRequest request "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," SearchRequest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 2.准备DSL")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 2.1.query")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        buildBasicQuery"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(params, request);")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 2.2.分页")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        int"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," page "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," params."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getPage"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        int"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," size "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," params."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getSize"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        request."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"from"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"((page "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"*"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," size)."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"size"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(size);")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 2.3.排序")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        String location "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," params."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getLocation"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (location "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," &&"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," !"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"location."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"equals"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'""'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")) {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            request."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"sort"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(SortBuilders")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                  ."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"geoDistanceSort"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"location"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," GeoPoint"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(location))")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                  ."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"order"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(SortOrder.ASC)")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                  ."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"unit"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(DistanceUnit.KILOMETERS)")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                 );")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 3.发送请求")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        SearchResponse response "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"search"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 4.解析响应")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," handleResponse"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(response);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    } "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"catch"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (IOException "),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"e"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        throw"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," RuntimeException"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(e);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[804]||(s[804]=i("h4",{id:"_9-3-5-排序距离显示",tabindex:"-1"},[l("9.3.5 排序距离显示 "),i("a",{class:"header-anchor",href:"#_9-3-5-排序距离显示","aria-label":'Permalink to "9.3.5 排序距离显示"'},"​")],-1)),s[805]||(s[805]=i("p",null,"重启服务后，测试我的酒店功能：",-1)),s[806]||(s[806]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210722100040674.png",alt:"image-20210722100040674",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[807]||(s[807]=i("p",null,"发现确实可以实现对我附近酒店的排序，不过并没有看到酒店到底距离我多远，这该怎么办？",-1)),s[808]||(s[808]=i("p",null,[l("排序完成后，页面还要获取我附近每个酒店的具体"),i("strong",null,"距离"),l("值，这个值在响应结果中是独立的：")],-1)),s[809]||(s[809]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210722095648542.png",alt:"image-20210722095648542",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[810]||(s[810]=i("p",null,"因此，我们在结果解析阶段，除了解析source部分以外，还要得到sort部分，也就是排序的距离，然后放到响应结果中。",-1)),s[811]||(s[811]=i("p",null,"我们要做两件事：",-1)),s[812]||(s[812]=i("ul",null,[i("li",null,"修改HotelDoc，添加排序距离字段，用于页面显示"),i("li",null,"修改HotelService类中的handleResponse方法，添加对sort值的获取")],-1)),s[813]||(s[813]=i("p",null,"1）修改HotelDoc类，添加距离字段",-1)),s[814]||(s[814]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"package"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," cn.itcast.hotel.pojo;")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," lombok.Data;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," lombok.NoArgsConstructor;")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Data")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"NoArgsConstructor")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HotelDoc"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Long id;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String name;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String address;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer price;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer score;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String brand;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String city;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String starName;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String business;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String location;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String pic;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 排序时的 距离值")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Object distance;")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HotelDoc"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Hotel "),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"hotel"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".id "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getId"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".name "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getName"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".address "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getAddress"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".price "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getPrice"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".score "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getScore"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".brand "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getBrand"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".city "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getCity"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".starName "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getStarName"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".business "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getBusiness"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".location "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getLatitude"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' ", "'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getLongitude"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".pic "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getPic"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[815]||(s[815]=i("p",null,"2）修改HotelService中的handleResponse方法",-1)),s[816]||(s[816]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210722100613966.png",alt:"image-20210722100613966",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[817]||(s[817]=i("p",null,"重启后测试，发现页面能成功显示距离了：",-1)),s[818]||(s[818]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210722100838604.png",alt:"image-20210722100838604",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[819]||(s[819]=i("h3",{id:"_9-4-酒店竞价排名",tabindex:"-1"},[l("9.4 酒店竞价排名 "),i("a",{class:"header-anchor",href:"#_9-4-酒店竞价排名","aria-label":'Permalink to "9.4 酒店竞价排名"'},"​")],-1)),s[820]||(s[820]=i("p",null,"需求：让指定的酒店在搜索结果中排名置顶",-1)),s[821]||(s[821]=i("h4",{id:"_9-4-1-需求分析",tabindex:"-1"},[l("9.4.1 需求分析 "),i("a",{class:"header-anchor",href:"#_9-4-1-需求分析","aria-label":'Permalink to "9.4.1 需求分析"'},"​")],-1)),s[822]||(s[822]=i("p",null,"要让指定酒店在搜索结果中排名置顶，效果如图：",-1)),s[823]||(s[823]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210722100947292.png",alt:"image-20210722100947292",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[824]||(s[824]=i("p",null,[l("页面会给指定的酒店添加"),i("strong",null,"广告"),l("标记。")],-1)),s[825]||(s[825]=i("p",null,"那怎样才能让指定的酒店排名置顶呢？",-1)),s[826]||(s[826]=i("p",null,"我们之前学习过的function_score查询可以影响算分，算分高了，自然排名也就高了。而function_score包含3个要素：",-1)),s[827]||(s[827]=i("ul",null,[i("li",null,"过滤条件：哪些文档要加分"),i("li",null,"算分函数：如何计算function score"),i("li",null,"加权方式：function score 与 query score如何运算")],-1)),s[828]||(s[828]=i("p",null,[l("这里的需求是：让"),i("strong",null,"指定酒店"),l("排名靠前。因此我们需要给这些酒店添加一个标记，这样在过滤条件中就可以"),i("strong",null,"根据这个标记来判断，是否要提高算分"),l("。")],-1)),s[829]||(s[829]=i("p",null,"比如，我们给酒店添加一个字段：isAD，Boolean类型：",-1)),s[830]||(s[830]=i("ul",null,[i("li",null,"true：是广告"),i("li",null,"false：不是广告")],-1)),s[831]||(s[831]=i("p",null,"这样function_score包含3个要素就很好确定了：",-1)),s[832]||(s[832]=i("ul",null,[i("li",null,"过滤条件：判断isAD 是否为true"),i("li",null,"算分函数：我们可以用最简单暴力的weight，固定加权值"),i("li",null,"加权方式：可以用默认的相乘，大大提高算分")],-1)),s[833]||(s[833]=i("p",null,"因此，业务的实现步骤包括：",-1)),s[834]||(s[834]=i("ol",null,[i("li",null,[i("p",null,"给HotelDoc类添加isAD字段，Boolean类型")]),i("li",null,[i("p",null,"挑选几个你喜欢的酒店，给它的文档数据添加isAD字段，值为true")]),i("li",null,[i("p",null,"修改search方法，添加function score功能，给isAD值为true的酒店增加权重")])],-1)),s[835]||(s[835]=i("h4",{id:"_9-4-2-修改hoteldoc实体",tabindex:"-1"},[l("9.4.2 修改HotelDoc实体 "),i("a",{class:"header-anchor",href:"#_9-4-2-修改hoteldoc实体","aria-label":'Permalink to "9.4.2 修改HotelDoc实体"'},"​")],-1)),s[836]||(s[836]=i("p",null,[l("给"),i("code",null,"cn.itcast.hotel.pojo"),l("包下的HotelDoc类添加isAD字段：")],-1)),s[837]||(s[837]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210722101908062.png",alt:"image-20210722101908062",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[838]||(s[838]=i("h4",{id:"_9-4-3-添加广告标记",tabindex:"-1"},[l("9.4.3 添加广告标记 "),i("a",{class:"header-anchor",href:"#_9-4-3-添加广告标记","aria-label":'Permalink to "9.4.3 添加广告标记"'},"​")],-1)),s[839]||(s[839]=i("p",null,"接下来，我们挑几个酒店，添加isAD字段，设置为true：",-1)),s[840]||(s[840]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"POST /hotel/_update/"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1902197537")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "doc"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "isAD"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"POST /hotel/_update/"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2056126831")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "doc"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "isAD"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"POST /hotel/_update/"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1989806195")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "doc"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "isAD"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"POST /hotel/_update/"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2056105938")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "doc"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "isAD"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[841]||(s[841]=i("h4",{id:"_9-4-4-添加算分函数查询",tabindex:"-1"},[l("9.4.4 添加算分函数查询 "),i("a",{class:"header-anchor",href:"#_9-4-4-添加算分函数查询","aria-label":'Permalink to "9.4.4 添加算分函数查询"'},"​")],-1)),s[842]||(s[842]=i("p",null,"接下来我们就要修改查询条件了。之前是用的boolean 查询，现在要改成function_socre查询。",-1)),s[843]||(s[843]=i("p",null,"function_score查询结构如下：",-1)),s[844]||(s[844]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210721191544750.png",alt:"image-20210721191544750",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[845]||(s[845]=i("p",null,"对应的JavaAPI如下：",-1)),s[846]||(s[846]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210722102850818.png",alt:"image-20210722102850818",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[847]||(s[847]=i("p",null,[l("我们可以将之前写的boolean查询作为"),i("strong",null,"原始查询"),l("条件放到query中，接下来就是添加"),i("strong",null,"过滤条件"),l("、"),i("strong",null,"算分函数"),l("、"),i("strong",null,"加权模式"),l("了。所以原来的代码依然可以沿用。")],-1)),s[848]||(s[848]=i("p",null,[l("修改"),i("code",null,"cn.itcast.hotel.service.impl"),l("包下的"),i("code",null,"HotelService"),l("类中的"),i("code",null,"buildBasicQuery"),l("方法，添加算分函数查询：")],-1)),s[849]||(s[849]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"private"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," buildBasicQuery"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(RequestParams params, SearchRequest request) {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 1.构建BooleanQuery")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    BoolQueryBuilder boolQuery "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," QueryBuilders."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"boolQuery"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 关键字搜索")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String key "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," params."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getKey"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (key "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ||"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' ""'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"equals"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(key)) {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        boolQuery."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"must"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"matchAllQuery"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    } "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"else"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        boolQuery."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"must"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"matchQuery"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"all"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", key));")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 城市条件")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (params."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getCity"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," &&"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," !"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"params."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getCity"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"equals"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'""'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")) {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        boolQuery."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"filter"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"termQuery"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"city"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", params."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getCity"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()));")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 品牌条件")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (params."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getBrand"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," &&"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," !"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"params."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getBrand"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"equals"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'""'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")) {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        boolQuery."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"filter"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"termQuery"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"brand"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", params."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getBrand"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()));")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 星级条件")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (params."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getStarName"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," &&"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," !"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"params."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getStarName"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"equals"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'""'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")) {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        boolQuery."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"filter"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"termQuery"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"starName"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", params."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getStarName"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()));")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 价格")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (params."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getMinPrice"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," &&"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," params."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getMaxPrice"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        boolQuery."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"filter"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(QueryBuilders")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                         ."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"rangeQuery"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"price"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                         ."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"gte"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(params."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getMinPrice"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                         ."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"lte"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(params."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getMaxPrice"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                        );")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 2.算分控制")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    FunctionScoreQueryBuilder functionScoreQuery "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        QueryBuilders."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"functionScoreQuery"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 原始查询，相关性算分的查询")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        boolQuery,")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // function score的数组")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        new"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," FunctionScoreQueryBuilder."),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"FilterFunctionBuilder"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[]{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            // 其中的一个function score 元素")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            new"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," FunctionScoreQueryBuilder."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"FilterFunctionBuilder"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"                // 过滤条件")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                QueryBuilders."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"termQuery"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"isAD"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"                // 算分函数")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                ScoreFunctionBuilders."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"weightFactorFunction"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"10"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            )")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        });")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    request."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"query"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(functionScoreQuery);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[850]||(s[850]=i("hr",null,null,-1)),s[851]||(s[851]=i("h2",{id:"_10-数据聚合",tabindex:"-1"},[l("10. 数据聚合 "),i("a",{class:"header-anchor",href:"#_10-数据聚合","aria-label":'Permalink to "10. 数据聚合"'},"​")],-1)),s[852]||(s[852]=i("p",null,[l("**"),i("a",{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/search-aggregations.html",target:"_blank",rel:"noreferrer"},"聚合（"),i("a",{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/search-aggregations.html",target:"_blank",rel:"noreferrer"},"aggregations"),i("a",{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/search-aggregations.html",target:"_blank",rel:"noreferrer"},"）"),l("**可以让我们极其方便的实现对数据的统计、分析、运算。例如：")],-1)),s[853]||(s[853]=i("ul",null,[i("li",null,"什么品牌的手机最受欢迎？"),i("li",null,"这些手机的平均价格、最高价格、最低价格？"),i("li",null,"这些手机每月的销售情况如何？")],-1)),s[854]||(s[854]=i("p",null,"实现这些统计功能的比数据库的sql要方便的多，而且查询速度非常快，可以实现近实时搜索效果。",-1)),s[855]||(s[855]=i("h3",{id:"_10-1-聚合的种类",tabindex:"-1"},[l("10.1 聚合的种类 "),i("a",{class:"header-anchor",href:"#_10-1-聚合的种类","aria-label":'Permalink to "10.1 聚合的种类"'},"​")],-1)),s[856]||(s[856]=i("p",null,"聚合常见的有三类：",-1)),s[857]||(s[857]=i("ul",null,[i("li",null,[i("p",null,"**桶（Bucket）**聚合：用来对文档做分组"),i("ul",null,[i("li",null,"TermAggregation：按照文档字段值分组，例如按照品牌值分组、按照国家分组"),i("li",null,"Date Histogram：按照日期阶梯分组，例如一周为一组，或者一月为一组")])]),i("li",null,[i("p",null,"**度量（Metric）**聚合：用以计算一些值，比如：最大值、最小值、平均值等"),i("ul",null,[i("li",null,"Avg：求平均值"),i("li",null,"Max：求最大值"),i("li",null,"Min：求最小值"),i("li",null,"Stats：同时求max、min、avg、sum等")])]),i("li",null,[i("p",null,"**管道（pipeline）**聚合：其它聚合的结果为基础做聚合")])],-1)),s[858]||(s[858]=i("blockquote",null,[i("p",null,"**注意：**参加聚合的字段必须是keyword、日期、数值、布尔类型")],-1)),s[859]||(s[859]=i("h3",{id:"_10-2-dsl实现聚合",tabindex:"-1"},[l("10.2 DSL实现聚合 "),i("a",{class:"header-anchor",href:"#_10-2-dsl实现聚合","aria-label":'Permalink to "10.2 DSL实现聚合"'},"​")],-1)),s[860]||(s[860]=i("p",null,"现在，我们要统计所有数据中的酒店品牌有几种，其实就是按照品牌对数据分组。此时可以根据酒店品牌的名称做聚合，也就是Bucket聚合。",-1)),s[861]||(s[861]=i("h4",{id:"_10-2-1-bucket聚合语法",tabindex:"-1"},[l("10.2.1 Bucket聚合语法 "),i("a",{class:"header-anchor",href:"#_10-2-1-bucket聚合语法","aria-label":'Permalink to "10.2.1 Bucket聚合语法"'},"​")],-1)),s[862]||(s[862]=i("p",null,"语法如下：",-1)),s[863]||(s[863]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /hotel/_search")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "size"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",  "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 设置size为0，结果中不包含文档，只包含聚合结果")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "aggs"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": { "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 定义聚合")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "brandAgg"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": { "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//给聚合起个名字")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "terms"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": { "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 聚合的类型，按照品牌值聚合，所以选择term")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "field"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"brand"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 参与聚合的字段")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "size"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"20"),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," // 希望获取的聚合结果数量")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[864]||(s[864]=i("p",null,"结果如图：",-1)),s[865]||(s[865]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723171948228.png",alt:"image-20210723171948228",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[866]||(s[866]=i("h4",{id:"_10-2-2-聚合结果排序",tabindex:"-1"},[l("10.2.2 聚合结果排序 "),i("a",{class:"header-anchor",href:"#_10-2-2-聚合结果排序","aria-label":'Permalink to "10.2.2 聚合结果排序"'},"​")],-1)),s[867]||(s[867]=i("p",null,"默认情况下，Bucket聚合会统计Bucket内的文档数量，记为_count，并且按照_count降序排序。",-1)),s[868]||(s[868]=i("p",null,"我们可以指定order属性，自定义聚合的排序方式：",-1)),s[869]||(s[869]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /hotel/_search")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "size"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", ")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "aggs"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "brandAgg"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "terms"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "field"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"brand"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "order"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "_count"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"asc"'),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," // 按照_count升序排列")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "size"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"20")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[870]||(s[870]=i("h4",{id:"_10-2-3-限定聚合范围",tabindex:"-1"},[l("10.2.3 限定聚合范围 "),i("a",{class:"header-anchor",href:"#_10-2-3-限定聚合范围","aria-label":'Permalink to "10.2.3 限定聚合范围"'},"​")],-1)),s[871]||(s[871]=i("p",null,"默认情况下，Bucket聚合是对索引库的所有文档做聚合，但真实场景下，用户会输入搜索条件，因此聚合必须是对搜索结果聚合。那么聚合必须添加限定条件。",-1)),s[872]||(s[872]=i("p",null,"我们可以限定要聚合的文档范围，只要添加query条件即可：",-1)),s[873]||(s[873]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /hotel/_search")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "query"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "range"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "price"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "lte"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"200"),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," // 只对200元以下的文档聚合")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }, ")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "size"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", ")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "aggs"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "brandAgg"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "terms"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "field"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"brand"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "size"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"20")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[874]||(s[874]=i("p",null,"这次，聚合得到的品牌明显变少了：",-1)),s[875]||(s[875]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723172404836.png",alt:"image-20210723172404836",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[876]||(s[876]=i("h4",{id:"_10-2-4-metric聚合语法",tabindex:"-1"},[l("10.2.4 Metric聚合语法 "),i("a",{class:"header-anchor",href:"#_10-2-4-metric聚合语法","aria-label":'Permalink to "10.2.4 Metric聚合语法"'},"​")],-1)),s[877]||(s[877]=i("p",null,"上节课，我们对酒店按照品牌分组，形成了一个个桶。现在我们需要对桶内的酒店做运算，获取每个品牌的用户评分的min、max、avg等值。",-1)),s[878]||(s[878]=i("p",null,"这就要用到Metric聚合了，例如stat聚合：就可以获取min、max、avg等结果。",-1)),s[879]||(s[879]=i("p",null,"语法如下：",-1)),s[880]||(s[880]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /hotel/_search")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "size"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", ")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "aggs"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "brandAgg"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": { ")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "terms"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": { ")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "field"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"brand"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", ")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "size"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"20")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "aggs"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": { "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 是brands聚合的子聚合，也就是分组后对每组分别计算")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "score_stats"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": { "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 聚合名称")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "stats"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": { "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 聚合类型，这里stats可以计算min、max、avg等")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'            "field"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"score"'),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," // 聚合字段，这里是score")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"          }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[881]||(s[881]=i("p",null,"这次的score_stats聚合是在brandAgg的聚合内部嵌套的子聚合。因为我们需要在每个桶分别计算。",-1)),s[882]||(s[882]=i("p",null,"另外，我们还可以给聚合结果做个排序，例如按照每个桶的酒店平均分做排序：",-1)),s[883]||(s[883]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723172917636.png",alt:"image-20210723172917636",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[884]||(s[884]=i("h4",{id:"_10-2-5-小结",tabindex:"-1"},[l("10.2.5 小结 "),i("a",{class:"header-anchor",href:"#_10-2-5-小结","aria-label":'Permalink to "10.2.5 小结"'},"​")],-1)),s[885]||(s[885]=i("blockquote",null,[i("ul",null,[i("li",null,[i("p",null,"aggs代表聚合，与query同级，此时query的作用是？"),i("ul",null,[i("li",null,"限定聚合的的文档范围")])]),i("li",null,[i("p",null,"聚合必须的三要素："),i("ul",null,[i("li",null,[i("p",null,"聚合名称")]),i("li",null,[i("p",null,"聚合类型")]),i("li",null,[i("p",null,"聚合字段")])])]),i("li",null,[i("p",null,"聚合可配置属性有："),i("ul",null,[i("li",null,[i("p",null,"size：指定聚合结果数量")]),i("li",null,[i("p",null,"order：指定聚合结果排序方式")]),i("li",null,[i("p",null,"field：指定聚合字段")])])])])],-1)),s[886]||(s[886]=i("h3",{id:"_10-3-restapi实现聚合",tabindex:"-1"},[l("10.3 RestAPI实现聚合 "),i("a",{class:"header-anchor",href:"#_10-3-restapi实现聚合","aria-label":'Permalink to "10.3 RestAPI实现聚合"'},"​")],-1)),s[887]||(s[887]=i("h4",{id:"_10-3-1-api语法",tabindex:"-1"},[l("10.3.1 API语法 "),i("a",{class:"header-anchor",href:"#_10-3-1-api语法","aria-label":'Permalink to "10.3.1 API语法"'},"​")],-1)),s[888]||(s[888]=i("p",null,"聚合条件与query条件同级别，因此需要使用request.source()来指定聚合条件。",-1)),s[889]||(s[889]=i("p",null,"聚合条件的语法：",-1)),s[890]||(s[890]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723173057733.png",alt:"image-20210723173057733",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[891]||(s[891]=i("p",null,"聚合的结果也与查询结果不同，API也比较特殊。不过同样是JSON逐层解析：",-1)),s[892]||(s[892]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723173215728.png",alt:"image-20210723173215728",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[893]||(s[893]=i("h4",{id:"_10-3-2-业务需求",tabindex:"-1"},[l("10.3.2 业务需求 "),i("a",{class:"header-anchor",href:"#_10-3-2-业务需求","aria-label":'Permalink to "10.3.2 业务需求"'},"​")],-1)),s[894]||(s[894]=i("p",null,"需求：搜索页面的品牌、城市等信息不应该是在页面写死，而是通过聚合索引库中的酒店数据得来的：",-1)),s[895]||(s[895]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723192605566.png",alt:"image-20210723192605566",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[896]||(s[896]=i("p",null,"分析：",-1)),s[897]||(s[897]=i("p",null,"目前，页面的城市列表、星级列表、品牌列表都是写死的，并不会随着搜索结果的变化而变化。但是用户搜索条件改变时，搜索结果会跟着变化。",-1)),s[898]||(s[898]=i("p",null,"例如：用户搜索“东方明珠”，那搜索的酒店肯定是在上海东方明珠附近，因此，城市只能是上海，此时城市列表中就不应该显示北京、深圳、杭州这些信息了。",-1)),s[899]||(s[899]=i("p",null,"也就是说，搜索结果中包含哪些城市，页面就应该列出哪些城市；搜索结果中包含哪些品牌，页面就应该列出哪些品牌。",-1)),s[900]||(s[900]=i("p",null,"如何得知搜索结果中包含哪些品牌？如何得知搜索结果中包含哪些城市？",-1)),s[901]||(s[901]=i("p",null,"使用聚合功能，利用Bucket聚合，对搜索结果中的文档基于品牌分组、基于城市分组，就能得知包含哪些品牌、哪些城市了。",-1)),s[902]||(s[902]=i("p",null,[l("因为是对搜索结果聚合，因此聚合是"),i("strong",null,"限定范围的聚合"),l("，也就是说聚合的限定条件跟搜索文档的条件一致。")],-1)),s[903]||(s[903]=i("p",null,"查看浏览器可以发现，前端其实已经发出了这样的一个请求：",-1)),s[904]||(s[904]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723193730799.png",alt:"image-20210723193730799",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[905]||(s[905]=i("p",null,[l("请求"),i("strong",null,"参数与搜索文档的参数完全一致"),l("。")],-1)),s[906]||(s[906]=i("p",null,"返回值类型就是页面要展示的最终结果：",-1)),s[907]||(s[907]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723203915982.png",alt:"image-20210723203915982",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[908]||(s[908]=i("p",null,"结果是一个Map结构：",-1)),s[909]||(s[909]=i("ul",null,[i("li",null,"key是字符串，城市、星级、品牌、价格"),i("li",null,"value是集合，例如多个城市的名称")],-1)),s[910]||(s[910]=i("h4",{id:"_10-3-3-业务实现",tabindex:"-1"},[l("10.3.3 业务实现 "),i("a",{class:"header-anchor",href:"#_10-3-3-业务实现","aria-label":'Permalink to "10.3.3 业务实现"'},"​")],-1)),s[911]||(s[911]=i("p",null,[l("在"),i("code",null,"cn.itcast.hotel.web"),l("包的"),i("code",null,"HotelController"),l("中添加一个方法，遵循下面的要求：")],-1)),s[912]||(s[912]=i("ul",null,[i("li",null,[l("请求方式："),i("code",null,"POST")]),i("li",null,[l("请求路径："),i("code",null,"/hotel/filters")]),i("li",null,[l("请求参数："),i("code",null,"RequestParams"),l("，与搜索文档的参数一致")]),i("li",null,[l("返回值类型："),i("code",null,"Map<String, List<String>>")])],-1)),s[913]||(s[913]=i("p",null,"代码：",-1)),s[914]||(s[914]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"PostMapping"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"filters"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Map"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"String, List"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"String"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">>"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getFilters"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestBody"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RequestParams params){")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotelService."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getFilters"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(params);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[915]||(s[915]=i("p",null,"这里调用了IHotelService中的getFilters方法，尚未实现。",-1)),s[916]||(s[916]=i("p",null,[l("在"),i("code",null,"cn.itcast.hotel.service.IHotelService"),l("中定义新方法：")],-1)),s[917]||(s[917]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Map"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"String, List"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"String"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">>"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," filters"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(RequestParams params);")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[918]||(s[918]=i("p",null,[l("在"),i("code",null,"cn.itcast.hotel.service.impl.HotelService"),l("中实现该方法：")],-1)),s[919]||(s[919]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Override")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Map"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"String, List"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"String"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">>"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," filters"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(RequestParams params) {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    try"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 1.准备Request")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        SearchRequest request "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," SearchRequest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 2.准备DSL")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 2.1.query")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        buildBasicQuery"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(params, request);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 2.2.设置size")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        request."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"size"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 2.3.聚合")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        buildAggregation"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 3.发出请求")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        SearchResponse response "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"search"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 4.解析结果")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        Map<"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"String"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", List<"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"String"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">> result "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," HashMap<>();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        Aggregations aggregations "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," response."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getAggregations"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 4.1.根据品牌名称，获取品牌结果")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        List<"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"String"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> brandList "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getAggByName"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(aggregations, "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"brandAgg"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        result."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"put"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"品牌"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", brandList);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 4.2.根据品牌名称，获取品牌结果")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        List<"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"String"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> cityList "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getAggByName"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(aggregations, "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"cityAgg"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        result."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"put"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"城市"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", cityList);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 4.3.根据品牌名称，获取品牌结果")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        List<"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"String"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> starList "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getAggByName"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(aggregations, "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"starAgg"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        result."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"put"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"星级"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", starList);")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," result;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    } "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"catch"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (IOException "),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"e"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        throw"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," RuntimeException"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(e);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"private"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," buildAggregation"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(SearchRequest request) {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    request."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"aggregation"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(AggregationBuilders")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                 ."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"terms"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"brandAgg"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                 ."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"field"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"brand"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                 ."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"size"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"100"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                );")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    request."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"aggregation"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(AggregationBuilders")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                 ."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"terms"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"cityAgg"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                 ."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"field"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"city"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                 ."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"size"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"100"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                );")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    request."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"aggregation"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(AggregationBuilders")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                 ."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"terms"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"starAgg"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                 ."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"field"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"starName"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                 ."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"size"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"100"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                );")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," List"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"String"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getAggByName"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Aggregations aggregations, String aggName) {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.1.根据聚合名称获取聚合结果")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    Terms brandTerms "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," aggregations."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"get"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(aggName);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.2.获取buckets")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    List<"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"?"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," extends"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," Terms"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Bucket"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> buckets "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," brandTerms."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getBuckets"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 4.3.遍历")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    List<"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"String"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> brandList "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ArrayList<>();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    for"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (Terms.Bucket bucket "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," buckets) {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 4.4.获取key")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        String key "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," bucket."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getKeyAsString"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        brandList."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"add"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(key);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    return"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," brandList;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[920]||(s[920]=i("hr",null,null,-1)),s[921]||(s[921]=i("h2",{id:"_11-自动补全",tabindex:"-1"},[l("11. 自动补全 "),i("a",{class:"header-anchor",href:"#_11-自动补全","aria-label":'Permalink to "11. 自动补全"'},"​")],-1)),s[922]||(s[922]=i("p",null,"当用户在搜索框输入字符时，我们应该提示出与该字符有关的搜索项，如图：",-1)),s[923]||(s[923]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723204936367.png",alt:"image-20210723204936367",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[924]||(s[924]=i("p",null,"这种根据用户输入的字母，提示完整词条的功能，就是自动补全了。",-1)),s[925]||(s[925]=i("p",null,"因为需要根据拼音字母来推断，因此要用到拼音分词功能。",-1)),s[926]||(s[926]=i("h3",{id:"_11-1-拼音分词器",tabindex:"-1"},[l("11.1.拼音分词器 "),i("a",{class:"header-anchor",href:"#_11-1-拼音分词器","aria-label":'Permalink to "11.1.拼音分词器"'},"​")],-1)),s[927]||(s[927]=i("p",null,[l("要实现根据字母做补全，就必须对文档按照拼音分词。在GitHub上恰好有elasticsearch的拼音分词插件。地址："),i("a",{href:"https://github.com/medcl/elasticsearch-analysis-pinyin",target:"_blank",rel:"noreferrer"},"https://github.com/medcl/elasticsearch-analysis-pinyin")],-1)),s[928]||(s[928]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723205932746.png",alt:"image-20210723205932746",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[929]||(s[929]=i("p",null,"课前资料中也提供了拼音分词器的安装包：",-1)),s[930]||(s[930]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723205722303.png",alt:"image-20210723205722303",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[931]||(s[931]=i("p",null,"安装方式与IK分词器一样，分三步：",-1)),s[932]||(s[932]=i("p",null,"​ ①解压",-1)),s[933]||(s[933]=i("p",null,"​ ②上传到虚拟机中，elasticsearch的plugin目录",-1)),s[934]||(s[934]=i("p",null,"​ ③重启elasticsearch",-1)),s[935]||(s[935]=i("p",null,"​ ④测试",-1)),s[936]||(s[936]=i("p",null,"详细安装步骤可以参考IK分词器的安装过程。",-1)),s[937]||(s[937]=i("p",null,"测试用法如下：",-1)),s[938]||(s[938]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"POST /_analyze")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "text"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"如家酒店还不错"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "analyzer"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"pinyin"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[939]||(s[939]=i("p",null,"结果：",-1)),s[940]||(s[940]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723210126506.png",alt:"image-20210723210126506",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[941]||(s[941]=i("h3",{id:"_11-2-自定义分词器",tabindex:"-1"},[l("11.2 自定义分词器 "),i("a",{class:"header-anchor",href:"#_11-2-自定义分词器","aria-label":'Permalink to "11.2 自定义分词器"'},"​")],-1)),s[942]||(s[942]=i("p",null,"默认的拼音分词器会将每个汉字单独分为拼音，而我们希望的是每个词条形成一组拼音，需要对拼音分词器做个性化定制，形成自定义分词器。",-1)),s[943]||(s[943]=i("p",null,"elasticsearch中分词器（analyzer）的组成包含三部分：",-1)),s[944]||(s[944]=i("ul",null,[i("li",null,"character filters：在tokenizer之前对文本进行处理。例如删除字符、替换字符"),i("li",null,"tokenizer：将文本按照一定的规则切割成词条（term）。例如keyword，就是不分词；还有ik_smart"),i("li",null,"tokenizer filter：将tokenizer输出的词条做进一步处理。例如大小写转换、同义词处理、拼音处理等")],-1)),s[945]||(s[945]=i("p",null,"文档分词时会依次由这三部分来处理文档：",-1)),s[946]||(s[946]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723210427878.png",alt:"image-20210723210427878",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[947]||(s[947]=i("p",null,"声明自定义分词器的语法如下：",-1)),s[948]||(s[948]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"PUT /test")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "settings"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "analysis"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "analyzer"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": { "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 自定义分词器")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "my_analyzer"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {  "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 分词器名称")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "tokenizer"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"ik_max_word"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "filter"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"py"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "filter"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": { "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 自定义tokenizer filter")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "py"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": { "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 过滤器名称")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"pinyin"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 过滤器类型，这里是pinyin")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'		  "keep_full_pinyin"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"false"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "keep_joined_full_pinyin"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "keep_original"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "limit_first_letter_length"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"16"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "remove_duplicated_term"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "none_chinese_pinyin_tokenize"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"false")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "mappings"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "properties"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "name"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"text"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "analyzer"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"my_analyzer"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "search_analyzer"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"ik_smart"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[949]||(s[949]=i("p",null,"测试：",-1)),s[950]||(s[950]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723211829150.png",alt:"image-20210723211829150",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[951]||(s[951]=i("p",null,"总结：",-1)),s[952]||(s[952]=i("p",null,"如何使用拼音分词器？",-1)),s[953]||(s[953]=i("ul",null,[i("li",null,[i("p",null,"①下载pinyin分词器")]),i("li",null,[i("p",null,"②解压并放到elasticsearch的plugin目录")]),i("li",null,[i("p",null,"③重启即可")])],-1)),s[954]||(s[954]=i("p",null,"如何自定义分词器？",-1)),s[955]||(s[955]=i("ul",null,[i("li",null,[i("p",null,"①创建索引库时，在settings中配置，可以包含三部分")]),i("li",null,[i("p",null,"②character filter")]),i("li",null,[i("p",null,"③tokenizer")]),i("li",null,[i("p",null,"④filter")])],-1)),s[956]||(s[956]=i("p",null,"拼音分词器注意事项？",-1)),s[957]||(s[957]=i("ul",null,[i("li",null,"为了避免搜索到同音字，搜索时不要使用拼音分词器")],-1)),s[958]||(s[958]=i("h3",{id:"_11-3-自动补全查询",tabindex:"-1"},[l("11.3 自动补全查询 "),i("a",{class:"header-anchor",href:"#_11-3-自动补全查询","aria-label":'Permalink to "11.3 自动补全查询"'},"​")],-1)),s[959]||(s[959]=i("p",null,[l("elasticsearch提供了"),i("a",{href:"https://www.elastic.co/guide/en/elasticsearch/reference/7.6/search-suggesters.html",target:"_blank",rel:"noreferrer"},"Completion Suggester"),l("查询来实现自动补全功能。这个查询会匹配以用户输入内容开头的词条并返回。为了提高补全查询的效率，对于文档中字段的类型有一些约束：")],-1)),s[960]||(s[960]=i("ul",null,[i("li",null,[i("p",null,"参与补全查询的字段必须是completion类型。")]),i("li",null,[i("p",null,"字段的内容一般是用来补全的多个词条形成的数组。")])],-1)),s[961]||(s[961]=i("p",null,"比如，一个这样的索引库：",-1)),s[962]||(s[962]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 创建索引库")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"PUT test")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "mappings"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "properties"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "title"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"completion"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[963]||(s[963]=i("p",null,"然后插入下面的数据：",-1)),s[964]||(s[964]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 示例数据")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"POST test/_doc")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "title"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": ["),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Sony"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"WH-1000XM3"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"POST test/_doc")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "title"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": ["),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"SK-II"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"PITERA"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"POST test/_doc")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "title"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": ["),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Nintendo"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"switch"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[965]||(s[965]=i("p",null,"查询的DSL语句如下：",-1)),s[966]||(s[966]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 自动补全查询")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GET /test/_search")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "suggest"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "title_suggest"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "text"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"s"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 关键字")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "completion"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "field"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"title"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 补全查询的字段")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "skip_duplicates"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 跳过重复的")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "size"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"10"),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," // 获取前10条结果")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[967]||(s[967]=i("h3",{id:"_11-4-实现酒店搜索框自动补全",tabindex:"-1"},[l("11.4 实现酒店搜索框自动补全 "),i("a",{class:"header-anchor",href:"#_11-4-实现酒店搜索框自动补全","aria-label":'Permalink to "11.4 实现酒店搜索框自动补全"'},"​")],-1)),s[968]||(s[968]=i("p",null,"现在，我们的hotel索引库还没有设置拼音分词器，需要修改索引库中的配置。但是我们知道索引库是无法修改的，只能删除然后重新创建。",-1)),s[969]||(s[969]=i("p",null,"另外，我们需要添加一个字段，用来做自动补全，将brand、suggestion、city等都放进去，作为自动补全的提示。",-1)),s[970]||(s[970]=i("p",null,"因此，总结一下，我们需要做的事情包括：",-1)),s[971]||(s[971]=i("ol",null,[i("li",null,[i("p",null,"修改hotel索引库结构，设置自定义拼音分词器")]),i("li",null,[i("p",null,"修改索引库的name、all字段，使用自定义分词器")]),i("li",null,[i("p",null,"索引库添加一个新字段suggestion，类型为completion类型，使用自定义的分词器")]),i("li",null,[i("p",null,"给HotelDoc类添加suggestion字段，内容包含brand、business")]),i("li",null,[i("p",null,"重新导入数据到hotel库")])],-1)),s[972]||(s[972]=i("h4",{id:"_11-4-1-修改酒店映射结构",tabindex:"-1"},[l("11.4.1 修改酒店映射结构 "),i("a",{class:"header-anchor",href:"#_11-4-1-修改酒店映射结构","aria-label":'Permalink to "11.4.1 修改酒店映射结构"'},"​")],-1)),s[973]||(s[973]=i("p",null,"代码如下：",-1)),s[974]||(s[974]=i("div",{class:"language-json max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 酒店数据索引库")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"PUT /hotel")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "settings"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "analysis"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "analyzer"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "text_anlyzer"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "tokenizer"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"ik_max_word"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "filter"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"py"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "completion_analyzer"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "tokenizer"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"keyword"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "filter"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"py"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "filter"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "py"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"pinyin"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "keep_full_pinyin"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"false"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "keep_joined_full_pinyin"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "keep_original"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "limit_first_letter_length"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"16"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "remove_duplicated_term"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "none_chinese_pinyin_tokenize"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"false")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'  "mappings"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "properties"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "id"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"keyword"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "name"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"text"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "analyzer"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"text_anlyzer"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "search_analyzer"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"ik_smart"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "copy_to"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"all"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "address"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"keyword"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "index"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"false")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "price"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"integer"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "score"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"integer"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "brand"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"keyword"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "copy_to"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"all"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "city"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"keyword"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "starName"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"keyword"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "business"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"keyword"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "copy_to"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"all"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "location"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"geo_point"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "pic"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"keyword"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "index"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"false")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "all"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"text"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "analyzer"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"text_anlyzer"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'        "search_analyzer"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"ik_smart"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      },")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'      "suggestion"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":{")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "type"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"completion"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'          "analyzer"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"completion_analyzer"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[975]||(s[975]=i("h4",{id:"_11-4-2-修改hoteldoc实体",tabindex:"-1"},[l("11.4.2 修改HotelDoc实体 "),i("a",{class:"header-anchor",href:"#_11-4-2-修改hoteldoc实体","aria-label":'Permalink to "11.4.2 修改HotelDoc实体"'},"​")],-1)),s[976]||(s[976]=i("p",null,"HotelDoc中要添加一个字段，用来做自动补全，内容可以是酒店品牌、城市、商圈等信息。按照自动补全字段的要求，最好是这些字段的数组。",-1)),s[977]||(s[977]=i("p",null,[l("因此我们在HotelDoc中添加一个suggestion字段，类型为"),i("code",null,"List<String>"),l("，然后将brand、city、business等信息放到里面。")],-1)),s[978]||(s[978]=i("p",null,"代码如下：",-1)),s[979]||(s[979]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"package"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," cn.itcast.hotel.pojo;")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," lombok.Data;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," lombok.NoArgsConstructor;")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," java.util.ArrayList;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," java.util.Arrays;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," java.util.Collections;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," java.util.List;")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Data")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"NoArgsConstructor")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HotelDoc"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Long id;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String name;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String address;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer price;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Integer score;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String brand;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String city;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String starName;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String business;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String location;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String pic;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Object distance;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Boolean isAD;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," List<"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"String"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> suggestion;")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HotelDoc"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Hotel "),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"hotel"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".id "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getId"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".name "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getName"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".address "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getAddress"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".price "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getPrice"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".score "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getScore"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".brand "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getBrand"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".city "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getCity"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".starName "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getStarName"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".business "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getBusiness"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".location "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getLatitude"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' ", "'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getLongitude"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".pic "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotel."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getPic"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 组装suggestion")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".business."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"contains"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")){")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            // business有多个值，需要切割")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            String"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[] arr "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".business."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"split"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            // 添加元素")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"            this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".suggestion "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ArrayList<>();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"            this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".suggestion."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"add"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".brand);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            Collections."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"addAll"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".suggestion, arr);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"else"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"            this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".suggestion "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Arrays."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"asList"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".brand, "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".business);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[980]||(s[980]=i("h4",{id:"_11-4-3-重新导入",tabindex:"-1"},[l("11.4.3 重新导入 "),i("a",{class:"header-anchor",href:"#_11-4-3-重新导入","aria-label":'Permalink to "11.4.3 重新导入"'},"​")],-1)),s[981]||(s[981]=i("p",null,"重新执行之前编写的导入数据功能，可以看到新的酒店数据中包含了suggestion：",-1)),s[982]||(s[982]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723213546183.png",alt:"image-20210723213546183",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[983]||(s[983]=i("h4",{id:"_11-4-4-自动补全查询的javaapi",tabindex:"-1"},[l("11.4.4 自动补全查询的JavaAPI "),i("a",{class:"header-anchor",href:"#_11-4-4-自动补全查询的javaapi","aria-label":'Permalink to "11.4.4 自动补全查询的JavaAPI"'},"​")],-1)),s[984]||(s[984]=i("p",null,"之前我们学习了自动补全查询的DSL，而没有学习对应的JavaAPI，这里给出一个示例：",-1)),s[985]||(s[985]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723213759922.png",alt:"image-20210723213759922",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[986]||(s[986]=i("p",null,"而自动补全的结果也比较特殊，解析的代码如下：",-1)),s[987]||(s[987]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723213917524.png",alt:"image-20210723213917524",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[988]||(s[988]=i("h4",{id:"_11-4-5-实现搜索框自动补全",tabindex:"-1"},[l("11.4.5 实现搜索框自动补全 "),i("a",{class:"header-anchor",href:"#_11-4-5-实现搜索框自动补全","aria-label":'Permalink to "11.4.5 实现搜索框自动补全"'},"​")],-1)),s[989]||(s[989]=i("p",null,"查看前端页面，可以发现当我们在输入框键入时，前端会发起ajax请求：",-1)),s[990]||(s[990]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723214021062.png",alt:"image-20210723214021062",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[991]||(s[991]=i("p",null,[l("返回值是补全词条的集合，类型为"),i("code",null,"List<String>")],-1)),s[992]||(s[992]=i("p",null,[l("1）在"),i("code",null,"cn.itcast.hotel.web"),l("包下的"),i("code",null,"HotelController"),l("中添加新接口，接收新的请求：")],-1)),s[993]||(s[993]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"GetMapping"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"suggestion"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," List"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"String"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getSuggestions"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RequestParam"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"key"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") String prefix) {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    return"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," hotelService."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getSuggestions"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(prefix);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[994]||(s[994]=i("p",null,[l("2）在"),i("code",null,"cn.itcast.hotel.service"),l("包下的"),i("code",null,"IhotelService"),l("中添加方法：")],-1)),s[995]||(s[995]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"List"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"String"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getSuggestions"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(String prefix);")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[996]||(s[996]=i("p",null,[l("3）在"),i("code",null,"cn.itcast.hotel.service.impl.HotelService"),l("中实现该方法：")],-1)),s[997]||(s[997]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Override")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," List"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"String"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getSuggestions"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(String prefix) {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    try"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 1.准备Request")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        SearchRequest request "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," SearchRequest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 2.准备DSL")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        request."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"suggest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," SuggestBuilder"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"addSuggestion"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            "suggestions"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            SuggestBuilders."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"completionSuggestion"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"suggestion"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            ."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"prefix"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(prefix)")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            ."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"skipDuplicates"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            ."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"size"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"10"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        ));")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 3.发起请求")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        SearchResponse response "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"search"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 4.解析结果")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        Suggest suggest "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," response."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getSuggest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 4.1.根据补全查询名称，获取补全结果")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        CompletionSuggestion suggestions "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," suggest."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getSuggestion"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"suggestions"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 4.2.获取options")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        List<"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"CompletionSuggestion"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Entry"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Option"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> options "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," suggestions."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getOptions"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 4.3.遍历")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        List<"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"String"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> list "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ArrayList<>(options."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"size"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        for"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (CompletionSuggestion.Entry.Option option "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," options) {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            String text "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," option."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getText"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"toString"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            list."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"add"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(text);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," list;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    } "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"catch"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (IOException "),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"e"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        throw"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," RuntimeException"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(e);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[998]||(s[998]=i("hr",null,null,-1)),s[999]||(s[999]=i("h2",{id:"_12-数据同步",tabindex:"-1"},[l("12. 数据同步 "),i("a",{class:"header-anchor",href:"#_12-数据同步","aria-label":'Permalink to "12. 数据同步"'},"​")],-1)),s[1e3]||(s[1e3]=i("p",null,[l("elasticsearch中的酒店数据来自于mysql数据库，因此mysql数据发生改变时，elasticsearch也必须跟着改变，这个就是elasticsearch与mysql之间的"),i("strong",null,"数据同步"),l("。")],-1)),s[1001]||(s[1001]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723214758392.png",alt:"image-20210723214758392",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[1002]||(s[1002]=i("h3",{id:"_12-1-思路分析",tabindex:"-1"},[l("12.1 思路分析 "),i("a",{class:"header-anchor",href:"#_12-1-思路分析","aria-label":'Permalink to "12.1 思路分析"'},"​")],-1)),s[1003]||(s[1003]=i("p",null,"常见的数据同步方案有三种：",-1)),s[1004]||(s[1004]=i("ul",null,[i("li",null,"同步调用"),i("li",null,"异步通知"),i("li",null,"监听binlog")],-1)),s[1005]||(s[1005]=i("h4",{id:"_12-1-1-同步调用",tabindex:"-1"},[l("12.1.1 同步调用 "),i("a",{class:"header-anchor",href:"#_12-1-1-同步调用","aria-label":'Permalink to "12.1.1 同步调用"'},"​")],-1)),s[1006]||(s[1006]=i("p",null,"方案一：同步调用",-1)),s[1007]||(s[1007]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723214931869.png",alt:"image-20210723214931869",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[1008]||(s[1008]=i("p",null,"基本步骤如下：",-1)),s[1009]||(s[1009]=i("ul",null,[i("li",null,"hotel-demo对外提供接口，用来修改elasticsearch中的数据"),i("li",null,"酒店管理服务在完成数据库操作后，直接调用hotel-demo提供的接口，")],-1)),s[1010]||(s[1010]=i("h4",{id:"_12-1-2-异步通知",tabindex:"-1"},[l("12.1.2 异步通知 "),i("a",{class:"header-anchor",href:"#_12-1-2-异步通知","aria-label":'Permalink to "12.1.2 异步通知"'},"​")],-1)),s[1011]||(s[1011]=i("p",null,"方案二：异步通知",-1)),s[1012]||(s[1012]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723215140735.png",alt:"image-20210723215140735",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[1013]||(s[1013]=i("p",null,"流程如下：",-1)),s[1014]||(s[1014]=i("ul",null,[i("li",null,"hotel-admin对mysql数据库数据完成增、删、改后，发送MQ消息"),i("li",null,"hotel-demo监听MQ，接收到消息后完成elasticsearch数据修改")],-1)),s[1015]||(s[1015]=i("h4",{id:"_12-1-3-监听binlog",tabindex:"-1"},[l("12.1.3 监听binlog "),i("a",{class:"header-anchor",href:"#_12-1-3-监听binlog","aria-label":'Permalink to "12.1.3 监听binlog"'},"​")],-1)),s[1016]||(s[1016]=i("p",null,"方案三：监听binlog",-1)),s[1017]||(s[1017]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723215518541.png",alt:"image-20210723215518541",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[1018]||(s[1018]=i("p",null,"流程如下：",-1)),s[1019]||(s[1019]=i("ul",null,[i("li",null,"给mysql开启binlog功能"),i("li",null,"mysql完成增、删、改操作都会记录在binlog中"),i("li",null,"hotel-demo基于canal监听binlog变化，实时更新elasticsearch中的内容")],-1)),s[1020]||(s[1020]=i("h4",{id:"_12-1-4-选择",tabindex:"-1"},[l("12.1.4 选择 "),i("a",{class:"header-anchor",href:"#_12-1-4-选择","aria-label":'Permalink to "12.1.4 选择"'},"​")],-1)),s[1021]||(s[1021]=i("p",null,"方式一：同步调用",-1)),s[1022]||(s[1022]=i("ul",null,[i("li",null,"优点：实现简单，粗暴"),i("li",null,"缺点：业务耦合度高")],-1)),s[1023]||(s[1023]=i("p",null,"方式二：异步通知",-1)),s[1024]||(s[1024]=i("ul",null,[i("li",null,"优点：低耦合，实现难度一般"),i("li",null,"缺点：依赖mq的可靠性")],-1)),s[1025]||(s[1025]=i("p",null,"方式三：监听binlog",-1)),s[1026]||(s[1026]=i("ul",null,[i("li",null,"优点：完全解除服务间耦合"),i("li",null,"缺点：开启binlog增加数据库负担、实现复杂度高")],-1)),s[1027]||(s[1027]=i("h3",{id:"_12-2-实现数据同步",tabindex:"-1"},[l("12.2 实现数据同步 "),i("a",{class:"header-anchor",href:"#_12-2-实现数据同步","aria-label":'Permalink to "12.2 实现数据同步"'},"​")],-1)),s[1028]||(s[1028]=i("h4",{id:"_12-2-1-思路",tabindex:"-1"},[l("12.2.1 思路 "),i("a",{class:"header-anchor",href:"#_12-2-1-思路","aria-label":'Permalink to "12.2.1 思路"'},"​")],-1)),s[1029]||(s[1029]=i("p",null,"利用课前资料提供的hotel-admin项目作为酒店管理的微服务。当酒店数据发生增、删、改时，要求对elasticsearch中数据也要完成相同操作。",-1)),s[1030]||(s[1030]=i("p",null,"步骤：",-1)),s[1031]||(s[1031]=i("ul",null,[i("li",null,[i("p",null,"导入课前资料提供的hotel-admin项目，启动并测试酒店数据的CRUD")]),i("li",null,[i("p",null,"声明exchange、queue、RoutingKey")]),i("li",null,[i("p",null,"在hotel-admin中的增、删、改业务中完成消息发送")]),i("li",null,[i("p",null,"在hotel-demo中完成消息监听，并更新elasticsearch中数据")]),i("li",null,[i("p",null,"启动并测试数据同步功能")])],-1)),s[1032]||(s[1032]=i("h4",{id:"_12-2-2-导入demo",tabindex:"-1"},[l("12.2.2 导入demo "),i("a",{class:"header-anchor",href:"#_12-2-2-导入demo","aria-label":'Permalink to "12.2.2 导入demo"'},"​")],-1)),s[1033]||(s[1033]=i("p",null,"导入课前资料提供的hotel-admin项目：",-1)),s[1034]||(s[1034]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723220237930.png",alt:"image-20210723220237930",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[1035]||(s[1035]=i("p",null,[l("运行后，访问 "),i("a",{href:"http://localhost:8099",target:"_blank",rel:"noreferrer"},"http://localhost:8099")],-1)),s[1036]||(s[1036]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723220354464.png",alt:"image-20210723220354464",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[1037]||(s[1037]=i("p",null,"其中包含了酒店的CRUD功能：",-1)),s[1038]||(s[1038]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723220511090.png",alt:"image-20210723220511090",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[1039]||(s[1039]=i("h4",{id:"_12-2-3-声明交换机、队列",tabindex:"-1"},[l("12.2.3 声明交换机、队列 "),i("a",{class:"header-anchor",href:"#_12-2-3-声明交换机、队列","aria-label":'Permalink to "12.2.3 声明交换机、队列"'},"​")],-1)),s[1040]||(s[1040]=i("p",null,"MQ结构如图：",-1)),s[1041]||(s[1041]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723215850307.png",alt:"image-20210723215850307",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[1042]||(s[1042]=i("h5",{id:"_1-引入依赖",tabindex:"-1"},[l("1）引入依赖 "),i("a",{class:"header-anchor",href:"#_1-引入依赖","aria-label":'Permalink to "1）引入依赖"'},"​")],-1)),s[1043]||(s[1043]=i("p",null,"在hotel-admin、hotel-demo中引入rabbitmq的依赖：",-1)),s[1044]||(s[1044]=i("div",{class:"language-xml max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"xml"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"<!--amqp-->")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"dependency"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    <"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"groupId"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">org.springframework.boot</"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"groupId"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    <"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"artifactId"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">spring-boot-starter-amqp</"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"artifactId"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"</"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"dependency"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[1045]||(s[1045]=i("h5",{id:"_2-声明队列交换机名称",tabindex:"-1"},[l("2）声明队列交换机名称 "),i("a",{class:"header-anchor",href:"#_2-声明队列交换机名称","aria-label":'Permalink to "2）声明队列交换机名称"'},"​")],-1)),s[1046]||(s[1046]=i("p",null,[l("在hotel-admin和hotel-demo中的"),i("code",null,"cn.itcast.hotel.constatnts"),l("包下新建一个类"),i("code",null,"MqConstants"),l("：")],-1)),s[1047]||(s[1047]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"package"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," cn.itcast.hotel.constatnts;")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," MqConstants"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    /**")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * 交换机")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     */")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," final"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String HOTEL_EXCHANGE "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "hotel.topic"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    /**")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * 监听新增和修改的队列")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     */")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," final"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String HOTEL_INSERT_QUEUE "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "hotel.insert.queue"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    /**")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * 监听删除的队列")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     */")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," final"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String HOTEL_DELETE_QUEUE "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "hotel.delete.queue"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    /**")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * 新增或修改的RoutingKey")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     */")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," final"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String HOTEL_INSERT_KEY "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "hotel.insert"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    /**")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * 删除的RoutingKey")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     */")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," final"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String HOTEL_DELETE_KEY "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "hotel.delete"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[1048]||(s[1048]=i("h5",{id:"_3-声明队列交换机",tabindex:"-1"},[l("3）声明队列交换机 "),i("a",{class:"header-anchor",href:"#_3-声明队列交换机","aria-label":'Permalink to "3）声明队列交换机"'},"​")],-1)),s[1049]||(s[1049]=i("p",null,"在hotel-demo中，定义配置类，声明队列、交换机：",-1)),s[1050]||(s[1050]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"package"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," cn.itcast.hotel.config;")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," cn.itcast.hotel.constants.MqConstants;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.springframework.amqp.core.Binding;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.springframework.amqp.core.BindingBuilder;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.springframework.amqp.core.Queue;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.springframework.amqp.core.TopicExchange;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.springframework.context.annotation.Bean;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.springframework.context.annotation.Configuration;")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Configuration")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," MqConfig"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Bean")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," TopicExchange "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"topicExchange"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(){")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," TopicExchange"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(MqConstants.HOTEL_EXCHANGE, "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"false"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Bean")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Queue "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"insertQueue"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(){")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Queue"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(MqConstants.HOTEL_INSERT_QUEUE, "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Bean")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Queue "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"deleteQueue"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(){")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Queue"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(MqConstants.HOTEL_DELETE_QUEUE, "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Bean")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Binding "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"insertQueueBinding"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(){")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," BindingBuilder."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bind"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"insertQueue"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"to"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"topicExchange"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"with"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(MqConstants.HOTEL_INSERT_KEY);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Bean")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Binding "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"deleteQueueBinding"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(){")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," BindingBuilder."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bind"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"deleteQueue"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"to"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"topicExchange"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"())."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"with"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(MqConstants.HOTEL_DELETE_KEY);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[1051]||(s[1051]=i("h4",{id:"_12-2-4-发送mq消息",tabindex:"-1"},[l("12.2.4 发送MQ消息 "),i("a",{class:"header-anchor",href:"#_12-2-4-发送mq消息","aria-label":'Permalink to "12.2.4 发送MQ消息"'},"​")],-1)),s[1052]||(s[1052]=i("p",null,"在hotel-admin中的增、删、改业务中分别发送MQ消息：",-1)),s[1053]||(s[1053]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723221843816.png",alt:"image-20210723221843816",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[1054]||(s[1054]=i("h4",{id:"_12-2-5-接收mq消息",tabindex:"-1"},[l("12.2.5 接收MQ消息 "),i("a",{class:"header-anchor",href:"#_12-2-5-接收mq消息","aria-label":'Permalink to "12.2.5 接收MQ消息"'},"​")],-1)),s[1055]||(s[1055]=i("p",null,"hotel-demo接收到MQ消息要做的事情包括：",-1)),s[1056]||(s[1056]=i("ul",null,[i("li",null,"新增消息：根据传递的hotel的id查询hotel信息，然后新增一条数据到索引库"),i("li",null,"删除消息：根据传递的hotel的id删除索引库中的一条数据")],-1)),s[1057]||(s[1057]=i("p",null,[l("1）首先在hotel-demo的"),i("code",null,"cn.itcast.hotel.service"),l("包下的"),i("code",null,"IHotelService"),l("中新增新增、删除业务")],-1)),s[1058]||(s[1058]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"void"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," deleteById"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Long id);")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"void"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," insertById"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Long id);")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[1059]||(s[1059]=i("p",null,[l("2）给hotel-demo中的"),i("code",null,"cn.itcast.hotel.service.impl"),l("包下的HotelService中实现业务：")],-1)),s[1060]||(s[1060]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Override")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," deleteById"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Long id) {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    try"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 1.准备Request")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        DeleteRequest request "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," DeleteRequest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", id."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"toString"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 2.发送请求")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"delete"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    } "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"catch"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (IOException "),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"e"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        throw"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," RuntimeException"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(e);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Override")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," insertById"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Long id) {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    try"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 0.根据id查询酒店数据")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        Hotel hotel "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getById"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(id);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 转换为文档类型")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        HotelDoc hotelDoc "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HotelDoc"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(hotel);")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 1.准备Request对象")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        IndexRequest request "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," IndexRequest"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"hotel"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"id"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(hotel."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getId"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"toString"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 2.准备Json文档")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        request."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"source"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(JSON."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"toJSONString"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(hotelDoc), XContentType.JSON);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 3.发送请求")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"index"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(request, RequestOptions.DEFAULT);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    } "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"catch"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (IOException "),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"e"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        throw"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," RuntimeException"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(e);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[1061]||(s[1061]=i("p",null,"3）编写监听器",-1)),s[1062]||(s[1062]=i("p",null,[l("在hotel-demo中的"),i("code",null,"cn.itcast.hotel.mq"),l("包新增一个类：")],-1)),s[1063]||(s[1063]=i("div",{class:"language-java max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"package"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," cn.itcast.hotel.mq;")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," cn.itcast.hotel.constants.MqConstants;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," cn.itcast.hotel.service.IHotelService;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.springframework.amqp.rabbit.annotation.RabbitListener;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.springframework.beans.factory.annotation.Autowired;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," org.springframework.stereotype.Component;")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Component")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HotelListener"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Autowired")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," IHotelService hotelService;")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    /**")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * 监听酒店新增或修改的业务")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," id"),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," 酒店id")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     */")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RabbitListener"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"queues"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," MqConstants.HOTEL_INSERT_QUEUE)")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," listenHotelInsertOrUpdate"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Long "),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"id"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"){")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        hotelService."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"insertById"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(id);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    /**")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * 监听酒店删除的业务")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," id"),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," 酒店id")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     */")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RabbitListener"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"queues"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," MqConstants.HOTEL_DELETE_QUEUE)")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," listenHotelDelete"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Long "),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"id"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"){")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        hotelService."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"deleteById"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(id);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[1064]||(s[1064]=i("hr",null,null,-1)),s[1065]||(s[1065]=i("h2",{id:"_13-集群",tabindex:"-1"},[l("13. 集群 "),i("a",{class:"header-anchor",href:"#_13-集群","aria-label":'Permalink to "13. 集群"'},"​")],-1)),s[1066]||(s[1066]=i("p",null,"单机的elasticsearch做数据存储，必然面临两个问题：海量数据存储问题、单点故障问题。",-1)),s[1067]||(s[1067]=i("ul",null,[i("li",null,"海量数据存储问题：将索引库从逻辑上拆分为N个分片（shard），存储到多个节点"),i("li",null,"单点故障问题：将分片数据在不同节点备份（replica ）")],-1)),s[1068]||(s[1068]=i("p",null,[i("strong",null,"ES集群相关概念"),l(":")],-1)),i("ul",null,[s[7]||(s[7]=i("li",null,[i("p",null,"集群（cluster）：一组拥有共同的 cluster name 的 节点。")],-1)),i("li",null,[o(y,{color:"red"},{default:n(()=>[...s[0]||(s[0]=[l("节点（node)",-1)])]),_:1}),s[1]||(s[1]=l(" ：集群中的一个 Elasticearch 实例",-1))]),i("li",null,[o(y,{color:"red"},{default:n(()=>[...s[2]||(s[2]=[l("分片（shard）",-1)])]),_:1}),s[3]||(s[3]=l("：索引可以被拆分为不同的部分进行存储，称为分片。在集群环境下，一个索引的不同分片可以拆分到不同的节点中",-1)),s[4]||(s[4]=i("p",null,"解决问题：数据量太大，单点存储量有限的问题。",-1)),s[5]||(s[5]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20200104124440086-5602723.png",alt:"image-20200104124440086",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[6]||(s[6]=i("blockquote",null,[i("p",null,"此处，我们把数据分成3片：shard0、shard1、shard2")],-1))]),s[8]||(s[8]=i("li",null,[i("p",null,"主分片（Primary shard）：相对于副本分片的定义。")],-1)),s[9]||(s[9]=i("li",null,[i("p",null,"副本分片（Replica shard）每个主分片可以有一个或者多个副本，数据和主分片一样。"),i("p",null,"​")],-1))]),s[1069]||(s[1069]=i("p",null,"数据备份可以保证高可用，但是每个分片备份一份，所需要的节点数量就会翻一倍，成本实在是太高了！",-1)),s[1070]||(s[1070]=i("p",null,"为了在高可用和成本间寻求平衡，我们可以这样做：",-1)),s[1071]||(s[1071]=i("ul",null,[i("li",null,"首先对数据分片，存储到不同节点"),i("li",null,"然后对每个分片进行备份，放到对方节点，完成互相备份")],-1)),s[1072]||(s[1072]=i("p",null,"这样可以大大减少所需要的服务节点数量，如图，我们以3分片，每个分片备份一份为例：",-1)),s[1073]||(s[1073]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20200104124551912.png",alt:"image-20200104124551912",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[1074]||(s[1074]=i("p",null,"现在，每个分片都有1个备份，存储在3个节点：",-1)),s[1075]||(s[1075]=i("ul",null,[i("li",null,"node0：保存了分片0和1"),i("li",null,"node1：保存了分片0和2"),i("li",null,"node2：保存了分片1和2")],-1)),s[1076]||(s[1076]=i("h3",{id:"_13-1-搭建es集群",tabindex:"-1"},[l("13.1 搭建ES集群 "),i("a",{class:"header-anchor",href:"#_13-1-搭建es集群","aria-label":'Permalink to "13.1 搭建ES集群"'},"​")],-1)),s[1077]||(s[1077]=i("h4",{id:"部署es集群",tabindex:"-1"},[l("部署es集群 "),i("a",{class:"header-anchor",href:"#部署es集群","aria-label":'Permalink to "部署es集群"'},"​")],-1)),s[1078]||(s[1078]=i("p",null,[l("部署es集群可以直接使用docker-compose来完成，不过要求你的Linux虚拟机至少有"),i("strong",null,"4G"),l("的内存空间")],-1)),s[1079]||(s[1079]=i("p",null,"首先编写一个docker-compose文件，内容如下：",-1)),s[1080]||(s[1080]=i("div",{class:"language-sh max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"sh"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"version:"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," '2.2'")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"services:")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  es01:")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    image:"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," docker.elastic.co/elasticsearch/elasticsearch:7.12.1")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    container_name:"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," es01")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    environment:")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," node.name=es01")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," cluster.name=es-docker-cluster")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," discovery.seed_hosts=es02,es03")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," cluster.initial_master_nodes=es01,es02,es03")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," bootstrap.memory_lock="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "ES_JAVA_OPTS=-Xms512m -Xmx512m"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    ulimits:")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      memlock:")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        soft:"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -1")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        hard:"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -1")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    volumes:")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," data01:/usr/share/elasticsearch/data")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    ports:")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 9200:9200")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    networks:")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," elastic")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  es02:")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    image:"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," docker.elastic.co/elasticsearch/elasticsearch:7.12.1")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    container_name:"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," es02")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    environment:")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," node.name=es02")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," cluster.name=es-docker-cluster")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," discovery.seed_hosts=es01,es03")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," cluster.initial_master_nodes=es01,es02,es03")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," bootstrap.memory_lock="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "ES_JAVA_OPTS=-Xms512m -Xmx512m"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    ulimits:")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      memlock:")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        soft:"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -1")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        hard:"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -1")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    volumes:")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," data02:/usr/share/elasticsearch/data")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    networks:")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," elastic")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  es03:")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    image:"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," docker.elastic.co/elasticsearch/elasticsearch:7.12.1")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    container_name:"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," es03")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    environment:")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," node.name=es03")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," cluster.name=es-docker-cluster")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," discovery.seed_hosts=es01,es02")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," cluster.initial_master_nodes=es01,es02,es03")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," bootstrap.memory_lock="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"true")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "ES_JAVA_OPTS=-Xms512m -Xmx512m"')]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    ulimits:")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      memlock:")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        soft:"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -1")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        hard:"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -1")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    volumes:")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," data03:/usr/share/elasticsearch/data")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    networks:")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      -"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," elastic")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"volumes:")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  data01:")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    driver:"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," local")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  data02:")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    driver:"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," local")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  data03:")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    driver:"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," local")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"networks:")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  elastic:")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    driver:"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," bridge")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[1081]||(s[1081]=i("p",null,[l("Run "),i("code",null,"docker-compose"),l(" to bring up the cluster:")],-1)),s[1082]||(s[1082]=i("div",{class:"language-sh max-h-300px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"sh"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker-compose"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," up")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),s[1083]||(s[1083]=i("h3",{id:"_13-2-集群脑裂问题",tabindex:"-1"},[l("13.2 集群脑裂问题 "),i("a",{class:"header-anchor",href:"#_13-2-集群脑裂问题","aria-label":'Permalink to "13.2 集群脑裂问题"'},"​")],-1)),s[1084]||(s[1084]=i("h4",{id:"_13-2-1-集群职责划分",tabindex:"-1"},[l("13.2.1 集群职责划分 "),i("a",{class:"header-anchor",href:"#_13-2-1-集群职责划分","aria-label":'Permalink to "13.2.1 集群职责划分"'},"​")],-1)),s[1085]||(s[1085]=i("p",null,"elasticsearch中集群节点有不同的职责划分：",-1)),s[1086]||(s[1086]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723223008967.png",alt:"image-20210723223008967",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[1087]||(s[1087]=i("p",null,"默认情况下，集群中的任何一个节点都同时具备上述四种角色。",-1)),s[1088]||(s[1088]=i("p",null,"但是真实的集群一定要将集群职责分离：",-1)),s[1089]||(s[1089]=i("ul",null,[i("li",null,"master节点：对CPU要求高，但是内存要求第"),i("li",null,"data节点：对CPU和内存要求都高"),i("li",null,"coordinating节点：对网络带宽、CPU要求高")],-1)),s[1090]||(s[1090]=i("p",null,"职责分离可以让我们根据不同节点的需求分配不同的硬件去部署。而且避免业务之间的互相干扰。",-1)),s[1091]||(s[1091]=i("p",null,"一个典型的es集群职责划分如图：",-1)),s[1092]||(s[1092]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723223629142.png",alt:"image-20210723223629142",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[1093]||(s[1093]=i("h4",{id:"_13-2-2-脑裂问题",tabindex:"-1"},[l("13.2.2 脑裂问题 "),i("a",{class:"header-anchor",href:"#_13-2-2-脑裂问题","aria-label":'Permalink to "13.2.2 脑裂问题"'},"​")],-1)),s[1094]||(s[1094]=i("p",null,"脑裂是因为集群中的节点失联导致的。",-1)),s[1095]||(s[1095]=i("p",null,"例如一个集群中，主节点与其它节点失联：",-1)),s[1096]||(s[1096]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723223804995.png",alt:"image-20210723223804995",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[1097]||(s[1097]=i("p",null,"此时，node2和node3认为node1宕机，就会重新选主：",-1)),s[1098]||(s[1098]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723223845754.png",alt:"image-20210723223845754",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[1099]||(s[1099]=i("p",null,"当node3当选后，集群继续对外提供服务，node2和node3自成集群，node1自成集群，两个集群数据不同步，出现数据差异。",-1)),s[1100]||(s[1100]=i("p",null,"当网络恢复后，因为集群中有两个master节点，集群状态的不一致，出现脑裂的情况：",-1)),s[1101]||(s[1101]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723224000555.png",alt:"image-20210723224000555",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[1102]||(s[1102]=i("p",null,"解决脑裂的方案是，要求选票超过 ( eligible节点数量 + 1 ）/ 2 才能当选为主，因此eligible节点数量最好是奇数。对应配置项是discovery.zen.minimum_master_nodes，在es7.0以后，已经成为默认配置，因此一般不会发生脑裂问题",-1)),s[1103]||(s[1103]=i("p",null,"例如：3个节点形成的集群，选票必须超过 （3 + 1） / 2 ，也就是2票。node3得到node2和node3的选票，当选为主。node1只有自己1票，没有当选。集群中依然只有1个主节点，没有出现脑裂。",-1)),s[1104]||(s[1104]=i("h4",{id:"_13-2-3-小结",tabindex:"-1"},[l("13.2.3 小结 "),i("a",{class:"header-anchor",href:"#_13-2-3-小结","aria-label":'Permalink to "13.2.3 小结"'},"​")],-1)),s[1105]||(s[1105]=i("blockquote",null,[i("ul",null,[i("li",null,[i("p",null,"master eligible节点的作用是什么？"),i("ul",null,[i("li",null,[i("p",null,"参与集群选主")]),i("li",null,[i("p",null,"主节点可以管理集群状态、管理分片信息、处理创建和删除索引库的请求")])])]),i("li",null,[i("p",null,"data节点的作用是什么？"),i("ul",null,[i("li",null,"数据的CRUD")])]),i("li",null,[i("p",null,"coordinator节点的作用是什么？"),i("ul",null,[i("li",null,[i("p",null,"路由请求到其它节点")]),i("li",null,[i("p",null,"合并查询到的结果，返回给用户")])])])])],-1)),s[1106]||(s[1106]=i("h3",{id:"_13-3-集群分布式存储",tabindex:"-1"},[l("13.3 集群分布式存储 "),i("a",{class:"header-anchor",href:"#_13-3-集群分布式存储","aria-label":'Permalink to "13.3 集群分布式存储"'},"​")],-1)),s[1107]||(s[1107]=i("p",null,"当新增文档时，应该保存到不同分片，保证数据均衡，那么coordinating node如何确定数据该存储到哪个分片呢？",-1)),s[1108]||(s[1108]=i("h4",{id:"_13-3-1-分片存储测试",tabindex:"-1"},[l("13.3.1 分片存储测试 "),i("a",{class:"header-anchor",href:"#_13-3-1-分片存储测试","aria-label":'Permalink to "13.3.1 分片存储测试"'},"​")],-1)),s[1109]||(s[1109]=i("p",null,"插入三条数据：",-1)),s[1110]||(s[1110]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723225006058.png",alt:"image-20210723225006058",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[1111]||(s[1111]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723225034637.png",alt:"image-20210723225034637",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[1112]||(s[1112]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723225112029.png",alt:"image-20210723225112029",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[1113]||(s[1113]=i("p",null,"测试可以看到，三条数据分别在不同分片：",-1)),s[1114]||(s[1114]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723225227928.png",alt:"image-20210723225227928",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[1115]||(s[1115]=i("p",null,"结果：",-1)),s[1116]||(s[1116]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723225342120.png",alt:"image-20210723225342120",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[1117]||(s[1117]=i("h4",{id:"_13-3-2-分片存储原理",tabindex:"-1"},[l("13.3.2 分片存储原理 "),i("a",{class:"header-anchor",href:"#_13-3-2-分片存储原理","aria-label":'Permalink to "13.3.2 分片存储原理"'},"​")],-1)),s[1118]||(s[1118]=i("p",null,"elasticsearch会通过hash算法来计算文档应该存储到哪个分片：",-1)),s[1119]||(s[1119]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723224354904.png",alt:"image-20210723224354904",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[1120]||(s[1120]=i("p",null,"说明：",-1)),s[1121]||(s[1121]=i("ul",null,[i("li",null,"_routing默认是文档的id"),i("li",null,"算法与分片数量有关，因此索引库一旦创建，分片数量不能修改！")],-1)),s[1122]||(s[1122]=i("p",null,"新增文档的流程如下：",-1)),s[1123]||(s[1123]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723225436084.png",alt:"image-20210723225436084",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[1124]||(s[1124]=i("p",null,"解读：",-1)),s[1125]||(s[1125]=i("ul",null,[i("li",null,"1）新增一个id=1的文档"),i("li",null,"2）对id做hash运算，假如得到的是2，则应该存储到shard-2"),i("li",null,"3）shard-2的主分片在node3节点，将数据路由到node3"),i("li",null,"4）保存文档"),i("li",null,"5）同步给shard-2的副本replica-2，在node2节点"),i("li",null,"6）返回结果给coordinating-node节点")],-1)),s[1126]||(s[1126]=i("h3",{id:"_13-4-集群分布式查询",tabindex:"-1"},[l("13.4 集群分布式查询 "),i("a",{class:"header-anchor",href:"#_13-4-集群分布式查询","aria-label":'Permalink to "13.4 集群分布式查询"'},"​")],-1)),s[1127]||(s[1127]=i("p",null,"elasticsearch的查询分成两个阶段：",-1)),s[1128]||(s[1128]=i("ul",null,[i("li",null,[i("p",null,"scatter phase：分散阶段，coordinating node会把请求分发到每一个分片")]),i("li",null,[i("p",null,"gather phase：聚集阶段，coordinating node汇总data node的搜索结果，并处理为最终结果集返回给用户")])],-1)),s[1129]||(s[1129]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723225809848.png",alt:"image-20210723225809848",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[1130]||(s[1130]=i("h3",{id:"_13-5-集群故障转移",tabindex:"-1"},[l("13.5 集群故障转移 "),i("a",{class:"header-anchor",href:"#_13-5-集群故障转移","aria-label":'Permalink to "13.5 集群故障转移"'},"​")],-1)),s[1131]||(s[1131]=i("p",null,"集群的master节点会监控集群中的节点状态，如果发现有节点宕机，会立即将宕机节点的分片数据迁移到其它节点，确保数据安全，这个叫做故障转移。",-1)),s[1132]||(s[1132]=i("p",null,"1）例如一个集群结构如图：",-1)),s[1133]||(s[1133]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723225945963.png",alt:"image-20210723225945963",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[1134]||(s[1134]=i("p",null,"现在，node1是主节点，其它两个节点是从节点。",-1)),s[1135]||(s[1135]=i("p",null,"2）突然，node1发生了故障：",-1)),s[1136]||(s[1136]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723230020574.png",alt:"image-20210723230020574",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[1137]||(s[1137]=i("p",null,"宕机后的第一件事，需要重新选主，例如选中了node2：",-1)),s[1138]||(s[1138]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723230055974.png",alt:"image-20210723230055974",loading:"lazy",decoding:"async",class:"lazy"})],-1)),s[1139]||(s[1139]=i("p",null,"node2成为主节点后，会检测集群监控状态，发现：shard-1、shard-0没有副本节点。因此需要将node1上的数据迁移到node2、node3：",-1)),s[1140]||(s[1140]=i("figure",null,[i("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210723230216642.png",alt:"image-20210723230216642",loading:"lazy",decoding:"async",class:"lazy"})],-1))]),"main-header":n(()=>[k(a.$slots,"main-header")]),"main-header-after":n(()=>[k(a.$slots,"main-header-after")]),"main-nav":n(()=>[k(a.$slots,"main-nav")]),"main-content-before":n(()=>[k(a.$slots,"main-content-before")]),"main-content":n(()=>[k(a.$slots,"main-content")]),"main-content-after":n(()=>[k(a.$slots,"main-content-after")]),"main-nav-before":n(()=>[k(a.$slots,"main-nav-before")]),"main-nav-after":n(()=>[k(a.$slots,"main-nav-after")]),comment:n(()=>[k(a.$slots,"comment")]),footer:n(()=>[k(a.$slots,"footer")]),aside:n(()=>[k(a.$slots,"aside")]),"aside-custom":n(()=>[k(a.$slots,"aside-custom")]),default:n(()=>[k(a.$slots,"default")]),_:3},8,["frontmatter"])}}};export{U as default,S as usePageData};
