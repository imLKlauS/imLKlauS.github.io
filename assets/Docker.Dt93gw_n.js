var u=(k,o,e)=>new Promise((h,d)=>{var p=n=>{try{r(e.next(n))}catch(i){d(i)}},g=n=>{try{r(e.throw(n))}catch(i){d(i)}},r=n=>n.done?h(n.value):Promise.resolve(n.value).then(p,g);r((e=e.apply(k,o)).next())});import{_ as m}from"./ValaxyMain.vue_vue_type_style_index_0_lang.39opEnV_.js";import"./chunks/@vueuse/motion.C0680yyY.js";import{d as F,a as E,u as b}from"./chunks/vue-router.BaQM4Kc2.js";import{a1 as C,a3 as a,a4 as t,a5 as l,a6 as f,a7 as s,F as v,a2 as D,Z as B}from"./framework.CyQERZzy.js";import"./app.yrEQeKqa.js";import"./chunks/dayjs.BSMtxqtT.js";import"./chunks/vue-i18n.CvwbWgfE.js";import"./chunks/pinia.CyvRWuDa.js";import"./chunks/nprogress.c3ZdlDjC.js";/* empty css                    */import"./YunComment.vue_vue_type_style_index_0_lang.XbFefrGO.js";import"./index.C5okkQwF.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang.Du2MZPyS.js";import"./post.C7a2r-qQ.js";const x=F("/posts/Docker",k=>u(null,null,function*(){return JSON.parse('{"title":"Docker 从入门到实战","description":"","frontmatter":{"title":"Docker 从入门到实战","author":"imklaus","top":98,"tags":["Docker"],"categories":["部署"],"date":"2025/12/7 17:34:00","outline":"deep","postTitleClass":"text-#62afe9","excerpt_type":"html","end":false},"headers":[],"relativePath":"pages/posts/Docker.md","lastUpdated":null}')}),{lazy:(k,o)=>k.name===o.name}),w={__name:"Docker",setup(k,{expose:o}){var r;const{data:e}=x(),h=b(),d=E(),p=Object.assign(d.meta.frontmatter||{},((r=e.value)==null?void 0:r.frontmatter)||{});return h.currentRoute.value.data=e.value,B("valaxy:frontmatter",p),globalThis.$frontmatter=p,o({frontmatter:{title:"Docker 从入门到实战",author:"imklaus",top:98,tags:["Docker"],categories:["部署"],date:"2025/12/7 17:34:00",outline:"deep",postTitleClass:"text-#62afe9",excerpt_type:"html",end:!1}}),(n,i)=>{const y=m;return D(),C(y,{frontmatter:v(p)},{"main-content-md":a(()=>[i[0]||(i[0]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/self-hosting-overpass-api-us-only-on-docker-a-journey-with-bumps.png",alt:"",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[1]||(i[1]=l("p",null,[s("参考视频："),l("a",{href:"https://www.bilibili.com/video/BV1LQ4y127n4",target:"_blank",rel:"noreferrer"},"黑马SpringCloud微服务技术栈Docker篇")],-1)),i[2]||(i[2]=l("p",null,"笔记的整体结构依据视频编写，并随着学习的深入补充了很多知识",-1)),i[3]||(i[3]=l("p",null,[l("strong",null,"目录指引"),s("：")],-1)),i[4]||(i[4]=l("nav",{class:"table-of-contents"},[l("ul",null,[l("li",null,[l("a",{href:"#_1-初识docker"},"1. 初识Docker"),l("ul",null,[l("li",null,[l("a",{href:"#_1-1-什么是docker"},"1.1 什么是Docker"),l("ul",null,[l("li",null,[l("a",{href:"#_1-1-1-应用部署的环境问题"},"1.1.1 应用部署的环境问题")]),l("li",null,[l("a",{href:"#_1-1-2-docker解决依赖兼容问题"},"1.1.2 Docker解决依赖兼容问题")]),l("li",null,[l("a",{href:"#_1-1-3-docker解决操作系统环境差异"},"1.1.3 Docker解决操作系统环境差异")]),l("li",null,[l("a",{href:"#_1-1-4-小结"},"1.1.4 小结")])])]),l("li",null,[l("a",{href:"#_1-2-docker和虚拟机的区别"},"1.2 Docker和虚拟机的区别")]),l("li",null,[l("a",{href:"#_1-3-docker架构"},"1.3 Docker架构"),l("ul",null,[l("li",null,[l("a",{href:"#_1-3-1-镜像和容器"},"1.3.1 镜像和容器")]),l("li",null,[l("a",{href:"#_1-3-2-dockerhub"},"1.3.2 DockerHub")]),l("li",null,[l("a",{href:"#_1-3-3-docker架构"},"1.3.3 Docker架构")]),l("li",null,[l("a",{href:"#_1-3-4-小结"},"1.3.4 小结")])])]),l("li",null,[l("a",{href:"#_1-4-安装docker"},"1.4 安装Docker"),l("ul",null,[l("li",null,[l("a",{href:"#centos安装docker"},"CentOS安装Docker")])])])])]),l("li",null,[l("a",{href:"#_2-docker的基本操作"},"2.Docker的基本操作"),l("ul",null,[l("li",null,[l("a",{href:"#_2-1-镜像操作"},"2.1.镜像操作"),l("ul",null,[l("li",null,[l("a",{href:"#_2-1-1-镜像名称"},"2.1.1 镜像名称")]),l("li",null,[l("a",{href:"#_2-1-2-镜像命令"},"2.1.2 镜像命令")]),l("li",null,[l("a",{href:"#_2-1-3-案例1-拉取、查看镜像"},"2.1.3 案例1-拉取、查看镜像")]),l("li",null,[l("a",{href:"#_2-1-4-案例2-保存、导入镜像"},"2.1.4 案例2-保存、导入镜像")]),l("li",null,[l("a",{href:"#_2-1-5-练习"},"2.1.5 练习")])])]),l("li",null,[l("a",{href:"#_2-2-容器操作"},"2.2 容器操作"),l("ul",null,[l("li",null,[l("a",{href:"#_2-2-1-容器相关命令"},"2.2.1 容器相关命令")]),l("li",null,[l("a",{href:"#_2-2-2-案例-创建并运行一个容器"},"2.2.2 案例-创建并运行一个容器")]),l("li",null,[l("a",{href:"#_2-2-3-案例-进入容器-修改文件"},"2.2.3 案例-进入容器，修改文件")]),l("li",null,[l("a",{href:"#_2-2-4-小结"},"2.2.4 小结")])])]),l("li",null,[l("a",{href:"#_2-3-数据卷-容器数据管理"},"2.3 数据卷（容器数据管理）"),l("ul",null,[l("li",null,[l("a",{href:"#_2-3-1-什么是数据卷"},"2.3.1 什么是数据卷")]),l("li",null,[l("a",{href:"#_2-3-2-数据集操作命令"},"2.3.2 数据集操作命令")]),l("li",null,[l("a",{href:"#_2-3-3-创建和查看数据卷"},"2.3.3 创建和查看数据卷")]),l("li",null,[l("a",{href:"#_2-3-4-挂载数据卷"},"2.3.4 挂载数据卷")]),l("li",null,[l("a",{href:"#_2-3-5-案例-给nginx挂载数据卷"},"2.3.5 案例-给nginx挂载数据卷")]),l("li",null,[l("a",{href:"#_2-3-6-案例-给mysql挂载本地目录"},"2.3.6 案例-给MySQL挂载本地目录")]),l("li",null,[l("a",{href:"#_2-3-7-小结"},"2.3.7 小结")])])])])]),l("li",null,[l("a",{href:"#_3-dockerfile自定义镜像"},"3. Dockerfile自定义镜像"),l("ul",null,[l("li",null,[l("a",{href:"#_3-1-镜像结构"},"3.1 镜像结构")]),l("li",null,[l("a",{href:"#_3-2-dockerfile语法"},"3.2 Dockerfile语法")]),l("li",null,[l("a",{href:"#_3-3-构建java项目"},"3.3 构建Java项目"),l("ul",null,[l("li",null,[l("a",{href:"#_3-3-1-基于ubuntu构建java项目"},"3.3.1 基于Ubuntu构建Java项目")]),l("li",null,[l("a",{href:"#_3-3-2-基于java8构建java项目"},"3.3.2 基于java8构建Java项目")])])]),l("li",null,[l("a",{href:"#_3-4-小结"},"3.4 小结")])])]),l("li",null,[l("a",{href:"#_4-docker-compose"},"4. Docker-Compose"),l("ul",null,[l("li",null,[l("a",{href:"#_4-1-初识dockercompose"},"4.1 初识DockerCompose")]),l("li",null,[l("a",{href:"#_4-2-安装dockercompose"},"4.2 安装DockerCompose"),l("ul",null,[l("li",null,[l("a",{href:"#centos7安装dockercompose"},"CentOS7安装DockerCompose")])])]),l("li",null,[l("a",{href:"#_4-3-部署微服务集群"},"4.3 部署微服务集群"),l("ul",null,[l("li",null,[l("a",{href:"#_4-3-1-compose文件"},"4.3.1 compose文件")]),l("li",null,[l("a",{href:"#_4-3-2-修改微服务配置"},"4.3.2 修改微服务配置")]),l("li",null,[l("a",{href:"#_4-3-3-打包"},"4.3.3 打包")]),l("li",null,[l("a",{href:"#_4-3-4-拷贝jar包到部署目录"},"4.3.4 拷贝jar包到部署目录")]),l("li",null,[l("a",{href:"#_4-3-5-部署"},"4.3.5 部署")])])])])]),l("li",null,[l("a",{href:"#_5-docker镜像仓库"},"5. Docker镜像仓库"),l("ul",null,[l("li",null,[l("a",{href:"#_5-1-搭建私有镜像仓库"},"5.1 搭建私有镜像仓库"),l("ul",null,[l("li",null,[l("a",{href:"#docker镜像仓库"},"Docker镜像仓库")])])]),l("li",null,[l("a",{href:"#_5-2-推送、拉取镜像"},"5.2 推送、拉取镜像")])])])])],-1)),i[5]||(i[5]=l("h2",{id:"_1-初识docker",tabindex:"-1"},[s("1. 初识Docker "),l("a",{class:"header-anchor",href:"#_1-初识docker","aria-label":'Permalink to "1. 初识Docker"'},"​")],-1)),i[6]||(i[6]=l("hr",null,null,-1)),i[7]||(i[7]=l("h3",{id:"_1-1-什么是docker",tabindex:"-1"},[s("1.1 什么是Docker "),l("a",{class:"header-anchor",href:"#_1-1-什么是docker","aria-label":'Permalink to "1.1 什么是Docker"'},"​")],-1)),i[8]||(i[8]=l("p",null,"微服务虽然具备各种各样的优势，但服务的拆分通用给部署带来了很大的麻烦。",-1)),i[9]||(i[9]=l("ul",null,[l("li",null,"分布式系统中，依赖的组件非常多，不同组件之间部署时往往会产生一些冲突。"),l("li",null,"在数百上千台服务中重复部署，环境不一定一致，会遇到各种问题")],-1)),i[10]||(i[10]=l("h4",{id:"_1-1-1-应用部署的环境问题",tabindex:"-1"},[s("1.1.1 应用部署的环境问题 "),l("a",{class:"header-anchor",href:"#_1-1-1-应用部署的环境问题","aria-label":'Permalink to "1.1.1 应用部署的环境问题"'},"​")],-1)),i[11]||(i[11]=l("p",null,"大型项目组件较多，运行环境也较为复杂，部署时会碰到一些问题：",-1)),i[12]||(i[12]=l("ul",null,[l("li",null,[l("p",null,"依赖关系复杂，容易出现兼容性问题")]),l("li",null,[l("p",null,"开发、测试、生产环境有差异")])],-1)),f(" more "),i[13]||(i[13]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731141907366.png",alt:"image-20210731141907366",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[14]||(i[14]=l("p",null,"例如一个项目中，部署时需要依赖于node.js、Redis、RabbitMQ、MySQL等，这些服务部署时所需要的函数库、依赖项各不相同，甚至会有冲突。给部署带来了极大的困难。",-1)),i[15]||(i[15]=l("h4",{id:"_1-1-2-docker解决依赖兼容问题",tabindex:"-1"},[s("1.1.2 Docker解决依赖兼容问题 "),l("a",{class:"header-anchor",href:"#_1-1-2-docker解决依赖兼容问题","aria-label":'Permalink to "1.1.2 Docker解决依赖兼容问题"'},"​")],-1)),i[16]||(i[16]=l("p",null,"而Docker确巧妙的解决了这些问题，Docker是如何实现的呢？",-1)),i[17]||(i[17]=l("p",null,"Docker为了解决依赖的兼容问题的，采用了两个手段：",-1)),i[18]||(i[18]=l("ul",null,[l("li",null,[l("p",null,"将应用的Libs（函数库）、Deps（依赖）、配置与应用一起打包")]),l("li",null,[l("p",null,[s("将每个应用放到一个隔离"),l("strong",null,"容器"),s("去运行，避免互相干扰")])])],-1)),i[19]||(i[19]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731142219735.png",alt:"image-20210731142219735",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[20]||(i[20]=l("p",null,"这样打包好的应用包中，既包含应用本身，也保护应用所需要的Libs、Deps，无需再操作系统上安装这些，自然就不存在不同应用之间的兼容问题了。",-1)),i[21]||(i[21]=l("p",null,"虽然解决了不同应用的兼容问题，但是开发、测试等环境会存在差异，操作系统版本也会有差异，怎么解决这些问题呢？",-1)),i[22]||(i[22]=l("h4",{id:"_1-1-3-docker解决操作系统环境差异",tabindex:"-1"},[s("1.1.3 Docker解决操作系统环境差异 "),l("a",{class:"header-anchor",href:"#_1-1-3-docker解决操作系统环境差异","aria-label":'Permalink to "1.1.3 Docker解决操作系统环境差异"'},"​")],-1)),i[23]||(i[23]=l("p",null,"要解决不同操作系统环境差异问题，必须先了解操作系统结构。以一个Ubuntu操作系统为例，结构如下：",-1)),i[24]||(i[24]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731143401460.png",alt:"image-20210731143401460",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[25]||(i[25]=l("p",null,"结构包括：",-1)),i[26]||(i[26]=l("ul",null,[l("li",null,"计算机硬件：例如CPU、内存、磁盘等"),l("li",null,[s("系统内核：所有Linux发行版的内核都是Linux，例如CentOS、Ubuntu、Fedora等。内核可以与计算机硬件交互，对外提供"),l("strong",null,"内核指令"),s("，用于操作计算机硬件。")]),l("li",null,"系统应用：操作系统本身提供的应用、函数库。这些函数库是对内核指令的封装，使用更加方便。")],-1)),i[27]||(i[27]=l("p",null,"应用于计算机交互的流程如下：",-1)),i[28]||(i[28]=l("p",null,"1）应用调用操作系统应用（函数库），实现各种功能",-1)),i[29]||(i[29]=l("p",null,"2）系统函数库是对内核指令集的封装，会调用内核指令",-1)),i[30]||(i[30]=l("p",null,"3）内核指令操作计算机硬件",-1)),i[31]||(i[31]=l("p",null,"Ubuntu和CentOS都是基于Linux内核，无非是系统应用不同，提供的函数库有差异：",-1)),i[32]||(i[32]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731144304990.png",alt:"image-20210731144304990",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[33]||(i[33]=l("p",null,"此时，如果将一个Ubuntu版本的MySQL应用安装到CentOS系统，MySQL在调用Ubuntu函数库时，会发现找不到或者不匹配，就会报错了：",-1)),i[34]||(i[34]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731144458680.png",alt:"image-20210731144458680",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[35]||(i[35]=l("p",null,"Docker如何解决不同系统环境的问题？",-1)),i[36]||(i[36]=l("ul",null,[l("li",null,"Docker将用户程序与所需要调用的系统(比如Ubuntu)函数库一起打包"),l("li",null,"Docker运行到不同操作系统时，直接基于打包的函数库，借助于操作系统的Linux内核来运行")],-1)),i[37]||(i[37]=l("p",null,"如图：",-1)),i[38]||(i[38]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731144820638.png",alt:"image-20210731144820638",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[39]||(i[39]=l("h4",{id:"_1-1-4-小结",tabindex:"-1"},[s("1.1.4 小结 "),l("a",{class:"header-anchor",href:"#_1-1-4-小结","aria-label":'Permalink to "1.1.4 小结"'},"​")],-1)),i[40]||(i[40]=l("p",null,"Docker如何解决大型项目依赖关系复杂，不同组件依赖的兼容性问题？",-1)),i[41]||(i[41]=l("ul",null,[l("li",null,[s("Docker允许开发中将应用、依赖、函数库、配置一起"),l("strong",null,"打包"),s("，形成可移植镜像")]),l("li",null,[s("Docker应用运行在容器中，使用沙箱机制，相互"),l("strong",null,"隔离")])],-1)),i[42]||(i[42]=l("p",null,"Docker如何解决开发、测试、生产环境有差异的问题？",-1)),i[43]||(i[43]=l("ul",null,[l("li",null,"Docker镜像中包含完整运行环境，包括系统函数库，仅依赖系统的Linux内核，因此可以在任意Linux操作系统上运行")],-1)),i[44]||(i[44]=l("p",null,"Docker是一个快速交付应用、运行应用的技术，具备下列优势：",-1)),i[45]||(i[45]=l("ul",null,[l("li",null,"可以将程序及其依赖、运行环境一起打包为一个镜像，可以迁移到任意Linux操作系统"),l("li",null,"运行时利用沙箱机制形成隔离容器，各个应用互不干扰"),l("li",null,"启动、移除都可以通过一行命令完成，方便快捷")],-1)),i[46]||(i[46]=l("h3",{id:"_1-2-docker和虚拟机的区别",tabindex:"-1"},[s("1.2 Docker和虚拟机的区别 "),l("a",{class:"header-anchor",href:"#_1-2-docker和虚拟机的区别","aria-label":'Permalink to "1.2 Docker和虚拟机的区别"'},"​")],-1)),i[47]||(i[47]=l("p",null,"Docker可以让一个应用在任何操作系统中非常方便的运行。而以前我们接触的虚拟机，也能在一个操作系统中，运行另外一个操作系统，保护系统中的任何应用。",-1)),i[48]||(i[48]=l("p",null,"两者有什么差异呢？",-1)),i[49]||(i[49]=l("p",null,[l("strong",null,"虚拟机"),s("（virtual machine）是在操作系统中"),l("strong",null,"模拟"),s("硬件设备，然后运行另一个操作系统，比如在 Windows 系统里面运行 Ubuntu 系统，这样就可以运行任意的Ubuntu应用了。")],-1)),i[50]||(i[50]=l("p",null,[l("strong",null,"Docker"),s("仅仅是封装函数库，并没有模拟完整的操作系统，如图：")],-1)),i[51]||(i[51]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731145914960.png",alt:"image-20210731145914960",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[52]||(i[52]=l("p",null,"对比来看：",-1)),i[53]||(i[53]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731152243765.png",alt:"image-20210731152243765",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[54]||(i[54]=l("p",null,"小结：",-1)),i[55]||(i[55]=l("p",null,"Docker和虚拟机的差异：",-1)),i[56]||(i[56]=l("ul",null,[l("li",null,[l("p",null,"docker是一个系统进程；虚拟机是在操作系统中的操作系统")]),l("li",null,[l("p",null,"docker体积小、启动速度快、性能好；虚拟机体积大、启动速度慢、性能一般")])],-1)),i[57]||(i[57]=l("h3",{id:"_1-3-docker架构",tabindex:"-1"},[s("1.3 Docker架构 "),l("a",{class:"header-anchor",href:"#_1-3-docker架构","aria-label":'Permalink to "1.3 Docker架构"'},"​")],-1)),i[58]||(i[58]=l("h4",{id:"_1-3-1-镜像和容器",tabindex:"-1"},[s("1.3.1 镜像和容器 "),l("a",{class:"header-anchor",href:"#_1-3-1-镜像和容器","aria-label":'Permalink to "1.3.1 镜像和容器"'},"​")],-1)),i[59]||(i[59]=l("p",null,"Docker中有几个重要的概念：",-1)),i[60]||(i[60]=l("p",null,[l("strong",null,"镜像（Image）"),s("：Docker将应用程序及其所需的依赖、函数库、环境、配置等文件打包在一起，称为镜像。")],-1)),i[61]||(i[61]=l("p",null,[l("strong",null,"容器（Container）"),s("：镜像中的应用程序运行后形成的进程就是"),l("strong",null,"容器"),s("，只是Docker会给容器进程做隔离，对外不可见。")],-1)),i[62]||(i[62]=l("p",null,[s("一切应用最终都是代码组成，都是硬盘中的一个个的字节形成的"),l("strong",null,"文件"),s("。只有运行时，才会加载到内存，形成进程。")],-1)),i[63]||(i[63]=l("p",null,[s("而"),l("strong",null,"镜像"),s("，就是把一个应用在硬盘上的文件、及其运行环境、部分系统函数库文件一起打包形成的文件包。这个文件包是只读的。")],-1)),i[64]||(i[64]=l("p",null,[l("strong",null,"容器"),s("呢，就是将这些文件中编写的程序、函数加载到内存中允许，形成进程，只不过要隔离起来。因此一个镜像可以启动多次，形成多个容器进程。")],-1)),i[65]||(i[65]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731153059464.png",alt:"image-20210731153059464",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[66]||(i[66]=l("p",null,[s("例如你下载了一个QQ，如果我们将QQ在磁盘上的运行"),l("strong",null,"文件"),s("及其运行的操作系统依赖打包，形成QQ镜像。然后你可以启动多次，双开、甚至三开QQ，跟多个妹子聊天。")],-1)),i[67]||(i[67]=l("h4",{id:"_1-3-2-dockerhub",tabindex:"-1"},[s("1.3.2 DockerHub "),l("a",{class:"header-anchor",href:"#_1-3-2-dockerhub","aria-label":'Permalink to "1.3.2 DockerHub"'},"​")],-1)),i[68]||(i[68]=l("p",null,"开源应用程序非常多，打包这些应用往往是重复的劳动。为了避免这些重复劳动，人们就会将自己打包的应用镜像，例如Redis、MySQL镜像放到网络上，共享使用，就像GitHub的代码共享一样。",-1)),i[69]||(i[69]=l("ul",null,[l("li",null,[l("p",null,"DockerHub：DockerHub是一个官方的Docker镜像的托管平台。这样的平台称为Docker Registry。")]),l("li",null,[l("p",null,[s("国内也有类似于DockerHub 的公开服务，比如 "),l("a",{href:"https://c.163yun.com/hub",target:"_blank",rel:"noreferrer"},"网易云镜像服务"),s("、"),l("a",{href:"https://cr.console.aliyun.com/",target:"_blank",rel:"noreferrer"},"阿里云镜像库"),s("等。")])])],-1)),i[70]||(i[70]=l("p",null,"我们一方面可以将自己的镜像共享到DockerHub，另一方面也可以从DockerHub拉取镜像：",-1)),i[71]||(i[71]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731153743354.png",alt:"image-20210731153743354",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[72]||(i[72]=l("h4",{id:"_1-3-3-docker架构",tabindex:"-1"},[s("1.3.3 Docker架构 "),l("a",{class:"header-anchor",href:"#_1-3-3-docker架构","aria-label":'Permalink to "1.3.3 Docker架构"'},"​")],-1)),i[73]||(i[73]=l("p",null,"我们要使用Docker来操作镜像、容器，就必须要安装Docker。",-1)),i[74]||(i[74]=l("p",null,"Docker是一个CS架构的程序，由两部分组成：",-1)),i[75]||(i[75]=l("ul",null,[l("li",null,[l("p",null,"服务端(server)：Docker守护进程，负责处理Docker指令，管理镜像、容器等")]),l("li",null,[l("p",null,"客户端(client)：通过命令或RestAPI向Docker服务端发送指令。可以在本地或远程向服务端发送指令。")])],-1)),i[76]||(i[76]=l("p",null,"如图：",-1)),i[77]||(i[77]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731154257653.png",alt:"image-20210731154257653",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[78]||(i[78]=l("h4",{id:"_1-3-4-小结",tabindex:"-1"},[s("1.3.4 小结 "),l("a",{class:"header-anchor",href:"#_1-3-4-小结","aria-label":'Permalink to "1.3.4 小结"'},"​")],-1)),i[79]||(i[79]=l("blockquote",null,[l("ul",null,[l("li",null,[l("p",null,"镜像："),l("ul",null,[l("li",null,"将应用程序及其依赖、环境、配置打包在一起")])]),l("li",null,[l("p",null,"容器："),l("ul",null,[l("li",null,"镜像运行起来就是容器，一个镜像可以运行多个容器")])]),l("li",null,[l("p",null,"Docker结构："),l("ul",null,[l("li",null,[l("p",null,"服务端：接收命令或远程请求，操作镜像或容器"),l("p",null,"客户端：发送命令或者请求到Docker服务端")])])]),l("li",null,[l("p",null,"DockerHub："),l("ul",null,[l("li",null,"一个镜像托管的服务器，类似的还有阿里云镜像服务，统称为DockerRegistry")])])])],-1)),i[80]||(i[80]=l("h3",{id:"_1-4-安装docker",tabindex:"-1"},[s("1.4 安装Docker "),l("a",{class:"header-anchor",href:"#_1-4-安装docker","aria-label":'Permalink to "1.4 安装Docker"'},"​")],-1)),i[81]||(i[81]=l("p",null,"企业部署一般都是采用Linux操作系统，而其中又数CentOS发行版占比最多，因此我们在CentOS下安装Docker。",-1)),i[82]||(i[82]=l("p",null,"Docker 分为 CE 和 EE 两大版本。CE 即社区版（免费，支持周期 7 个月），EE 即企业版，强调安全，付费使用，支持周期 24 个月。",-1)),i[83]||(i[83]=l("p",null,[s("Docker CE 分为 "),l("code",null,"stable"),s(),l("code",null,"test"),s(" 和 "),l("code",null,"nightly"),s(" 三个更新频道。")],-1)),i[84]||(i[84]=l("p",null,[s("官方网站上有各种环境下的 "),l("a",{href:"https://docs.docker.com/install/",target:"_blank",rel:"noreferrer"},"安装指南"),s("，这里主要介绍 Docker CE 在 CentOS上的安装。")],-1)),i[85]||(i[85]=l("h4",{id:"centos安装docker",tabindex:"-1"},[s("CentOS安装Docker "),l("a",{class:"header-anchor",href:"#centos安装docker","aria-label":'Permalink to "CentOS安装Docker"'},"​")],-1)),i[86]||(i[86]=l("p",null,"Docker CE 支持 64 位版本 CentOS 7，并且要求内核版本不低于 3.10， CentOS 7 满足最低内核的要求，所以我们在CentOS 7安装Docker。",-1)),i[87]||(i[87]=l("h5",{id:"_1-卸载-可选",tabindex:"-1"},[s("1. 卸载（可选） "),l("a",{class:"header-anchor",href:"#_1-卸载-可选","aria-label":'Permalink to "1. 卸载（可选）"'},"​")],-1)),i[88]||(i[88]=l("p",null,"如果之前安装过旧版本的Docker，可以使用下面命令卸载：",-1)),i[89]||(i[89]=l("div",{class:"language-sh max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"sh"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"yum"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," remove"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," docker"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"                  docker-client"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"                  docker-client-latest"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"                  docker-common"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"                  docker-latest"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"                  docker-latest-logrotate"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"                  docker-logrotate"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"                  docker-selinux"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"                  docker-engine-selinux"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"                  docker-engine"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"                  docker-ce")])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[90]||(i[90]=l("h5",{id:"_2-安装docker",tabindex:"-1"},[s("2. 安装docker "),l("a",{class:"header-anchor",href:"#_2-安装docker","aria-label":'Permalink to "2. 安装docker"'},"​")],-1)),i[91]||(i[91]=l("p",null,"首先需要大家虚拟机联网，安装yum工具",-1)),i[92]||(i[92]=l("div",{class:"language-sh max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"sh"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"yum"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," install"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -y"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," yum-utils"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"           device-mapper-persistent-data"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"           lvm2"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --skip-broken")])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[93]||(i[93]=l("p",null,"然后更新本地镜像源：",-1)),i[94]||(i[94]=l("div",{class:"language-shell max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"shell"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 设置docker镜像源")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"yum-config-manager"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    --add-repo"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"    https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    ")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"sed"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -i"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 's/download.docker.com/mirrors.aliyun.com\\/docker-ce/g'"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /etc/yum.repos.d/docker-ce.repo")]),s(`
`),l("span",{class:"line"}),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"yum"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," makecache"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," fast")])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[95]||(i[95]=l("p",null,"然后输入命令：",-1)),i[96]||(i[96]=l("div",{class:"language-shell max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"shell"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"yum"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," install"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -y"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," docker-ce")])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[97]||(i[97]=l("p",null,"docker-ce为社区免费版本。稍等片刻，docker即可安装成功。",-1)),i[98]||(i[98]=l("h5",{id:"_3-启动docker",tabindex:"-1"},[s("3. 启动docker "),l("a",{class:"header-anchor",href:"#_3-启动docker","aria-label":'Permalink to "3. 启动docker"'},"​")],-1)),i[99]||(i[99]=l("p",null,"Docker应用需要用到各种端口，逐一去修改防火墙设置。非常麻烦，因此建议大家直接关闭防火墙！",-1)),i[100]||(i[100]=l("p",null,"启动docker前，一定要关闭防火墙后！！",-1)),i[101]||(i[101]=l("p",null,"启动docker前，一定要关闭防火墙后！！",-1)),i[102]||(i[102]=l("p",null,"启动docker前，一定要关闭防火墙后！！",-1)),i[103]||(i[103]=l("div",{class:"language-sh max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"sh"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 关闭")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"systemctl"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," stop"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," firewalld")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 禁止开机启动防火墙")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"systemctl"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," disable"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," firewalld")])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[104]||(i[104]=l("p",null,"通过命令启动docker：",-1)),i[105]||(i[105]=l("div",{class:"language-sh max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"sh"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"systemctl"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," start"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," docker"),l("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  # 启动docker服务")]),s(`
`),l("span",{class:"line"}),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"systemctl"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," stop"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," docker"),l("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  # 停止docker服务")]),s(`
`),l("span",{class:"line"}),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"systemctl"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," restart"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," docker"),l("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  # 重启docker服务")]),s(`
`),l("span",{class:"line"}),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"systemctl"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," enable"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," docker"),l("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," # 开机自启")])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[106]||(i[106]=l("p",null,"然后输入命令，可以查看docker版本：",-1)),i[107]||(i[107]=l("div",{class:"language-sh max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"sh"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -v")])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[108]||(i[108]=l("p",null,"如图：",-1)),i[109]||(i[109]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210418154704436.png",alt:"image-20210418154704436",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[110]||(i[110]=l("h5",{id:"_4-配置镜像加速",tabindex:"-1"},[s("4. 配置镜像加速 "),l("a",{class:"header-anchor",href:"#_4-配置镜像加速","aria-label":'Permalink to "4. 配置镜像加速"'},"​")],-1)),i[111]||(i[111]=l("p",null,"docker官方镜像仓库网速较差，我们需要设置国内镜像服务：",-1)),i[112]||(i[112]=l("p",null,[s("参考阿里云的镜像加速文档："),l("a",{href:"https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors",target:"_blank",rel:"noreferrer"},"https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors")],-1)),i[113]||(i[113]=l("hr",null,null,-1)),i[114]||(i[114]=l("h2",{id:"_2-docker的基本操作",tabindex:"-1"},[s("2.Docker的基本操作 "),l("a",{class:"header-anchor",href:"#_2-docker的基本操作","aria-label":'Permalink to "2.Docker的基本操作"'},"​")],-1)),i[115]||(i[115]=l("h3",{id:"_2-1-镜像操作",tabindex:"-1"},[s("2.1.镜像操作 "),l("a",{class:"header-anchor",href:"#_2-1-镜像操作","aria-label":'Permalink to "2.1.镜像操作"'},"​")],-1)),i[116]||(i[116]=l("h4",{id:"_2-1-1-镜像名称",tabindex:"-1"},[s("2.1.1 镜像名称 "),l("a",{class:"header-anchor",href:"#_2-1-1-镜像名称","aria-label":'Permalink to "2.1.1 镜像名称"'},"​")],-1)),i[117]||(i[117]=l("p",null,"首先来看下镜像的名称组成：",-1)),i[118]||(i[118]=l("ul",null,[l("li",null,"镜名称一般分两部分组成：[repository]:[tag]。"),l("li",null,"在没有指定tag时，默认是latest，代表最新版本的镜像")],-1)),i[119]||(i[119]=l("p",null,"如图：",-1)),i[120]||(i[120]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731155141362.png",alt:"image-20210731155141362",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[121]||(i[121]=l("p",null,"这里的mysql就是repository，5.7就是tag，合一起就是镜像名称，代表5.7版本的MySQL镜像。",-1)),i[122]||(i[122]=l("h4",{id:"_2-1-2-镜像命令",tabindex:"-1"},[s("2.1.2 镜像命令 "),l("a",{class:"header-anchor",href:"#_2-1-2-镜像命令","aria-label":'Permalink to "2.1.2 镜像命令"'},"​")],-1)),i[123]||(i[123]=l("p",null,"常见的镜像操作命令如图：",-1)),i[124]||(i[124]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731155649535.png",alt:"image-20210731155649535",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[125]||(i[125]=l("h4",{id:"_2-1-3-案例1-拉取、查看镜像",tabindex:"-1"},[s("2.1.3 案例1-拉取、查看镜像 "),l("a",{class:"header-anchor",href:"#_2-1-3-案例1-拉取、查看镜像","aria-label":'Permalink to "2.1.3 案例1-拉取、查看镜像"'},"​")],-1)),i[126]||(i[126]=l("p",null,"需求：从DockerHub中拉取一个nginx镜像并查看",-1)),i[127]||(i[127]=l("p",null,[s("1）首先去镜像仓库搜索nginx镜像，比如"),l("a",{href:"https://hub.docker.com/",target:"_blank",rel:"noreferrer"},"DockerHub"),s(":")],-1)),i[128]||(i[128]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731155844368.png",alt:"image-20210731155844368",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[129]||(i[129]=l("p",null,"2）根据查看到的镜像名称，拉取自己需要的镜像，通过命令：docker pull nginx",-1)),i[130]||(i[130]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731155856199.png",alt:"image-20210731155856199",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[131]||(i[131]=l("p",null,"3）通过命令：docker images 查看拉取到的镜像",-1)),i[132]||(i[132]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731155903037.png",alt:"image-20210731155903037",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[133]||(i[133]=l("h4",{id:"_2-1-4-案例2-保存、导入镜像",tabindex:"-1"},[s("2.1.4 案例2-保存、导入镜像 "),l("a",{class:"header-anchor",href:"#_2-1-4-案例2-保存、导入镜像","aria-label":'Permalink to "2.1.4 案例2-保存、导入镜像"'},"​")],-1)),i[134]||(i[134]=l("p",null,"需求：利用docker save将nginx镜像导出磁盘，然后再通过load加载回来",-1)),i[135]||(i[135]=l("p",null,"1）利用docker xx --help命令查看docker save和docker load的语法",-1)),i[136]||(i[136]=l("p",null,"例如，查看save命令用法，可以输入命令：",-1)),i[137]||(i[137]=l("div",{class:"language-sh max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"sh"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," save"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --help")])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[138]||(i[138]=l("p",null,"结果：",-1)),i[139]||(i[139]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731161104732.png",alt:"image-20210731161104732",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[140]||(i[140]=l("p",null,"命令格式：",-1)),i[141]||(i[141]=l("div",{class:"language-shell max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"shell"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," save"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -o"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," [保存的目标文件名称] [镜像名称]")])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[142]||(i[142]=l("p",null,"2）使用docker save导出镜像到磁盘",-1)),i[143]||(i[143]=l("p",null,"运行命令：",-1)),i[144]||(i[144]=l("div",{class:"language-sh max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"sh"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," save"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -o"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," nginx.tar"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," nginx:latest")])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[145]||(i[145]=l("p",null,"结果如图：",-1)),i[146]||(i[146]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731161354344.png",alt:"image-20210731161354344",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[147]||(i[147]=l("p",null,"3）使用docker load加载镜像",-1)),i[148]||(i[148]=l("p",null,"先删除本地的nginx镜像：",-1)),i[149]||(i[149]=l("div",{class:"language-sh max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"sh"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," rmi"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," nginx:latest")])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[150]||(i[150]=l("p",null,"然后运行命令，加载本地文件：",-1)),i[151]||(i[151]=l("div",{class:"language-sh max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"sh"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," load"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -i"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," nginx.tar")])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[152]||(i[152]=l("p",null,"结果：",-1)),i[153]||(i[153]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731161746245.png",alt:"image-20210731161746245",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[154]||(i[154]=l("h4",{id:"_2-1-5-练习",tabindex:"-1"},[s("2.1.5 练习 "),l("a",{class:"header-anchor",href:"#_2-1-5-练习","aria-label":'Permalink to "2.1.5 练习"'},"​")],-1)),i[155]||(i[155]=l("p",null,"需求：去DockerHub搜索并拉取一个Redis镜像",-1)),i[156]||(i[156]=l("p",null,"目标：",-1)),i[157]||(i[157]=l("p",null,"1）去DockerHub搜索Redis镜像",-1)),i[158]||(i[158]=l("p",null,"2）查看Redis镜像的名称和版本",-1)),i[159]||(i[159]=l("p",null,"3）利用docker pull命令拉取镜像",-1)),i[160]||(i[160]=l("p",null,"4）利用docker save命令将 redis:latest打包为一个redis.tar包",-1)),i[161]||(i[161]=l("p",null,"5）利用docker rmi 删除本地的redis:latest",-1)),i[162]||(i[162]=l("p",null,"6）利用docker load 重新加载 redis.tar文件",-1)),i[163]||(i[163]=l("h3",{id:"_2-2-容器操作",tabindex:"-1"},[s("2.2 容器操作 "),l("a",{class:"header-anchor",href:"#_2-2-容器操作","aria-label":'Permalink to "2.2 容器操作"'},"​")],-1)),i[164]||(i[164]=l("h4",{id:"_2-2-1-容器相关命令",tabindex:"-1"},[s("2.2.1 容器相关命令 "),l("a",{class:"header-anchor",href:"#_2-2-1-容器相关命令","aria-label":'Permalink to "2.2.1 容器相关命令"'},"​")],-1)),i[165]||(i[165]=l("p",null,"容器操作的命令如图：",-1)),i[166]||(i[166]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731161950495.png",alt:"image-20210731161950495",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[167]||(i[167]=l("p",null,"容器保护三个状态：",-1)),i[168]||(i[168]=l("ul",null,[l("li",null,"运行：进程正常运行"),l("li",null,"暂停：进程暂停，CPU不再运行，并不释放内存"),l("li",null,"停止：进程终止，回收进程占用的内存、CPU等资源")],-1)),i[169]||(i[169]=l("p",null,"其中：",-1)),i[170]||(i[170]=l("ul",null,[l("li",null,[l("p",null,"docker run：创建并运行一个容器，处于运行状态")]),l("li",null,[l("p",null,"docker pause：让一个运行的容器暂停")]),l("li",null,[l("p",null,"docker unpause：让一个容器从暂停状态恢复运行")]),l("li",null,[l("p",null,"docker stop：停止一个运行的容器")]),l("li",null,[l("p",null,"docker start：让一个停止的容器再次运行")]),l("li",null,[l("p",null,"docker rm：删除一个容器")])],-1)),i[171]||(i[171]=l("h4",{id:"_2-2-2-案例-创建并运行一个容器",tabindex:"-1"},[s("2.2.2 案例-创建并运行一个容器 "),l("a",{class:"header-anchor",href:"#_2-2-2-案例-创建并运行一个容器","aria-label":'Permalink to "2.2.2 案例-创建并运行一个容器"'},"​")],-1)),i[172]||(i[172]=l("p",null,"创建并运行nginx容器的命令：",-1)),i[173]||(i[173]=l("div",{class:"language-sh max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"sh"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," run"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --name"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," containerName"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -p"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 80:80"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -d"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," nginx")])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[174]||(i[174]=l("p",null,"命令解读：",-1)),i[175]||(i[175]=l("ul",null,[l("li",null,"docker run ：创建并运行一个容器"),l("li",null,"–name : 给容器起一个名字，比如叫做mn"),l("li",null,"-p ：将宿主机端口与容器端口映射，冒号左侧是宿主机端口，右侧是容器端口"),l("li",null,"-d：后台运行容器"),l("li",null,"nginx：镜像名称，例如nginx")],-1)),i[176]||(i[176]=l("p",null,[s("这里的"),l("code",null,"-p"),s("参数，是将容器端口映射到宿主机端口。")],-1)),i[177]||(i[177]=l("p",null,"默认情况下，容器是隔离环境，我们直接访问宿主机的80端口，肯定访问不到容器中的nginx。",-1)),i[178]||(i[178]=l("p",null,"现在，将容器的80与宿主机的80关联起来，当我们访问宿主机的80端口时，就会被映射到容器的80，这样就能访问到nginx了：",-1)),i[179]||(i[179]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731163255863.png",alt:"image-20210731163255863",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[180]||(i[180]=l("h4",{id:"_2-2-3-案例-进入容器-修改文件",tabindex:"-1"},[s("2.2.3 案例-进入容器，修改文件 "),l("a",{class:"header-anchor",href:"#_2-2-3-案例-进入容器-修改文件","aria-label":'Permalink to "2.2.3 案例-进入容器，修改文件"'},"​")],-1)),i[181]||(i[181]=l("p",null,[l("strong",null,"需求"),s("：进入Nginx容器，修改HTML文件内容，添加“传智教育欢迎您”")],-1)),i[182]||(i[182]=l("p",null,[l("strong",null,"提示"),s("：进入容器要用到docker exec命令。")],-1)),i[183]||(i[183]=l("p",null,[l("strong",null,"步骤"),s("：")],-1)),i[184]||(i[184]=l("p",null,"1）进入容器。进入我们刚刚创建的nginx容器的命令为：",-1)),i[185]||(i[185]=l("div",{class:"language-sh max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"sh"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," exec"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -it"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," mn"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," bash")])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[186]||(i[186]=l("p",null,"命令解读：",-1)),i[187]||(i[187]=l("ul",null,[l("li",null,[l("p",null,"docker exec ：进入容器内部，执行一个命令")]),l("li",null,[l("p",null,"-it : 给当前进入的容器创建一个标准输入、输出终端，允许我们与容器交互")]),l("li",null,[l("p",null,"mn ：要进入的容器的名称")]),l("li",null,[l("p",null,"bash：进入容器后执行的命令，bash是一个linux终端交互命令")])],-1)),i[188]||(i[188]=l("p",null,"2）进入nginx的HTML所在目录 /usr/share/nginx/html",-1)),i[189]||(i[189]=l("p",null,"容器内部会模拟一个独立的Linux文件系统，看起来如同一个linux服务器一样：",-1)),i[190]||(i[190]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731164159811.png",alt:"image-20210731164159811",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[191]||(i[191]=l("p",null,"nginx的环境、配置、运行文件全部都在这个文件系统中，包括我们要修改的html文件。",-1)),i[192]||(i[192]=l("p",null,[s("查看DockerHub网站中的nginx页面，可以知道nginx的html目录位置在"),l("code",null,"/usr/share/nginx/html")],-1)),i[193]||(i[193]=l("p",null,"我们执行命令，进入该目录：",-1)),i[194]||(i[194]=l("div",{class:"language-sh max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"sh"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"cd"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /usr/share/nginx/html")])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[195]||(i[195]=l("p",null,"查看目录下文件：",-1)),i[196]||(i[196]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731164455818.png",alt:"image-20210731164455818",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[197]||(i[197]=l("p",null,"3）修改index.html的内容",-1)),i[198]||(i[198]=l("p",null,"容器内没有vi命令，无法直接修改，我们用下面的命令来修改：",-1)),i[199]||(i[199]=l("div",{class:"language-sh max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"sh"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"sed"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -i"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -e"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 's#Welcome to nginx#传智教育欢迎您#g'"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -e"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},` 's#<head>#<head><meta charset="utf-8">#g'`),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," index.html")])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[200]||(i[200]=l("p",null,[s("在浏览器访问自己的虚拟机地址，例如我的是："),l("a",{href:"http://192.168.150.101",target:"_blank",rel:"noreferrer"},"http://192.168.150.101"),s("，即可看到结果：")],-1)),i[201]||(i[201]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731164717604.png",alt:"image-20210731164717604",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[202]||(i[202]=l("h4",{id:"_2-2-4-小结",tabindex:"-1"},[s("2.2.4 小结 "),l("a",{class:"header-anchor",href:"#_2-2-4-小结","aria-label":'Permalink to "2.2.4 小结"'},"​")],-1)),i[203]||(i[203]=l("p",null,"docker run命令的常见参数有哪些？",-1)),i[204]||(i[204]=l("ul",null,[l("li",null,"–name：指定容器名称"),l("li",null,"-p：指定端口映射"),l("li",null,"-d：让容器后台运行")],-1)),i[205]||(i[205]=l("p",null,"查看容器日志的命令：",-1)),i[206]||(i[206]=l("ul",null,[l("li",null,"docker logs"),l("li",null,"添加 -f 参数可以持续查看日志")],-1)),i[207]||(i[207]=l("p",null,"查看容器状态：",-1)),i[208]||(i[208]=l("ul",null,[l("li",null,"docker ps"),l("li",null,"docker ps -a 查看所有容器，包括已经停止的")],-1)),i[209]||(i[209]=l("h3",{id:"_2-3-数据卷-容器数据管理",tabindex:"-1"},[s("2.3 数据卷（容器数据管理） "),l("a",{class:"header-anchor",href:"#_2-3-数据卷-容器数据管理","aria-label":'Permalink to "2.3 数据卷（容器数据管理）"'},"​")],-1)),i[210]||(i[210]=l("p",null,"在之前的nginx案例中，修改nginx的html页面时，需要进入nginx内部。并且因为没有编辑器，修改文件也很麻烦。",-1)),i[211]||(i[211]=l("p",null,"这就是因为容器与数据（容器内文件）耦合带来的后果。",-1)),i[212]||(i[212]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731172440275.png",alt:"image-20210731172440275",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[213]||(i[213]=l("p",null,"要解决这个问题，必须将数据与容器解耦，这就要用到数据卷了。",-1)),i[214]||(i[214]=l("h4",{id:"_2-3-1-什么是数据卷",tabindex:"-1"},[s("2.3.1 什么是数据卷 "),l("a",{class:"header-anchor",href:"#_2-3-1-什么是数据卷","aria-label":'Permalink to "2.3.1 什么是数据卷"'},"​")],-1)),i[215]||(i[215]=l("p",null,"**数据卷（volume）**是一个虚拟目录，指向宿主机文件系统中的某个目录。",-1)),i[216]||(i[216]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731173541846.png",alt:"image-20210731173541846",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[217]||(i[217]=l("p",null,"一旦完成数据卷挂载，对容器的一切操作都会作用在数据卷对应的宿主机目录了。",-1)),i[218]||(i[218]=l("p",null,"这样，我们操作宿主机的/var/lib/docker/volumes/html目录，就等于操作容器内的/usr/share/nginx/html目录了",-1)),i[219]||(i[219]=l("h4",{id:"_2-3-2-数据集操作命令",tabindex:"-1"},[s("2.3.2 数据集操作命令 "),l("a",{class:"header-anchor",href:"#_2-3-2-数据集操作命令","aria-label":'Permalink to "2.3.2 数据集操作命令"'},"​")],-1)),i[220]||(i[220]=l("p",null,"数据卷操作的基本语法如下：",-1)),i[221]||(i[221]=l("div",{class:"language-sh max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"sh"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," volume"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," [COMMAND]")])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[222]||(i[222]=l("p",null,"docker volume命令是数据卷操作，根据命令后跟随的command来确定下一步的操作：",-1)),i[223]||(i[223]=l("ul",null,[l("li",null,"create 创建一个volume"),l("li",null,"inspect 显示一个或多个volume的信息"),l("li",null,"ls 列出所有的volume"),l("li",null,"prune 删除未使用的volume"),l("li",null,"rm 删除一个或多个指定的volume")],-1)),i[224]||(i[224]=l("h4",{id:"_2-3-3-创建和查看数据卷",tabindex:"-1"},[s("2.3.3 创建和查看数据卷 "),l("a",{class:"header-anchor",href:"#_2-3-3-创建和查看数据卷","aria-label":'Permalink to "2.3.3 创建和查看数据卷"'},"​")],-1)),i[225]||(i[225]=l("p",null,[l("strong",null,"需求"),s("：创建一个数据卷，并查看数据卷在宿主机的目录位置")],-1)),i[226]||(i[226]=l("p",null,"① 创建数据卷",-1)),i[227]||(i[227]=l("div",{class:"language-sh max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"sh"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," volume"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," create"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," html")])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[228]||(i[228]=l("p",null,"② 查看所有数据",-1)),i[229]||(i[229]=l("div",{class:"language-sh max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"sh"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," volume"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ls")])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[230]||(i[230]=l("p",null,"结果：",-1)),i[231]||(i[231]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731173746910.png",alt:"image-20210731173746910",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[232]||(i[232]=l("p",null,"③ 查看数据卷详细信息卷",-1)),i[233]||(i[233]=l("div",{class:"language-sh max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"sh"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," volume"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," inspect"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," html")])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[234]||(i[234]=l("p",null,"结果：",-1)),i[235]||(i[235]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731173809877.png",alt:"image-20210731173809877",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[236]||(i[236]=l("p",null,[s("可以看到，我们创建的html这个数据卷关联的宿主机目录为"),l("code",null,"/var/lib/docker/volumes/html/_data"),s("目录。")],-1)),i[237]||(i[237]=l("p",null,[l("strong",null,"小结"),s("：")],-1)),i[238]||(i[238]=l("p",null,"数据卷的作用：",-1)),i[239]||(i[239]=l("ul",null,[l("li",null,"将容器与数据分离，解耦合，方便操作容器内数据，保证数据安全")],-1)),i[240]||(i[240]=l("p",null,"数据卷操作：",-1)),i[241]||(i[241]=l("ul",null,[l("li",null,"docker volume create：创建数据卷"),l("li",null,"docker volume ls：查看所有数据卷"),l("li",null,"docker volume inspect：查看数据卷详细信息，包括关联的宿主机目录位置"),l("li",null,"docker volume rm：删除指定数据卷"),l("li",null,"docker volume prune：删除所有未使用的数据卷")],-1)),i[242]||(i[242]=l("h4",{id:"_2-3-4-挂载数据卷",tabindex:"-1"},[s("2.3.4 挂载数据卷 "),l("a",{class:"header-anchor",href:"#_2-3-4-挂载数据卷","aria-label":'Permalink to "2.3.4 挂载数据卷"'},"​")],-1)),i[243]||(i[243]=l("p",null,"我们在创建容器时，可以通过 -v 参数来挂载一个数据卷到某个容器内目录，命令格式如下：",-1)),i[244]||(i[244]=l("div",{class:"language-sh max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"sh"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," run"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"  --name"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," mn"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"  -v"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," html:/root/html"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"  -p"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 8080:80")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  nginx"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[245]||(i[245]=l("p",null,"这里的-v就是挂载数据卷的命令：",-1)),i[246]||(i[246]=l("ul",null,[l("li",null,[l("code",null,"-v html:/root/htm"),s(" ：把html数据卷挂载到容器内的/root/html这个目录中")])],-1)),i[247]||(i[247]=l("h4",{id:"_2-3-5-案例-给nginx挂载数据卷",tabindex:"-1"},[s("2.3.5 案例-给nginx挂载数据卷 "),l("a",{class:"header-anchor",href:"#_2-3-5-案例-给nginx挂载数据卷","aria-label":'Permalink to "2.3.5 案例-给nginx挂载数据卷"'},"​")],-1)),i[248]||(i[248]=l("p",null,[l("strong",null,"需求"),s("：创建一个nginx容器，修改容器内的html目录内的index.html内容")],-1)),i[249]||(i[249]=l("p",null,[l("strong",null,"分析"),s("：上个案例中，我们进入nginx容器内部，已经知道nginx的html目录所在位置/usr/share/nginx/html ，我们需要把这个目录挂载到html这个数据卷上，方便操作其中的内容。")],-1)),i[250]||(i[250]=l("p",null,[l("strong",null,"提示"),s("：运行容器时使用 -v 参数挂载数据卷")],-1)),i[251]||(i[251]=l("p",null,"步骤：",-1)),i[252]||(i[252]=l("p",null,"① 创建容器并挂载数据卷到容器内的HTML目录",-1)),i[253]||(i[253]=l("div",{class:"language-sh max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"sh"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," run"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --name"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," mn"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -v"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," html:/usr/share/nginx/html"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -p"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 80:80"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -d"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," nginx")])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[254]||(i[254]=l("p",null,"② 进入html数据卷所在位置，并修改HTML内容",-1)),i[255]||(i[255]=l("div",{class:"language-sh max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"sh"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 查看html数据卷的位置")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," volume"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," inspect"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," html")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 进入该目录")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"cd"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /var/lib/docker/volumes/html/_data")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 修改文件")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"vi"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," index.html")])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[256]||(i[256]=l("h4",{id:"_2-3-6-案例-给mysql挂载本地目录",tabindex:"-1"},[s("2.3.6 案例-给MySQL挂载本地目录 "),l("a",{class:"header-anchor",href:"#_2-3-6-案例-给mysql挂载本地目录","aria-label":'Permalink to "2.3.6 案例-给MySQL挂载本地目录"'},"​")],-1)),i[257]||(i[257]=l("p",null,"容器不仅仅可以挂载数据卷，也可以直接挂载到宿主机目录上。关联关系如下：",-1)),i[258]||(i[258]=l("ul",null,[l("li",null,"带数据卷模式：宿主机目录 --> 数据卷 —> 容器内目录"),l("li",null,"直接挂载模式：宿主机目录 —> 容器内目录")],-1)),i[259]||(i[259]=l("p",null,"如图：",-1)),i[260]||(i[260]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731175155453.png",alt:"image-20210731175155453",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[261]||(i[261]=l("p",null,[l("strong",null,"语法"),s("：")],-1)),i[262]||(i[262]=l("p",null,"目录挂载与数据卷挂载的语法是类似的：",-1)),i[263]||(i[263]=l("ul",null,[l("li",null,"-v [宿主机目录]:[容器内目录]"),l("li",null,"-v [宿主机文件]:[容器内文件]")],-1)),i[264]||(i[264]=l("p",null,[l("strong",null,"需求"),s("：创建并运行一个MySQL容器，将宿主机目录直接挂载到容器")],-1)),i[265]||(i[265]=l("p",null,"实现思路如下：",-1)),i[266]||(i[266]=l("p",null,"1）在将课前资料中的mysql.tar文件上传到虚拟机，通过load命令加载为镜像",-1)),i[267]||(i[267]=l("p",null,"2）创建目录/tmp/mysql/data",-1)),i[268]||(i[268]=l("p",null,"3）创建目录/tmp/mysql/conf，将课前资料提供的hmy.cnf文件上传到/tmp/mysql/conf",-1)),i[269]||(i[269]=l("p",null,"4）去DockerHub查阅资料，创建并运行MySQL容器，要求：",-1)),i[270]||(i[270]=l("p",null,"① 挂载/tmp/mysql/data到mysql容器内数据存储目录",-1)),i[271]||(i[271]=l("p",null,"② 挂载/tmp/mysql/conf/hmy.cnf到mysql容器的配置文件",-1)),i[272]||(i[272]=l("p",null,"③ 设置MySQL密码",-1)),i[273]||(i[273]=l("h4",{id:"_2-3-7-小结",tabindex:"-1"},[s("2.3.7 小结 "),l("a",{class:"header-anchor",href:"#_2-3-7-小结","aria-label":'Permalink to "2.3.7 小结"'},"​")],-1)),i[274]||(i[274]=l("p",null,"docker run的命令中通过 -v 参数挂载文件或目录到容器中：",-1)),i[275]||(i[275]=l("ul",null,[l("li",null,"-v volume名称:容器内目录"),l("li",null,"-v 宿主机文件:容器内文"),l("li",null,"-v 宿主机目录:容器内目录")],-1)),i[276]||(i[276]=l("p",null,"数据卷挂载与目录直接挂载的",-1)),i[277]||(i[277]=l("ul",null,[l("li",null,"数据卷挂载耦合度低，由docker来管理目录，但是目录较深，不好找"),l("li",null,"目录挂载耦合度高，需要我们自己管理目录，不过目录容易寻找查看")],-1)),i[278]||(i[278]=l("hr",null,null,-1)),i[279]||(i[279]=l("h2",{id:"_3-dockerfile自定义镜像",tabindex:"-1"},[s("3. Dockerfile自定义镜像 "),l("a",{class:"header-anchor",href:"#_3-dockerfile自定义镜像","aria-label":'Permalink to "3. Dockerfile自定义镜像"'},"​")],-1)),i[280]||(i[280]=l("p",null,"常见的镜像在DockerHub就能找到，但是我们自己写的项目就必须自己构建镜像了。",-1)),i[281]||(i[281]=l("p",null,"而要自定义镜像，就必须先了解镜像的结构才行。",-1)),i[282]||(i[282]=l("h3",{id:"_3-1-镜像结构",tabindex:"-1"},[s("3.1 镜像结构 "),l("a",{class:"header-anchor",href:"#_3-1-镜像结构","aria-label":'Permalink to "3.1 镜像结构"'},"​")],-1)),i[283]||(i[283]=l("p",null,"镜像是将应用程序及其需要的系统函数库、环境、配置、依赖打包而成。",-1)),i[284]||(i[284]=l("p",null,"我们以MySQL为例，来看看镜像的组成结构：",-1)),i[285]||(i[285]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731175806273.png",alt:"image-20210731175806273",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[286]||(i[286]=l("p",null,"简单来说，镜像就是在系统函数库、运行环境基础上，添加应用程序文件、配置文件、依赖文件等组合，然后编写好启动脚本打包在一起形成的文件。",-1)),i[287]||(i[287]=l("p",null,"我们要构建镜像，其实就是实现上述打包的过程。",-1)),i[288]||(i[288]=l("h3",{id:"_3-2-dockerfile语法",tabindex:"-1"},[s("3.2 Dockerfile语法 "),l("a",{class:"header-anchor",href:"#_3-2-dockerfile语法","aria-label":'Permalink to "3.2 Dockerfile语法"'},"​")],-1)),i[289]||(i[289]=l("p",null,"构建自定义的镜像时，并不需要一个个文件去拷贝，打包。",-1)),i[290]||(i[290]=l("p",null,"我们只需要告诉Docker，我们的镜像的组成，需要哪些BaseImage、需要拷贝什么文件、需要安装什么依赖、启动脚本是什么，将来Docker会帮助我们构建镜像。",-1)),i[291]||(i[291]=l("p",null,"而描述上述信息的文件就是Dockerfile文件。",-1)),i[292]||(i[292]=l("p",null,[l("strong",null,"Dockerfile"),s("就是一个文本文件，其中包含一个个的"),l("strong",null,"指令(Instruction)"),s("，用指令来说明要执行什么操作来构建镜像。每一个指令都会形成一层Layer。")],-1)),i[293]||(i[293]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731180321133.png",alt:"image-20210731180321133",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[294]||(i[294]=l("p",null,[s("更新详细语法说明，请参考官网文档： "),l("a",{href:"https://docs.docker.com/engine/reference/builder",target:"_blank",rel:"noreferrer"},"https://docs.docker.com/engine/reference/builder")],-1)),i[295]||(i[295]=l("h3",{id:"_3-3-构建java项目",tabindex:"-1"},[s("3.3 构建Java项目 "),l("a",{class:"header-anchor",href:"#_3-3-构建java项目","aria-label":'Permalink to "3.3 构建Java项目"'},"​")],-1)),i[296]||(i[296]=l("h4",{id:"_3-3-1-基于ubuntu构建java项目",tabindex:"-1"},[s("3.3.1 基于Ubuntu构建Java项目 "),l("a",{class:"header-anchor",href:"#_3-3-1-基于ubuntu构建java项目","aria-label":'Permalink to "3.3.1 基于Ubuntu构建Java项目"'},"​")],-1)),i[297]||(i[297]=l("p",null,"需求：基于Ubuntu镜像构建一个新镜像，运行一个java项目",-1)),i[298]||(i[298]=l("ul",null,[l("li",null,[l("p",null,"步骤1：新建一个空文件夹docker-demo"),l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210801101207444.png",alt:"image-20210801101207444",loading:"lazy",decoding:"async",class:"lazy"})])]),l("li",null,[l("p",null,"步骤2：拷贝课前资料中的docker-demo.jar文件到docker-demo这个目录"),l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210801101314816.png",alt:"image-20210801101314816",loading:"lazy",decoding:"async",class:"lazy"})])]),l("li",null,[l("p",null,"步骤3：拷贝课前资料中的jdk8.tar.gz文件到docker-demo这个目录"),l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210801101410200.png",alt:"image-20210801101410200",loading:"lazy",decoding:"async",class:"lazy"})])]),l("li",null,[l("p",null,"步骤4：拷贝课前资料提供的Dockerfile到docker-demo这个目录"),l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210801101455590.png",alt:"image-20210801101455590",loading:"lazy",decoding:"async",class:"lazy"})]),l("p",null,"其中的内容如下："),l("div",{class:"language-dockerfile max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"dockerfile"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 指定基础镜像")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"FROM"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ubuntu:16.04")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 配置环境变量，JDK的安装目录")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ENV"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," JAVA_DIR=/usr/local")]),s(`
`),l("span",{class:"line"}),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 拷贝jdk和java项目的包")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"COPY"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ./jdk8.tar.gz $JAVA_DIR/")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"COPY"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ./docker-demo.jar /tmp/app.jar")]),s(`
`),l("span",{class:"line"}),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 安装JDK")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RUN"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," cd $JAVA_DIR \\")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," && tar -xf ./jdk8.tar.gz \\")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," && mv ./jdk1.8.0_144 ./java8")]),s(`
`),l("span",{class:"line"}),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 配置环境变量")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ENV"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," JAVA_HOME=$JAVA_DIR/java8")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ENV"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," PATH=$PATH:$JAVA_HOME/bin")]),s(`
`),l("span",{class:"line"}),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 暴露端口")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"EXPOSE"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," 8090")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 入口，java项目的启动命令")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ENTRYPOINT"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," java -jar /tmp/app.jar")])])]),l("button",{class:"code-block-unfold-btn"})])]),l("li",null,[l("p",null,"步骤5：进入docker-demo"),l("p",null,"将准备好的docker-demo上传到虚拟机任意目录，然后进入docker-demo目录下")]),l("li",null,[l("p",null,"步骤6：运行命令："),l("div",{class:"language-sh max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"sh"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," build"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -t"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," javaweb:1.0"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," .")])])]),l("button",{class:"code-block-unfold-btn"})])])],-1)),i[299]||(i[299]=l("p",null,[s("最后访问 "),l("a",{href:"http://192.168.150.101:8090/hello/count%EF%BC%8C%E5%85%B6%E4%B8%AD%E7%9A%84ip%E6%94%B9%E6%88%90%E4%BD%A0%E7%9A%84%E8%99%9A%E6%8B%9F%E6%9C%BAip",target:"_blank",rel:"noreferrer"},"http://192.168.150.101:8090/hello/count，其中的ip改成你的虚拟机ip")],-1)),i[300]||(i[300]=l("h4",{id:"_3-3-2-基于java8构建java项目",tabindex:"-1"},[s("3.3.2 基于java8构建Java项目 "),l("a",{class:"header-anchor",href:"#_3-3-2-基于java8构建java项目","aria-label":'Permalink to "3.3.2 基于java8构建Java项目"'},"​")],-1)),i[301]||(i[301]=l("p",null,"虽然我们可以基于Ubuntu基础镜像，添加任意自己需要的安装包，构建镜像，但是却比较麻烦。所以大多数情况下，我们都可以在一些安装了部分软件的基础镜像上做改造。",-1)),i[302]||(i[302]=l("p",null,"例如，构建java项目的镜像，可以在已经准备了JDK的基础镜像基础上构建。",-1)),i[303]||(i[303]=l("p",null,"需求：基于java:8-alpine镜像，将一个Java项目构建为镜像",-1)),i[304]||(i[304]=l("p",null,"实现思路如下：",-1)),i[305]||(i[305]=l("ul",null,[l("li",null,[l("p",null,"① 新建一个空的目录，然后在目录中新建一个文件，命名为Dockerfile")]),l("li",null,[l("p",null,"② 拷贝课前资料提供的docker-demo.jar到这个目录中")]),l("li",null,[l("p",null,"③ 编写Dockerfile文件："),l("ul",null,[l("li",null,[l("p",null,"a ）基于java:8-alpine作为基础镜像")]),l("li",null,[l("p",null,"b ）将app.jar拷贝到镜像中")]),l("li",null,[l("p",null,"c ）暴露端口")]),l("li",null,[l("p",null,"d ）编写入口ENTRYPOINT"),l("p",null,"内容如下："),l("div",{class:"language-dockerfile max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"dockerfile"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"FROM"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," java:8-alpine")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"COPY"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ./app.jar /tmp/app.jar")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"EXPOSE"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," 8090")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ENTRYPOINT"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," java -jar /tmp/app.jar")])])]),l("button",{class:"code-block-unfold-btn"})])])])]),l("li",null,[l("p",null,"④ 使用docker build命令构建镜像")]),l("li",null,[l("p",null,"⑤ 使用docker run创建容器并运行")])],-1)),i[306]||(i[306]=l("h3",{id:"_3-4-小结",tabindex:"-1"},[s("3.4 小结 "),l("a",{class:"header-anchor",href:"#_3-4-小结","aria-label":'Permalink to "3.4 小结"'},"​")],-1)),i[307]||(i[307]=l("blockquote",null,[l("ol",null,[l("li",null,[l("p",null,"Dockerfile的本质是一个文件，通过指令描述镜像的构建过程")]),l("li",null,[l("p",null,"Dockerfile的第一行必须是FROM，从一个基础镜像来构建")]),l("li",null,[l("p",null,"基础镜像可以是基本操作系统，如Ubuntu。也可以是其他人制作好的镜像，例如：java:8-alpine")])])],-1)),i[308]||(i[308]=l("hr",null,null,-1)),i[309]||(i[309]=l("h2",{id:"_4-docker-compose",tabindex:"-1"},[s("4. Docker-Compose "),l("a",{class:"header-anchor",href:"#_4-docker-compose","aria-label":'Permalink to "4. Docker-Compose"'},"​")],-1)),i[310]||(i[310]=l("p",null,"Docker Compose可以基于Compose文件帮我们快速的部署分布式应用，而无需手动一个个创建和运行容器！",-1)),i[311]||(i[311]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731180921742.png",alt:"image-20210731180921742",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[312]||(i[312]=l("h3",{id:"_4-1-初识dockercompose",tabindex:"-1"},[s("4.1 初识DockerCompose "),l("a",{class:"header-anchor",href:"#_4-1-初识dockercompose","aria-label":'Permalink to "4.1 初识DockerCompose"'},"​")],-1)),i[313]||(i[313]=l("p",null,"Compose文件是一个文本文件，通过指令定义集群中的每个容器如何运行。格式如下：",-1)),i[314]||(i[314]=l("div",{class:"language-json max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"json"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"version: "),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"3.8"')]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," services:")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  mysql:")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    image: mysql:"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"5.7"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"25")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    environment:")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"     MYSQL_ROOT_PASSWORD: "),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"123"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    volumes:")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"     - "),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/tmp/mysql/data:/var/lib/mysql"')]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"     - "),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/tmp/mysql/conf/hmy.cnf:/etc/mysql/conf.d/hmy.cnf"')]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  web:")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    build: .")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    ports:")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"     - "),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"8090:8090"')])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[315]||(i[315]=l("p",null,"上面的Compose文件就描述一个项目，其中包含两个容器：",-1)),i[316]||(i[316]=l("ul",null,[l("li",null,[s("mysql：一个基于"),l("code",null,"mysql:5.7.25"),s("镜像构建的容器，并且挂载了两个目录")]),l("li",null,[s("web：一个基于"),l("code",null,"docker build"),s("临时构建的镜像容器，映射端口时8090")])],-1)),i[317]||(i[317]=l("p",null,[s("DockerCompose的详细语法参考官网："),l("a",{href:"https://docs.docker.com/compose/compose-file/",target:"_blank",rel:"noreferrer"},"https://docs.docker.com/compose/compose-file/")],-1)),i[318]||(i[318]=l("p",null,"其实DockerCompose文件可以看做是将多个docker run命令写到一个文件，只是语法稍有差异。",-1)),i[319]||(i[319]=l("h3",{id:"_4-2-安装dockercompose",tabindex:"-1"},[s("4.2 安装DockerCompose "),l("a",{class:"header-anchor",href:"#_4-2-安装dockercompose","aria-label":'Permalink to "4.2 安装DockerCompose"'},"​")],-1)),i[320]||(i[320]=l("h4",{id:"centos7安装dockercompose",tabindex:"-1"},[s("CentOS7安装DockerCompose "),l("a",{class:"header-anchor",href:"#centos7安装dockercompose","aria-label":'Permalink to "CentOS7安装DockerCompose"'},"​")],-1)),i[321]||(i[321]=l("h5",{id:"_1-下载",tabindex:"-1"},[s("1. 下载 "),l("a",{class:"header-anchor",href:"#_1-下载","aria-label":'Permalink to "1. 下载"'},"​")],-1)),i[322]||(i[322]=l("p",null,"Linux下需要通过命令下载：",-1)),i[323]||(i[323]=l("div",{class:"language-sh max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"sh"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 安装")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"curl"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -L"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," https://github.com/docker/compose/releases/download/1.23.1/docker-compose-`"),l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"uname"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -s"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"`"),l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"-"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"`"),l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"uname"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -m"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"`"),l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," >"),l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," /usr/local/bin/docker-compose")])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[324]||(i[324]=l("p",null,"如果下载速度较慢，或者下载失败，可以使用课前资料提供的docker-compose文件：",-1)),i[325]||(i[325]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210417133020614.png",alt:"image-20210417133020614",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[326]||(i[326]=l("p",null,[s("上传到"),l("code",null,"/usr/local/bin/"),s("目录也可以。")],-1)),i[327]||(i[327]=l("h5",{id:"_2-修改文件权限",tabindex:"-1"},[s("2. 修改文件权限 "),l("a",{class:"header-anchor",href:"#_2-修改文件权限","aria-label":'Permalink to "2. 修改文件权限"'},"​")],-1)),i[328]||(i[328]=l("p",null,"修改文件权限：",-1)),i[329]||(i[329]=l("div",{class:"language-sh max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"sh"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 修改权限")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"chmod"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," +x"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /usr/local/bin/docker-compose")])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[330]||(i[330]=l("h5",{id:"_3-base自动补全命令",tabindex:"-1"},[s("3. Base自动补全命令： "),l("a",{class:"header-anchor",href:"#_3-base自动补全命令","aria-label":'Permalink to "3. Base自动补全命令："'},"​")],-1)),i[331]||(i[331]=l("div",{class:"language-sh max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"sh"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 补全命令")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"curl"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -L"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," https://raw.githubusercontent.com/docker/compose/1.29.1/contrib/completion/bash/docker-compose"),l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," >"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /etc/bash_completion.d/docker-compose")])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[332]||(i[332]=l("p",null,"如果这里出现错误，需要修改自己的hosts文件：",-1)),i[333]||(i[333]=l("div",{class:"language-sh max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"sh"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"echo"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "199.232.68.133 raw.githubusercontent.com"'),l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," >>"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /etc/hosts")])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[334]||(i[334]=l("h3",{id:"_4-3-部署微服务集群",tabindex:"-1"},[s("4.3 部署微服务集群 "),l("a",{class:"header-anchor",href:"#_4-3-部署微服务集群","aria-label":'Permalink to "4.3 部署微服务集群"'},"​")],-1)),i[335]||(i[335]=l("p",null,[l("strong",null,"需求"),s("：将之前学习的cloud-demo微服务集群利用DockerCompose部署")],-1)),i[336]||(i[336]=l("p",null,[l("strong",null,"实现思路"),s("：")],-1)),i[337]||(i[337]=l("p",null,"① 查看课前资料提供的cloud-demo文件夹，里面已经编写好了docker-compose文件",-1)),i[338]||(i[338]=l("p",null,"② 修改自己的cloud-demo项目，将数据库、nacos地址都命名为docker-compose中的服务名",-1)),i[339]||(i[339]=l("p",null,"③ 使用maven打包工具，将项目中的每个微服务都打包为app.jar",-1)),i[340]||(i[340]=l("p",null,"④ 将打包好的app.jar拷贝到cloud-demo中的每一个对应的子目录中",-1)),i[341]||(i[341]=l("p",null,[s("⑤ 将cloud-demo上传至虚拟机，利用 "),l("code",null,"docker-compose up -d"),s(" 来部署")],-1)),i[342]||(i[342]=l("h4",{id:"_4-3-1-compose文件",tabindex:"-1"},[s("4.3.1 compose文件 "),l("a",{class:"header-anchor",href:"#_4-3-1-compose文件","aria-label":'Permalink to "4.3.1 compose文件"'},"​")],-1)),i[343]||(i[343]=l("p",null,"查看课前资料提供的cloud-demo文件夹，里面已经编写好了docker-compose文件，而且每个微服务都准备了一个独立的目录：",-1)),i[344]||(i[344]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210731181341330.png",alt:"image-20210731181341330",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[345]||(i[345]=l("p",null,"内容如下：",-1)),i[346]||(i[346]=l("div",{class:"language-yaml max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"yaml"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"version"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"3.2"')]),s(`
`),l("span",{class:"line"}),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"services"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  nacos"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    image"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"nacos/nacos-server")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    environment"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"      MODE"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"standalone")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    ports"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"8848:8848"')]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  mysql"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    image"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"mysql:5.7.25")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    environment"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"      MYSQL_ROOT_PASSWORD"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"123")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    volumes"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"$PWD/mysql/data:/var/lib/mysql"')]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"$PWD/mysql/conf:/etc/mysql/conf.d/"')]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  userservice"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    build"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"./user-service")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  orderservice"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    build"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"./order-service")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  gateway"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    build"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"./gateway")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    ports"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"10010:10010"')])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[347]||(i[347]=l("p",null,"可以看到，其中包含5个service服务：",-1)),i[348]||(i[348]=l("ul",null,[l("li",null,[l("code",null,"nacos"),s("：作为注册中心和配置中心 "),l("ul",null,[l("li",null,[l("code",null,"image: nacos/nacos-server"),s("： 基于nacos/nacos-server镜像构建")]),l("li",null,[l("code",null,"environment"),s("：环境变量 "),l("ul",null,[l("li",null,[l("code",null,"MODE: standalone"),s("：单点模式启动")])])]),l("li",null,[l("code",null,"ports"),s("：端口映射，这里暴露了8848端口")])])]),l("li",null,[l("code",null,"mysql"),s("：数据库 "),l("ul",null,[l("li",null,[l("code",null,"image: mysql:5.7.25"),s("：镜像版本是mysql:5.7.25")]),l("li",null,[l("code",null,"environment"),s("：环境变量 "),l("ul",null,[l("li",null,[l("code",null,"MYSQL_ROOT_PASSWORD: 123"),s("：设置数据库root账户的密码为123")])])]),l("li",null,[l("code",null,"volumes"),s("：数据卷挂载，这里挂载了mysql的data、conf目录，其中有我提前准备好的数据")])])]),l("li",null,[l("code",null,"userservice"),s("、"),l("code",null,"orderservice"),s("、"),l("code",null,"gateway"),s("：都是基于Dockerfile临时构建的")])],-1)),i[349]||(i[349]=l("p",null,"查看mysql目录，可以看到其中已经准备好了cloud_order、cloud_user表：",-1)),i[350]||(i[350]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210801095205034.png",alt:"image-20210801095205034",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[351]||(i[351]=l("p",null,"查看微服务目录，可以看到都包含Dockerfile文件：",-1)),i[352]||(i[352]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210801095320586.png",alt:"image-20210801095320586",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[353]||(i[353]=l("p",null,"内容如下：",-1)),i[354]||(i[354]=l("div",{class:"language-dockerfile max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"dockerfile"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"FROM"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," java:8-alpine")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"COPY"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ./app.jar /tmp/app.jar")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ENTRYPOINT"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," java -jar /tmp/app.jar")])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[355]||(i[355]=l("h4",{id:"_4-3-2-修改微服务配置",tabindex:"-1"},[s("4.3.2 修改微服务配置 "),l("a",{class:"header-anchor",href:"#_4-3-2-修改微服务配置","aria-label":'Permalink to "4.3.2 修改微服务配置"'},"​")],-1)),i[356]||(i[356]=l("p",null,"因为微服务将来要部署为docker容器，而容器之间互联不是通过IP地址，而是通过容器名。这里我们将order-service、user-service、gateway服务的mysql、nacos地址都修改为基于容器名的访问。",-1)),i[357]||(i[357]=l("p",null,"如下所示：",-1)),i[358]||(i[358]=l("div",{class:"language-yaml max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"yaml"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"spring"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  datasource"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    url"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"jdbc:mysql://mysql:3306/cloud_order?useSSL=false")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    username"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"root")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    password"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"123")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    driver-class-name"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"com.mysql.jdbc.Driver")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  application"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    name"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"orderservice")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  cloud"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    nacos"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"      server-addr"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"nacos:8848"),l("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," # nacos服务地址")])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[359]||(i[359]=l("h4",{id:"_4-3-3-打包",tabindex:"-1"},[s("4.3.3 打包 "),l("a",{class:"header-anchor",href:"#_4-3-3-打包","aria-label":'Permalink to "4.3.3 打包"'},"​")],-1)),i[360]||(i[360]=l("p",null,"接下来需要将我们的每个微服务都打包。因为之前查看到Dockerfile中的jar包名称都是app.jar，因此我们的每个微服务都需要用这个名称。",-1)),i[361]||(i[361]=l("p",null,"可以通过修改pom.xml中的打包名称来实现，每个微服务都需要修改：",-1)),i[362]||(i[362]=l("div",{class:"language-xml max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"xml"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"build"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  <!-- 服务打包的最终名称 -->")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  <"),l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"finalName"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">app</"),l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"finalName"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  <"),l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"plugins"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    <"),l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"plugin"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      <"),l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"groupId"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">org.springframework.boot</"),l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"groupId"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      <"),l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"artifactId"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">spring-boot-maven-plugin</"),l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"artifactId"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    </"),l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"plugin"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  </"),l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"plugins"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"</"),l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"build"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[363]||(i[363]=l("p",null,"打包后：",-1)),i[364]||(i[364]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210801095951030.png",alt:"image-20210801095951030",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[365]||(i[365]=l("h4",{id:"_4-3-4-拷贝jar包到部署目录",tabindex:"-1"},[s("4.3.4 拷贝jar包到部署目录 "),l("a",{class:"header-anchor",href:"#_4-3-4-拷贝jar包到部署目录","aria-label":'Permalink to "4.3.4 拷贝jar包到部署目录"'},"​")],-1)),i[366]||(i[366]=l("p",null,"编译打包好的app.jar文件，需要放到Dockerfile的同级目录中。注意：每个微服务的app.jar放到与服务名称对应的目录，别搞错了。",-1)),i[367]||(i[367]=l("p",null,"user-service：",-1)),i[368]||(i[368]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210801100201253.png",alt:"image-20210801100201253",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[369]||(i[369]=l("p",null,"order-service：",-1)),i[370]||(i[370]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210801100231495.png",alt:"image-20210801100231495",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[371]||(i[371]=l("p",null,"gateway：",-1)),i[372]||(i[372]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210801100308102.png",alt:"image-20210801100308102",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[373]||(i[373]=l("h4",{id:"_4-3-5-部署",tabindex:"-1"},[s("4.3.5 部署 "),l("a",{class:"header-anchor",href:"#_4-3-5-部署","aria-label":'Permalink to "4.3.5 部署"'},"​")],-1)),i[374]||(i[374]=l("p",null,"最后，我们需要将文件整个cloud-demo文件夹上传到虚拟机中，理由DockerCompose部署。",-1)),i[375]||(i[375]=l("p",null,"上传到任意目录：",-1)),i[376]||(i[376]=l("figure",null,[l("img",{src:"https://gcore.jsdelivr.net/gh/imLKlauS/blog-picture@main/blogs/image-20210801100955653.png",alt:"image-20210801100955653",loading:"lazy",decoding:"async",class:"lazy"})],-1)),i[377]||(i[377]=l("p",null,"部署：",-1)),i[378]||(i[378]=l("p",null,"进入cloud-demo目录，然后运行下面的命令：",-1)),i[379]||(i[379]=l("div",{class:"language-sh max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"sh"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker-compose"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," up"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -d")])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[380]||(i[380]=l("hr",null,null,-1)),i[381]||(i[381]=l("h2",{id:"_5-docker镜像仓库",tabindex:"-1"},[s("5. Docker镜像仓库 "),l("a",{class:"header-anchor",href:"#_5-docker镜像仓库","aria-label":'Permalink to "5. Docker镜像仓库"'},"​")],-1)),i[382]||(i[382]=l("h3",{id:"_5-1-搭建私有镜像仓库",tabindex:"-1"},[s("5.1 搭建私有镜像仓库 "),l("a",{class:"header-anchor",href:"#_5-1-搭建私有镜像仓库","aria-label":'Permalink to "5.1 搭建私有镜像仓库"'},"​")],-1)),i[383]||(i[383]=l("h4",{id:"docker镜像仓库",tabindex:"-1"},[s("Docker镜像仓库 "),l("a",{class:"header-anchor",href:"#docker镜像仓库","aria-label":'Permalink to "Docker镜像仓库"'},"​")],-1)),i[384]||(i[384]=l("p",null,"搭建镜像仓库可以基于Docker官方提供的DockerRegistry来实现。",-1)),i[385]||(i[385]=l("p",null,[s("官网地址："),l("a",{href:"https://hub.docker.com/_/registry",target:"_blank",rel:"noreferrer"},"https://hub.docker.com/_/registry")],-1)),i[386]||(i[386]=l("h5",{id:"_1-简化版镜像仓库",tabindex:"-1"},[s("1. 简化版镜像仓库 "),l("a",{class:"header-anchor",href:"#_1-简化版镜像仓库","aria-label":'Permalink to "1. 简化版镜像仓库"'},"​")],-1)),i[387]||(i[387]=l("p",null,"Docker官方的Docker Registry是一个基础版本的Docker镜像仓库，具备仓库管理的完整功能，但是没有图形化界面。",-1)),i[388]||(i[388]=l("p",null,"搭建方式比较简单，命令如下：",-1)),i[389]||(i[389]=l("div",{class:"language-sh max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"sh"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," run"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -d"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    --restart=always"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    --name"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," registry"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"	\\")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    -p"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 5000:5000"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    -v"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," registry-data:/var/lib/registry"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"    registry")])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[390]||(i[390]=l("p",null,"命令中挂载了一个数据卷registry-data到容器内的/var/lib/registry 目录，这是私有镜像库存放数据的目录。",-1)),i[391]||(i[391]=l("p",null,[s("访问"),l("a",{href:"http://YourIp:5000/v2/_catalog",target:"_blank",rel:"noreferrer"},"http://YourIp:5000/v2/_catalog"),s(" 可以查看当前私有镜像服务中包含的镜像")],-1)),i[392]||(i[392]=l("h5",{id:"_2-带有图形化界面版本",tabindex:"-1"},[s("2. 带有图形化界面版本 "),l("a",{class:"header-anchor",href:"#_2-带有图形化界面版本","aria-label":'Permalink to "2. 带有图形化界面版本"'},"​")],-1)),i[393]||(i[393]=l("p",null,"使用DockerCompose部署带有图象界面的DockerRegistry，命令如下：",-1)),i[394]||(i[394]=l("div",{class:"language-yaml max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"yaml"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"version"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'3.0'")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"services"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  registry"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    image"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"registry")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    volumes"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"./registry-data:/var/lib/registry")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  ui"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    image"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"joxit/docker-registry-ui:static")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    ports"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"8080:80")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    environment"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"REGISTRY_TITLE=传智教育私有仓库")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"REGISTRY_URL=http://registry:5000")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    depends_on"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"registry")])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[395]||(i[395]=l("h5",{id:"_3-配置docker信任地址",tabindex:"-1"},[s("3. 配置Docker信任地址 "),l("a",{class:"header-anchor",href:"#_3-配置docker信任地址","aria-label":'Permalink to "3. 配置Docker信任地址"'},"​")],-1)),i[396]||(i[396]=l("p",null,"我们的私服采用的是http协议，默认不被Docker信任，所以需要做一个配置：",-1)),i[397]||(i[397]=l("div",{class:"language-sh max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"sh"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 打开要修改的文件")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"vi"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /etc/docker/daemon.json")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 添加内容：")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},'"insecure-registries"'),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},":"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"["),l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},'"http://192.168.150.101:8080"'),l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"]")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 重加载")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"systemctl"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," daemon-reload")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 重启docker")]),s(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"systemctl"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," restart"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," docker")])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[398]||(i[398]=l("h3",{id:"_5-2-推送、拉取镜像",tabindex:"-1"},[s("5.2 推送、拉取镜像 "),l("a",{class:"header-anchor",href:"#_5-2-推送、拉取镜像","aria-label":'Permalink to "5.2 推送、拉取镜像"'},"​")],-1)),i[399]||(i[399]=l("p",null,"推送镜像到私有镜像服务必须先tag，步骤如下：",-1)),i[400]||(i[400]=l("p",null,[s("① 重新tag本地镜像，名称前缀为私有仓库的地址："),l("code",null,"192.168.150.101:8080/")],-1)),i[401]||(i[401]=l("div",{class:"language-sh max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"sh"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," tag"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," nginx:latest"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 192.168.150.101:8080/nginx:1.0")])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[402]||(i[402]=l("p",null,"② 推送镜像",-1)),i[403]||(i[403]=l("div",{class:"language-sh max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"sh"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," push"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 192.168.150.101:8080/nginx:1.0")])])]),l("button",{class:"code-block-unfold-btn"})],-1)),i[404]||(i[404]=l("p",null,"③ 拉取镜像",-1)),i[405]||(i[405]=l("div",{class:"language-sh max-h-300px"},[l("button",{title:"Copy code",class:"copy"}),l("span",{class:"lang"},"sh"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," pull"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 192.168.150.101:8080/nginx:1.0")])])]),l("button",{class:"code-block-unfold-btn"})],-1))]),"main-header":a(()=>[t(n.$slots,"main-header")]),"main-header-after":a(()=>[t(n.$slots,"main-header-after")]),"main-nav":a(()=>[t(n.$slots,"main-nav")]),"main-content-before":a(()=>[t(n.$slots,"main-content-before")]),"main-content":a(()=>[t(n.$slots,"main-content")]),"main-content-after":a(()=>[t(n.$slots,"main-content-after")]),"main-nav-before":a(()=>[t(n.$slots,"main-nav-before")]),"main-nav-after":a(()=>[t(n.$slots,"main-nav-after")]),comment:a(()=>[t(n.$slots,"comment")]),footer:a(()=>[t(n.$slots,"footer")]),aside:a(()=>[t(n.$slots,"aside")]),"aside-custom":a(()=>[t(n.$slots,"aside-custom")]),default:a(()=>[t(n.$slots,"default")]),_:3},8,["frontmatter"])}}};export{w as default,x as usePageData};
